(function(Uf,Vf,Wf){function I(a,b){function c(){}c.prototype=a;var d=new c,e;for(e in b)d[e]=b[e];b.toString!==Object.prototype.toString&&(d.toString=b.toString);return d}function w(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=Xf++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];null==c&&(c=function(){return c.method.apply(c.scope,arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c);return c}var Xc=function(){this._animationFrameId=null;this.pixelRatio=
1;this.set_skipFrame(!1);this.autoResize=!0;this.roundPixels=this.forceFXAA=this.antialias=this.transparent=!1;this.clearBeforeRender=!0;this.preserveDrawingBuffer=!1;this.backgroundColor=16777215;this.width=window.innerWidth;this.height=window.innerHeight;this.set_fps(60)};Xc.__name__=!0;Xc.prototype={set_fps:function(a){this._frameCount=0;return 1<=a&&60>a?this.fps=a|0:this.fps=60},set_skipFrame:function(a){a&&(Uf.log("pixi.plugins.app.Application > Deprecated: skipFrame - use fps property and set it to 30 instead"),
this.set_fps(30));return this.skipFrame=a},_setDefaultValues:function(){this._animationFrameId=null;this.pixelRatio=1;this.set_skipFrame(!1);this.autoResize=!0;this.roundPixels=this.forceFXAA=this.antialias=this.transparent=!1;this.clearBeforeRender=!0;this.preserveDrawingBuffer=!1;this.backgroundColor=16777215;this.width=window.innerWidth;this.height=window.innerHeight;this.set_fps(60)},start:function(a,b,c){null==a&&(a="auto");null==c?(this.canvas=window.document.createElement("canvas"),this.canvas.style.width=
this.width+"px",this.canvas.style.height=this.height+"px",this.canvas.style.position="absolute"):this.canvas=c;null==b?window.document.body.appendChild(this.canvas):b.appendChild(this.canvas);this.stage=new PIXI.Container;c={};c.view=this.canvas;c.backgroundColor=this.backgroundColor;c.resolution=this.pixelRatio;c.antialias=this.antialias;c.forceFXAA=this.forceFXAA;c.autoResize=this.autoResize;c.transparent=this.transparent;c.clearBeforeRender=this.clearBeforeRender;c.preserveDrawingBuffer=this.preserveDrawingBuffer;
this.renderer="auto"==a?PIXI.autoDetectRenderer(this.width,this.height,c):"canvas"==a?new PIXI.CanvasRenderer(this.width,this.height,c):new PIXI.WebGLRenderer(this.width,this.height,c);this.roundPixels&&(this.renderer.roundPixels=!0);null==b?window.document.body.appendChild(this.renderer.view):b.appendChild(this.renderer.view);this.resumeRendering()},pauseRendering:function(){window.onresize=null;null!=this._animationFrameId&&(window.cancelAnimationFrame(this._animationFrameId),this._animationFrameId=
null)},resumeRendering:function(){this.autoResize&&(window.onresize=w(this,this._onWindowResize));null==this._animationFrameId&&(this._animationFrameId=window.requestAnimationFrame(w(this,this._onRequestAnimationFrame)))},_onWindowResize:function(a){this.width=window.innerWidth;this.height=window.innerHeight;this.renderer.resize(this.width,this.height);this.canvas.style.width=this.width+"px";this.canvas.style.height=this.height+"px";if(null!=this.onResize)this.onResize()},_onRequestAnimationFrame:function(a){this._frameCount++;
if(this._frameCount==(60/this.fps|0)){this._frameCount=0;if(null!=this.onUpdate)this.onUpdate(a);this.renderer.render(this.stage)}this._animationFrameId=window.requestAnimationFrame(w(this,this._onRequestAnimationFrame))},addStats:function(){null!=window.Perf&&(new qa).addInfo(["UNKNOWN","WEBGL","CANVAS"][this.renderer.type]+" - "+this.pixelRatio)},__class__:Xc};var la=function(){Xc.call(this);this.loadAssets()};la.__name__=!0;la.main=function(){la._instance=new la};la.getCurrentWidth=function(){return la._instance.width};
la.getCurrentHeight=function(){return la._instance.height};la.__super__=Xc;la.prototype=I(Xc.prototype,{loadAssets:function(){var a=new PIXI.loaders.Loader;a.add("spritesheet","assets/mc.json");a.load(w(this,this.onAssetsLoaded))},onAssetsLoaded:function(){this.init();this.currentScreen=new fe;this.stage.addChild(this.currentScreen);this.onUpdate=(fa=this.currentScreen,w(fa,fa.update))},init:function(){this.backgroundColor=6724095;this.autoResize=!0;Xc.prototype.start.call(this);this.initListeners()},
initListeners:function(){window.addEventListener("orientationchange",w(this,this.onOrientationChange),!1);window.onbeforeunload=w(this,this.onGameExit)},onGameExit:function(a){return this.currentScreen.onGameExit(a)},onOrientationChange:function(a){window.location.reload()},__class__:la});Math.__name__=!0;var qa=Vf.Perf=function(a,b){null==b&&(b=0);null==a&&(a="TR");this._perfObj=window.performance;null!=ub.field(this._perfObj,"memory")&&(this._memoryObj=ub.field(this._perfObj,"memory"));this._memCheck=
null!=this._perfObj&&null!=this._memoryObj&&0<this._memoryObj.totalJSHeapSize;this._pos=a;this._offset=b;this.currentFps=60;this.currentMs=0;this.currentMem="0";this.avgFps=this.lowFps=60;this._ticks=this._time=this._totalFps=this._measureCount=0;this._fpsMax=this._fpsMin=60;null!=this._perfObj&&null!=(fa=this._perfObj,w(fa,fa.now))?this._startTime=this._perfObj.now():this._startTime=(new Date).getTime();this._prevTime=-qa.MEASUREMENT_INTERVAL;this._createFpsDom();this._createMsDom();this._memCheck&&
this._createMemoryDom();null!=(fa=window,w(fa,fa.requestAnimationFrame))?this.RAF=(fa=window,w(fa,fa.requestAnimationFrame)):null!=window.mozRequestAnimationFrame?this.RAF=window.mozRequestAnimationFrame:null!=window.webkitRequestAnimationFrame?this.RAF=window.webkitRequestAnimationFrame:null!=window.msRequestAnimationFrame&&(this.RAF=window.msRequestAnimationFrame);null!=(fa=window,w(fa,fa.cancelAnimationFrame))?this.CAF=(fa=window,w(fa,fa.cancelAnimationFrame)):null!=window.mozCancelAnimationFrame?
this.CAF=window.mozCancelAnimationFrame:null!=window.webkitCancelAnimationFrame?this.CAF=window.webkitCancelAnimationFrame:null!=window.msCancelAnimationFrame&&(this.CAF=window.msCancelAnimationFrame);null!=this.RAF&&(this._raf=ub.callMethod(window,this.RAF,[w(this,this._tick)]))};qa.__name__=!0;qa.prototype={_init:function(){this.currentFps=60;this.currentMs=0;this.currentMem="0";this.avgFps=this.lowFps=60;this._ticks=this._time=this._totalFps=this._measureCount=0;this._fpsMax=this._fpsMin=60;null!=
this._perfObj&&null!=(fa=this._perfObj,w(fa,fa.now))?this._startTime=this._perfObj.now():this._startTime=(new Date).getTime();this._prevTime=-qa.MEASUREMENT_INTERVAL},_now:function(){return null!=this._perfObj&&null!=(fa=this._perfObj,w(fa,fa.now))?this._perfObj.now():(new Date).getTime()},_tick:function(a){var b;b=null!=this._perfObj&&null!=(fa=this._perfObj,w(fa,fa.now))?this._perfObj.now():(new Date).getTime();this._ticks++;null!=this._raf&&b>this._prevTime+qa.MEASUREMENT_INTERVAL&&(this.currentMs=
Math.round(b-this._startTime),this.ms.innerHTML="MS: "+this.currentMs,this.currentFps=Math.round(1E3*this._ticks/(b-this._prevTime)),0<this.currentFps&&a>qa.DELAY_TIME&&(this._measureCount++,this._totalFps+=this.currentFps,this.lowFps=this._fpsMin=Math.min(this._fpsMin,this.currentFps),this._fpsMax=Math.max(this._fpsMax,this.currentFps),this.avgFps=Math.round(this._totalFps/this._measureCount)),this.fps.innerHTML="FPS: "+this.currentFps+" ("+this._fpsMin+"-"+this._fpsMax+")",this.fps.style.backgroundColor=
30<=this.currentFps?qa.FPS_BG_CLR:15<=this.currentFps?qa.FPS_WARN_BG_CLR:qa.FPS_PROB_BG_CLR,this._prevTime=b,this._ticks=0,this._memCheck&&(this.currentMem=this._getFormattedSize(this._memoryObj.usedJSHeapSize,2),this.memory.innerHTML="MEM: "+this.currentMem));this._startTime=b;null!=this._raf&&(this._raf=ub.callMethod(window,this.RAF,[w(this,this._tick)]))},_createDiv:function(a,b){null==b&&(b=0);var c;c=window.document.createElement("div");c.id=a;c.className=a;c.style.position="absolute";switch(this._pos){case "TL":c.style.left=
this._offset+"px";c.style.top=b+"px";break;case "TR":c.style.right=this._offset+"px";c.style.top=b+"px";break;case "BL":c.style.left=this._offset+"px";c.style.bottom=(this._memCheck?48:32)-b+"px";break;case "BR":c.style.right=this._offset+"px",c.style.bottom=(this._memCheck?48:32)-b+"px"}c.style.width="80px";c.style.height="12px";c.style.lineHeight="12px";c.style.padding="2px";c.style.fontFamily=qa.FONT_FAMILY;c.style.fontSize="9px";c.style.fontWeight="bold";c.style.textAlign="center";window.document.body.appendChild(c);
return c},_createFpsDom:function(){this.fps=this._createDiv("fps");this.fps.style.backgroundColor=qa.FPS_BG_CLR;this.fps.style.zIndex="995";this.fps.style.color=qa.FPS_TXT_CLR;this.fps.innerHTML="FPS: 0"},_createMsDom:function(){this.ms=this._createDiv("ms",16);this.ms.style.backgroundColor=qa.MS_BG_CLR;this.ms.style.zIndex="996";this.ms.style.color=qa.MS_TXT_CLR;this.ms.innerHTML="MS: 0"},_createMemoryDom:function(){this.memory=this._createDiv("memory",32);this.memory.style.backgroundColor=qa.MEM_BG_CLR;
this.memory.style.color=qa.MEM_TXT_CLR;this.memory.style.zIndex="997";this.memory.innerHTML="MEM: 0"},_getFormattedSize:function(a,b){null==b&&(b=0);if(0==a)return"0";var c=Math.pow(10,b),d=Math.floor(Math.log(a)/Math.log(1024));return Math.round(a*c/Math.pow(1024,d))/c+" "+["Bytes","KB","MB","GB","TB"][d]},addInfo:function(a){this.info=this._createDiv("info",this._memCheck?48:32);this.info.style.backgroundColor=qa.INFO_BG_CLR;this.info.style.color=qa.INFO_TXT_CLR;this.info.style.zIndex="998";this.info.innerHTML=
a},clearInfo:function(){null!=this.info&&(window.document.body.removeChild(this.info),this.info=null)},destroy:function(){ub.callMethod(window,this.CAF,[this._raf]);this._memoryObj=this._perfObj=this._raf=null;null!=this.fps&&(window.document.body.removeChild(this.fps),this.fps=null);null!=this.ms&&(window.document.body.removeChild(this.ms),this.ms=null);null!=this.memory&&(window.document.body.removeChild(this.memory),this.memory=null);this.clearInfo();this.currentFps=60;this.currentMs=0;this.currentMem=
"0";this.avgFps=this.lowFps=60;this._ticks=this._time=this._totalFps=this._measureCount=0;this._fpsMax=this._fpsMin=60;null!=this._perfObj&&null!=(fa=this._perfObj,w(fa,fa.now))?this._startTime=this._perfObj.now():this._startTime=(new Date).getTime();this._prevTime=-qa.MEASUREMENT_INTERVAL},_cancelRAF:function(){ub.callMethod(window,this.CAF,[this._raf]);this._raf=null},__class__:qa};var ub=function(){};ub.__name__=!0;ub.field=function(a,b){try{return a[b]}catch(c){return c instanceof f&&(c=c.val),
null}};ub.setField=function(a,b,c){a[b]=c};ub.callMethod=function(a,b,c){return b.apply(a,c)};ub.fields=function(a){var b=[];if(null!=a){var c=Object.prototype.hasOwnProperty,d;for(d in a)"__id__"!=d&&"hx__closures__"!=d&&c.call(a,d)&&b.push(d)}return b};ub.copy=function(a){for(var b={},c=0,d=ub.fields(a);c<d.length;){var e=d[c];++c;ub.setField(b,e,ub.field(a,e))}return b};var Za=function(){};Za.__name__=!0;Za.string=function(a){return ca.__string_rec(a,"")};Za.random=function(a){return 0>=a?0:Math.floor(Math.random()*
a)};var Ed=function(){};Ed.__name__=!0;Ed.hex=function(a,b){var c="";do c="0123456789ABCDEF".charAt(a&15)+c,a>>>=4;while(0<a);if(null!=b)for(;c.length<b;)c="0"+c;return c};var Fd=function(a){PIXI.Sprite.call(this,PIXI.Texture.fromImage("assets/ball.png"));this.buttonMode=this.interactive=!0;this.anchor.set(.5,.5);a.addListener("change",w(this,this.update));this.model=a};Fd.__name__=!0;Fd.__super__=PIXI.Sprite;Fd.prototype=I(PIXI.Sprite.prototype,{getBody:function(){return this.model.getBody()},update:function(a){this.position.x=
this.model.get_x();this.position.y=this.model.get_y();this.rotation=this.model.get_rotation()},startDrag:function(){this.model.set_isCollisionEnabled(!1);this.revive()},freeze:function(){this.model.freeze()},revive:function(){this.model.revive()},stopDrag:function(){this.model.set_isCollisionEnabled(!0)},toggleTexture:function(a){this.texture=a?PIXI.Texture.fromImage("assets/bunny.png"):PIXI.Texture.fromImage("assets/ball.png");this.model.setColliderRadius(a?10:25)},__class__:Fd});var ge=function(){this.explosionTextures=
[];for(var a=0;26>a;){var b=a++,b=PIXI.Texture.fromFrame("Explosion_Sequence_A "+(b+1)+".png");this.explosionTextures.push(b)}PIXI.extras.MovieClip.call(this,this.explosionTextures);this.animationSpeed=.5;this.loop=!1;this.onComplete=w(this,this.onAnimationFinish);this.anchor.set(.5,.5)};ge.__name__=!0;ge.__super__=PIXI.extras.MovieClip;ge.prototype=I(PIXI.extras.MovieClip.prototype,{onAnimationFinish:function(){this.stop();null!=this.parent&&this.parent.removeChild(this)},__class__:ge});var le=function(){this.isOn=
!1;PIXI.Graphics.call(this);this.buttonMode=this.interactive=!0;this.label=new PIXI.Text("Fun mode: OFF",{fill:16777215});this.label.x=this.label.y=20;this.addChild(this.label);this.beginFill(16711680,.8);this.lineStyle(2,16711680);this.drawRect(0,0,this.label.width+40,this.label.height+40)};le.__name__=!0;le.__super__=PIXI.Graphics;le.prototype=I(PIXI.Graphics.prototype,{toggle:function(){this.isOn=!this.isOn;this.label.text="Fun mode: "+(this.isOn?"ON":"OFF")},__class__:le});var f=function(a){Error.call(this);
this.val=a;this.message=String(a);Error.captureStackTrace&&Error.captureStackTrace(this,f)};f.__name__=!0;f.__super__=Error;f.prototype=I(Error.prototype,{__class__:f});var ca=function(){};ca.__name__=!0;ca.getClass=function(a){if(a instanceof Array&&null==a.__enum__)return Array;var b=a.__class__;if(null!=b)return b;a=ca.__nativeClassName(a);return null!=a?ca.__resolveNativeClass(a):null};ca.__string_rec=function(a,b){if(null==a)return"null";if(5<=b.length)return"<...>";var c=typeof a;"function"==
c&&(a.__name__||a.__ename__)&&(c="object");switch(c){case "object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];c=a[0]+"(";b+="\t";for(var d=2,e=a.length;d<e;)var h=d++,c=2!=h?c+(","+ca.__string_rec(a[h],b)):c+ca.__string_rec(a[h],b);return c+")"}c=a.length;d="[";b+="\t";for(e=0;e<c;)h=e++,d+=(0<h?",":"")+ca.__string_rec(a[h],b);return d+"]"}try{d=a.toString}catch(t){return t instanceof f&&(t=t.val),"???"}if(null!=d&&d!=Object.toString&&"function"==typeof d&&(c=a.toString(),"[object Object]"!=
c))return c;c=null;d="{\n";b+="\t";e=null!=a.hasOwnProperty;for(c in a)e&&!a.hasOwnProperty(c)||"prototype"==c||"__class__"==c||"__super__"==c||"__interfaces__"==c||"__properties__"==c||(2!=d.length&&(d+=", \n"),d+=b+c+" : "+ca.__string_rec(a[c],b));b=b.substring(1);return d+("\n"+b+"}");case "function":return"<function>";case "string":return a;default:return String(a)}};ca.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,e=c.length;d<e;){var h=
d++,h=c[h];if(h==b||ca.__interfLoop(h,b))return!0}return ca.__interfLoop(a.__super__,b)};ca.__instanceof=function(a,b){if(null==b)return!1;switch(b){case Yf:return(a|0)===a;case Sf:return"number"==typeof a;case Tf:return"boolean"==typeof a;case String:return"string"==typeof a;case Array:return a instanceof Array&&null==a.__enum__;case Zf:return!0;default:if(null!=a)if("function"==typeof b){if(a instanceof b||ca.__interfLoop(ca.getClass(a),b))return!0}else{if("object"==typeof b&&ca.__isNativeObj(b)&&
a instanceof b)return!0}else return!1;return b==$f&&null!=a.__name__||b==ag&&null!=a.__ename__?!0:a.__enum__==b}};ca.__cast=function(a,b){if(ca.__instanceof(a,b))return a;throw new f("Cannot cast "+Za.string(a)+" to "+Za.string(b));};ca.__nativeClassName=function(a){a=ca.__toStr.call(a).slice(8,-1);return"Object"==a||"Function"==a||"Math"==a||"JSON"==a?null:a};ca.__isNativeObj=function(a){return null!=ca.__nativeClassName(a)};ca.__resolveNativeClass=function(a){return Wf[a]};var Hd=function(){this._isCollisionEnabled=
!0;EventEmitter.call(this);var a=ld;null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new Ga,g.internal=!1);this.body=new a(g.BodyType_DYNAMIC);this.shape=new Gd(25);this.body.zpp_inner.wrap_shapes.add(this.shape);this.body.set_angularVel(0);this.body.set_allowRotation(!0);this.body.setShapeMaterials(hb.rubber())};Hd.__name__=!0;Hd.fromState=function(a){var b=new Hd;1<a.x&&(a.x=.9);1<a.y&&(a.y=.9);b.set_x(a.x*la.getCurrentWidth());b.set_y(a.y*la.getCurrentHeight());b.set_rotation(a.rotation);
return b};Hd.__super__=EventEmitter;Hd.prototype=I(EventEmitter.prototype,{assignSpace:function(a){this.currentSpace=a;this.body.set_space(this.currentSpace)},getBody:function(){return this.body},freeze:function(){this.body.set_rotation(0);this.body.set_angularVel(0);this.body.set_velocity(new E(0,0));this.body.set_space(null)},revive:function(){this.body.get_position().set_x(this.get_x());this.body.get_position().set_y(this.get_y());this.body.set_rotation(this.get_rotation());null==this.body.get_space()&&
this.assignSpace(this.currentSpace)},toObject:function(){return{x:this.get_x()/la.getCurrentWidth(),y:this.get_y()/la.getCurrentHeight(),rotation:this.get_rotation()}},update:function(){this.emit("change")},get_x:function(){return this.body.get_position().get_x()},get_y:function(){return this.body.get_position().get_y()},get_rotation:function(){return this.body.zpp_inner.rot},set_x:function(a){this.body.get_position().set_x(a);return a},set_y:function(a){this.body.get_position().set_y(a);return a},
set_rotation:function(a){this.body.set_rotation(a);return a},set_isCollisionEnabled:function(a){this._isCollisionEnabled=a;this.shape.zpp_inner.filter.wrapper().set_collisionMask(a?-1:0);return a},get_isCollisionEnabled:function(){return this._isCollisionEnabled},setColliderRadius:function(a){this.shape.set_radius(a)},__class__:Hd});var he=function(){PIXI.DisplayObject.call(this);this.ballCollection=[]};he.__name__=!0;he.__super__=PIXI.DisplayObject;he.prototype=I(PIXI.DisplayObject.prototype,{update:function(){for(var a=
0,b=this.ballCollection.length;a<b;){var c=a++;this.ballCollection[c].update()}},addBall:function(a){this.ballCollection.push(a)},toJson:function(){for(var a=[],b=0,c=this.ballCollection.length;b<c;){var d=b++;a.push(this.ballCollection[d].toObject())}return JSON.stringify(a)},fromJson:function(a,b){var c=JSON.parse(a),d;this.ballCollection=[];for(var e=0,h=c.length;e<h;)d=e++,d=Hd.fromState(c[d]),this.ballCollection.push(d),b(d)},__class__:he});var u=function(){};u.__name__=!0;u.prototype={__class__:u};
var mc=function(){this.zpp_inner=null;if(!Ra.internal)throw new f("Error: Callback cannot be instantiated derp!");};mc.__name__=!0;mc.prototype={get_event:function(){return va.events[this.zpp_inner.event]},get_listener:function(){return this.zpp_inner.listener.outer},toString:function(){return""},__class__:mc};var me=function(){mc.call(this)};me.__name__=!0;me.__super__=mc;me.prototype=I(mc.prototype,{get_body:function(){return this.zpp_inner.body.outer},toString:function(){var a;a="Cb:"+["WAKE",
"SLEEP"][this.zpp_inner.event-2];a+=":"+this.zpp_inner.body.outer.toString();return a+=" : listener: "+Za.string(this.zpp_inner.listener.outer)},__class__:me});var nc=function(){this.zpp_inner=null;if(!va.internal)throw new f("Error: Cannot instantiate Listener derp!");};nc.__name__=!0;nc.prototype={get_type:function(){return va.types[this.zpp_inner.type]},get_event:function(){return va.events[this.zpp_inner.event]},set_event:function(a){if(null==a)throw new f("Error: Cannot set listener event type to null");
va.events[this.zpp_inner.event]!=a&&(null==g.CbEvent_BEGIN&&(g.internal=!0,g.CbEvent_BEGIN=new S,g.internal=!1),a==g.CbEvent_BEGIN?a=0:(null==g.CbEvent_ONGOING&&(g.internal=!0,g.CbEvent_ONGOING=new S,g.internal=!1),a==g.CbEvent_ONGOING?a=6:(null==g.CbEvent_END&&(g.internal=!0,g.CbEvent_END=new S,g.internal=!1),a==g.CbEvent_END?a=1:(null==g.CbEvent_SLEEP&&(g.internal=!0,g.CbEvent_SLEEP=new S,g.internal=!1),a==g.CbEvent_SLEEP?a=3:(null==g.CbEvent_WAKE&&(g.internal=!0,g.CbEvent_WAKE=new S,g.internal=
!1),a==g.CbEvent_WAKE?a=2:(null==g.CbEvent_PRE&&(g.internal=!0,g.CbEvent_PRE=new S,g.internal=!1),a=a==g.CbEvent_PRE?5:4))))),this.zpp_inner.swapEvent(a));return va.events[this.zpp_inner.event]},get_precedence:function(){return this.zpp_inner.precedence},set_precedence:function(a){this.zpp_inner.precedence!=a&&(this.zpp_inner.precedence=a,this.zpp_inner.invalidate_precedence());return this.zpp_inner.precedence},get_space:function(){return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},
set_space:function(a){(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)!=a&&(null!=this.zpp_inner.space&&this.zpp_inner.space.outer.zpp_inner.wrap_listeners.remove(this),null!=a?a.zpp_inner.wrap_listeners.add(this):this.zpp_inner.space=null);return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},toString:function(){var a="BEGIN END WAKE SLEEP BREAK PRE ONGOING".split(" ")[this.zpp_inner.event];if(0==this.zpp_inner.type)return"BodyListener{"+a+"::"+Za.string(this.zpp_inner.body.outer_zn.zpp_inner_zn.options.outer)+
"}";if(1==this.zpp_inner.type)return"ConstraintListener{"+a+"::"+Za.string(this.zpp_inner.constraint.outer_zn.zpp_inner_zn.options.outer)+"}";var b=this.zpp_inner.interaction,c;switch(b.itype){case 1:c="COLLISION";break;case 2:c="SENSOR";break;case 4:c="FLUID";break;default:c="ALL"}return(2==this.zpp_inner.type?"InteractionListener{"+a+"#"+c+"::"+Za.string(b.outer_zni.zpp_inner_zn.options1.outer)+":"+Za.string(b.outer_zni.zpp_inner_zn.options2.outer)+"}":"PreListener{"+c+"::"+Za.string(b.outer_znp.zpp_inner_zn.options1.outer)+
":"+Za.string(b.outer_znp.zpp_inner_zn.options2.outer)+"}")+" precedence="+this.zpp_inner.precedence},__class__:nc};var df=function(a,b,c,d){null==d&&(d=0);this.zpp_inner_zn=null;va.internal=!0;nc.call(this);va.internal=!1;if(null==c)throw new f("Error: BodyListener::handler cannot be null");var e=-1;null==g.CbEvent_WAKE&&(g.internal=!0,g.CbEvent_WAKE=new S,g.internal=!1);if(a==g.CbEvent_WAKE)e=2;else if(null==g.CbEvent_SLEEP&&(g.internal=!0,g.CbEvent_SLEEP=new S,g.internal=!1),a==g.CbEvent_SLEEP)e=
3;else throw new f("Error: cbEvent '"+a.toString()+"' is not a valid event type for a BodyListener");this.zpp_inner=this.zpp_inner_zn=new Qd(Yc.argument(b),e,c);this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;this.zpp_inner.precedence=d};df.__name__=!0;df.__super__=nc;df.prototype=I(nc.prototype,{get_options:function(){return this.zpp_inner_zn.options.outer},set_options:function(a){this.zpp_inner_zn.options.set(a.zpp_inner);return this.zpp_inner_zn.options.outer},get_handler:function(){return this.zpp_inner_zn.handler},
set_handler:function(a){if(null==a)throw new f("Error: BodyListener::handler cannot be null");this.zpp_inner_zn.handler=a;return this.zpp_inner_zn.handler},__class__:df});var S=function(){if(!g.internal)throw new f("Error: Cannot instantiate CbEvent derp!");};S.__name__=!0;S.get_BEGIN=function(){null==g.CbEvent_BEGIN&&(g.internal=!0,g.CbEvent_BEGIN=new S,g.internal=!1);return g.CbEvent_BEGIN};S.get_ONGOING=function(){null==g.CbEvent_ONGOING&&(g.internal=!0,g.CbEvent_ONGOING=new S,g.internal=!1);return g.CbEvent_ONGOING};
S.get_END=function(){null==g.CbEvent_END&&(g.internal=!0,g.CbEvent_END=new S,g.internal=!1);return g.CbEvent_END};S.get_WAKE=function(){null==g.CbEvent_WAKE&&(g.internal=!0,g.CbEvent_WAKE=new S,g.internal=!1);return g.CbEvent_WAKE};S.get_SLEEP=function(){null==g.CbEvent_SLEEP&&(g.internal=!0,g.CbEvent_SLEEP=new S,g.internal=!1);return g.CbEvent_SLEEP};S.get_BREAK=function(){null==g.CbEvent_BREAK&&(g.internal=!0,g.CbEvent_BREAK=new S,g.internal=!1);return g.CbEvent_BREAK};S.get_PRE=function(){null==
g.CbEvent_PRE&&(g.internal=!0,g.CbEvent_PRE=new S,g.internal=!1);return g.CbEvent_PRE};S.prototype={toString:function(){null==g.CbEvent_PRE&&(g.internal=!0,g.CbEvent_PRE=new S,g.internal=!1);var a;this==g.CbEvent_PRE?a="PRE":(null==g.CbEvent_BEGIN&&(g.internal=!0,g.CbEvent_BEGIN=new S,g.internal=!1),this==g.CbEvent_BEGIN?a="BEGIN":(null==g.CbEvent_ONGOING&&(g.internal=!0,g.CbEvent_ONGOING=new S,g.internal=!1),this==g.CbEvent_ONGOING?a="ONGOING":(null==g.CbEvent_END&&(g.internal=!0,g.CbEvent_END=new S,
g.internal=!1),this==g.CbEvent_END?a="END":(null==g.CbEvent_WAKE&&(g.internal=!0,g.CbEvent_WAKE=new S,g.internal=!1),this==g.CbEvent_WAKE?a="WAKE":(null==g.CbEvent_SLEEP&&(g.internal=!0,g.CbEvent_SLEEP=new S,g.internal=!1),this==g.CbEvent_SLEEP?a="SLEEP":(null==g.CbEvent_BREAK&&(g.internal=!0,g.CbEvent_BREAK=new S,g.internal=!1),a=this==g.CbEvent_BREAK?"BREAK":""))))));return a},__class__:S};var vb=function(){this.zpp_inner=null;this.zpp_inner=new Ha;this.zpp_inner.outer=this};vb.__name__=!0;vb.get_ANY_BODY=
function(){return Ha.ANY_BODY};vb.get_ANY_CONSTRAINT=function(){return Ha.ANY_CONSTRAINT};vb.get_ANY_SHAPE=function(){return Ha.ANY_SHAPE};vb.get_ANY_COMPOUND=function(){return Ha.ANY_COMPOUND};vb.prototype={get_id:function(){return this.zpp_inner.id},including:function(a){return(new nd(this)).including(a)},excluding:function(a){return(new nd(this)).excluding(a)},get_userData:function(){null==this.zpp_inner.userData&&(this.zpp_inner.userData={});return this.zpp_inner.userData},get_interactors:function(){null==
this.zpp_inner.wrap_interactors&&(this.zpp_inner.wrap_interactors=od.get(this.zpp_inner.interactors,!0));return this.zpp_inner.wrap_interactors},get_constraints:function(){null==this.zpp_inner.wrap_constraints&&(this.zpp_inner.wrap_constraints=mb.get(this.zpp_inner.constraints,!0));return this.zpp_inner.wrap_constraints},toString:function(){return this==Ha.ANY_BODY?"ANY_BODY":this==Ha.ANY_SHAPE?"ANY_SHAPE":this==Ha.ANY_COMPOUND?"ANY_COMPOUND":this==Ha.ANY_CONSTRAINT?"ANY_CONSTRAINT":"CbType#"+this.zpp_inner.id},
__class__:vb};var db=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null;if(!Vb.internal)throw new f("Error: Cannot instantiate CbTypeIterator derp!");};db.__name__=!0;db.get=function(a){var b;null==db.zpp_pool?(Vb.internal=!0,b=new db,Vb.internal=!1):(b=db.zpp_pool,db.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};db.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<
a)return!0;this.zpp_next=db.zpp_pool;db.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:db};var pd=function(){this.zpp_inner=null;this.zpp_inner=new Vb;this.zpp_inner.outer=this};pd.__name__=!0;pd.fromArray=function(a){if(null==a)throw new f("Error: Cannot convert null Array to Nape list");for(var b=new pd,c=0;c<a.length;){var d=a[c];++c;b.push(d)}return b};pd.prototype={get_length:function(){this.zpp_inner.valmod();
this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},has:function(a){this.zpp_inner.valmod();return this.zpp_inner.inner.has(a.zpp_inner)},at:function(a){this.zpp_inner.valmod();if(0>a||a>=this.get_length())throw new f("Error: Index out of bounds");this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=
this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},push:function(a){if(this.zpp_inner.immutable)throw new f("Error: CbTypeList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=
null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},unshift:function(a){if(this.zpp_inner.immutable)throw new f("Error: CbTypeList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?
(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)):this.zpp_inner.inner.add(a.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},pop:function(){if(this.zpp_inner.immutable)throw new f("Error: CbTypeList is immutable");this.zpp_inner.modify_test();if(null==
this.zpp_inner.inner.head)throw new f("Error: Cannot remove from empty list");this.zpp_inner.valmod();var a=null;if(this.zpp_inner.reverse_flag){var a=this.zpp_inner.inner.head.elt,b=a.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(b);this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),a=null==b?this.zpp_inner.inner.head.elt:
b.next.elt,c=a.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(c);this.zpp_inner.dontremove||this.zpp_inner.inner.erase(b)}this.zpp_inner.invalidate();return a.outer},shift:function(){if(this.zpp_inner.immutable)throw new f("Error: CbTypeList is immutable");this.zpp_inner.modify_test();if(null==this.zpp_inner.inner.head)throw new f("Error: Cannot remove from empty list");this.zpp_inner.valmod();var a=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&
(this.zpp_inner.at_ite=null);var b;b=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2);var a=null==b?this.zpp_inner.inner.head.elt:b.next.elt,c=a.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(c);this.zpp_inner.dontremove||this.zpp_inner.inner.erase(b)}else a=this.zpp_inner.inner.head.elt,b=a.outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(b),this.zpp_inner.dontremove||this.zpp_inner.inner.pop();this.zpp_inner.invalidate();return a.outer},add:function(a){return this.zpp_inner.reverse_flag?
this.push(a):this.unshift(a)},remove:function(a){if(this.zpp_inner.immutable)throw new f("Error: CbTypeList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),this.zpp_inner.invalidate());return b},clear:function(){if(this.zpp_inner.immutable)throw new f("Error: CbTypeList is immutable");
if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},empty:function(){return null==this.zpp_inner.inner.head},iterator:function(){this.zpp_inner.valmod();return db.get(this)},copy:function(a){null==a&&(a=!1);var b=new pd,c;this.zpp_inner.valmod();for(c=db.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b.push(a?function(a){throw new f("Error: CbType is not a copyable type");}(this):d)}return b},
merge:function(a){if(null==a)throw new f("Error: Cannot merge with null list");a.zpp_inner.valmod();for(a=db.get(a);a.hasNext();){var b;a.zpp_critical=!1;b=a.zpp_inner.at(a.zpp_i++);this.has(b)||(this.zpp_inner.reverse_flag?this.push(b):this.unshift(b))}},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=db.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},foreach:function(a){if(null==a)throw new f("Error: Cannot execute null on list elements");
var b;this.zpp_inner.valmod();for(b=db.get(this);b.hasNext();)try{var c=void 0;b.zpp_critical=!1;c=b.zpp_inner.at(b.zpp_i++);a(c)}catch(d){d instanceof f&&(d=d.val);b.zpp_next=db.zpp_pool;db.zpp_pool=b;b.zpp_inner=null;break}return this},filter:function(a){if(null==a)throw new f("Error: Cannot select elements of list with null");for(var b=0;b<this.get_length();){var c=this.at(b);try{a(c)?b++:this.remove(c)}catch(d){d instanceof f&&(d=d.val);break}}return this},__class__:pd};var Id=function(){mc.call(this)};
Id.__name__=!0;Id.__super__=mc;Id.prototype=I(mc.prototype,{get_constraint:function(){return this.zpp_inner.constraint.outer},toString:function(){var a;a="Cb:"+["WAKE","SLEEP","BREAK"][this.zpp_inner.event-2];a+=":"+this.zpp_inner.constraint.outer.toString();return a+=" : listener: "+Za.string(this.zpp_inner.listener.outer)},__class__:Id});var ef=function(a,b,c,d){null==d&&(d=0);this.zpp_inner_zn=null;va.internal=!0;nc.call(this);va.internal=!1;if(null==c)throw new f("Error: ConstraintListener::handler cannot be null");
var e=-1;null==g.CbEvent_WAKE&&(g.internal=!0,g.CbEvent_WAKE=new S,g.internal=!1);if(a==g.CbEvent_WAKE)e=2;else if(null==g.CbEvent_SLEEP&&(g.internal=!0,g.CbEvent_SLEEP=new S,g.internal=!1),a==g.CbEvent_SLEEP)e=3;else if(null==g.CbEvent_BREAK&&(g.internal=!0,g.CbEvent_BREAK=new S,g.internal=!1),a==g.CbEvent_BREAK)e=4;else throw new f("Error: cbEvent '"+a.toString()+"' is not a valid event type for a ConstraintListener");this.zpp_inner=this.zpp_inner_zn=new ne(Yc.argument(b),e,c);this.zpp_inner.outer=
this;this.zpp_inner_zn.outer_zn=this;this.zpp_inner.precedence=d};ef.__name__=!0;ef.__super__=nc;ef.prototype=I(nc.prototype,{get_options:function(){return this.zpp_inner_zn.options.outer},set_options:function(a){this.zpp_inner_zn.options.set(a.zpp_inner);return this.zpp_inner_zn.options.outer},get_handler:function(){return this.zpp_inner_zn.handler},set_handler:function(a){if(null==a)throw new f("Error: ConstraintListener::handler cannot be null");this.zpp_inner_zn.handler=a;return this.zpp_inner_zn.handler},
__class__:ef});var Rd=function(){mc.call(this)};Rd.__name__=!0;Rd.__super__=mc;Rd.prototype=I(mc.prototype,{get_int1:function(){return this.zpp_inner.int1.outer_i},get_int2:function(){return this.zpp_inner.int2.outer_i},get_arbiters:function(){return this.zpp_inner.wrap_arbiters},toString:function(){var a;a="Cb:"+"BEGIN END     ONGOING".split(" ")[this.zpp_inner.event];a+=":"+this.zpp_inner.int1.outer_i.toString()+"/"+this.zpp_inner.int2.outer_i.toString();a+=" : "+this.zpp_inner.wrap_arbiters.toString();
return a+=" : listener: "+Za.string(this.zpp_inner.listener.outer)},__class__:Rd});var ff=function(a,b,c,d,e,h){null==h&&(h=0);this.zpp_inner_zn=null;va.internal=!0;nc.call(this);va.internal=!1;if(null==e)throw new f("Error: InteractionListener::handler cannot be null");if(null==a)throw new f("Error: CbEvent cannot be null for InteractionListener");var t=-1;null==g.CbEvent_BEGIN&&(g.internal=!0,g.CbEvent_BEGIN=new S,g.internal=!1);if(a==g.CbEvent_BEGIN)t=0;else if(null==g.CbEvent_END&&(g.internal=
!0,g.CbEvent_END=new S,g.internal=!1),a==g.CbEvent_END)t=1;else if(null==g.CbEvent_ONGOING&&(g.internal=!0,g.CbEvent_ONGOING=new S,g.internal=!1),a==g.CbEvent_ONGOING)t=6;else throw new f("Error: CbEvent '"+a.toString()+"' is not a valid event type for InteractionListener");this.zpp_inner=this.zpp_inner_zn=new Lb(Yc.argument(c),Yc.argument(d),t,2);this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zni=this;this.zpp_inner.precedence=h;this.zpp_inner_zn.handleri=e;this.set_interactionType(b)};ff.__name__=
!0;ff.__super__=nc;ff.prototype=I(nc.prototype,{get_options1:function(){return this.zpp_inner_zn.options1.outer},set_options1:function(a){this.zpp_inner_zn.options1.set(a.zpp_inner);return this.zpp_inner_zn.options1.outer},get_options2:function(){return this.zpp_inner_zn.options2.outer},set_options2:function(a){this.zpp_inner_zn.options2.set(a.zpp_inner);return this.zpp_inner_zn.options2.outer},get_interactionType:function(){var a=this.zpp_inner_zn.itype;return 1==a?(null==g.InteractionType_COLLISION&&
(g.internal=!0,g.InteractionType_COLLISION=new ta,g.internal=!1),g.InteractionType_COLLISION):2==a?(null==g.InteractionType_SENSOR&&(g.internal=!0,g.InteractionType_SENSOR=new ta,g.internal=!1),g.InteractionType_SENSOR):4==a?(null==g.InteractionType_FLUID&&(g.internal=!0,g.InteractionType_FLUID=new ta,g.internal=!1),g.InteractionType_FLUID):7==a?(null==g.InteractionType_ANY&&(g.internal=!0,g.InteractionType_ANY=new ta,g.internal=!1),g.InteractionType_ANY):null},set_interactionType:function(a){if(null==
a)throw new f("Error: Cannot set listener interaction type to null");this.get_interactionType()!=a&&(null==g.InteractionType_COLLISION&&(g.internal=!0,g.InteractionType_COLLISION=new ta,g.internal=!1),a==g.InteractionType_COLLISION?a=1:(null==g.InteractionType_SENSOR&&(g.internal=!0,g.InteractionType_SENSOR=new ta,g.internal=!1),a==g.InteractionType_SENSOR?a=2:(null==g.InteractionType_FLUID&&(g.internal=!0,g.InteractionType_FLUID=new ta,g.internal=!1),a=a==g.InteractionType_FLUID?4:7)),this.zpp_inner_zn.itype=
a);return this.get_interactionType()},get_handler:function(){return this.zpp_inner_zn.handleri},set_handler:function(a){if(null==a)throw new f("Error: InteractionListener::handler cannot be null");this.zpp_inner_zn.handleri=a;return this.zpp_inner_zn.handleri},get_allowSleepingCallbacks:function(){return this.zpp_inner_zn.allowSleepingCallbacks},set_allowSleepingCallbacks:function(a){this.zpp_inner_zn.allowSleepingCallbacks=a;return this.zpp_inner_zn.allowSleepingCallbacks},__class__:ff});var ta=
function(){if(!g.internal)throw new f("Error: Cannot instantiate InteractionType derp!");};ta.__name__=!0;ta.get_COLLISION=function(){null==g.InteractionType_COLLISION&&(g.internal=!0,g.InteractionType_COLLISION=new ta,g.internal=!1);return g.InteractionType_COLLISION};ta.get_SENSOR=function(){null==g.InteractionType_SENSOR&&(g.internal=!0,g.InteractionType_SENSOR=new ta,g.internal=!1);return g.InteractionType_SENSOR};ta.get_FLUID=function(){null==g.InteractionType_FLUID&&(g.internal=!0,g.InteractionType_FLUID=
new ta,g.internal=!1);return g.InteractionType_FLUID};ta.get_ANY=function(){null==g.InteractionType_ANY&&(g.internal=!0,g.InteractionType_ANY=new ta,g.internal=!1);return g.InteractionType_ANY};ta.prototype={toString:function(){null==g.InteractionType_COLLISION&&(g.internal=!0,g.InteractionType_COLLISION=new ta,g.internal=!1);var a;this==g.InteractionType_COLLISION?a="COLLISION":(null==g.InteractionType_SENSOR&&(g.internal=!0,g.InteractionType_SENSOR=new ta,g.internal=!1),this==g.InteractionType_SENSOR?
a="SENSOR":(null==g.InteractionType_FLUID&&(g.internal=!0,g.InteractionType_FLUID=new ta,g.internal=!1),this==g.InteractionType_FLUID?a="FLUID":(null==g.InteractionType_ANY&&(g.internal=!0,g.InteractionType_ANY=new ta,g.internal=!1),a=this==g.InteractionType_ANY?"ANY":"")));return a},__class__:ta};var Sa=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null;if(!qd.internal)throw new f("Error: Cannot instantiate ListenerIterator derp!");};Sa.__name__=!0;Sa.get=function(a){var b;
null==Sa.zpp_pool?(qd.internal=!0,b=new Sa,qd.internal=!1):(b=Sa.zpp_pool,Sa.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};Sa.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=Sa.zpp_pool;Sa.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:Sa};var Sd=function(){this.zpp_inner=null;this.zpp_inner=
new qd;this.zpp_inner.outer=this};Sd.__name__=!0;Sd.fromArray=function(a){if(null==a)throw new f("Error: Cannot convert null Array to Nape list");for(var b=new Sd,c=0;c<a.length;){var d=a[c];++c;b.push(d)}return b};Sd.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},has:function(a){this.zpp_inner.valmod();return this.zpp_inner.inner.has(a.zpp_inner)},
at:function(a){this.zpp_inner.valmod();if(0>a||a>=this.get_length())throw new f("Error: Index out of bounds");this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},push:function(a){if(this.zpp_inner.immutable)throw new f("Error: ListenerList is immutable");
this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);
return b},unshift:function(a){if(this.zpp_inner.immutable)throw new f("Error: ListenerList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)):this.zpp_inner.inner.add(a.zpp_inner),
this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},pop:function(){if(this.zpp_inner.immutable)throw new f("Error: ListenerList is immutable");this.zpp_inner.modify_test();if(null==this.zpp_inner.inner.head)throw new f("Error: Cannot remove from empty list");this.zpp_inner.valmod();var a=null;if(this.zpp_inner.reverse_flag){var a=this.zpp_inner.inner.head.elt,b=a.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(b);this.zpp_inner.dontremove||
this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),a=null==b?this.zpp_inner.inner.head.elt:b.next.elt,c=a.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(c);this.zpp_inner.dontremove||this.zpp_inner.inner.erase(b)}this.zpp_inner.invalidate();return a.outer},shift:function(){if(this.zpp_inner.immutable)throw new f("Error: ListenerList is immutable");
this.zpp_inner.modify_test();if(null==this.zpp_inner.inner.head)throw new f("Error: Cannot remove from empty list");this.zpp_inner.valmod();var a=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b;b=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2);var a=null==b?this.zpp_inner.inner.head.elt:b.next.elt,c=a.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(c);this.zpp_inner.dontremove||
this.zpp_inner.inner.erase(b)}else a=this.zpp_inner.inner.head.elt,b=a.outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(b),this.zpp_inner.dontremove||this.zpp_inner.inner.pop();this.zpp_inner.invalidate();return a.outer},add:function(a){return this.zpp_inner.reverse_flag?this.push(a):this.unshift(a)},remove:function(a){if(this.zpp_inner.immutable)throw new f("Error: ListenerList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=
c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),this.zpp_inner.invalidate());return b},clear:function(){if(this.zpp_inner.immutable)throw new f("Error: ListenerList is immutable");if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},empty:function(){return null==this.zpp_inner.inner.head},iterator:function(){this.zpp_inner.valmod();
return Sa.get(this)},copy:function(a){null==a&&(a=!1);var b=new Sd,c;this.zpp_inner.valmod();for(c=Sa.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b.push(a?function(a){throw new f("Error: Listener is not a copyable type");}(this):d)}return b},merge:function(a){if(null==a)throw new f("Error: Cannot merge with null list");a.zpp_inner.valmod();for(a=Sa.get(a);a.hasNext();){var b;a.zpp_critical=!1;b=a.zpp_inner.at(a.zpp_i++);this.has(b)||(this.zpp_inner.reverse_flag?this.push(b):
this.unshift(b))}},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=Sa.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},foreach:function(a){if(null==a)throw new f("Error: Cannot execute null on list elements");var b;this.zpp_inner.valmod();for(b=Sa.get(this);b.hasNext();)try{var c=void 0;b.zpp_critical=!1;c=b.zpp_inner.at(b.zpp_i++);a(c)}catch(d){d instanceof f&&(d=d.val);b.zpp_next=Sa.zpp_pool;
Sa.zpp_pool=b;b.zpp_inner=null;break}return this},filter:function(a){if(null==a)throw new f("Error: Cannot select elements of list with null");for(var b=0;b<this.get_length();){var c=this.at(b);try{a(c)?b++:this.remove(c)}catch(d){d instanceof f&&(d=d.val);break}}return this},__class__:Sd};var pb=function(){if(!g.internal)throw new f("Error: Cannot instantiate ListenerType derp!");};pb.__name__=!0;pb.get_BODY=function(){null==g.ListenerType_BODY&&(g.internal=!0,g.ListenerType_BODY=new pb,g.internal=
!1);return g.ListenerType_BODY};pb.get_CONSTRAINT=function(){null==g.ListenerType_CONSTRAINT&&(g.internal=!0,g.ListenerType_CONSTRAINT=new pb,g.internal=!1);return g.ListenerType_CONSTRAINT};pb.get_INTERACTION=function(){null==g.ListenerType_INTERACTION&&(g.internal=!0,g.ListenerType_INTERACTION=new pb,g.internal=!1);return g.ListenerType_INTERACTION};pb.get_PRE=function(){null==g.ListenerType_PRE&&(g.internal=!0,g.ListenerType_PRE=new pb,g.internal=!1);return g.ListenerType_PRE};pb.prototype={toString:function(){null==
g.ListenerType_BODY&&(g.internal=!0,g.ListenerType_BODY=new pb,g.internal=!1);var a;this==g.ListenerType_BODY?a="BODY":(null==g.ListenerType_CONSTRAINT&&(g.internal=!0,g.ListenerType_CONSTRAINT=new pb,g.internal=!1),this==g.ListenerType_CONSTRAINT?a="CONSTRAINT":(null==g.ListenerType_INTERACTION&&(g.internal=!0,g.ListenerType_INTERACTION=new pb,g.internal=!1),this==g.ListenerType_INTERACTION?a="INTERACTION":(null==g.ListenerType_PRE&&(g.internal=!0,g.ListenerType_PRE=new pb,g.internal=!1),a=this==
g.ListenerType_PRE?"PRE":"")));return a},__class__:pb};var nd=function(a,b){this.zpp_inner=null;this.zpp_inner=new Yc;this.zpp_inner.outer=this;null!=a&&this.including(a);null!=b&&this.excluding(b)};nd.__name__=!0;nd.prototype={get_includes:function(){null==this.zpp_inner.wrap_includes&&this.zpp_inner.setup_includes();return this.zpp_inner.wrap_includes},get_excludes:function(){null==this.zpp_inner.wrap_excludes&&this.zpp_inner.setup_excludes();return this.zpp_inner.wrap_excludes},including:function(a){this.zpp_inner.append(this.zpp_inner.includes,
a);return this},excluding:function(a){this.zpp_inner.append(this.zpp_inner.excludes,a);return this},toString:function(){null==this.zpp_inner.wrap_includes&&this.zpp_inner.setup_includes();var a=this.zpp_inner.wrap_includes.toString();null==this.zpp_inner.wrap_excludes&&this.zpp_inner.setup_excludes();return"@{"+a+" excluding "+this.zpp_inner.wrap_excludes.toString()+"}"},__class__:nd};var Jd=function(){mc.call(this)};Jd.__name__=!0;Jd.__super__=mc;Jd.prototype=I(mc.prototype,{get_arbiter:function(){return this.zpp_inner.pre_arbiter.wrapper()},
get_int1:function(){return this.zpp_inner.int1.outer_i},get_int2:function(){return this.zpp_inner.int2.outer_i},get_swapped:function(){return this.zpp_inner.pre_swapped},toString:function(){var a;a="Cb:PRE:"+(":"+this.zpp_inner.int1.outer_i.toString()+"/"+this.zpp_inner.int2.outer_i.toString());a+=" : "+this.zpp_inner.pre_arbiter.wrapper().toString();return a+=" : listnener: "+Za.string(this.zpp_inner.listener.outer)},__class__:Jd});var ja=function(){if(!g.internal)throw new f("Error: Cannot instantiate PreFlag derp!");
};ja.__name__=!0;ja.get_ACCEPT=function(){null==g.PreFlag_ACCEPT&&(g.internal=!0,g.PreFlag_ACCEPT=new ja,g.internal=!1);return g.PreFlag_ACCEPT};ja.get_IGNORE=function(){null==g.PreFlag_IGNORE&&(g.internal=!0,g.PreFlag_IGNORE=new ja,g.internal=!1);return g.PreFlag_IGNORE};ja.get_ACCEPT_ONCE=function(){null==g.PreFlag_ACCEPT_ONCE&&(g.internal=!0,g.PreFlag_ACCEPT_ONCE=new ja,g.internal=!1);return g.PreFlag_ACCEPT_ONCE};ja.get_IGNORE_ONCE=function(){null==g.PreFlag_IGNORE_ONCE&&(g.internal=!0,g.PreFlag_IGNORE_ONCE=
new ja,g.internal=!1);return g.PreFlag_IGNORE_ONCE};ja.prototype={toString:function(){null==g.PreFlag_ACCEPT&&(g.internal=!0,g.PreFlag_ACCEPT=new ja,g.internal=!1);var a;this==g.PreFlag_ACCEPT?a="ACCEPT":(null==g.PreFlag_IGNORE&&(g.internal=!0,g.PreFlag_IGNORE=new ja,g.internal=!1),this==g.PreFlag_IGNORE?a="IGNORE":(null==g.PreFlag_ACCEPT_ONCE&&(g.internal=!0,g.PreFlag_ACCEPT_ONCE=new ja,g.internal=!1),this==g.PreFlag_ACCEPT_ONCE?a="ACCEPT_ONCE":(null==g.PreFlag_IGNORE_ONCE&&(g.internal=!0,g.PreFlag_IGNORE_ONCE=
new ja,g.internal=!1),a=this==g.PreFlag_IGNORE_ONCE?"IGNORE_ONCE":"")));return a},__class__:ja};var oe=function(a,b,c,d,e,h){null==h&&(h=!1);null==e&&(e=0);this.zpp_inner_zn=null;va.internal=!0;nc.call(this);va.internal=!1;if(null==d)throw new f("Error: PreListener must take a handler!");this.zpp_inner=this.zpp_inner_zn=new Lb(Yc.argument(b),Yc.argument(c),5,3);this.zpp_inner.outer=this;this.zpp_inner_zn.outer_znp=this;this.zpp_inner.precedence=e;this.zpp_inner_zn.pure=h;this.zpp_inner_zn.handlerp=
d;this.set_interactionType(a)};oe.__name__=!0;oe.__super__=nc;oe.prototype=I(nc.prototype,{get_options1:function(){return this.zpp_inner_zn.options1.outer},set_options1:function(a){this.zpp_inner_zn.options1.set(a.zpp_inner);return this.zpp_inner_zn.options1.outer},get_options2:function(){return this.zpp_inner_zn.options2.outer},set_options2:function(a){this.zpp_inner_zn.options2.set(a.zpp_inner);return this.zpp_inner_zn.options2.outer},get_handler:function(){return this.zpp_inner_zn.handlerp},set_handler:function(a){if(null==
a)throw new f("Error: PreListener must take a non-null handler!");this.zpp_inner_zn.handlerp=a;this.zpp_inner_zn.wake();return this.zpp_inner_zn.handlerp},get_pure:function(){return this.zpp_inner_zn.pure},set_pure:function(a){a||this.zpp_inner_zn.wake();this.zpp_inner_zn.pure=a;return this.zpp_inner_zn.pure},get_interactionType:function(){var a=this.zpp_inner_zn.itype;return 1==a?(null==g.InteractionType_COLLISION&&(g.internal=!0,g.InteractionType_COLLISION=new ta,g.internal=!1),g.InteractionType_COLLISION):
2==a?(null==g.InteractionType_SENSOR&&(g.internal=!0,g.InteractionType_SENSOR=new ta,g.internal=!1),g.InteractionType_SENSOR):4==a?(null==g.InteractionType_FLUID&&(g.internal=!0,g.InteractionType_FLUID=new ta,g.internal=!1),g.InteractionType_FLUID):7==a?(null==g.InteractionType_ANY&&(g.internal=!0,g.InteractionType_ANY=new ta,g.internal=!1),g.InteractionType_ANY):null},set_interactionType:function(a){if(null==a)throw new f("Error: Cannot set listener interaction type to null");this.get_interactionType()!=
a&&(null==g.InteractionType_COLLISION&&(g.internal=!0,g.InteractionType_COLLISION=new ta,g.internal=!1),a==g.InteractionType_COLLISION?a=1:(null==g.InteractionType_SENSOR&&(g.internal=!0,g.InteractionType_SENSOR=new ta,g.internal=!1),a==g.InteractionType_SENSOR?a=2:(null==g.InteractionType_FLUID&&(g.internal=!0,g.InteractionType_FLUID=new ta,g.internal=!1),a=a==g.InteractionType_FLUID?4:7)),this.zpp_inner_zn.itype=a);return this.get_interactionType()},__class__:oe});var T=function(){this.debugDraw=
!0;this.zpp_inner.insert_cbtype(Ha.ANY_CONSTRAINT.zpp_inner);if(!T.zpp_internalAlloc)throw new f("Error: Constraint cannot be instantiated derp!");};T.__name__=!0;T.prototype={get_userData:function(){null==this.zpp_inner.userData&&(this.zpp_inner.userData={});return this.zpp_inner.userData},get_compound:function(){return null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer},set_compound:function(a){(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer)!=a&&(null!=(null==this.zpp_inner.compound?
null:this.zpp_inner.compound.outer)&&(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer).zpp_inner.wrap_constraints.remove(this),null!=a&&a.zpp_inner.wrap_constraints.add(this));return null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer},get_space:function(){return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},set_space:function(a){if(null!=this.zpp_inner.compound)throw new f("Error: Cannot set the space of a Constraint belonging to a Compound, only the root Compound space can be set");
(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)!=a&&(null!=this.zpp_inner.component&&(this.zpp_inner.component.woken=!1),this.zpp_inner.clearcache(),null!=this.zpp_inner.space&&this.zpp_inner.space.outer.zpp_inner.wrap_constraints.remove(this),null!=a?a.zpp_inner.wrap_constraints.add(this):this.zpp_inner.space=null);return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},get_isSleeping:function(){if(null==this.zpp_inner.space||!this.zpp_inner.active)throw new f("Error: isSleeping only makes sense if constraint is active and inside a space");
return this.zpp_inner.component.sleeping},get_active:function(){return this.zpp_inner.active},set_active:function(a){this.zpp_inner.active!=a&&(null!=this.zpp_inner.component&&(this.zpp_inner.component.woken=!1),this.zpp_inner.clearcache(),a?(this.zpp_inner.active=a,this.zpp_inner.activate(),null!=this.zpp_inner.space&&(null!=this.zpp_inner.component&&(this.zpp_inner.component.sleeping=!0),this.zpp_inner.space.wake_constraint(this.zpp_inner,!0))):(null!=this.zpp_inner.space&&(this.zpp_inner.wake(),
this.zpp_inner.space.live_constraints.remove(this.zpp_inner)),this.zpp_inner.active=a,this.zpp_inner.deactivate()));return this.zpp_inner.active},get_ignore:function(){return this.zpp_inner.ignore},set_ignore:function(a){this.zpp_inner.ignore!=a&&(this.zpp_inner.ignore=a,this.zpp_inner.wake());return this.zpp_inner.ignore},get_stiff:function(){return this.zpp_inner.stiff},set_stiff:function(a){this.zpp_inner.stiff!=a&&(this.zpp_inner.stiff=a,this.zpp_inner.wake());return this.zpp_inner.stiff},get_frequency:function(){return this.zpp_inner.frequency},
set_frequency:function(a){if(a!=a)throw new f("Error: Constraint::Frequency cannot be NaN");if(0>=a)throw new f("Error: Constraint::Frequency must be >0");this.zpp_inner.frequency!=a&&(this.zpp_inner.frequency=a,this.zpp_inner.stiff||this.zpp_inner.wake());return this.zpp_inner.frequency},get_damping:function(){return this.zpp_inner.damping},set_damping:function(a){if(a!=a)throw new f("Error: Constraint::Damping cannot be Nan");if(0>a)throw new f("Error: Constraint::Damping must be >=0");this.zpp_inner.damping!=
a&&(this.zpp_inner.damping=a,this.zpp_inner.stiff||this.zpp_inner.wake());return this.zpp_inner.damping},get_maxForce:function(){return this.zpp_inner.maxForce},set_maxForce:function(a){if(a!=a)throw new f("Error: Constraint::maxForce cannot be NaN");if(0>a)throw new f("Error: Constraint::maxForce must be >=0");this.zpp_inner.maxForce!=a&&(this.zpp_inner.maxForce=a,this.zpp_inner.wake());return this.zpp_inner.maxForce},get_maxError:function(){return this.zpp_inner.maxError},set_maxError:function(a){if(a!=
a)throw new f("Error: Constraint::maxError cannot be NaN");if(0>a)throw new f("Error: Constraint::maxError must be >=0");this.zpp_inner.maxError!=a&&(this.zpp_inner.maxError=a,this.zpp_inner.wake());return this.zpp_inner.maxError},get_breakUnderForce:function(){return this.zpp_inner.breakUnderForce},set_breakUnderForce:function(a){this.zpp_inner.breakUnderForce!=a&&(this.zpp_inner.breakUnderForce=a,this.zpp_inner.wake());return this.zpp_inner.breakUnderForce},get_breakUnderError:function(){return this.zpp_inner.breakUnderError},
set_breakUnderError:function(a){this.zpp_inner.breakUnderError!=a&&(this.zpp_inner.breakUnderError=a,this.zpp_inner.wake());return this.zpp_inner.breakUnderError},get_removeOnBreak:function(){return this.zpp_inner.removeOnBreak},set_removeOnBreak:function(a){this.zpp_inner.removeOnBreak=a;return this.zpp_inner.removeOnBreak},impulse:function(){return null},bodyImpulse:function(a){return null},visitBodies:function(a){},get_cbTypes:function(){null==this.zpp_inner.wrap_cbTypes&&this.zpp_inner.setupcbTypes();
return this.zpp_inner.wrap_cbTypes},toString:function(){return"{Constraint}"},copy:function(){return this.zpp_inner.copy()},__class__:T};var qe=function(a,b,c,d,e){null==e&&(e=1);this.zpp_inner_zn=null;this.zpp_inner=this.zpp_inner_zn=new pe;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;T.zpp_internalAlloc=!0;T.call(this);T.zpp_internalAlloc=!1;this.set_body1(a);this.set_body2(b);this.zpp_inner.immutable_midstep("AngleJoint::jointMin");if(c!=c)throw new f("Error: AngleJoint::jointMin cannot be NaN");
this.zpp_inner_zn.jointMin!=c&&(this.zpp_inner_zn.jointMin=c,this.zpp_inner.wake());this.zpp_inner_zn.jointMin;this.zpp_inner.immutable_midstep("AngleJoint::jointMax");if(d!=d)throw new f("Error: AngleJoint::jointMax cannot be NaN");this.zpp_inner_zn.jointMax!=d&&(this.zpp_inner_zn.jointMax=d,this.zpp_inner.wake());this.zpp_inner_zn.jointMax;this.zpp_inner.immutable_midstep("AngleJoint::ratio");if(e!=e)throw new f("Error: AngleJoint::ratio cannot be NaN");this.zpp_inner_zn.ratio!=e&&(this.zpp_inner_zn.ratio=
e,this.zpp_inner.wake());this.zpp_inner_zn.ratio};qe.__name__=!0;qe.__super__=T;qe.prototype=I(T.prototype,{get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(a){this.zpp_inner.immutable_midstep("Constraint::body1");a=null==a?null:a.zpp_inner;a!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),
this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=a,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=a&&this.zpp_inner_zn.b2!=a&&null!=a&&a.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=a&&a.wake()));return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},get_body2:function(){return null==
this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(a){this.zpp_inner.immutable_midstep("Constraint::body2");a=null==a?null:a.zpp_inner;a!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),
this.zpp_inner_zn.b2=a,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=a&&this.zpp_inner_zn.b1!=a&&null!=a&&a.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=a&&a.wake()));return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},get_jointMin:function(){return this.zpp_inner_zn.jointMin},set_jointMin:function(a){this.zpp_inner.immutable_midstep("AngleJoint::jointMin");
if(a!=a)throw new f("Error: AngleJoint::jointMin cannot be NaN");this.zpp_inner_zn.jointMin!=a&&(this.zpp_inner_zn.jointMin=a,this.zpp_inner.wake());return this.zpp_inner_zn.jointMin},get_jointMax:function(){return this.zpp_inner_zn.jointMax},set_jointMax:function(a){this.zpp_inner.immutable_midstep("AngleJoint::jointMax");if(a!=a)throw new f("Error: AngleJoint::jointMax cannot be NaN");this.zpp_inner_zn.jointMax!=a&&(this.zpp_inner_zn.jointMax=a,this.zpp_inner.wake());return this.zpp_inner_zn.jointMax},
get_ratio:function(){return this.zpp_inner_zn.ratio},set_ratio:function(a){this.zpp_inner.immutable_midstep("AngleJoint::ratio");if(a!=a)throw new f("Error: AngleJoint::ratio cannot be NaN");this.zpp_inner_zn.ratio!=a&&(this.zpp_inner_zn.ratio=a,this.zpp_inner.wake());return this.zpp_inner_zn.ratio},isSlack:function(){if(null==(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)||null==(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer))throw new f("Error: Cannot compute slack for AngleJoint if either body is null.");
return this.zpp_inner_zn.is_slack()},impulse:function(){var a=new Qb(1,1);if(0>=a.zpp_inner.m||0>=a.zpp_inner.n)throw new f("Error: MatMN indices out of range");a.zpp_inner.x[0*a.zpp_inner.n]=this.zpp_inner_zn.jAcc;return a},bodyImpulse:function(a){if(null==a)throw new f("Error: Cannot evaluate impulse on null body");if(a!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&a!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer))throw new f("Error: Body is not linked to this constraint");
return this.zpp_inner.active?this.zpp_inner_zn.bodyImpulse(a.zpp_inner):N.get(0,0,0)},visitBodies:function(a){if(null==a)throw new f("Error: Cannot apply null lambda to bodies");null!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&a(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer);null!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&a(null==
this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)},__class__:qe});var $a=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null;if(!mb.internal)throw new f("Error: Cannot instantiate ConstraintIterator derp!");};$a.__name__=!0;$a.get=function(a){var b;null==$a.zpp_pool?(mb.internal=!0,b=new $a,mb.internal=!1):(b=$a.zpp_pool,$a.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};$a.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();
var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=$a.zpp_pool;$a.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:$a};var Td=function(){this.zpp_inner=null;this.zpp_inner=new mb;this.zpp_inner.outer=this};Td.__name__=!0;Td.fromArray=function(a){if(null==a)throw new f("Error: Cannot convert null Array to Nape list");for(var b=new Td,c=0;c<a.length;){var d=a[c];++c;b.push(d)}return b};
Td.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},has:function(a){this.zpp_inner.valmod();return this.zpp_inner.inner.has(a.zpp_inner)},at:function(a){this.zpp_inner.valmod();if(0>a||a>=this.get_length())throw new f("Error: Index out of bounds");this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=
a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},push:function(a){if(this.zpp_inner.immutable)throw new f("Error: ConstraintList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&
(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},unshift:function(a){if(this.zpp_inner.immutable)throw new f("Error: ConstraintList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):
!0)this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)):this.zpp_inner.inner.add(a.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},pop:function(){if(this.zpp_inner.immutable)throw new f("Error: ConstraintList is immutable");
this.zpp_inner.modify_test();if(null==this.zpp_inner.inner.head)throw new f("Error: Cannot remove from empty list");this.zpp_inner.valmod();var a=null;if(this.zpp_inner.reverse_flag){var a=this.zpp_inner.inner.head.elt,b=a.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(b);this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-
2),a=null==b?this.zpp_inner.inner.head.elt:b.next.elt,c=a.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(c);this.zpp_inner.dontremove||this.zpp_inner.inner.erase(b)}this.zpp_inner.invalidate();return a.outer},shift:function(){if(this.zpp_inner.immutable)throw new f("Error: ConstraintList is immutable");this.zpp_inner.modify_test();if(null==this.zpp_inner.inner.head)throw new f("Error: Cannot remove from empty list");this.zpp_inner.valmod();var a=null;if(this.zpp_inner.reverse_flag){null!=
this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b;b=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2);var a=null==b?this.zpp_inner.inner.head.elt:b.next.elt,c=a.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(c);this.zpp_inner.dontremove||this.zpp_inner.inner.erase(b)}else a=this.zpp_inner.inner.head.elt,b=a.outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(b),this.zpp_inner.dontremove||this.zpp_inner.inner.pop();
this.zpp_inner.invalidate();return a.outer},add:function(a){return this.zpp_inner.reverse_flag?this.push(a):this.unshift(a)},remove:function(a){if(this.zpp_inner.immutable)throw new f("Error: ConstraintList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),
this.zpp_inner.invalidate());return b},clear:function(){if(this.zpp_inner.immutable)throw new f("Error: ConstraintList is immutable");if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},empty:function(){return null==this.zpp_inner.inner.head},iterator:function(){this.zpp_inner.valmod();return $a.get(this)},copy:function(a){null==a&&(a=!1);var b=new Td,c;this.zpp_inner.valmod();for(c=$a.get(this);c.hasNext();){var d;
c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b.push(a?function(a){throw new f("Error: Constraint is not a copyable type");}(this):d)}return b},merge:function(a){if(null==a)throw new f("Error: Cannot merge with null list");a.zpp_inner.valmod();for(a=$a.get(a);a.hasNext();){var b;a.zpp_critical=!1;b=a.zpp_inner.at(a.zpp_i++);this.has(b)||(this.zpp_inner.reverse_flag?this.push(b):this.unshift(b))}},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=$a.get(this);c.hasNext();){var d;c.zpp_critical=
!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},foreach:function(a){if(null==a)throw new f("Error: Cannot execute null on list elements");var b;this.zpp_inner.valmod();for(b=$a.get(this);b.hasNext();)try{var c=void 0;b.zpp_critical=!1;c=b.zpp_inner.at(b.zpp_i++);a(c)}catch(d){d instanceof f&&(d=d.val);b.zpp_next=$a.zpp_pool;$a.zpp_pool=b;b.zpp_inner=null;break}return this},filter:function(a){if(null==a)throw new f("Error: Cannot select elements of list with null");
for(var b=0;b<this.get_length();){var c=this.at(b);try{a(c)?b++:this.remove(c)}catch(d){d instanceof f&&(d=d.val);break}}return this},__class__:Td};var Ae=function(a,b,c,d,e,h){this.zpp_inner_zn=null;this.zpp_inner=this.zpp_inner_zn=new ze;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;T.zpp_internalAlloc=!0;T.call(this);T.zpp_internalAlloc=!1;this.set_body1(a);this.set_body2(b);if(null!=c&&c.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==c)throw new f("Error: Constraint::anchor1 cannot be null");
null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();this.zpp_inner_zn.wrap_a1.set(c);null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();this.zpp_inner_zn.wrap_a1;if(null!=d&&d.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==d)throw new f("Error: Constraint::anchor2 cannot be null");null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();this.zpp_inner_zn.wrap_a2.set(d);null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();this.zpp_inner_zn.wrap_a2;
this.zpp_inner.immutable_midstep("DistanceJoint::jointMin");if(e!=e)throw new f("Error: DistanceJoint::jointMin cannot be NaN");if(0>e)throw new f("Error: DistanceJoint::jointMin must be >= 0");this.zpp_inner_zn.jointMin!=e&&(this.zpp_inner_zn.jointMin=e,this.zpp_inner.wake());this.zpp_inner_zn.jointMin;this.zpp_inner.immutable_midstep("DistanceJoint::jointMax");if(h!=h)throw new f("Error: DistanceJoint::jointMax cannot be NaN");if(0>h)throw new f("Error: DistanceJoint::jointMax must be >= 0");this.zpp_inner_zn.jointMax!=
h&&(this.zpp_inner_zn.jointMax=h,this.zpp_inner.wake());this.zpp_inner_zn.jointMax};Ae.__name__=!0;Ae.__super__=T;Ae.prototype=I(T.prototype,{get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(a){this.zpp_inner.immutable_midstep("Constraint::body1");a=null==a?null:a.zpp_inner;a!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=
this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=a,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=a&&this.zpp_inner_zn.b2!=a&&null!=a&&a.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=a&&a.wake()));return null==
this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(a){this.zpp_inner.immutable_midstep("Constraint::body2");a=null==a?null:a.zpp_inner;a!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&
null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=a,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=a&&this.zpp_inner_zn.b1!=a&&null!=a&&a.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=a&&a.wake()));return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},get_anchor1:function(){null==this.zpp_inner_zn.wrap_a1&&
this.zpp_inner_zn.setup_a1();return this.zpp_inner_zn.wrap_a1},set_anchor1:function(a){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Constraint::anchor1 cannot be null");null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();this.zpp_inner_zn.wrap_a1.set(a);null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();return this.zpp_inner_zn.wrap_a1},get_anchor2:function(){null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();
return this.zpp_inner_zn.wrap_a2},set_anchor2:function(a){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Constraint::anchor2 cannot be null");null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();this.zpp_inner_zn.wrap_a2.set(a);null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();return this.zpp_inner_zn.wrap_a2},get_jointMin:function(){return this.zpp_inner_zn.jointMin},set_jointMin:function(a){this.zpp_inner.immutable_midstep("DistanceJoint::jointMin");
if(a!=a)throw new f("Error: DistanceJoint::jointMin cannot be NaN");if(0>a)throw new f("Error: DistanceJoint::jointMin must be >= 0");this.zpp_inner_zn.jointMin!=a&&(this.zpp_inner_zn.jointMin=a,this.zpp_inner.wake());return this.zpp_inner_zn.jointMin},get_jointMax:function(){return this.zpp_inner_zn.jointMax},set_jointMax:function(a){this.zpp_inner.immutable_midstep("DistanceJoint::jointMax");if(a!=a)throw new f("Error: DistanceJoint::jointMax cannot be NaN");if(0>a)throw new f("Error: DistanceJoint::jointMax must be >= 0");
this.zpp_inner_zn.jointMax!=a&&(this.zpp_inner_zn.jointMax=a,this.zpp_inner.wake());return this.zpp_inner_zn.jointMax},isSlack:function(){if(null==(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)||null==(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer))throw new f("Error: Cannot compute slack for DistanceJoint if either body is null.");return this.zpp_inner_zn.slack},impulse:function(){var a=new Qb(1,1);if(0>=a.zpp_inner.m||0>=a.zpp_inner.n)throw new f("Error: MatMN indices out of range");
a.zpp_inner.x[0*a.zpp_inner.n]=this.zpp_inner_zn.jAcc;return a},bodyImpulse:function(a){if(null==a)throw new f("Error: Cannot evaluate impulse on null body");if(a!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&a!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer))throw new f("Error: Body is not linked to this constraint");return this.zpp_inner.active?this.zpp_inner_zn.bodyImpulse(a.zpp_inner):N.get()},visitBodies:function(a){null!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&
a(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer);null!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&a(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)},__class__:Ae});var Ce=function(a,b,c,d,e,h,t){this.zpp_inner_zn=null;this.zpp_inner=this.zpp_inner_zn=new Be;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;T.zpp_internalAlloc=
!0;T.call(this);T.zpp_internalAlloc=!1;this.set_body1(a);this.set_body2(b);if(null!=c&&c.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==c)throw new f("Error: Constraint::anchor1 cannot be null");null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();this.zpp_inner_zn.wrap_a1.set(c);null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();this.zpp_inner_zn.wrap_a1;if(null!=d&&d.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
if(null==d)throw new f("Error: Constraint::anchor2 cannot be null");null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();this.zpp_inner_zn.wrap_a2.set(d);null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();this.zpp_inner_zn.wrap_a2;if(null!=e&&e.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==e)throw new f("Error: Constraint::direction cannot be null");null==this.zpp_inner_zn.wrap_n&&this.zpp_inner_zn.setup_n();this.zpp_inner_zn.wrap_n.set(e);
null==this.zpp_inner_zn.wrap_n&&this.zpp_inner_zn.setup_n();this.zpp_inner_zn.wrap_n;this.zpp_inner.immutable_midstep("LineJoint::jointMin");if(h!=h)throw new f("Error: AngleJoint::jointMin cannot be NaN");this.zpp_inner_zn.jointMin!=h&&(this.zpp_inner_zn.jointMin=h,this.zpp_inner.wake());this.zpp_inner_zn.jointMin;this.zpp_inner.immutable_midstep("LineJoint::jointMax");if(t!=t)throw new f("Error: AngleJoint::jointMax cannot be NaN");this.zpp_inner_zn.jointMax!=t&&(this.zpp_inner_zn.jointMax=t,this.zpp_inner.wake());
this.zpp_inner_zn.jointMax};Ce.__name__=!0;Ce.__super__=T;Ce.prototype=I(T.prototype,{get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(a){this.zpp_inner.immutable_midstep("Constraint::body1");a=null==a?null:a.zpp_inner;a!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),
this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=a,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=a&&this.zpp_inner_zn.b2!=a&&null!=a&&a.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=a&&a.wake()));return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},get_body2:function(){return null==
this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(a){this.zpp_inner.immutable_midstep("Constraint::body2");a=null==a?null:a.zpp_inner;a!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),
this.zpp_inner_zn.b2=a,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=a&&this.zpp_inner_zn.b1!=a&&null!=a&&a.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=a&&a.wake()));return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},get_anchor1:function(){null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();return this.zpp_inner_zn.wrap_a1},set_anchor1:function(a){if(null!=
a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Constraint::anchor1 cannot be null");null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();this.zpp_inner_zn.wrap_a1.set(a);null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();return this.zpp_inner_zn.wrap_a1},get_anchor2:function(){null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();return this.zpp_inner_zn.wrap_a2},set_anchor2:function(a){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
if(null==a)throw new f("Error: Constraint::anchor2 cannot be null");null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();this.zpp_inner_zn.wrap_a2.set(a);null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();return this.zpp_inner_zn.wrap_a2},get_direction:function(){null==this.zpp_inner_zn.wrap_n&&this.zpp_inner_zn.setup_n();return this.zpp_inner_zn.wrap_n},set_direction:function(a){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Constraint::direction cannot be null");
null==this.zpp_inner_zn.wrap_n&&this.zpp_inner_zn.setup_n();this.zpp_inner_zn.wrap_n.set(a);null==this.zpp_inner_zn.wrap_n&&this.zpp_inner_zn.setup_n();return this.zpp_inner_zn.wrap_n},get_jointMin:function(){return this.zpp_inner_zn.jointMin},set_jointMin:function(a){this.zpp_inner.immutable_midstep("LineJoint::jointMin");if(a!=a)throw new f("Error: AngleJoint::jointMin cannot be NaN");this.zpp_inner_zn.jointMin!=a&&(this.zpp_inner_zn.jointMin=a,this.zpp_inner.wake());return this.zpp_inner_zn.jointMin},
get_jointMax:function(){return this.zpp_inner_zn.jointMax},set_jointMax:function(a){this.zpp_inner.immutable_midstep("LineJoint::jointMax");if(a!=a)throw new f("Error: AngleJoint::jointMax cannot be NaN");this.zpp_inner_zn.jointMax!=a&&(this.zpp_inner_zn.jointMax=a,this.zpp_inner.wake());return this.zpp_inner_zn.jointMax},impulse:function(){var a=new Qb(2,1);if(0>=a.zpp_inner.m||0>=a.zpp_inner.n)throw new f("Error: MatMN indices out of range");a.zpp_inner.x[0*a.zpp_inner.n]=this.zpp_inner_zn.jAccx;
if(1>=a.zpp_inner.m||0>=a.zpp_inner.n)throw new f("Error: MatMN indices out of range");a.zpp_inner.x[a.zpp_inner.n]=this.zpp_inner_zn.jAccy;return a},bodyImpulse:function(a){if(null==a)throw new f("Error: Cannot evaluate impulse on null body");if(a!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&a!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer))throw new f("Error: Body is not linked to this constraint");return this.zpp_inner.active?this.zpp_inner_zn.bodyImpulse(a.zpp_inner):
N.get()},visitBodies:function(a){null!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&a(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer);null!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&a(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)},__class__:Ce});var Ee=function(a,b,c,d){null==d&&(d=1);null==c&&(c=0);this.zpp_inner_zn=
null;this.zpp_inner=this.zpp_inner_zn=new De;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;T.zpp_internalAlloc=!0;T.call(this);T.zpp_internalAlloc=!1;this.set_body1(a);this.set_body2(b);this.zpp_inner.immutable_midstep("MotorJoint::rate");if(c!=c)throw new f("Error: MotorJoint::rate cannot be NaN");this.zpp_inner_zn.rate!=c&&(this.zpp_inner_zn.rate=c,this.zpp_inner.wake());this.zpp_inner_zn.rate;this.zpp_inner.immutable_midstep("MotorJoint::ratio");if(d!=d)throw new f("Error: MotorJoint::ratio cannot be NaN");
this.zpp_inner_zn.ratio!=d&&(this.zpp_inner_zn.ratio=d,this.zpp_inner.wake());this.zpp_inner_zn.ratio};Ee.__name__=!0;Ee.__super__=T;Ee.prototype=I(T.prototype,{get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(a){this.zpp_inner.immutable_midstep("Constraint::body1");a=null==a?null:a.zpp_inner;a!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&
null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=a,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=a&&this.zpp_inner_zn.b2!=a&&null!=a&&a.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=a&&a.wake()));
return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(a){this.zpp_inner.immutable_midstep("Constraint::body2");a=null==a?null:a.zpp_inner;a!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),
this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=a,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=a&&this.zpp_inner_zn.b1!=a&&null!=a&&a.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=a&&a.wake()));return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},get_ratio:function(){return this.zpp_inner_zn.ratio},
set_ratio:function(a){this.zpp_inner.immutable_midstep("MotorJoint::ratio");if(a!=a)throw new f("Error: MotorJoint::ratio cannot be NaN");this.zpp_inner_zn.ratio!=a&&(this.zpp_inner_zn.ratio=a,this.zpp_inner.wake());return this.zpp_inner_zn.ratio},get_rate:function(){return this.zpp_inner_zn.rate},set_rate:function(a){this.zpp_inner.immutable_midstep("MotorJoint::rate");if(a!=a)throw new f("Error: MotorJoint::rate cannot be NaN");this.zpp_inner_zn.rate!=a&&(this.zpp_inner_zn.rate=a,this.zpp_inner.wake());
return this.zpp_inner_zn.rate},impulse:function(){var a=new Qb(1,1);if(0>=a.zpp_inner.m||0>=a.zpp_inner.n)throw new f("Error: MatMN indices out of range");a.zpp_inner.x[0*a.zpp_inner.n]=this.zpp_inner_zn.jAcc;return a},bodyImpulse:function(a){if(null==a)throw new f("Error: Cannot evaluate impulse on null body");if(a!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&a!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer))throw new f("Error: Body is not linked to this constraint");
return this.zpp_inner.active?this.zpp_inner_zn.bodyImpulse(a.zpp_inner):N.get()},visitBodies:function(a){null!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&a(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer);null!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&a(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)},__class__:Ee});
var Ud=function(a,b,c,d){this.zpp_inner_zn=null;this.zpp_inner=this.zpp_inner_zn=new Fe;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;T.zpp_internalAlloc=!0;T.call(this);T.zpp_internalAlloc=!1;this.set_body1(a);this.set_body2(b);if(null!=c&&c.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==c)throw new f("Error: Constraint::anchor1 cannot be null");null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();this.zpp_inner_zn.wrap_a1.set(c);null==this.zpp_inner_zn.wrap_a1&&
this.zpp_inner_zn.setup_a1();this.zpp_inner_zn.wrap_a1;if(null!=d&&d.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==d)throw new f("Error: Constraint::anchor2 cannot be null");null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();this.zpp_inner_zn.wrap_a2.set(d);null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();this.zpp_inner_zn.wrap_a2};Ud.__name__=!0;Ud.__super__=T;Ud.prototype=I(T.prototype,{get_body1:function(){return null==this.zpp_inner_zn.b1?
null:this.zpp_inner_zn.b1.outer},set_body1:function(a){this.zpp_inner.immutable_midstep("Constraint::body1");a=null==a?null:a.zpp_inner;a!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),
this.zpp_inner_zn.b1=a,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=a&&this.zpp_inner_zn.b2!=a&&null!=a&&a.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=a&&a.wake()));return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(a){this.zpp_inner.immutable_midstep("Constraint::body2");
a=null==a?null:a.zpp_inner;a!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=a,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=a&&this.zpp_inner_zn.b1!=
a&&null!=a&&a.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=a&&a.wake()));return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},get_anchor1:function(){null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();return this.zpp_inner_zn.wrap_a1},set_anchor1:function(a){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Constraint::anchor1 cannot be null");
null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();this.zpp_inner_zn.wrap_a1.set(a);null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();return this.zpp_inner_zn.wrap_a1},get_anchor2:function(){null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();return this.zpp_inner_zn.wrap_a2},set_anchor2:function(a){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Constraint::anchor2 cannot be null");null==this.zpp_inner_zn.wrap_a2&&
this.zpp_inner_zn.setup_a2();this.zpp_inner_zn.wrap_a2.set(a);null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();return this.zpp_inner_zn.wrap_a2},impulse:function(){var a=new Qb(2,1);if(0>=a.zpp_inner.m||0>=a.zpp_inner.n)throw new f("Error: MatMN indices out of range");a.zpp_inner.x[0*a.zpp_inner.n]=this.zpp_inner_zn.jAccx;if(1>=a.zpp_inner.m||0>=a.zpp_inner.n)throw new f("Error: MatMN indices out of range");a.zpp_inner.x[a.zpp_inner.n]=this.zpp_inner_zn.jAccy;return a},bodyImpulse:function(a){if(null==
a)throw new f("Error: Cannot evaluate impulse on null body");if(a!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&a!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer))throw new f("Error: Body is not linked to this constraint");return this.zpp_inner.active?this.zpp_inner_zn.bodyImpulse(a.zpp_inner):N.get()},visitBodies:function(a){null!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&a(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer);null!=(null==
this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&a(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)},__class__:Ud});var He=function(a,b,c,d,e,h,t,q,g,l,n){null==n&&(n=1);this.zpp_inner_zn=null;this.zpp_inner=this.zpp_inner_zn=new Ge;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;T.zpp_internalAlloc=!0;T.call(this);T.zpp_internalAlloc=!1;this.set_body1(a);
this.set_body2(b);this.set_body3(c);this.set_body4(d);if(null!=e&&e.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==e)throw new f("Error: Constraint::anchor1 cannot be null");null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();this.zpp_inner_zn.wrap_a1.set(e);null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();this.zpp_inner_zn.wrap_a1;if(null!=h&&h.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==h)throw new f("Error: Constraint::anchor2 cannot be null");
null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();this.zpp_inner_zn.wrap_a2.set(h);null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();this.zpp_inner_zn.wrap_a2;if(null!=t&&t.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==t)throw new f("Error: Constraint::anchor3 cannot be null");null==this.zpp_inner_zn.wrap_a3&&this.zpp_inner_zn.setup_a3();this.zpp_inner_zn.wrap_a3.set(t);null==this.zpp_inner_zn.wrap_a3&&this.zpp_inner_zn.setup_a3();this.zpp_inner_zn.wrap_a3;
if(null!=q&&q.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==q)throw new f("Error: Constraint::anchor4 cannot be null");null==this.zpp_inner_zn.wrap_a4&&this.zpp_inner_zn.setup_a4();this.zpp_inner_zn.wrap_a4.set(q);null==this.zpp_inner_zn.wrap_a4&&this.zpp_inner_zn.setup_a4();this.zpp_inner_zn.wrap_a4;this.zpp_inner.immutable_midstep("PulleyJoint::ratio");if(n!=n)throw new f("Error: PulleyJoint::ratio cannot be NaN");this.zpp_inner_zn.ratio!=n&&(this.zpp_inner_zn.ratio=
n,this.zpp_inner.wake());this.zpp_inner_zn.ratio;this.zpp_inner.immutable_midstep("PulleyJoint::jointMin");if(g!=g)throw new f("Error: PulleyJoint::jointMin cannot be NaN");if(0>g)throw new f("Error: PulleyJoint::jointMin must be >= 0");this.zpp_inner_zn.jointMin!=g&&(this.zpp_inner_zn.jointMin=g,this.zpp_inner.wake());this.zpp_inner_zn.jointMin;this.zpp_inner.immutable_midstep("PulleyJoint::jointMax");if(l!=l)throw new f("Error: PulleyJoint::jointMax cannot be NaN");if(0>l)throw new f("Error: PulleyJoint::jointMax must be >= 0");
this.zpp_inner_zn.jointMax!=l&&(this.zpp_inner_zn.jointMax=l,this.zpp_inner.wake());this.zpp_inner_zn.jointMax};He.__name__=!0;He.__super__=T;He.prototype=I(T.prototype,{get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(a){this.zpp_inner.immutable_midstep("Constraint::body1");a=null==a?null:a.zpp_inner;a!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=
this.zpp_inner_zn.b1&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=a,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=a&&this.zpp_inner_zn.b2!=a&&this.zpp_inner_zn.b3!=a&&this.zpp_inner_zn.b4!=a&&null!=a&&a.constraints.add(this.zpp_inner),
this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=a&&a.wake()));return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(a){this.zpp_inner.immutable_midstep("Constraint::body2");a=null==a?null:a.zpp_inner;a!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&
this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=a,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=a&&this.zpp_inner_zn.b1!=a&&this.zpp_inner_zn.b3!=a&&this.zpp_inner_zn.b4!=
a&&null!=a&&a.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=a&&a.wake()));return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},get_body3:function(){return null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer},set_body3:function(a){this.zpp_inner.immutable_midstep("Constraint::body3");a=null==a?null:a.zpp_inner;a!=this.zpp_inner_zn.b3&&(null!=this.zpp_inner_zn.b3&&(null!=(null==
this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b3&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b3&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b3&&null!=this.zpp_inner_zn.b3&&this.zpp_inner_zn.b3.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b3.wake()),this.zpp_inner_zn.b3=a,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=a&&this.zpp_inner_zn.b1!=
a&&this.zpp_inner_zn.b2!=a&&this.zpp_inner_zn.b4!=a&&null!=a&&a.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=a&&a.wake()));return null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer},get_body4:function(){return null==this.zpp_inner_zn.b4?null:this.zpp_inner_zn.b4.outer},set_body4:function(a){this.zpp_inner.immutable_midstep("Constraint::body4");a=null==a?null:a.zpp_inner;a!=this.zpp_inner_zn.b4&&
(null!=this.zpp_inner_zn.b4&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b4&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b4&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b4&&null!=this.zpp_inner_zn.b4&&this.zpp_inner_zn.b4.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b4.wake()),this.zpp_inner_zn.b4=a,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&
null!=a&&this.zpp_inner_zn.b1!=a&&this.zpp_inner_zn.b2!=a&&this.zpp_inner_zn.b3!=a&&null!=a&&a.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=a&&a.wake()));return null==this.zpp_inner_zn.b4?null:this.zpp_inner_zn.b4.outer},get_anchor1:function(){null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();return this.zpp_inner_zn.wrap_a1},set_anchor1:function(a){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
if(null==a)throw new f("Error: Constraint::anchor1 cannot be null");null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();this.zpp_inner_zn.wrap_a1.set(a);null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();return this.zpp_inner_zn.wrap_a1},get_anchor2:function(){null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();return this.zpp_inner_zn.wrap_a2},set_anchor2:function(a){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Constraint::anchor2 cannot be null");
null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();this.zpp_inner_zn.wrap_a2.set(a);null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();return this.zpp_inner_zn.wrap_a2},get_anchor3:function(){null==this.zpp_inner_zn.wrap_a3&&this.zpp_inner_zn.setup_a3();return this.zpp_inner_zn.wrap_a3},set_anchor3:function(a){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Constraint::anchor3 cannot be null");null==this.zpp_inner_zn.wrap_a3&&
this.zpp_inner_zn.setup_a3();this.zpp_inner_zn.wrap_a3.set(a);null==this.zpp_inner_zn.wrap_a3&&this.zpp_inner_zn.setup_a3();return this.zpp_inner_zn.wrap_a3},get_anchor4:function(){null==this.zpp_inner_zn.wrap_a4&&this.zpp_inner_zn.setup_a4();return this.zpp_inner_zn.wrap_a4},set_anchor4:function(a){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Constraint::anchor4 cannot be null");null==this.zpp_inner_zn.wrap_a4&&this.zpp_inner_zn.setup_a4();
this.zpp_inner_zn.wrap_a4.set(a);null==this.zpp_inner_zn.wrap_a4&&this.zpp_inner_zn.setup_a4();return this.zpp_inner_zn.wrap_a4},get_jointMin:function(){return this.zpp_inner_zn.jointMin},set_jointMin:function(a){this.zpp_inner.immutable_midstep("PulleyJoint::jointMin");if(a!=a)throw new f("Error: PulleyJoint::jointMin cannot be NaN");if(0>a)throw new f("Error: PulleyJoint::jointMin must be >= 0");this.zpp_inner_zn.jointMin!=a&&(this.zpp_inner_zn.jointMin=a,this.zpp_inner.wake());return this.zpp_inner_zn.jointMin},
get_jointMax:function(){return this.zpp_inner_zn.jointMax},set_jointMax:function(a){this.zpp_inner.immutable_midstep("PulleyJoint::jointMax");if(a!=a)throw new f("Error: PulleyJoint::jointMax cannot be NaN");if(0>a)throw new f("Error: PulleyJoint::jointMax must be >= 0");this.zpp_inner_zn.jointMax!=a&&(this.zpp_inner_zn.jointMax=a,this.zpp_inner.wake());return this.zpp_inner_zn.jointMax},get_ratio:function(){return this.zpp_inner_zn.ratio},set_ratio:function(a){this.zpp_inner.immutable_midstep("PulleyJoint::ratio");
if(a!=a)throw new f("Error: PulleyJoint::ratio cannot be NaN");this.zpp_inner_zn.ratio!=a&&(this.zpp_inner_zn.ratio=a,this.zpp_inner.wake());return this.zpp_inner_zn.ratio},isSlack:function(){if(null==(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)||null==(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)||null==(null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer)||null==(null==this.zpp_inner_zn.b4?null:this.zpp_inner_zn.b4.outer))throw new f("Error: Cannot compute slack for PulleyJoint if either body is null.");
return this.zpp_inner_zn.slack},impulse:function(){var a=new Qb(1,1);if(0>=a.zpp_inner.m||0>=a.zpp_inner.n)throw new f("Error: MatMN indices out of range");a.zpp_inner.x[0*a.zpp_inner.n]=this.zpp_inner_zn.jAcc;return a},bodyImpulse:function(a){if(null==a)throw new f("Error: Cannot evaluate impulse on null body");if(a!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&a!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&a!=(null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer)&&
a!=(null==this.zpp_inner_zn.b4?null:this.zpp_inner_zn.b4.outer))throw new f("Error: Body is not linked to this constraint");return this.zpp_inner.active?this.zpp_inner_zn.bodyImpulse(a.zpp_inner):N.get()},visitBodies:function(a){null!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&a(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer);null!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)!=(null==this.zpp_inner_zn.b1?
null:this.zpp_inner_zn.b1.outer)&&a(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer);null!=(null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer)&&(null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer)!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&(null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer)!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&a(null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer);null!=(null==this.zpp_inner_zn.b4?
null:this.zpp_inner_zn.b4.outer)&&(null==this.zpp_inner_zn.b4?null:this.zpp_inner_zn.b4.outer)!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&(null==this.zpp_inner_zn.b4?null:this.zpp_inner_zn.b4.outer)!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&(null==this.zpp_inner_zn.b4?null:this.zpp_inner_zn.b4.outer)!=(null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer)&&a(null==this.zpp_inner_zn.b4?null:this.zpp_inner_zn.b4.outer)},__class__:He});var gf=function(a,
b){null==b&&(b=!1);this.zpp_inner_zn=null;if(1>a)throw new f("Error: Constraint dimension must be at least 1");this.zpp_inner=this.zpp_inner_zn=new Ie(a,b);this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;T.zpp_internalAlloc=!0;T.call(this);T.zpp_internalAlloc=!1};gf.__name__=!0;gf.__super__=T;gf.prototype=I(T.prototype,{__bindVec2:function(){var a=new E;a.zpp_inner._inuse=!0;a.zpp_inner._invalidate=(fa=this.zpp_inner_zn,w(fa,fa.bindVec2_invalidate));return a},__copy:function(){throw new f("Error: UserConstraint::__copy must be overriden");
},__broken:function(){},__validate:function(){},__draw:function(a){},__prepare:function(){},__position:function(a){throw new f("Error: UserConstraint::__position must be overriden");},__velocity:function(a){throw new f("Error: Userconstraint::__velocity must be overriden");},__eff_mass:function(a){throw new f("Error: UserConstraint::__eff_mass must be overriden");},__clamp:function(a){},__impulse:function(a,b,c){throw new f("Error: UserConstraint::__impulse must be overriden");},impulse:function(){for(var a=
new Qb(this.zpp_inner_zn.dim,1),b=0,c=this.zpp_inner_zn.dim;b<c;){var d=b++;if(0>d||d>=a.zpp_inner.m||0>=a.zpp_inner.n)throw new f("Error: MatMN indices out of range");a.zpp_inner.x[d*a.zpp_inner.n]=this.zpp_inner_zn.jAcc[d]}return a},bodyImpulse:function(a){if(null==a)throw new f("Error: Cannot evaluate impulse on null body");for(var b=!1,c=0,d=this.zpp_inner_zn.bodies;c<d.length;){var e=d[c];++c;if(e.body==a.zpp_inner){b=!0;break}}if(!b)throw new f("Error: Body is not linked to this constraint");
return this.zpp_inner.active?this.zpp_inner_zn.bodyImpulse(a.zpp_inner):N.get()},visitBodies:function(a){for(var b=0,c=this.zpp_inner_zn.bodies.length;b<c;){var d=this.zpp_inner_zn.bodies[b];if(null!=d.body){for(var e=!1,h=b+1;h<c;){var t=h++;if(this.zpp_inner_zn.bodies[t].body==d.body){e=!0;break}}e||a(d.body.outer)}b++}},__invalidate:function(){this.zpp_inner.immutable_midstep("UserConstraint::invalidate()");this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&
this.zpp_inner.wake()},__registerBody:function(a,b){this.zpp_inner.immutable_midstep("UserConstraint::registerBody(..)");if(a!=b){if(null!=a){if(!this.zpp_inner_zn.remBody(a.zpp_inner))throw new f("Error: oldBody is not registered to the cosntraint");this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&a.zpp_inner.wake()}null!=b&&this.zpp_inner_zn.addBody(b.zpp_inner);this.zpp_inner.wake();null!=b&&b.zpp_inner.wake()}return b},__class__:gf});var Ke=function(a,
b,c,d,e){null==e&&(e=0);this.zpp_inner_zn=null;this.zpp_inner=this.zpp_inner_zn=new Je;this.zpp_inner.outer=this;this.zpp_inner_zn.outer_zn=this;T.zpp_internalAlloc=!0;T.call(this);T.zpp_internalAlloc=!1;this.set_body1(a);this.set_body2(b);if(null!=c&&c.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==c)throw new f("Error: Constraint::anchor1 cannot be null");null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();this.zpp_inner_zn.wrap_a1.set(c);null==this.zpp_inner_zn.wrap_a1&&
this.zpp_inner_zn.setup_a1();this.zpp_inner_zn.wrap_a1;if(null!=d&&d.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==d)throw new f("Error: Constraint::anchor2 cannot be null");null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();this.zpp_inner_zn.wrap_a2.set(d);null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();this.zpp_inner_zn.wrap_a2;this.zpp_inner.immutable_midstep("WeldJoint::phase");if(e!=e)throw new f("Error: WeldJoint::phase cannot be NaN");
this.zpp_inner_zn.phase!=e&&(this.zpp_inner_zn.phase=e,this.zpp_inner.wake());this.zpp_inner_zn.phase};Ke.__name__=!0;Ke.__super__=T;Ke.prototype=I(T.prototype,{get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(a){this.zpp_inner.immutable_midstep("Constraint::body1");a=null==a?null:a.zpp_inner;a!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&
null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=a,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=a&&this.zpp_inner_zn.b2!=a&&null!=a&&a.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=a&&a.wake()));
return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(a){this.zpp_inner.immutable_midstep("Constraint::body2");a=null==a?null:a.zpp_inner;a!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),
this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=a,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=a&&this.zpp_inner_zn.b1!=a&&null!=a&&a.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=a&&a.wake()));return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},get_anchor1:function(){null==
this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();return this.zpp_inner_zn.wrap_a1},set_anchor1:function(a){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Constraint::anchor1 cannot be null");null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();this.zpp_inner_zn.wrap_a1.set(a);null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1();return this.zpp_inner_zn.wrap_a1},get_anchor2:function(){null==this.zpp_inner_zn.wrap_a2&&
this.zpp_inner_zn.setup_a2();return this.zpp_inner_zn.wrap_a2},set_anchor2:function(a){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Constraint::anchor2 cannot be null");null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();this.zpp_inner_zn.wrap_a2.set(a);null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2();return this.zpp_inner_zn.wrap_a2},get_phase:function(){return this.zpp_inner_zn.phase},set_phase:function(a){this.zpp_inner.immutable_midstep("WeldJoint::phase");
if(a!=a)throw new f("Error: WeldJoint::phase cannot be NaN");this.zpp_inner_zn.phase!=a&&(this.zpp_inner_zn.phase=a,this.zpp_inner.wake());return this.zpp_inner_zn.phase},impulse:function(){var a=new Qb(3,1);if(0>=a.zpp_inner.m||0>=a.zpp_inner.n)throw new f("Error: MatMN indices out of range");a.zpp_inner.x[0*a.zpp_inner.n]=this.zpp_inner_zn.jAccx;if(1>=a.zpp_inner.m||0>=a.zpp_inner.n)throw new f("Error: MatMN indices out of range");a.zpp_inner.x[a.zpp_inner.n]=this.zpp_inner_zn.jAccy;if(1>=a.zpp_inner.m||
0>=a.zpp_inner.n)throw new f("Error: MatMN indices out of range");a.zpp_inner.x[a.zpp_inner.n]=this.zpp_inner_zn.jAccz;return a},bodyImpulse:function(a){if(null==a)throw new f("Error: Cannot evaluate impulse on null body");if(a!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&a!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer))throw new f("Error: Body is not linked to this constraint");return this.zpp_inner.active?this.zpp_inner_zn.bodyImpulse(a.zpp_inner):N.get()},visitBodies:function(a){null!=
(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&a(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer);null!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&a(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)},__class__:Ke});var rd=function(){this.zpp_inner=null;if(!F.internal)throw new f("Error: Cannot instantiate Arbiter derp!");
};rd.__name__=!0;rd.prototype={get_isSleeping:function(){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");return this.zpp_inner.sleeping},get_type:function(){return F.types[this.zpp_inner.type]},isCollisionArbiter:function(){return this.zpp_inner.type==F.COL},isFluidArbiter:function(){return this.zpp_inner.type==F.FLUID},isSensorArbiter:function(){return this.zpp_inner.type==F.SENSOR},get_collisionArbiter:function(){return this.zpp_inner.type==F.COL?this.zpp_inner.colarb.outer_zn:
null},get_fluidArbiter:function(){return this.zpp_inner.type==F.FLUID?this.zpp_inner.fluidarb.outer_zn:null},get_shape1:function(){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");return this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws2.outer:this.zpp_inner.ws1.outer},get_shape2:function(){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");return this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws1.outer:this.zpp_inner.ws2.outer},
get_body1:function(){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");return this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.b2.outer:this.zpp_inner.b1.outer},get_body2:function(){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");return this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.b1.outer:this.zpp_inner.b2.outer},get_state:function(){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");var a=this.zpp_inner.immState;
if(5==a)return null==g.PreFlag_ACCEPT&&(g.internal=!0,g.PreFlag_ACCEPT=new ja,g.internal=!1),g.PreFlag_ACCEPT;switch(a){case 1:return null==g.PreFlag_ACCEPT_ONCE&&(g.internal=!0,g.PreFlag_ACCEPT_ONCE=new ja,g.internal=!1),g.PreFlag_ACCEPT_ONCE;default:if(6==a)return null==g.PreFlag_IGNORE&&(g.internal=!0,g.PreFlag_IGNORE=new ja,g.internal=!1),g.PreFlag_IGNORE;null==g.PreFlag_IGNORE_ONCE&&(g.internal=!0,g.PreFlag_IGNORE_ONCE=new ja,g.internal=!1);return g.PreFlag_IGNORE_ONCE}},totalImpulse:function(a,
b){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");var c;if(c=null!=a){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");c=a!=(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.b2.outer:this.zpp_inner.b1.outer)}if(c){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");c=a!=(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.b1.outer:this.zpp_inner.b2.outer)}if(c)throw new f("Error: Arbiter does not relate to body");
return N.get(0,0,0)},toString:function(){var a;a=this.zpp_inner.type==F.COL?"CollisionArbiter":this.zpp_inner.type==F.FLUID?"FluidArbiter":"SensorArbiter";if(this.zpp_inner.cleared)a+="(object-pooled)";else{a+="(";if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");a=a+(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws2.outer:this.zpp_inner.ws1.outer).toString()+"|";if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");a=a+(this.zpp_inner.ws1.id>
this.zpp_inner.ws2.id?this.zpp_inner.ws1.outer:this.zpp_inner.ws2.outer).toString()+")"+(this.zpp_inner.type==F.COL?"["+["SD","DD"][this.zpp_inner.colarb.stat?0:1]+"]":"")+"<-"+this.get_state().toString()}return a},__class__:rd};var Hc=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null;if(!qb.internal)throw new f("Error: Cannot instantiate ArbiterIterator derp!");};Hc.__name__=!0;Hc.get=function(a){var b;null==Hc.zpp_pool?(qb.internal=!0,b=new Hc,qb.internal=!1):(b=
Hc.zpp_pool,Hc.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};Hc.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.zpp_gl();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=Hc.zpp_pool;Hc.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:Hc};var sd=function(){this.zpp_inner=null;this.zpp_inner=new qb;this.zpp_inner.outer=this};sd.__name__=!0;sd.fromArray=
function(a){if(null==a)throw new f("Error: Cannot convert null Array to Nape list");for(var b=new sd,c=0;c<a.length;){var d=a[c];++c;b.push(d)}return b};sd.prototype={get_length:function(){return this.zpp_gl()},zpp_gl:function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1;this.zpp_inner.user_length=0;for(var a=this.zpp_inner.inner.head;null!=a;)a.elt.active&&this.zpp_inner.user_length++,a=a.next}return this.zpp_inner.user_length},zpp_vm:function(){this.zpp_inner.valmod()},
has:function(a){this.zpp_vm();return this.zpp_inner.inner.has(a.zpp_inner)},at:function(a){this.zpp_vm();if(0>a||a>=this.zpp_gl())throw new f("Error: Index out of bounds");this.zpp_inner.reverse_flag&&(a=this.zpp_gl()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)for(this.zpp_inner.at_index=0,this.zpp_inner.at_ite=this.zpp_inner.inner.head;!this.zpp_inner.at_ite.elt.active;)this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;for(;this.zpp_inner.at_index!=a;)for(this.zpp_inner.at_index++,
this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;!this.zpp_inner.at_ite.elt.active;)this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.wrapper()},push:function(a){if(this.zpp_inner.immutable)throw new f("Error: ArbiterList is immutable");this.zpp_inner.modify_test();this.zpp_vm();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&(this.empty()?this.zpp_inner.push_ite=
null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.zpp_gl()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},unshift:function(a){if(this.zpp_inner.immutable)throw new f("Error: ArbiterList is immutable");this.zpp_inner.modify_test();this.zpp_vm();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?
(null==this.zpp_inner.push_ite&&(this.empty()?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.zpp_gl()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)):this.zpp_inner.inner.add(a.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},pop:function(){if(this.zpp_inner.immutable)throw new f("Error: ArbiterList is immutable");this.zpp_inner.modify_test();if(this.empty())throw new f("Error: Cannot remove from empty list");
this.zpp_vm();var a=null;if(this.zpp_inner.reverse_flag){var a=this.zpp_inner.inner.head.elt,b=a.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(b);this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b=1==this.zpp_gl()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-2),a=null==b?this.zpp_inner.inner.head.elt:b.next.elt,c=a.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(c);
this.zpp_inner.dontremove||this.zpp_inner.inner.erase(b)}this.zpp_inner.invalidate();return a.wrapper()},shift:function(){if(this.zpp_inner.immutable)throw new f("Error: ArbiterList is immutable");this.zpp_inner.modify_test();if(this.empty())throw new f("Error: Cannot remove from empty list");this.zpp_vm();var a=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b;b=1==this.zpp_gl()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-
2);var a=null==b?this.zpp_inner.inner.head.elt:b.next.elt,c=a.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(c);this.zpp_inner.dontremove||this.zpp_inner.inner.erase(b)}else a=this.zpp_inner.inner.head.elt,b=a.wrapper(),null!=this.zpp_inner.subber&&this.zpp_inner.subber(b),this.zpp_inner.dontremove||this.zpp_inner.inner.pop();this.zpp_inner.invalidate();return a.wrapper()},add:function(a){return this.zpp_inner.reverse_flag?this.push(a):this.unshift(a)},remove:function(a){if(this.zpp_inner.immutable)throw new f("Error: ArbiterList is immutable");
this.zpp_inner.modify_test();this.zpp_vm();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),this.zpp_inner.invalidate());return b},clear:function(){if(this.zpp_inner.immutable)throw new f("Error: ArbiterList is immutable");if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},
empty:function(){return 0==this.zpp_gl()},iterator:function(){this.zpp_vm();return Hc.get(this)},copy:function(a){null==a&&(a=!1);for(var b=new sd,c=this.iterator();c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b.push(a?function(a){throw new f("Error: Arbiter is not a copyable type");}(this):d)}return b},merge:function(a){if(null==a)throw new f("Error: Cannot merge with null list");for(a=a.iterator();a.hasNext();){var b;a.zpp_critical=!1;b=a.zpp_inner.at(a.zpp_i++);this.has(b)||
this.add(b)}},toString:function(){for(var a="[",b=!0,c=this.iterator();c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},foreach:function(a){if(null==a)throw new f("Error: Cannot execute null on list elements");for(var b=this.iterator();b.hasNext();)try{var c=void 0;b.zpp_critical=!1;c=b.zpp_inner.at(b.zpp_i++);a(c)}catch(d){d instanceof f&&(d=d.val);b.zpp_next=Hc.zpp_pool;Hc.zpp_pool=b;b.zpp_inner=null;break}return this},
filter:function(a){if(null==a)throw new f("Error: Cannot select elements of list with null");for(var b=0;b<this.zpp_gl();){var c=this.at(b);try{a(c)?b++:this.remove(c)}catch(d){d instanceof f&&(d=d.val);break}}return this},__class__:sd};var rb=function(){if(!g.internal)throw new f("Error: Cannot instantiate ArbiterType derp!");};rb.__name__=!0;rb.get_COLLISION=function(){null==g.ArbiterType_COLLISION&&(g.internal=!0,g.ArbiterType_COLLISION=new rb,g.internal=!1);return g.ArbiterType_COLLISION};rb.get_SENSOR=
function(){null==g.ArbiterType_SENSOR&&(g.internal=!0,g.ArbiterType_SENSOR=new rb,g.internal=!1);return g.ArbiterType_SENSOR};rb.get_FLUID=function(){null==g.ArbiterType_FLUID&&(g.internal=!0,g.ArbiterType_FLUID=new rb,g.internal=!1);return g.ArbiterType_FLUID};rb.prototype={toString:function(){null==g.ArbiterType_COLLISION&&(g.internal=!0,g.ArbiterType_COLLISION=new rb,g.internal=!1);var a;this==g.ArbiterType_COLLISION?a="COLLISION":(null==g.ArbiterType_SENSOR&&(g.internal=!0,g.ArbiterType_SENSOR=
new rb,g.internal=!1),this==g.ArbiterType_SENSOR?a="SENSOR":(null==g.ArbiterType_FLUID&&(g.internal=!0,g.ArbiterType_FLUID=new rb,g.internal=!1),a=this==g.ArbiterType_FLUID?"FLUID":""));return a},__class__:rb};var Le=function(){if(!F.internal)throw new f("Error: Cannot instantiate CollisionArbiter derp!");rd.call(this)};Le.__name__=!0;Le.__super__=rd;Le.prototype=I(rd.prototype,{get_contacts:function(){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");null==this.zpp_inner.colarb.wrap_contacts&&
this.zpp_inner.colarb.setupcontacts();return this.zpp_inner.colarb.wrap_contacts},get_normal:function(){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");null==this.zpp_inner.colarb.wrap_normal&&this.zpp_inner.colarb.getnormal();return this.zpp_inner.colarb.wrap_normal},get_radius:function(){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");return this.zpp_inner.colarb.radius},get_referenceEdge1:function(){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");
var a=this.zpp_inner.colarb.__ref_edge1,b;if(b=null!=a){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");if(!(b=!(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws2.outer:this.zpp_inner.ws1.outer).isPolygon())){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");b=(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws2.outer:this.zpp_inner.ws1.outer).zpp_inner!=a.polygon}}b&&(a=this.zpp_inner.colarb.__ref_edge2);return null==
a?null:a.wrapper()},get_referenceEdge2:function(){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");var a=this.zpp_inner.colarb.__ref_edge1,b;if(b=null!=a){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");if(!(b=!(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws1.outer:this.zpp_inner.ws2.outer).isPolygon())){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");b=(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?
this.zpp_inner.ws1.outer:this.zpp_inner.ws2.outer).zpp_inner!=a.polygon}}b&&(a=this.zpp_inner.colarb.__ref_edge2);return null==a?null:a.wrapper()},firstVertex:function(){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");return null!=this.zpp_inner.colarb.__ref_edge1!=(null!=this.zpp_inner.colarb.__ref_edge2)?-1==this.zpp_inner.colarb.__ref_vertex:!1},secondVertex:function(){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");return null!=this.zpp_inner.colarb.__ref_edge1!=
(null!=this.zpp_inner.colarb.__ref_edge2)?1==this.zpp_inner.colarb.__ref_vertex:!1},normalImpulse:function(a,b){null==b&&(b=!1);if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");var c;if(c=null!=a){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");c=a!=(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.b2.outer:this.zpp_inner.b1.outer)}if(c){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");c=a!=(this.zpp_inner.ws1.id>
this.zpp_inner.ws2.id?this.zpp_inner.b1.outer:this.zpp_inner.b2.outer)}if(c)throw new f("Error: Arbiter does not relate to body");var d=c=0,e=0,h=this.zpp_inner.colarb;if(!b||h.oc1.fresh){var t=h.oc1.wrapper().normalImpulse(a);if(null!=t&&t.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");t.zpp_inner.validate();c+=1*t.zpp_inner.x;if(null!=t&&t.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");t.zpp_inner.validate();d+=1*t.zpp_inner.y;if(null!=t&&t.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");
t.zpp_inner.validate();e+=1*t.zpp_inner.z;t.dispose()}if(h.hc2&&(!b||h.oc2.fresh)){h=h.oc2.wrapper().normalImpulse(a);if(null!=h&&h.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");h.zpp_inner.validate();c+=1*h.zpp_inner.x;if(null!=h&&h.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");h.zpp_inner.validate();d+=1*h.zpp_inner.y;if(null!=h&&h.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");h.zpp_inner.validate();e+=1*h.zpp_inner.z;
h.dispose()}return N.get(c,d,e)},tangentImpulse:function(a,b){null==b&&(b=!1);if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");var c;if(c=null!=a){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");c=a!=(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.b2.outer:this.zpp_inner.b1.outer)}if(c){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");c=a!=(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.b1.outer:
this.zpp_inner.b2.outer)}if(c)throw new f("Error: Arbiter does not relate to body");var d=c=0,e=0,h=this.zpp_inner.colarb;if(!b||h.oc1.fresh){var t=h.oc1.wrapper().tangentImpulse(a);if(null!=t&&t.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");t.zpp_inner.validate();c+=1*t.zpp_inner.x;if(null!=t&&t.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");t.zpp_inner.validate();d+=1*t.zpp_inner.y;if(null!=t&&t.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");
t.zpp_inner.validate();e+=1*t.zpp_inner.z;t.dispose()}if(h.hc2&&(!b||h.oc2.fresh)){h=h.oc2.wrapper().tangentImpulse(a);if(null!=h&&h.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");h.zpp_inner.validate();c+=1*h.zpp_inner.x;if(null!=h&&h.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");h.zpp_inner.validate();d+=1*h.zpp_inner.y;if(null!=h&&h.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");h.zpp_inner.validate();e+=1*h.zpp_inner.z;
h.dispose()}return N.get(c,d,e)},totalImpulse:function(a,b){null==b&&(b=!1);if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");var c;if(c=null!=a){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");c=a!=(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.b2.outer:this.zpp_inner.b1.outer)}if(c){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");c=a!=(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.b1.outer:
this.zpp_inner.b2.outer)}if(c)throw new f("Error: Arbiter does not relate to body");var d=c=0,e=0,h=this.zpp_inner.colarb;if(!b||h.oc1.fresh){var t=h.oc1.wrapper().totalImpulse(a);if(null!=t&&t.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");t.zpp_inner.validate();c+=1*t.zpp_inner.x;if(null!=t&&t.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");t.zpp_inner.validate();d+=1*t.zpp_inner.y;if(null!=t&&t.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");
t.zpp_inner.validate();e+=1*t.zpp_inner.z;t.dispose()}if(h.hc2&&(!b||h.oc2.fresh)){h=h.oc2.wrapper().totalImpulse(a);if(null!=h&&h.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");h.zpp_inner.validate();c+=1*h.zpp_inner.x;if(null!=h&&h.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");h.zpp_inner.validate();d+=1*h.zpp_inner.y;if(null!=h&&h.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");h.zpp_inner.validate();e+=1*h.zpp_inner.z;
h.dispose()}return N.get(c,d,e)},rollingImpulse:function(a,b){null==b&&(b=!1);if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");var c;if(c=null!=a){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");c=a!=(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.b2.outer:this.zpp_inner.b1.outer)}if(c){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");c=a!=(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.b1.outer:
this.zpp_inner.b2.outer)}if(c)throw new f("Error: Arbiter does not relate to body");c=this.zpp_inner.colarb;return!b||c.oc1.fresh?c.oc1.wrapper().rollingImpulse(a):0},get_elasticity:function(){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");var a=this.zpp_inner.colarb;a.invalidated&&(a.invalidated=!1,a.userdef_restitution||(a.restitution=-Infinity>=a.s1.material.elasticity||-Infinity>=a.s2.material.elasticity?0:Infinity<=a.s1.material.elasticity||Infinity<=a.s2.material.elasticity?
1:(a.s1.material.elasticity+a.s2.material.elasticity)/2,0>a.restitution&&(a.restitution=0),1<a.restitution&&(a.restitution=1)),a.userdef_dyn_fric||(a.dyn_fric=Math.sqrt(a.s1.material.dynamicFriction*a.s2.material.dynamicFriction)),a.userdef_stat_fric||(a.stat_fric=Math.sqrt(a.s1.material.staticFriction*a.s2.material.staticFriction)),a.userdef_rfric||(a.rfric=Math.sqrt(a.s1.material.rollingFriction*a.s2.material.rollingFriction)));return a.restitution},set_elasticity:function(a){if(!this.zpp_inner.colarb.mutable)throw new f("Error: CollisionArbiter::elasticity is only mutable during a pre-handler");
if(a!=a)throw new f("Error: CollisionArbiter::elasticity cannot be NaN");if(0>a)throw new f("Error: CollisionArbiter::elasticity cannot be negative");var b=this.zpp_inner.colarb;b.restitution=a;b.userdef_restitution=!0;return this.get_elasticity()},get_dynamicFriction:function(){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");var a=this.zpp_inner.colarb;a.invalidated&&(a.invalidated=!1,a.userdef_restitution||(a.restitution=-Infinity>=a.s1.material.elasticity||-Infinity>=
a.s2.material.elasticity?0:Infinity<=a.s1.material.elasticity||Infinity<=a.s2.material.elasticity?1:(a.s1.material.elasticity+a.s2.material.elasticity)/2,0>a.restitution&&(a.restitution=0),1<a.restitution&&(a.restitution=1)),a.userdef_dyn_fric||(a.dyn_fric=Math.sqrt(a.s1.material.dynamicFriction*a.s2.material.dynamicFriction)),a.userdef_stat_fric||(a.stat_fric=Math.sqrt(a.s1.material.staticFriction*a.s2.material.staticFriction)),a.userdef_rfric||(a.rfric=Math.sqrt(a.s1.material.rollingFriction*a.s2.material.rollingFriction)));
return a.dyn_fric},set_dynamicFriction:function(a){if(!this.zpp_inner.colarb.mutable)throw new f("Error: CollisionArbiter::dynamicFriction is only mutable during a pre-handler");if(a!=a)throw new f("Error: CollisionArbiter::dynamicFriction cannot be NaN");if(0>a)throw new f("Error: CollisionArbiter::dynamicFriction cannot be negative");var b=this.zpp_inner.colarb;b.dyn_fric=a;b.userdef_dyn_fric=!0;return this.get_dynamicFriction()},get_staticFriction:function(){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");
var a=this.zpp_inner.colarb;a.invalidated&&(a.invalidated=!1,a.userdef_restitution||(a.restitution=-Infinity>=a.s1.material.elasticity||-Infinity>=a.s2.material.elasticity?0:Infinity<=a.s1.material.elasticity||Infinity<=a.s2.material.elasticity?1:(a.s1.material.elasticity+a.s2.material.elasticity)/2,0>a.restitution&&(a.restitution=0),1<a.restitution&&(a.restitution=1)),a.userdef_dyn_fric||(a.dyn_fric=Math.sqrt(a.s1.material.dynamicFriction*a.s2.material.dynamicFriction)),a.userdef_stat_fric||(a.stat_fric=
Math.sqrt(a.s1.material.staticFriction*a.s2.material.staticFriction)),a.userdef_rfric||(a.rfric=Math.sqrt(a.s1.material.rollingFriction*a.s2.material.rollingFriction)));return a.stat_fric},set_staticFriction:function(a){if(!this.zpp_inner.colarb.mutable)throw new f("Error: CollisionArbiter::staticFriction is only mutable during a pre-handler");if(a!=a)throw new f("Error: CollisionArbiter::staticFriction cannot be NaN");if(0>a)throw new f("Error: CollisionArbiter::staticFriction cannot be negative");
var b=this.zpp_inner.colarb;b.stat_fric=a;b.userdef_stat_fric=!0;return this.get_staticFriction()},get_rollingFriction:function(){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");var a=this.zpp_inner.colarb;a.invalidated&&(a.invalidated=!1,a.userdef_restitution||(a.restitution=-Infinity>=a.s1.material.elasticity||-Infinity>=a.s2.material.elasticity?0:Infinity<=a.s1.material.elasticity||Infinity<=a.s2.material.elasticity?1:(a.s1.material.elasticity+a.s2.material.elasticity)/
2,0>a.restitution&&(a.restitution=0),1<a.restitution&&(a.restitution=1)),a.userdef_dyn_fric||(a.dyn_fric=Math.sqrt(a.s1.material.dynamicFriction*a.s2.material.dynamicFriction)),a.userdef_stat_fric||(a.stat_fric=Math.sqrt(a.s1.material.staticFriction*a.s2.material.staticFriction)),a.userdef_rfric||(a.rfric=Math.sqrt(a.s1.material.rollingFriction*a.s2.material.rollingFriction)));return a.rfric},set_rollingFriction:function(a){if(!this.zpp_inner.colarb.mutable)throw new f("Error: CollisionArbiter::rollingFriction is only mutable during a pre-handler");
if(a!=a)throw new f("Error: CollisionArbiter::rollingFriction cannot be NaN");if(0>a)throw new f("Error: CollisionArbiter::rollingFriction cannot be negative");var b=this.zpp_inner.colarb;b.rfric=a;b.userdef_rfric=!0;return this.get_rollingFriction()},__class__:Le});var hf=function(){this.zpp_inner=null;if(!Ia.internal)throw new f("Error: Cannot instantiate Contact derp!");};hf.__name__=!0;hf.prototype={get_arbiter:function(){return null==this.zpp_inner.arbiter?null:this.zpp_inner.arbiter.outer.get_collisionArbiter()},
get_penetration:function(){if(this.zpp_inner.inactiveme())throw new f("Error: Contact not currently in use");return-this.zpp_inner.dist},get_position:function(){if(this.zpp_inner.inactiveme())throw new f("Error: Contact not currently in use");null==this.zpp_inner.wrap_position&&this.zpp_inner.getposition();return this.zpp_inner.wrap_position},get_fresh:function(){if(this.zpp_inner.inactiveme())throw new f("Error: Contact not currently in use");return this.zpp_inner.fresh},normalImpulse:function(a){if(this.zpp_inner.inactiveme())throw new f("Error: Contact not currently in use");
var b=this.zpp_inner.arbiter.colarb,c=this.zpp_inner.inner,d=c.jnAcc;if(null==a)return N.get(b.nx*d,b.ny*d);if(a!=b.b1.outer&&a!=b.b2.outer)throw new f("Error: Contact does not relate to the given body");return a==b.b1.outer?N.get(b.nx*-d,b.ny*-d,-(b.ny*c.r1x-b.nx*c.r1y)*d):N.get(b.nx*d,b.ny*d,(b.ny*c.r2x-b.nx*c.r2y)*d)},tangentImpulse:function(a){if(this.zpp_inner.inactiveme())throw new f("Error: Contact not currently in use");var b=this.zpp_inner.arbiter.colarb,c=this.zpp_inner.inner,d=c.jtAcc;
if(null==a)return N.get(-b.ny*d,b.nx*d);if(a!=b.b1.outer&&a!=b.b2.outer)throw new f("Error: Contact does not relate to the given body");return a==b.b1.outer?N.get(b.ny*d,-b.nx*d,-(c.r1x*b.nx+c.r1y*b.ny)*d):N.get(-b.ny*d,b.nx*d,(c.r2x*b.nx+c.r2y*b.ny)*d)},rollingImpulse:function(a){if(this.zpp_inner.inactiveme())throw new f("Error: Contact not currently in use");var b=this.zpp_inner.arbiter.colarb,c=this.zpp_inner.arbiter.colarb.jrAcc;if(null==a)return c;if(a!=b.b1.outer&&a!=b.b2.outer)throw new f("Error: Contact does not relate to the given body");
return a==b.b1.outer?-c:c},totalImpulse:function(a){if(this.zpp_inner.inactiveme())throw new f("Error: Contact not currently in use");var b=this.zpp_inner.arbiter.colarb,c=this.zpp_inner.inner,d=c.jnAcc,e=c.jtAcc,h=b.jrAcc;if(null==a)return N.get(b.nx*d-b.ny*e,b.ny*d+b.nx*e,h);if(a!=b.b1.outer&&a!=b.b2.outer)throw new f("Error: Contact does not relate to the given body");var t=b.nx*d-b.ny*e,d=b.ny*d+b.nx*e;return a==b.b1.outer?N.get(-t,-d,-(d*c.r1x-t*c.r1y)-h):N.get(t,d,d*c.r2x-t*c.r2y+h)},get_friction:function(){if(this.zpp_inner.inactiveme())throw new f("Error: Contact not currently in use");
return this.zpp_inner.inner.friction},toString:function(){return null==this.zpp_inner.arbiter||this.zpp_inner.arbiter.cleared?"{object-pooled}":"{Contact}"},__class__:hf};var Mb=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null;if(!td.internal)throw new f("Error: Cannot instantiate ContactIterator derp!");};Mb.__name__=!0;Mb.get=function(a){var b;null==Mb.zpp_pool?(td.internal=!0,b=new Mb,td.internal=!1):(b=Mb.zpp_pool,Mb.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=
a;b.zpp_critical=!1;return b};Mb.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=Mb.zpp_pool;Mb.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:Mb};var xd=function(){this.zpp_inner=null;this.zpp_inner=new td;this.zpp_inner.outer=this};xd.__name__=!0;xd.fromArray=function(a){if(null==a)throw new f("Error: Cannot convert null Array to Nape list");
for(var b=new xd,c=0;c<a.length;){var d=a[c];++c;b.push(d)}return b};xd.prototype={get_length:function(){this.zpp_inner.valmod();if(this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1;this.zpp_inner.user_length=0;for(var a=this.zpp_inner.inner.next;null!=a;){var b=a;b.active&&b.arbiter.active&&this.zpp_inner.user_length++;a=a.next}}return this.zpp_inner.user_length},has:function(a){this.zpp_inner.valmod();return this.zpp_inner.inner.has(a.zpp_inner)},at:function(a){this.zpp_inner.valmod();if(0>
a||a>=this.get_length())throw new f("Error: Index out of bounds");this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)for(this.zpp_inner.at_index=0,this.zpp_inner.at_ite=this.zpp_inner.inner.next;;){var b=this.zpp_inner.at_ite;if(b.active&&b.arbiter.active)break;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}for(;this.zpp_inner.at_index!=a;)for(this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;;){b=this.zpp_inner.at_ite;
if(b.active&&b.arbiter.active)break;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}return this.zpp_inner.at_ite.wrapper()},push:function(a){if(this.zpp_inner.immutable)throw new f("Error: ContactList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&(0==this.get_length()?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=
this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},unshift:function(a){if(this.zpp_inner.immutable)throw new f("Error: ContactList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&
(0==this.get_length()?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)):this.zpp_inner.inner.add(a.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},pop:function(){if(this.zpp_inner.immutable)throw new f("Error: ContactList is immutable");this.zpp_inner.modify_test();if(0==this.get_length())throw new f("Error: Cannot remove from empty list");
this.zpp_inner.valmod();var a=null;if(this.zpp_inner.reverse_flag){var a=this.zpp_inner.inner.next,b=a.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(b);this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),a=null==b?this.zpp_inner.inner.next:b.next,c=a.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(c);
this.zpp_inner.dontremove||this.zpp_inner.inner.erase(b)}this.zpp_inner.invalidate();return a.wrapper()},shift:function(){if(this.zpp_inner.immutable)throw new f("Error: ContactList is immutable");this.zpp_inner.modify_test();if(0==this.get_length())throw new f("Error: Cannot remove from empty list");this.zpp_inner.valmod();var a=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b;b=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-
2);var a=null==b?this.zpp_inner.inner.next:b.next,c=a.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(c);this.zpp_inner.dontremove||this.zpp_inner.inner.erase(b)}else a=this.zpp_inner.inner.next,b=a.wrapper(),null!=this.zpp_inner.subber&&this.zpp_inner.subber(b),this.zpp_inner.dontremove||this.zpp_inner.inner.pop();this.zpp_inner.invalidate();return a.wrapper()},add:function(a){return this.zpp_inner.reverse_flag?this.push(a):this.unshift(a)},remove:function(a){if(this.zpp_inner.immutable)throw new f("Error: ContactList is immutable");
this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.next;null!=c;){if(c==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),this.zpp_inner.invalidate());return b},clear:function(){if(this.zpp_inner.immutable)throw new f("Error: ContactList is immutable");if(this.zpp_inner.reverse_flag)for(;0!=this.get_length();)this.pop();else for(;0!=this.get_length();)this.shift()},
empty:function(){return 0==this.get_length()},iterator:function(){this.zpp_inner.valmod();return Mb.get(this)},copy:function(a){null==a&&(a=!1);var b=new xd,c;this.zpp_inner.valmod();for(c=Mb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b.push(a?function(a){throw new f("Error: Contact is not a copyable type");}(this):d)}return b},merge:function(a){if(null==a)throw new f("Error: Cannot merge with null list");a.zpp_inner.valmod();for(a=Mb.get(a);a.hasNext();){var b;a.zpp_critical=
!1;b=a.zpp_inner.at(a.zpp_i++);this.has(b)||(this.zpp_inner.reverse_flag?this.push(b):this.unshift(b))}},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=Mb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},foreach:function(a){if(null==a)throw new f("Error: Cannot execute null on list elements");var b;this.zpp_inner.valmod();for(b=Mb.get(this);b.hasNext();)try{var c=void 0;b.zpp_critical=!1;
c=b.zpp_inner.at(b.zpp_i++);a(c)}catch(d){d instanceof f&&(d=d.val);b.zpp_next=Mb.zpp_pool;Mb.zpp_pool=b;b.zpp_inner=null;break}return this},filter:function(a){if(null==a)throw new f("Error: Cannot select elements of list with null");for(var b=0;b<this.get_length();){var c=this.at(b);try{a(c)?b++:this.remove(c)}catch(d){d instanceof f&&(d=d.val);break}}return this},__class__:xd};var Me=function(){if(!F.internal)throw new f("Error: Cannot instantiate FluidArbiter derp!");rd.call(this)};Me.__name__=
!0;Me.__super__=rd;Me.prototype=I(rd.prototype,{get_position:function(){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");null==this.zpp_inner.fluidarb.wrap_position&&this.zpp_inner.fluidarb.getposition();return this.zpp_inner.fluidarb.wrap_position},set_position:function(a){if(!this.zpp_inner.fluidarb.mutable)throw new f("Error: Arbiter is mutable only within a pre-handler");if(null==a)throw new f("Error: FluidArbiter::position cannot be null");if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");
null==this.zpp_inner.fluidarb.wrap_position&&this.zpp_inner.fluidarb.getposition();this.zpp_inner.fluidarb.wrap_position.set(a);if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");null==this.zpp_inner.fluidarb.wrap_position&&this.zpp_inner.fluidarb.getposition();return this.zpp_inner.fluidarb.wrap_position},get_overlap:function(){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");return this.zpp_inner.fluidarb.overlap},set_overlap:function(a){if(!this.zpp_inner.fluidarb.mutable)throw new f("Error: Arbiter is mutable only within a pre-handler");
if(a!=a)throw new f("Error: FluidArbiter::overlap cannot be NaN");if(0>=a||Infinity==a)throw new f("Error: FluidArbiter::overlap must be strictly positive and non infinite");this.zpp_inner.fluidarb.overlap=a;if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");return this.zpp_inner.fluidarb.overlap},buoyancyImpulse:function(a){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");var b;if(b=null!=a){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");
b=a!=(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.b2.outer:this.zpp_inner.b1.outer)}if(b){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");b=a!=(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.b1.outer:this.zpp_inner.b2.outer)}if(b)throw new f("Error: Arbiter does not relate to body");b=this.zpp_inner.fluidarb;return null==a?N.get(b.buoyx,b.buoyy,0):a.zpp_inner==this.zpp_inner.b2?N.get(b.buoyx,b.buoyy,b.buoyy*b.r2x-b.buoyx*b.r2y):N.get(-b.buoyx,
-b.buoyy,-(b.buoyy*b.r1x-b.buoyx*b.r1y))},dragImpulse:function(a){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");var b;if(b=null!=a){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");b=a!=(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.b2.outer:this.zpp_inner.b1.outer)}if(b){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");b=a!=(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.b1.outer:this.zpp_inner.b2.outer)}if(b)throw new f("Error: Arbiter does not relate to body");
b=this.zpp_inner.fluidarb;a=null==a||a.zpp_inner==this.zpp_inner.b2?1:-1;return N.get(b.dampx*a,b.dampy*a,b.adamp*a)},totalImpulse:function(a,b){null==b&&(b=!1);if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");var c;if(c=null!=a){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");c=a!=(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.b2.outer:this.zpp_inner.b1.outer)}if(c){if(!this.zpp_inner.active)throw new f("Error: Arbiter not currently in use");
c=a!=(this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.b1.outer:this.zpp_inner.b2.outer)}if(c)throw new f("Error: Arbiter does not relate to body");var d=this.buoyancyImpulse(a),e=this.dragImpulse(a);e.set_x(function(a){if(null!=e&&e.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");e.zpp_inner.validate();return e.zpp_inner.x}(this)+function(a){if(null!=d&&d.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");d.zpp_inner.validate();return d.zpp_inner.x}(this));
e.set_y(function(a){if(null!=e&&e.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");e.zpp_inner.validate();return e.zpp_inner.y}(this)+function(a){if(null!=d&&d.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");d.zpp_inner.validate();return d.zpp_inner.y}(this));e.set_z(function(a){if(null!=e&&e.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");e.zpp_inner.validate();return e.zpp_inner.z}(this)+function(a){if(null!=d&&d.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");
d.zpp_inner.validate();return d.zpp_inner.z}(this));d.dispose();return e},__class__:Me});var Ne=function(a,b,c,d,e,h){null==h&&(h=-1);null==e&&(e=1);null==d&&(d=-1);null==c&&(c=1);null==b&&(b=-1);null==a&&(a=1);this.zpp_inner=null;null==za.zpp_pool?this.zpp_inner=new za:(this.zpp_inner=za.zpp_pool,za.zpp_pool=this.zpp_inner.next,this.zpp_inner.next=null);null;this.zpp_inner.outer=this;this.zpp_inner.collisionGroup!=a&&(this.zpp_inner.collisionGroup=a,this.zpp_inner.invalidate());this.zpp_inner.collisionGroup;
this.zpp_inner.collisionMask!=b&&(this.zpp_inner.collisionMask=b,this.zpp_inner.invalidate());this.zpp_inner.collisionMask;this.zpp_inner.sensorGroup!=c&&(this.zpp_inner.sensorGroup=c,this.zpp_inner.invalidate());this.zpp_inner.sensorGroup;this.zpp_inner.sensorMask!=d&&(this.zpp_inner.sensorMask=d,this.zpp_inner.invalidate());this.zpp_inner.sensorMask;this.zpp_inner.fluidGroup!=e&&(this.zpp_inner.fluidGroup=e,this.zpp_inner.invalidate());this.zpp_inner.fluidGroup;this.zpp_inner.fluidMask!=h&&(this.zpp_inner.fluidMask=
h,this.zpp_inner.invalidate());this.zpp_inner.fluidMask};Ne.__name__=!0;Ne.prototype={get_userData:function(){null==this.zpp_inner.userData&&(this.zpp_inner.userData={});return this.zpp_inner.userData},get_shapes:function(){null==this.zpp_inner.wrap_shapes&&(this.zpp_inner.wrap_shapes=Zc.get(this.zpp_inner.shapes,!0));return this.zpp_inner.wrap_shapes},get_collisionGroup:function(){return this.zpp_inner.collisionGroup},set_collisionGroup:function(a){this.zpp_inner.collisionGroup!=a&&(this.zpp_inner.collisionGroup=
a,this.zpp_inner.invalidate());return this.zpp_inner.collisionGroup},get_collisionMask:function(){return this.zpp_inner.collisionMask},set_collisionMask:function(a){this.zpp_inner.collisionMask!=a&&(this.zpp_inner.collisionMask=a,this.zpp_inner.invalidate());return this.zpp_inner.collisionMask},get_sensorGroup:function(){return this.zpp_inner.sensorGroup},set_sensorGroup:function(a){this.zpp_inner.sensorGroup!=a&&(this.zpp_inner.sensorGroup=a,this.zpp_inner.invalidate());return this.zpp_inner.sensorGroup},
get_sensorMask:function(){return this.zpp_inner.sensorMask},set_sensorMask:function(a){this.zpp_inner.sensorMask!=a&&(this.zpp_inner.sensorMask=a,this.zpp_inner.invalidate());return this.zpp_inner.sensorMask},get_fluidGroup:function(){return this.zpp_inner.fluidGroup},set_fluidGroup:function(a){this.zpp_inner.fluidGroup!=a&&(this.zpp_inner.fluidGroup=a,this.zpp_inner.invalidate());return this.zpp_inner.fluidGroup},get_fluidMask:function(){return this.zpp_inner.fluidMask},set_fluidMask:function(a){this.zpp_inner.fluidMask!=
a&&(this.zpp_inner.fluidMask=a,this.zpp_inner.invalidate());return this.zpp_inner.fluidMask},shouldCollide:function(a){if(null==a)throw new f("Error: filter argument cannot be null for shouldCollide");return this.zpp_inner.shouldCollide(a.zpp_inner)},shouldSense:function(a){if(null==a)throw new f("Error: filter argument cannot be null for shouldSense");return this.zpp_inner.shouldSense(a.zpp_inner)},shouldFlow:function(a){if(null==a)throw new f("Error: filter argument cannot be null for shouldFlow");
return this.zpp_inner.shouldFlow(a.zpp_inner)},copy:function(){return new Ne(this.zpp_inner.collisionGroup,this.zpp_inner.collisionMask,this.zpp_inner.sensorGroup,this.zpp_inner.sensorMask,this.zpp_inner.fluidGroup,this.zpp_inner.fluidMask)},toString:function(){return"{ collision: "+Ed.hex(this.zpp_inner.collisionGroup,8)+"~"+Ed.hex(this.zpp_inner.collisionMask,8)+" sensor: "+Ed.hex(this.zpp_inner.sensorGroup,8)+"~"+Ed.hex(this.zpp_inner.sensorMask,8)+" fluid: "+Ed.hex(this.zpp_inner.fluidGroup,8)+
"~"+Ed.hex(this.zpp_inner.fluidMask,8)+" }"},__class__:Ne};var Oe=function(a,b,c,d){null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.zpp_inner=null;if(a!=a||b!=b)throw new f("Error: AABB position cannot be NaN");if(c!=c||d!=d)throw new f("Error: AABB dimensions cannot be NaN");this.zpp_inner=X.get(a,b,a+c,b+d);this.zpp_inner.outer=this};Oe.__name__=!0;Oe.prototype={copy:function(){this.zpp_inner.validate();return this.zpp_inner.copy().wrapper()},get_min:function(){return this.zpp_inner.getmin()},
set_min:function(a){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(this.zpp_inner._immutable)throw new f("Error: AABB is immutable");if(null==a)throw new f("Error: Cannot assign null to AABB::min");this.zpp_inner.validate();var b=this.zpp_inner.minx;this.zpp_inner.validate();(b=b!=this.zpp_inner.minx)||(this.zpp_inner.validate(),b=this.zpp_inner.miny,this.zpp_inner.validate(),b=b!=this.zpp_inner.miny);if(b)throw new f("Error: AABB::min components cannot be NaN");
if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();if(a.zpp_inner.x>this.zpp_inner.getmax().get_x())throw new f("Error: Assignment would cause negative width");if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();if(a.zpp_inner.y>this.zpp_inner.getmax().get_y())throw new f("Error: Assignment would cause negative height");this.zpp_inner.getmin().set(a);return this.zpp_inner.getmin()},
get_max:function(){return this.zpp_inner.getmax()},set_max:function(a){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(this.zpp_inner._immutable)throw new f("Error: AABB is immutable");if(null==a)throw new f("Error: Cannot assign null to AABB::max");this.zpp_inner.validate();var b=this.zpp_inner.minx;this.zpp_inner.validate();(b=b!=this.zpp_inner.minx)||(this.zpp_inner.validate(),b=this.zpp_inner.miny,this.zpp_inner.validate(),b=b!=this.zpp_inner.miny);if(b)throw new f("Error: AABB::max components cannot be NaN");
if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();if(a.zpp_inner.x<this.zpp_inner.getmin().get_x())throw new f("Error: Assignment would cause negative width");if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();if(a.zpp_inner.y<this.zpp_inner.getmin().get_y())throw new f("Error: Assignment would cause negative height");this.zpp_inner.getmax().set(a);return this.zpp_inner.getmax()},
get_x:function(){this.zpp_inner.validate();return this.zpp_inner.minx},set_x:function(a){if(this.zpp_inner._immutable)throw new f("Error: AABB is immutable");this.zpp_inner.validate();if(this.zpp_inner.minx!=a){if(a!=a)throw new f("Error: AABB::x cannot be NaN");this.zpp_inner.maxx+=a-this.zpp_inner.minx;this.zpp_inner.minx=a;this.zpp_inner.invalidate()}this.zpp_inner.validate();return this.zpp_inner.minx},get_y:function(){this.zpp_inner.validate();return this.zpp_inner.miny},set_y:function(a){if(this.zpp_inner._immutable)throw new f("Error: AABB is immutable");
this.zpp_inner.validate();if(this.zpp_inner.miny!=a){if(a!=a)throw new f("Error: AABB::y cannot be NaN");this.zpp_inner.maxy+=a-this.zpp_inner.miny;this.zpp_inner.miny=a;this.zpp_inner.invalidate()}this.zpp_inner.validate();return this.zpp_inner.miny},get_width:function(){this.zpp_inner.validate();return this.zpp_inner.width()},set_width:function(a){if(this.zpp_inner._immutable)throw new f("Error: AABB is immutable");this.zpp_inner.validate();if(this.zpp_inner.width()!=a){if(a!=a)throw new f("Error: AABB::width cannot be NaN");
if(0>a)throw new f("Error: AABB::width ("+a+") must be >= 0");var b=this.zpp_inner;this.zpp_inner.validate();b.maxx=this.zpp_inner.minx+a;this.zpp_inner.invalidate()}this.zpp_inner.validate();return this.zpp_inner.width()},get_height:function(){this.zpp_inner.validate();return this.zpp_inner.height()},set_height:function(a){if(this.zpp_inner._immutable)throw new f("Error: AABB is immutable");this.zpp_inner.validate();if(this.zpp_inner.height()!=a){if(a!=a)throw new f("Error: AABB::height cannot be NaN");
if(0>a)throw new f("Error: AABB::height ("+a+") must be >= 0");var b=this.zpp_inner;this.zpp_inner.validate();b.maxy=this.zpp_inner.miny+a;this.zpp_inner.invalidate()}this.zpp_inner.validate();return this.zpp_inner.height()},toString:function(){this.zpp_inner.validate();return this.zpp_inner.toString()},__class__:Oe};var jf=function(){this.zpp_inner=null;if(!Ba.internal)throw new f("Error: ConvexResult cannot be instantiated derp!");};jf.__name__=!0;jf.prototype={get_normal:function(){if(null!=this.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");
return this.zpp_inner.normal},get_position:function(){if(null!=this.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");return this.zpp_inner.position},get_toi:function(){if(null!=this.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");return this.zpp_inner.toiDistance},get_shape:function(){if(null!=this.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");return this.zpp_inner.shape},dispose:function(){if(null!=
this.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");this.zpp_inner.free()},toString:function(){if(null!=this.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");var a="{ shape: "+Za.string(function(a){if(null!=a.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");return a.zpp_inner.shape}(this))+" toi: ";if(null!=this.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");
return a+this.zpp_inner.toiDistance+" }"},__class__:jf};var fc=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null;if(!oc.internal)throw new f("Error: Cannot instantiate ConvexResultIterator derp!");};fc.__name__=!0;fc.get=function(a){var b;null==fc.zpp_pool?(oc.internal=!0,b=new fc,oc.internal=!1):(b=fc.zpp_pool,fc.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};fc.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();
this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=fc.zpp_pool;fc.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:fc};var Kd=function(){this.zpp_inner=null;this.zpp_inner=new oc;this.zpp_inner.outer=this};Kd.__name__=!0;Kd.fromArray=function(a){if(null==a)throw new f("Error: Cannot convert null Array to Nape list");for(var b=new Kd,c=0;c<a.length;){var d=a[c];++c;b.push(d)}return b};Kd.prototype={get_length:function(){this.zpp_inner.valmod();
this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},has:function(a){this.zpp_inner.valmod();return this.zpp_inner.inner.has(a)},at:function(a){this.zpp_inner.valmod();if(0>a||a>=this.get_length())throw new f("Error: Index out of bounds");this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);
else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt},push:function(a){if(this.zpp_inner.immutable)throw new f("Error: ConvexResultList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?
null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},unshift:function(a){if(this.zpp_inner.immutable)throw new f("Error: ConvexResultList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&
(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a)):this.zpp_inner.inner.add(a),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},pop:function(){if(this.zpp_inner.immutable)throw new f("Error: ConvexResultList is immutable");this.zpp_inner.modify_test();if(null==this.zpp_inner.inner.head)throw new f("Error: Cannot remove from empty list");
this.zpp_inner.valmod();var a=null;if(this.zpp_inner.reverse_flag)a=this.zpp_inner.inner.head.elt,null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.pop();else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b;b=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2);a=null==b?this.zpp_inner.inner.head.elt:b.next.elt;null!=this.zpp_inner.subber&&this.zpp_inner.subber(a);this.zpp_inner.dontremove||
this.zpp_inner.inner.erase(b)}this.zpp_inner.invalidate();return a},shift:function(){if(this.zpp_inner.immutable)throw new f("Error: ConvexResultList is immutable");this.zpp_inner.modify_test();if(null==this.zpp_inner.inner.head)throw new f("Error: Cannot remove from empty list");this.zpp_inner.valmod();var a=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b;b=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-
2);a=null==b?this.zpp_inner.inner.head.elt:b.next.elt;null!=this.zpp_inner.subber&&this.zpp_inner.subber(a);this.zpp_inner.dontremove||this.zpp_inner.inner.erase(b)}else a=this.zpp_inner.inner.head.elt,null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.pop();this.zpp_inner.invalidate();return a},add:function(a){return this.zpp_inner.reverse_flag?this.push(a):this.unshift(a)},remove:function(a){if(this.zpp_inner.immutable)throw new f("Error: ConvexResultList is immutable");
this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a),this.zpp_inner.invalidate());return b},clear:function(){if(this.zpp_inner.immutable)throw new f("Error: ConvexResultList is immutable");if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},
empty:function(){return null==this.zpp_inner.inner.head},iterator:function(){this.zpp_inner.valmod();return fc.get(this)},copy:function(a){null==a&&(a=!1);var b=new Kd,c;this.zpp_inner.valmod();for(c=fc.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b.push(a?function(a){throw new f("Error: ConvexResult is not a copyable type");}(this):d)}return b},merge:function(a){if(null==a)throw new f("Error: Cannot merge with null list");a.zpp_inner.valmod();for(a=fc.get(a);a.hasNext();){var b;
a.zpp_critical=!1;b=a.zpp_inner.at(a.zpp_i++);this.has(b)||(this.zpp_inner.reverse_flag?this.push(b):this.unshift(b))}},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=fc.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},foreach:function(a){if(null==a)throw new f("Error: Cannot execute null on list elements");var b;this.zpp_inner.valmod();for(b=fc.get(this);b.hasNext();)try{var c=void 0;b.zpp_critical=
!1;c=b.zpp_inner.at(b.zpp_i++);a(c)}catch(d){d instanceof f&&(d=d.val);b.zpp_next=fc.zpp_pool;fc.zpp_pool=b;b.zpp_inner=null;break}return this},filter:function(a){if(null==a)throw new f("Error: Cannot select elements of list with null");for(var b=0;b<this.get_length();){var c=this.at(b);try{a(c)?b++:this.remove(c)}catch(d){d instanceof f&&(d=d.val);break}}return this},__class__:Kd};var Ic=function(a){this.zpp_pool=this.zpp_inner=null;this.zpp_inner=new kf(this);if(null!=a){if(a instanceof Array&&
null==a.__enum__)for(var b=0;b<a.length;){var c=a[b];++b;if(null==c)throw new f("Error: Array<Vec2> contains null objects");if(!ca.__instanceof(c,E))throw new f("Error: Array<Vec2> contains non Vec2 objects");var d=c;if(null!=d&&d.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");c=y.get(function(a){if(null!=d&&d.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");d.zpp_inner.validate();return d.zpp_inner.x}(this),function(a){if(null!=d&&d.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
d.zpp_inner.validate();return d.zpp_inner.y}(this));null==this.zpp_inner.vertices?this.zpp_inner.vertices=c.prev=c.next=c:(c.prev=this.zpp_inner.vertices,c.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=c,this.zpp_inner.vertices.next=c);this.zpp_inner.vertices=c}else if(ca.__instanceof(a,Ac))for(b=a.iterator();b.hasNext();){var e;b.zpp_critical=!1;e=b.zpp_inner.at(b.zpp_i++);if(null==e)throw new f("Error: Vec2List contains null objects");if(null!=e&&e.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
c=y.get(function(a){if(null!=e&&e.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");e.zpp_inner.validate();return e.zpp_inner.x}(this),function(a){if(null!=e&&e.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");e.zpp_inner.validate();return e.zpp_inner.y}(this));null==this.zpp_inner.vertices?this.zpp_inner.vertices=c.prev=c.next=c:(c.prev=this.zpp_inner.vertices,c.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=c,this.zpp_inner.vertices.next=
c);this.zpp_inner.vertices=c}else if(ca.__instanceof(a,Ic)){if(null!=a&&a.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");b=a.zpp_inner.vertices;if(null!=b){c=b;do{var h=E.get(c.x,c.y,null),c=c.next,t=y.get(function(a){if(null!=h&&h.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");h.zpp_inner.validate();return h.zpp_inner.x}(this),function(a){if(null!=h&&h.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");h.zpp_inner.validate();
return h.zpp_inner.y}(this));null==this.zpp_inner.vertices?this.zpp_inner.vertices=t.prev=t.next=t:(t.prev=this.zpp_inner.vertices,t.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=t,this.zpp_inner.vertices.next=t);this.zpp_inner.vertices=t;h.dispose()}while(c!=b)}}else throw new f("Error: Invalid type for polygon object, should be Array<Vec2>, Vec2List, GeomPoly or for flash10+ flash.Vector<Vec2>");this.skipForward(1);if(a instanceof Array&&null==a.__enum__)for(b=0;b<a.length;){c=
a[b];if(t=c.zpp_inner.weak)c.dispose(),t=!0;t?a.splice(b,1):b++}else if(ca.__instanceof(a,Ac))for(null!=a.zpp_inner._validate&&a.zpp_inner._validate(),a=a.zpp_inner.inner,b=null,c=a.head;null!=c;)t=c.elt,t.outer.zpp_inner.weak?(c=a.erase(b),t.outer.zpp_inner.weak?(t.outer.dispose(),!0):!1):(b=c,c=c.next)}};Ic.__name__=!0;Ic.get=function(a){var b;null==ga.poolGeomPoly?b=new Ic:(b=ga.poolGeomPoly,ga.poolGeomPoly=b.zpp_pool,b.zpp_pool=null,b.zpp_disp=!1,b==ga.nextGeomPoly&&(ga.nextGeomPoly=null));if(null!=
a){if(a instanceof Array&&null==a.__enum__)for(var c=0;c<a.length;){var d=a[c];++c;if(null==d)throw new f("Error: Array<Vec2> contains null objects");if(!ca.__instanceof(d,E))throw new f("Error: Array<Vec2> contains non Vec2 objects");var e=d;if(null!=e&&e.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");d=y.get(function(a){if(null!=e&&e.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");e.zpp_inner.validate();return e.zpp_inner.x}(this),function(a){if(null!=
e&&e.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");e.zpp_inner.validate();return e.zpp_inner.y}(this));null==b.zpp_inner.vertices?b.zpp_inner.vertices=d.prev=d.next=d:(d.prev=b.zpp_inner.vertices,d.next=b.zpp_inner.vertices.next,b.zpp_inner.vertices.next.prev=d,b.zpp_inner.vertices.next=d);b.zpp_inner.vertices=d}else if(ca.__instanceof(a,Ac))for(c=a.iterator();c.hasNext();){var h;c.zpp_critical=!1;h=c.zpp_inner.at(c.zpp_i++);if(null==h)throw new f("Error: Vec2List contains null objects");
if(null!=h&&h.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");d=y.get(function(a){if(null!=h&&h.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");h.zpp_inner.validate();return h.zpp_inner.x}(this),function(a){if(null!=h&&h.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");h.zpp_inner.validate();return h.zpp_inner.y}(this));null==b.zpp_inner.vertices?b.zpp_inner.vertices=d.prev=d.next=d:(d.prev=b.zpp_inner.vertices,d.next=b.zpp_inner.vertices.next,
b.zpp_inner.vertices.next.prev=d,b.zpp_inner.vertices.next=d);b.zpp_inner.vertices=d}else if(ca.__instanceof(a,Ic)){if(null!=a&&a.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");c=a.zpp_inner.vertices;if(null!=c){d=c;do{var t=E.get(d.x,d.y,null),d=d.next,q=y.get(function(a){if(null!=t&&t.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");t.zpp_inner.validate();return t.zpp_inner.x}(this),function(a){if(null!=t&&t.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
t.zpp_inner.validate();return t.zpp_inner.y}(this));null==b.zpp_inner.vertices?b.zpp_inner.vertices=q.prev=q.next=q:(q.prev=b.zpp_inner.vertices,q.next=b.zpp_inner.vertices.next,b.zpp_inner.vertices.next.prev=q,b.zpp_inner.vertices.next=q);b.zpp_inner.vertices=q;t.dispose()}while(d!=c)}}else throw new f("Error: Invalid type for polygon object, should be Array<Vec2>, Vec2List, GeomPoly or for flash10+ flash.Vector<Vec2>");b.skipForward(1);if(a instanceof Array&&null==a.__enum__)for(c=0;c<a.length;){d=
a[c];if(q=d.zpp_inner.weak)d.dispose(),q=!0;q?a.splice(c,1):c++}else if(ca.__instanceof(a,Ac))for(null!=a.zpp_inner._validate&&a.zpp_inner._validate(),a=a.zpp_inner.inner,c=null,d=a.head;null!=d;)q=d.elt,q.outer.zpp_inner.weak?(d=a.erase(c),q.outer.zpp_inner.weak?(q.outer.dispose(),!0):!1):(c=d,d=d.next)}return b};Ic.prototype={empty:function(){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");return null==this.zpp_inner.vertices},size:function(){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");
var a=0,b=this.zpp_inner.vertices,c=this.zpp_inner.vertices;if(null!=b){do a++,b=b.next;while(b!=c)}return a},iterator:function(){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");return wb.get(this.zpp_inner.vertices,!0)},forwardIterator:function(){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");return wb.get(this.zpp_inner.vertices,!0)},backwardsIterator:function(){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");
return wb.get(this.zpp_inner.vertices,!1)},current:function(){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");if(null==this.zpp_inner.vertices)throw new f("Error: GeomPoly is empty");return this.zpp_inner.vertices.wrapper()},push:function(a){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
if(null==a)throw new f("Error: Cannot push null vertex");var b=y.get(function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this),function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this));null==this.zpp_inner.vertices?this.zpp_inner.vertices=b.prev=b.next=b:(b.prev=this.zpp_inner.vertices,b.next=this.zpp_inner.vertices.next,
this.zpp_inner.vertices.next.prev=b,this.zpp_inner.vertices.next=b);this.zpp_inner.vertices=b;a.zpp_inner.weak?(a.dispose(),!0):!1;return this},pop:function(){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");if(null==this.zpp_inner.vertices)throw new f("Error: Cannot pop from empty polygon");var a=this.zpp_inner.vertices;if(null!=this.zpp_inner.vertices&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices)this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=
null,this.zpp_inner.vertices=null;else{var b=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next;this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null;this.zpp_inner.vertices=null;this.zpp_inner.vertices=b}null!=a.wrap&&(a.wrap.zpp_inner._inuse=!1,a.wrap.dispose(),a.wrap=null);a.prev=a.next=null;a.next=y.zpp_pool;y.zpp_pool=a;return this},unshift:function(a){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
if(null==a)throw new f("Error: Cannot unshift null vertex");var b=y.get(function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this),function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this));null==this.zpp_inner.vertices?this.zpp_inner.vertices=b.prev=b.next=b:(b.next=this.zpp_inner.vertices,b.prev=this.zpp_inner.vertices.prev,
this.zpp_inner.vertices.prev.next=b,this.zpp_inner.vertices.prev=b);this.zpp_inner.vertices=b;a.zpp_inner.weak?(a.dispose(),!0):!1;return this},shift:function(){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");if(null==this.zpp_inner.vertices)throw new f("Error: Cannot shift from empty polygon");var a=this.zpp_inner.vertices;if(null!=this.zpp_inner.vertices&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices)this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=
null,this.zpp_inner.vertices=this.zpp_inner.vertices=null;else{var b=this.zpp_inner.vertices.next;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next;this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null;this.zpp_inner.vertices=null;this.zpp_inner.vertices=b}null!=a.wrap&&(a.wrap.zpp_inner._inuse=!1,a.wrap.dispose(),a.wrap=null);a.prev=a.next=null;a.next=y.zpp_pool;y.zpp_pool=a;return this},skipForward:function(a){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");
if(null!=this.zpp_inner.vertices)if(0<a)for(;0<a--;)this.zpp_inner.vertices=this.zpp_inner.vertices.next;else if(0>a)for(;0>a++;)this.zpp_inner.vertices=this.zpp_inner.vertices.prev;return this},skipBackwards:function(a){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");return this.skipForward(-a)},erase:function(a){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");for(;0!=a&&null!=this.zpp_inner.vertices;){var b=this.zpp_inner.vertices;
if(0<a){if(null!=this.zpp_inner.vertices&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices)this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=this.zpp_inner.vertices=null;else{var c=this.zpp_inner.vertices.next;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next;this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null;this.zpp_inner.vertices=null;this.zpp_inner.vertices=c}a--}else 0>
a&&(null!=this.zpp_inner.vertices&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices?(this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null):(c=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null,this.zpp_inner.vertices=c),a++);null!=b.wrap&&(b.wrap.zpp_inner._inuse=
!1,b.wrap.dispose(),b.wrap=null);b.prev=b.next=null;b.next=y.zpp_pool;y.zpp_pool=b}return this},clear:function(){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");for(;null!=this.zpp_inner.vertices;){var a=this.zpp_inner.vertices;if(null!=this.zpp_inner.vertices&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices)this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=this.zpp_inner.vertices=null;else{var b=this.zpp_inner.vertices.next;
this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next;this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null;this.zpp_inner.vertices=null;this.zpp_inner.vertices=b}null!=a.wrap&&(a.wrap.zpp_inner._inuse=!1,a.wrap.dispose(),a.wrap=null);a.prev=a.next=null;a.next=y.zpp_pool;y.zpp_pool=a}return this},copy:function(){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");var a=Ic.get(),b=this.zpp_inner.vertices,
c=this.zpp_inner.vertices;if(null!=b){do{var d=b,d=y.get(d.x,d.y);null==a.zpp_inner.vertices?a.zpp_inner.vertices=d.prev=d.next=d:(d.prev=a.zpp_inner.vertices,d.next=a.zpp_inner.vertices.next,a.zpp_inner.vertices.next.prev=d,a.zpp_inner.vertices.next=d);a.zpp_inner.vertices=d;b=b.next}while(b!=c)}return a.skipForward(1)},dispose:function(){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");this.clear();this.zpp_pool=null;null!=ga.nextGeomPoly?ga.nextGeomPoly.zpp_pool=
this:ga.poolGeomPoly=this;ga.nextGeomPoly=this;this.zpp_disp=!0},toString:function(){var a="GeomPoly[",b=this.zpp_inner.vertices,c=this.zpp_inner.vertices;if(null!=b){do{var d=b;d!=this.zpp_inner.vertices&&(a+=",");a+="{"+d.x+","+d.y+"}";b=b.next}while(b!=c)}return a+"]"},area:function(){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)return 0;
var a;a=0;var b=this.zpp_inner.vertices,c=this.zpp_inner.vertices;if(null!=b){do{var d=b;a+=d.x*(d.next.y-d.prev.y);b=b.next}while(b!=c)}a*=.5;return 0>a?-a:a},winding:function(){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)return null==g.Winding_UNDEFINED&&(g.internal=!0,g.Winding_UNDEFINED=new gc,g.internal=!1),g.Winding_UNDEFINED;
var a;a=0;var b=this.zpp_inner.vertices,c=this.zpp_inner.vertices;if(null!=b){do{var d=b;a+=d.x*(d.next.y-d.prev.y);b=b.next}while(b!=c)}a*=.5;if(0<a)return null==g.Winding_CLOCKWISE&&(g.internal=!0,g.Winding_CLOCKWISE=new gc,g.internal=!1),g.Winding_CLOCKWISE;if(0==a)return null==g.Winding_UNDEFINED&&(g.internal=!0,g.Winding_UNDEFINED=new gc,g.internal=!1),g.Winding_UNDEFINED;null==g.Winding_ANTICLOCKWISE&&(g.internal=!0,g.Winding_ANTICLOCKWISE=new gc,g.internal=!1);return g.Winding_ANTICLOCKWISE},
contains:function(a){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: GeomPoly::contains point cannot be null");var b;if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();b=a.zpp_inner.x;var c;if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();
c=a.zpp_inner.y;var d=!1,e=this.zpp_inner.vertices,h=this.zpp_inner.vertices;if(null!=e){do{var t=e,q=t.prev;(t.y<c&&q.y>=c||q.y<c&&t.y>=c)&&(t.x<=b||q.x<=b)&&t.x+(c-t.y)/(q.y-t.y)*(q.x-t.x)<b&&(d=!d);e=e.next}while(e!=h)}b=d;a.zpp_inner.weak?(a.dispose(),!0):!1;return b},isClockwise:function(){var a=this.winding();null==g.Winding_CLOCKWISE&&(g.internal=!0,g.Winding_CLOCKWISE=new gc,g.internal=!1);return a==g.Winding_CLOCKWISE},isConvex:function(){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");
if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)return!0;var a=!1,b=!1,c=!0,d=this.zpp_inner.vertices,e=this.zpp_inner.vertices;if(null!=d){do{var h=d,t=h.prev,q=h.next,g=0,l=0,g=q.x-h.x,l=q.y-h.y,n=q=0,q=h.x-t.x,n=h.y-t.y,h=n*g-q*l;0<h?b=!0:0>h&&(a=!0);if(b&&a){c=!1;break}d=d.next}while(d!=e)}return c},isSimple:function(){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");return null==
this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next?!0:A.isSimple(this.zpp_inner.vertices)},isMonotone:function(){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");return null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next?!0:G.isMonotone(this.zpp_inner.vertices)},isDegenerate:function(){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");
return null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next?!0:this.area()<u.epsilon},simplify:function(a){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");if(0>=a)throw new f("Error: Epsilon should be > 0 for simplifying a GeomPoly");if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)return this.copy();a=xb.simplify(this.zpp_inner.vertices,
a);var b=Ic.get();b.zpp_inner.vertices=a;return b},simpleDecomposition:function(a){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)throw new f("Error: Cannot decompose a degenerate polygon");var b=A.decompose(this.zpp_inner.vertices,function(a){null==Y.sharedGVList&&(Y.sharedGVList=new ud);return Y.sharedGVList}(this));for(a=null==a?
new Rc:a;null!=b.head;){var c=b.pop_unsafe(),d=Ic.get();d.zpp_inner.vertices=c;a.zpp_inner.reverse_flag?a.push(d):a.unshift(d)}return a},monotoneDecomposition:function(a){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)throw new f("Error: Cannot decompose a degenerate polygon");var b=G.decompose(this.zpp_inner.vertices,function(a){null==
G.sharedPPoly&&(G.sharedPPoly=new Y);return G.sharedPPoly}(this)).extract(function(a){null==Y.sharedGVList&&(Y.sharedGVList=new ud);return Y.sharedGVList}(this));for(a=null==a?new Rc:a;null!=b.head;){var c=b.pop_unsafe(),d=Ic.get();d.zpp_inner.vertices=c;a.zpp_inner.reverse_flag?a.push(d):a.unshift(d)}return a},convexDecomposition:function(a,b){null==a&&(a=!1);if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||
this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)throw new f("Error: Cannot decompose a degenerate polygon");var c=G.decompose(this.zpp_inner.vertices,function(a){null==G.sharedPPoly&&(G.sharedPPoly=new Y);return G.sharedPPoly}(this)).extract_partitions(function(a){null==Y.sharedPPList&&(Y.sharedPPList=new vd);return Y.sharedPPList}(this)),d;for(d=null==b?new Rc:b;null!=c.head;){var e=c.pop_unsafe();V.triangulate(e);a&&V.optimise(e);Ld.optimise(e);var h=e.extract(function(a){null==Y.sharedGVList&&
(Y.sharedGVList=new ud);return Y.sharedGVList}(this));e.next=Y.zpp_pool;for(Y.zpp_pool=e;null!=h.head;){var e=h.pop_unsafe(),t=Ic.get();t.zpp_inner.vertices=e;d.zpp_inner.reverse_flag?d.push(t):d.unshift(t)}}return d},triangularDecomposition:function(a,b){null==a&&(a=!1);if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)throw new f("Error: Cannot decompose a degenerate polygon");
var c=G.decompose(this.zpp_inner.vertices,function(a){null==G.sharedPPoly&&(G.sharedPPoly=new Y);return G.sharedPPoly}(this)).extract_partitions(function(a){null==Y.sharedPPList&&(Y.sharedPPList=new vd);return Y.sharedPPList}(this)),d;for(d=null==b?new Rc:b;null!=c.head;){var e=c.pop_unsafe();V.triangulate(e);a&&V.optimise(e);var h=e.extract(function(a){null==Y.sharedGVList&&(Y.sharedGVList=new ud);return Y.sharedGVList}(this));e.next=Y.zpp_pool;for(Y.zpp_pool=e;null!=h.head;){var e=h.pop_unsafe(),
t=Ic.get();t.zpp_inner.vertices=e;d.zpp_inner.reverse_flag?d.push(t):d.unshift(t)}}return d},inflate:function(a){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");var b=Ic.get(),c=this.winding();null==g.Winding_CLOCKWISE&&(g.internal=!0,g.Winding_CLOCKWISE=new gc,g.internal=!1);c==g.Winding_CLOCKWISE&&(a=-a);var d=this.zpp_inner.vertices,c=this.zpp_inner.vertices;if(null!=d){do{var e=d,h=e.prev,t=e.next,q=0,k=0,l=0,n=0,q=e.x-h.x,k=e.y-h.y,l=t.x-e.x,n=t.y-e.y,r=
t=h=0,z=0,h=q,t=k,r=1/Math.sqrt(h*h+t*t),h=h*r,t=t*r,r=h,h=-t,t=r,r=a,h=h*r,t=t*r,r=l,z=n,x=1/Math.sqrt(r*r+z*z),r=r*x,z=z*x,x=r,r=-z,z=x,x=a,r=r*x,z=z*x,p=x=0,x=r-h,p=z-t,r=n*x-l*p,r=0==r?0:r/(n*q-l*k),n=l=0,l=e.x+h,n=e.y+t,e=r,l=l+q*e,n=n+k*e;b.push(E.get(l,n,null));d=d.next}while(d!=c)}return b.skipForward(1)},cut:function(a,b,c,d,e){null==d&&(d=!1);null==c&&(c=!1);if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");
if(null!=this.zpp_inner.vertices&&null!=this.zpp_inner.vertices.next&&this.zpp_inner.vertices.prev!=this.zpp_inner.vertices.next&&!A.isSimple(this.zpp_inner.vertices))throw new f("Error: Cut requires a truly simple polygon");if(null==a||null==b)throw new f("Error: Cannot cut with null start/end's");if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null!=b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");c=ab.run(this.zpp_inner.vertices,
a,b,c,d,e);a.zpp_inner.weak?(a.dispose(),!0):!1;b.zpp_inner.weak?(b.dispose(),!0):!1;return c},transform:function(a){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");if(null==a)throw new f("Error: Cannot transform by null matrix");var b=this.zpp_inner.vertices,c=this.zpp_inner.vertices;if(null!=b){do{var d=b,e=a.zpp_inner.a*d.x+a.zpp_inner.b*d.y+a.zpp_inner.tx;d.y=a.zpp_inner.c*d.x+a.zpp_inner.d*d.y+a.zpp_inner.ty;d.x=e;b=b.next}while(b!=c)}return this},bounds:function(){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");
if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");if(null==this.zpp_inner.vertices)throw new f("Error: empty GeomPoly has no defineable bounds");var a=1E100,b=1E100,c=-1E100,d=-1E100,e=this.zpp_inner.vertices,h=this.zpp_inner.vertices;if(null!=e){do{var t=e;t.x<a&&(a=t.x);t.y<b&&(b=t.y);t.x>c&&(c=t.x);t.y>d&&(d=t.y);e=e.next}while(e!=h)}return new Oe(a,b,c-a,d-b)},top:function(){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");
if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");if(null==this.zpp_inner.vertices)throw new f("Error: empty GeomPoly has no defineable topmost vertex");var a=this.zpp_inner.vertices,b=this.zpp_inner.vertices.next,c=this.zpp_inner.vertices;if(null!=b){do{var d=b;d.y<a.y&&(a=d);b=b.next}while(b!=c)}null==a.wrap&&(a.wrap=E.get(a.x,a.y,null),a.wrap.zpp_inner._inuse=!0,a.wrap.zpp_inner._invalidate=w(a,a.modwrap),a.wrap.zpp_inner._validate=w(a,a.getwrap));return a.wrap},
bottom:function(){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");if(null==this.zpp_inner.vertices)throw new f("Error: empty GeomPoly has no defineable bottommost vertex");var a=this.zpp_inner.vertices,b=this.zpp_inner.vertices.next,c=this.zpp_inner.vertices;if(null!=b){do{var d=b;d.y>a.y&&(a=d);b=b.next}while(b!=c)}null==a.wrap&&(a.wrap=E.get(a.x,a.y,null),a.wrap.zpp_inner._inuse=
!0,a.wrap.zpp_inner._invalidate=w(a,a.modwrap),a.wrap.zpp_inner._validate=w(a,a.getwrap));return a.wrap},left:function(){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");if(null==this.zpp_inner.vertices)throw new f("Error: empty GeomPoly has no defineable leftmost vertex");var a=this.zpp_inner.vertices,b=this.zpp_inner.vertices.next,c=this.zpp_inner.vertices;if(null!=b){do{var d=
b;d.x<a.x&&(a=d);b=b.next}while(b!=c)}null==a.wrap&&(a.wrap=E.get(a.x,a.y,null),a.wrap.zpp_inner._inuse=!0,a.wrap.zpp_inner._invalidate=w(a,a.modwrap),a.wrap.zpp_inner._validate=w(a,a.getwrap));return a.wrap},right:function(){if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");if(this.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");if(null==this.zpp_inner.vertices)throw new f("Error: empty GeomPoly has no defineable rightmmost vertex");
var a=this.zpp_inner.vertices,b=this.zpp_inner.vertices.next,c=this.zpp_inner.vertices;if(null!=b){do{var d=b;d.x>a.x&&(a=d);b=b.next}while(b!=c)}null==a.wrap&&(a.wrap=E.get(a.x,a.y,null),a.wrap.zpp_inner._inuse=!0,a.wrap.zpp_inner._invalidate=w(a,a.modwrap),a.wrap.zpp_inner._validate=w(a,a.getwrap));return a.wrap},__class__:Ic};var Rb=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null;if(!$c.internal)throw new f("Error: Cannot instantiate GeomPolyIterator derp!");
};Rb.__name__=!0;Rb.get=function(a){var b;null==Rb.zpp_pool?($c.internal=!0,b=new Rb,$c.internal=!1):(b=Rb.zpp_pool,Rb.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};Rb.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=Rb.zpp_pool;Rb.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:Rb};
var Rc=function(){this.zpp_inner=null;this.zpp_inner=new $c;this.zpp_inner.outer=this};Rc.__name__=!0;Rc.fromArray=function(a){if(null==a)throw new f("Error: Cannot convert null Array to Nape list");for(var b=new Rc,c=0;c<a.length;){var d=a[c];++c;b.push(d)}return b};Rc.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},has:function(a){this.zpp_inner.valmod();
return this.zpp_inner.inner.has(a.zpp_inner)},at:function(a){this.zpp_inner.valmod();if(0>a||a>=this.get_length())throw new f("Error: Index out of bounds");this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},
push:function(a){if(this.zpp_inner.immutable)throw new f("Error: GeomPolyList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,
a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},unshift:function(a){if(this.zpp_inner.immutable)throw new f("Error: GeomPolyList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-
1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)):this.zpp_inner.inner.add(a.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},pop:function(){if(this.zpp_inner.immutable)throw new f("Error: GeomPolyList is immutable");this.zpp_inner.modify_test();if(null==this.zpp_inner.inner.head)throw new f("Error: Cannot remove from empty list");this.zpp_inner.valmod();var a=null;if(this.zpp_inner.reverse_flag){var a=
this.zpp_inner.inner.head.elt,b=a.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(b);this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),a=null==b?this.zpp_inner.inner.head.elt:b.next.elt,c=a.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(c);this.zpp_inner.dontremove||this.zpp_inner.inner.erase(b)}this.zpp_inner.invalidate();
return a.outer},shift:function(){if(this.zpp_inner.immutable)throw new f("Error: GeomPolyList is immutable");this.zpp_inner.modify_test();if(null==this.zpp_inner.inner.head)throw new f("Error: Cannot remove from empty list");this.zpp_inner.valmod();var a=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b;b=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2);var a=null==b?this.zpp_inner.inner.head.elt:
b.next.elt,c=a.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(c);this.zpp_inner.dontremove||this.zpp_inner.inner.erase(b)}else a=this.zpp_inner.inner.head.elt,b=a.outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(b),this.zpp_inner.dontremove||this.zpp_inner.inner.pop();this.zpp_inner.invalidate();return a.outer},add:function(a){return this.zpp_inner.reverse_flag?this.push(a):this.unshift(a)},remove:function(a){if(this.zpp_inner.immutable)throw new f("Error: GeomPolyList is immutable");
this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),this.zpp_inner.invalidate());return b},clear:function(){if(this.zpp_inner.immutable)throw new f("Error: GeomPolyList is immutable");if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=
this.zpp_inner.inner.head;)this.shift()},empty:function(){return null==this.zpp_inner.inner.head},iterator:function(){this.zpp_inner.valmod();return Rb.get(this)},copy:function(a){null==a&&(a=!1);var b=new Rc,c;this.zpp_inner.valmod();for(c=Rb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b.push(a?function(a){throw new f("Error: GeomPoly is not a copyable type");}(this):d)}return b},merge:function(a){if(null==a)throw new f("Error: Cannot merge with null list");a.zpp_inner.valmod();
for(a=Rb.get(a);a.hasNext();){var b;a.zpp_critical=!1;b=a.zpp_inner.at(a.zpp_i++);this.has(b)||(this.zpp_inner.reverse_flag?this.push(b):this.unshift(b))}},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=Rb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},foreach:function(a){if(null==a)throw new f("Error: Cannot execute null on list elements");var b;this.zpp_inner.valmod();for(b=Rb.get(this);b.hasNext();)try{var c=
void 0;b.zpp_critical=!1;c=b.zpp_inner.at(b.zpp_i++);a(c)}catch(d){d instanceof f&&(d=d.val);b.zpp_next=Rb.zpp_pool;Rb.zpp_pool=b;b.zpp_inner=null;break}return this},filter:function(a){if(null==a)throw new f("Error: Cannot select elements of list with null");for(var b=0;b<this.get_length();){var c=this.at(b);try{a(c)?b++:this.remove(c)}catch(d){d instanceof f&&(d=d.val);break}}return this},__class__:Rc};var lf=function(){if(!wb.internal)throw new f("Error: Cannot instantiate GeomVertexIterator");
};lf.__name__=!0;lf.prototype={hasNext:function(){if(null==this.zpp_inner)throw new f("Error: Iterator has been disposed");var a=this.zpp_inner.ptr!=this.zpp_inner.start||this.zpp_inner.first;this.zpp_inner.first=!1;if(!a){var b=this.zpp_inner;b.outer.zpp_inner=null;b.ptr=b.start=null;b.next=wb.zpp_pool;wb.zpp_pool=b}return a},next:function(){if(null==this.zpp_inner)throw new f("Error: Iterator has been disposed");var a=this.zpp_inner.ptr.wrapper();this.zpp_inner.ptr=this.zpp_inner.forward?this.zpp_inner.ptr.next:
this.zpp_inner.ptr.prev;return a},__class__:lf};var bb=function(a,b,c,d,e,h){null==h&&(h=0);null==e&&(e=0);null==d&&(d=1);null==c&&(c=0);null==b&&(b=0);null==a&&(a=1);this.zpp_inner=null;this.zpp_inner=ad.get();this.zpp_inner.outer=this;if(a!=a)throw new f("Error: Mat23::a cannot be NaN");this.zpp_inner.a=a;this.zpp_inner.invalidate();this.zpp_inner.a;if(b!=b)throw new f("Error: Mat23::b cannot be NaN");this.zpp_inner.b=b;this.zpp_inner.invalidate();this.zpp_inner.b;if(e!=e)throw new f("Error: Mat23::tx cannot be NaN");
this.zpp_inner.tx=e;this.zpp_inner.invalidate();this.zpp_inner.tx;if(c!=c)throw new f("Error: Mat23::c cannot be NaN");this.zpp_inner.c=c;this.zpp_inner.invalidate();this.zpp_inner.c;if(d!=d)throw new f("Error: Mat23::d cannot be NaN");this.zpp_inner.d=d;this.zpp_inner.invalidate();this.zpp_inner.d;if(h!=h)throw new f("Error: Mat23::ty cannot be NaN");this.zpp_inner.ty=h;this.zpp_inner.invalidate();this.zpp_inner.ty};bb.__name__=!0;bb.rotation=function(a){if(a!=a)throw new f("Error: Cannot create rotation matrix with NaN angle");
var b=Math.cos(a);a=Math.sin(a);return new bb(b,-a,a,b,0,0)};bb.translation=function(a,b){return new bb(1,0,0,1,a,b)};bb.scale=function(a,b){return new bb(a,0,0,b,0,0)};bb.prototype={get_a:function(){return this.zpp_inner.a},set_a:function(a){if(a!=a)throw new f("Error: Mat23::a cannot be NaN");this.zpp_inner.a=a;this.zpp_inner.invalidate();return this.zpp_inner.a},get_b:function(){return this.zpp_inner.b},set_b:function(a){if(a!=a)throw new f("Error: Mat23::b cannot be NaN");this.zpp_inner.b=a;this.zpp_inner.invalidate();
return this.zpp_inner.b},get_c:function(){return this.zpp_inner.c},set_c:function(a){if(a!=a)throw new f("Error: Mat23::c cannot be NaN");this.zpp_inner.c=a;this.zpp_inner.invalidate();return this.zpp_inner.c},get_d:function(){return this.zpp_inner.d},set_d:function(a){if(a!=a)throw new f("Error: Mat23::d cannot be NaN");this.zpp_inner.d=a;this.zpp_inner.invalidate();return this.zpp_inner.d},get_tx:function(){return this.zpp_inner.tx},set_tx:function(a){if(a!=a)throw new f("Error: Mat23::tx cannot be NaN");
this.zpp_inner.tx=a;this.zpp_inner.invalidate();return this.zpp_inner.tx},get_ty:function(){return this.zpp_inner.ty},set_ty:function(a){if(a!=a)throw new f("Error: Mat23::ty cannot be NaN");this.zpp_inner.ty=a;this.zpp_inner.invalidate();return this.zpp_inner.ty},copy:function(){return new bb(this.zpp_inner.a,this.zpp_inner.b,this.zpp_inner.c,this.zpp_inner.d,this.zpp_inner.tx,this.zpp_inner.ty)},set:function(a){if(null==a)throw new f("Error: Cannot set form null matrix");this.zpp_inner.set(a.zpp_inner);
this.zpp_inner.invalidate();return this},setAs:function(a,b,c,d,e,h){null==h&&(h=0);null==e&&(e=0);null==d&&(d=1);null==c&&(c=0);null==b&&(b=0);null==a&&(a=1);this.zpp_inner.setas(a,b,c,d,e,h);this.zpp_inner.invalidate();return this},reset:function(){return this.setAs()},get_determinant:function(){return this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c},singular:function(){var a=this.zpp_inner.a*this.zpp_inner.a+this.zpp_inner.b*this.zpp_inner.b+this.zpp_inner.c*this.zpp_inner.c+
this.zpp_inner.d*this.zpp_inner.d,b=this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c;0>b&&(b=-b);return a>u.illConditionedThreshold*b},inverse:function(){if(this.singular())throw new f("Error: Matrix is singular and cannot be inverted");var a=1/(this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c);return new bb(this.zpp_inner.d*a,-this.zpp_inner.b*a,-this.zpp_inner.c*a,this.zpp_inner.a*a,(this.zpp_inner.b*this.zpp_inner.ty-this.zpp_inner.d*this.zpp_inner.tx)*a,(this.zpp_inner.c*
this.zpp_inner.tx-this.zpp_inner.a*this.zpp_inner.ty)*a)},transpose:function(){return new bb(this.zpp_inner.a,this.zpp_inner.c,this.zpp_inner.b,this.zpp_inner.d,-this.zpp_inner.a*this.zpp_inner.tx-this.zpp_inner.c*this.zpp_inner.ty,-this.zpp_inner.b*this.zpp_inner.tx-this.zpp_inner.d*this.zpp_inner.ty)},concat:function(a){if(null==a)throw new f("Error: Cannot concatenate with null Mat23");return new bb(a.zpp_inner.a*this.zpp_inner.a+a.zpp_inner.b*this.zpp_inner.c,a.zpp_inner.a*this.zpp_inner.b+a.zpp_inner.b*
this.zpp_inner.d,a.zpp_inner.c*this.zpp_inner.a+a.zpp_inner.d*this.zpp_inner.c,a.zpp_inner.c*this.zpp_inner.b+a.zpp_inner.d*this.zpp_inner.d,a.zpp_inner.a*this.zpp_inner.tx+a.zpp_inner.b*this.zpp_inner.ty+a.zpp_inner.tx,a.zpp_inner.c*this.zpp_inner.tx+a.zpp_inner.d*this.zpp_inner.ty+a.zpp_inner.ty)},transform:function(a,b,c){null==c&&(c=!1);null==b&&(b=!1);if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Cannot transform null Vec2");
b=b?E.get(function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this)*this.zpp_inner.a+function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this)*this.zpp_inner.b,function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this)*this.zpp_inner.c+
function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this)*this.zpp_inner.d,c):E.get(function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this)*this.zpp_inner.a+function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this)*this.zpp_inner.b+
this.zpp_inner.tx,function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this)*this.zpp_inner.c+function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this)*this.zpp_inner.d+this.zpp_inner.ty,c);a.zpp_inner.weak?(a.dispose(),!0):!1;return b},inverseTransform:function(a,b,c){null==c&&(c=!1);null==b&&(b=!1);if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
if(null==a)throw new f("Error: Cannot transform null Vec2");if(this.singular())throw new f("Error: Matrix is singular and inverse transformation cannot be performed");var d=1/(this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c);if(b)c=E.get((function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this)*this.zpp_inner.d-function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.y}(this)*this.zpp_inner.b)*d,(function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this)*this.zpp_inner.a-function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this)*this.zpp_inner.c)*d,c);else{if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();b=a.zpp_inner.x-this.zpp_inner.tx;var e;if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();e=a.zpp_inner.y-this.zpp_inner.ty;c=E.get((b*this.zpp_inner.d-e*this.zpp_inner.b)*d,(e*this.zpp_inner.a-b*this.zpp_inner.c)*d,c)}a.zpp_inner.weak?(a.dispose(),!0):!1;return c},toString:function(){return"{ a: "+this.zpp_inner.a+" b: "+this.zpp_inner.b+" c: "+this.zpp_inner.c+" d: "+this.zpp_inner.d+" tx: "+this.zpp_inner.tx+" ty: "+
this.zpp_inner.ty+" }"},equiorthogonal:function(){if(this.singular())return!1;var a=this.zpp_inner.a*this.zpp_inner.b+this.zpp_inner.c*this.zpp_inner.d;return a*a<u.epsilon?(a=this.zpp_inner.a*this.zpp_inner.a+this.zpp_inner.b*this.zpp_inner.b-this.zpp_inner.c*this.zpp_inner.c-this.zpp_inner.d*this.zpp_inner.d,a*a<u.epsilon):!1},orthogonal:function(){var a=this.zpp_inner.a*this.zpp_inner.b+this.zpp_inner.c*this.zpp_inner.d;if(a*a<u.epsilon){var a=this.zpp_inner.a*this.zpp_inner.a+this.zpp_inner.b*
this.zpp_inner.b-1,b=this.zpp_inner.c*this.zpp_inner.c+this.zpp_inner.d*this.zpp_inner.d-1;return a*a<u.epsilon&&b*b<u.epsilon}return!1},equiorthogonalise:function(){if(!this.equiorthogonal()){var a=Math.sqrt(this.zpp_inner.a*this.zpp_inner.a+this.zpp_inner.c*this.zpp_inner.c),b=Math.sqrt(this.zpp_inner.b*this.zpp_inner.b+this.zpp_inner.d*this.zpp_inner.d);if(a*a<u.epsilon||b*b<u.epsilon)throw new f("Error: Matrix is singular and cannot be equiorthogonalised");var c=(a+b)/2,a=c/a,b=c/b;this.set_a(this.zpp_inner.a*
a);this.set_c(this.zpp_inner.c*a);this.set_b(this.zpp_inner.b*b);this.set_d(this.zpp_inner.d*b);b=.25*Math.PI-.5*Math.acos((this.zpp_inner.a*this.zpp_inner.b+this.zpp_inner.c*this.zpp_inner.d)/(c*c));0<this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c&&(b=-b);var a=Math.sin(b),b=Math.cos(b),c=this.zpp_inner.a*b-this.zpp_inner.c*a,d=this.zpp_inner.b*b+this.zpp_inner.d*a;this.set_c(this.zpp_inner.c*b+this.zpp_inner.a*a);if(c!=c)throw new f("Error: Mat23::a cannot be NaN");this.zpp_inner.a=
c;this.zpp_inner.invalidate();this.zpp_inner.a;this.set_d(this.zpp_inner.d*b-this.zpp_inner.b*a);if(d!=d)throw new f("Error: Mat23::b cannot be NaN");this.zpp_inner.b=d;this.zpp_inner.invalidate();this.zpp_inner.b;this.zpp_inner.invalidate()}return this},orthogonalise:function(){if(!this.orthogonal()){var a=Math.sqrt(this.zpp_inner.a*this.zpp_inner.a+this.zpp_inner.c*this.zpp_inner.c),b=Math.sqrt(this.zpp_inner.b*this.zpp_inner.b+this.zpp_inner.d*this.zpp_inner.d);if(a*a<u.epsilon||b*b<u.epsilon)throw new f("Error: Matrix is singular and cannot be orthogonalised");
a=1/a;b=1/b;this.set_a(this.zpp_inner.a*a);this.set_c(this.zpp_inner.c*a);this.set_b(this.zpp_inner.b*b);this.set_d(this.zpp_inner.d*b);b=.25*Math.PI-.5*Math.acos((this.zpp_inner.a*this.zpp_inner.b+this.zpp_inner.c*this.zpp_inner.d)/1);0<this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c&&(b=-b);var a=Math.sin(b),b=Math.cos(b),c=this.zpp_inner.a*b-this.zpp_inner.c*a,d=this.zpp_inner.b*b+this.zpp_inner.d*a;this.set_c(this.zpp_inner.c*b+this.zpp_inner.a*a);if(c!=c)throw new f("Error: Mat23::a cannot be NaN");
this.zpp_inner.a=c;this.zpp_inner.invalidate();this.zpp_inner.a;this.set_d(this.zpp_inner.d*b-this.zpp_inner.b*a);if(d!=d)throw new f("Error: Mat23::b cannot be NaN");this.zpp_inner.b=d;this.zpp_inner.invalidate();this.zpp_inner.b;this.zpp_inner.invalidate()}return this},__class__:bb};var Qb=function(a,b){this.zpp_inner=null;if(0>=a||0>=b)throw new f("Error: MatMN::dimensions cannot be < 1");this.zpp_inner=new mf(a,b);this.zpp_inner.outer=this};Qb.__name__=!0;Qb.prototype={get_rows:function(){return this.zpp_inner.m},
get_cols:function(){return this.zpp_inner.n},x:function(a,b){if(0>a||0>b||a>=this.zpp_inner.m||b>=this.zpp_inner.n)throw new f("Error: MatMN indices out of range");return this.zpp_inner.x[a*this.zpp_inner.n+b]},setx:function(a,b,c){if(0>a||0>b||a>=this.zpp_inner.m||b>=this.zpp_inner.n)throw new f("Error: MatMN indices out of range");return this.zpp_inner.x[a*this.zpp_inner.n+b]=c},toString:function(){for(var a="{ ",b=!0,c=0,d=this.zpp_inner.m;c<d;){var e=c++;b||(a+="; ");for(var b=!1,h=0,t=this.zpp_inner.n;h<
t;){var q=h++,g=void 0;if(0>e||0>q||e>=this.zpp_inner.m||q>=this.zpp_inner.n)throw new f("Error: MatMN indices out of range");g=this.zpp_inner.x[e*this.zpp_inner.n+q];a+=g+" "}}return a+"}"},transpose:function(){for(var a=new Qb(this.zpp_inner.n,this.zpp_inner.m),b=0,c=this.zpp_inner.m;b<c;)for(var d=b++,e=0,h=this.zpp_inner.n;e<h;){var t=e++;a.setx(t,d,function(a){if(0>d||0>t||d>=a.zpp_inner.m||t>=a.zpp_inner.n)throw new f("Error: MatMN indices out of range");return a.zpp_inner.x[d*a.zpp_inner.n+
t]}(this))}return a},mul:function(a){if(this.zpp_inner.n!=a.zpp_inner.m)throw new f("Error: Matrix dimensions aren't compatible");for(var b=new Qb(this.zpp_inner.m,a.zpp_inner.n),c=0,d=this.zpp_inner.m;c<d;)for(var e=c++,h=0,t=a.zpp_inner.n;h<t;){for(var q=h++,g=0,l=0,n=this.zpp_inner.n;l<n;){var r=l++;if(0>e||0>r||e>=this.zpp_inner.m||r>=this.zpp_inner.n)throw new f("Error: MatMN indices out of range");var z=this.zpp_inner.x[e*this.zpp_inner.n+r];if(0>r||0>q||r>=a.zpp_inner.m||q>=a.zpp_inner.n)throw new f("Error: MatMN indices out of range");
g+=z*a.zpp_inner.x[r*a.zpp_inner.n+q]}if(0>e||0>q||e>=b.zpp_inner.m||q>=b.zpp_inner.n)throw new f("Error: MatMN indices out of range");b.zpp_inner.x[e*b.zpp_inner.n+q]=g}return b},__class__:Qb};var nf=function(){this.zpp_inner=null;if(!Ba.internal)throw new f("Error: RayResult cannot be instantiated derp!");};nf.__name__=!0;nf.prototype={get_normal:function(){if(null!=this.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");return this.zpp_inner.normal},get_distance:function(){if(null!=
this.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");return this.zpp_inner.toiDistance},get_inner:function(){if(null!=this.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");return this.zpp_inner.inner},get_shape:function(){if(null!=this.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");return this.zpp_inner.shape},dispose:function(){if(null!=this.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");
this.zpp_inner.free()},toString:function(){if(null!=this.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");var a="{ shape: "+Za.string(function(a){if(null!=a.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");return a.zpp_inner.shape}(this))+" distance: ";if(null!=this.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");return a+this.zpp_inner.toiDistance+" ?inner: "+Za.string(function(a){if(null!=
a.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");return a.zpp_inner.inner}(this))+" }"},__class__:nf};var Sb=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null;if(!gd.internal)throw new f("Error: Cannot instantiate RayResultIterator derp!");};Sb.__name__=!0;Sb.get=function(a){var b;null==Sb.zpp_pool?(gd.internal=!0,b=new Sb,gd.internal=!1):(b=Sb.zpp_pool,Sb.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};
Sb.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=Sb.zpp_pool;Sb.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:Sb};var bd=function(){this.zpp_inner=null;this.zpp_inner=new gd;this.zpp_inner.outer=this};bd.__name__=!0;bd.fromArray=function(a){if(null==a)throw new f("Error: Cannot convert null Array to Nape list");
for(var b=new bd,c=0;c<a.length;){var d=a[c];++c;b.push(d)}return b};bd.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},has:function(a){this.zpp_inner.valmod();return this.zpp_inner.inner.has(a)},at:function(a){this.zpp_inner.valmod();if(0>a||a>=this.get_length())throw new f("Error: Index out of bounds");this.zpp_inner.reverse_flag&&(a=this.get_length()-
1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt},push:function(a){if(this.zpp_inner.immutable)throw new f("Error: RayResultList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):
!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},unshift:function(a){if(this.zpp_inner.immutable)throw new f("Error: RayResultList is immutable");this.zpp_inner.modify_test();
this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a)):this.zpp_inner.inner.add(a),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},pop:function(){if(this.zpp_inner.immutable)throw new f("Error: RayResultList is immutable");
this.zpp_inner.modify_test();if(null==this.zpp_inner.inner.head)throw new f("Error: Cannot remove from empty list");this.zpp_inner.valmod();var a=null;if(this.zpp_inner.reverse_flag)a=this.zpp_inner.inner.head.elt,null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.pop();else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b;b=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-
2);a=null==b?this.zpp_inner.inner.head.elt:b.next.elt;null!=this.zpp_inner.subber&&this.zpp_inner.subber(a);this.zpp_inner.dontremove||this.zpp_inner.inner.erase(b)}this.zpp_inner.invalidate();return a},shift:function(){if(this.zpp_inner.immutable)throw new f("Error: RayResultList is immutable");this.zpp_inner.modify_test();if(null==this.zpp_inner.inner.head)throw new f("Error: Cannot remove from empty list");this.zpp_inner.valmod();var a=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&
null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b;b=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2);a=null==b?this.zpp_inner.inner.head.elt:b.next.elt;null!=this.zpp_inner.subber&&this.zpp_inner.subber(a);this.zpp_inner.dontremove||this.zpp_inner.inner.erase(b)}else a=this.zpp_inner.inner.head.elt,null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.pop();this.zpp_inner.invalidate();return a},add:function(a){return this.zpp_inner.reverse_flag?
this.push(a):this.unshift(a)},remove:function(a){if(this.zpp_inner.immutable)throw new f("Error: RayResultList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a),this.zpp_inner.invalidate());return b},clear:function(){if(this.zpp_inner.immutable)throw new f("Error: RayResultList is immutable");
if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},empty:function(){return null==this.zpp_inner.inner.head},iterator:function(){this.zpp_inner.valmod();return Sb.get(this)},copy:function(a){null==a&&(a=!1);var b=new bd,c;this.zpp_inner.valmod();for(c=Sb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b.push(a?function(a){throw new f("Error: RayResult is not a copyable type");}(this):d)}return b},
merge:function(a){if(null==a)throw new f("Error: Cannot merge with null list");a.zpp_inner.valmod();for(a=Sb.get(a);a.hasNext();){var b;a.zpp_critical=!1;b=a.zpp_inner.at(a.zpp_i++);this.has(b)||(this.zpp_inner.reverse_flag?this.push(b):this.unshift(b))}},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=Sb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},foreach:function(a){if(null==a)throw new f("Error: Cannot execute null on list elements");
var b;this.zpp_inner.valmod();for(b=Sb.get(this);b.hasNext();)try{var c=void 0;b.zpp_critical=!1;c=b.zpp_inner.at(b.zpp_i++);a(c)}catch(d){d instanceof f&&(d=d.val);b.zpp_next=Sb.zpp_pool;Sb.zpp_pool=b;b.zpp_inner=null;break}return this},filter:function(a){if(null==a)throw new f("Error: Cannot select elements of list with null");for(var b=0;b<this.get_length();){var c=this.at(b);try{a(c)?b++:this.remove(c)}catch(d){d instanceof f&&(d=d.val);break}}return this},__class__:bd};var E=function(a,b){null==
b&&(b=0);null==a&&(a=0);this.zpp_inner=this.zpp_pool=null;if(a!=a||b!=b)throw new f("Error: Vec2 components cannot be NaN");this.zpp_inner=P.get(a,b,null);this.zpp_inner.outer=this};E.__name__=!0;E.weak=function(a,b){null==b&&(b=0);null==a&&(a=0);return E.get(a,b,!0)};E.get=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);null==a&&(a=0);if(a!=a||b!=b)throw new f("Error: Vec2 components cannot be NaN");var d;null==ga.poolVec2?d=new E:(d=ga.poolVec2,ga.poolVec2=d.zpp_pool,d.zpp_pool=null,d.zpp_disp=!1,
d==ga.nextVec2&&(ga.nextVec2=null));if(null==d.zpp_inner)d.zpp_inner=P.get(a,b,null),d.zpp_inner.outer=d;else{if(null!=d&&d.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");d.zpp_inner.immutable();if(a!=a||b!=b)throw new f("Error: Vec2 components cannot be NaN");if(null!=d&&d.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");d.zpp_inner.validate();var e;if(!(e=d.zpp_inner.x!=a)){if(null!=d&&d.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
d.zpp_inner.validate();e=d.zpp_inner.y!=b}e&&(d.zpp_inner.x=a,d.zpp_inner.y=b,d.zpp_inner.invalidate());d}d.zpp_inner.weak=c;return d};E.fromPolar=function(a,b,c){null==c&&(c=!1);if(a!=a)throw new f("Error: Vec2::length cannot be NaN");if(b!=b)throw new f("Error: Vec2::angle cannot be NaN");return E.get(a*Math.cos(b),a*Math.sin(b),c)};E.dsq=function(a,b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null!=b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
if(null==a||null==b)throw new f("Error: Cannot compute squared distance between null Vec2");var c=eb.vec_dsq(function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this),function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this),function(a){if(null!=b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
b.zpp_inner.validate();return b.zpp_inner.x}(this),function(a){if(null!=b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");b.zpp_inner.validate();return b.zpp_inner.y}(this));a.zpp_inner.weak?(a.dispose(),!0):!1;b.zpp_inner.weak?(b.dispose(),!0):!1;return c};E.distance=function(a,b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null!=b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a||null==
b)throw new f("Error: Cannot compute squared distance between null Vec2");var c=Math.sqrt(eb.vec_dsq(function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this),function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this),function(a){if(null!=b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
b.zpp_inner.validate();return b.zpp_inner.x}(this),function(a){if(null!=b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");b.zpp_inner.validate();return b.zpp_inner.y}(this)));a.zpp_inner.weak?(a.dispose(),!0):!1;b.zpp_inner.weak?(b.dispose(),!0):!1;return c};E.prototype={dispose:function(){if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.immutable();if(this.zpp_inner._inuse)throw new f("Error: This Vec2 is not disposable");
var a=this.zpp_inner;this.zpp_pool=this.zpp_inner=this.zpp_inner.outer=null;null!=ga.nextVec2?ga.nextVec2.zpp_pool=this:ga.poolVec2=this;ga.nextVec2=this;this.zpp_disp=!0;null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null);a._isimmutable=null;a._validate=null;a._invalidate=null;a.next=P.zpp_pool;P.zpp_pool=a},copy:function(a){null==a&&(a=!1);if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");return E.get(function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.x}(this),function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this),a)},get_x:function(){if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();return this.zpp_inner.x},set_x:function(a){if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.immutable();if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
this.zpp_inner.validate();if(this.zpp_inner.x!=a){if(a!=a)throw new f("Error: Vec2::x cannot be NaN");this.zpp_inner.x=a;this.zpp_inner.invalidate()}if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();return this.zpp_inner.x},get_y:function(){if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();return this.zpp_inner.y},set_y:function(a){if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
this.zpp_inner.immutable();if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();if(this.zpp_inner.y!=a){if(a!=a)throw new f("Error: Vec2::y cannot be NaN");this.zpp_inner.y=a;this.zpp_inner.invalidate()}if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();return this.zpp_inner.y},get_length:function(){if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");return Math.sqrt(function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.x}(this)*function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this)+function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this)*function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this))},set_length:function(a){if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
this.zpp_inner.immutable();if(a!=a)throw new f("Error: Vec2::length cannot be NaN");if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();var b=this.zpp_inner.x;if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();b*=this.zpp_inner.x;if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();var c=this.zpp_inner.y;if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
this.zpp_inner.validate();if(0==b+c*this.zpp_inner.y)throw new f("Error: Cannot set length of a zero vector");a/=Math.sqrt(function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this)*function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this)+function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();
return a.zpp_inner.y}(this)*function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this));var d=this;d.set_x(function(a){if(null!=d&&d.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");d.zpp_inner.validate();return d.zpp_inner.x}(this)*a);var e=this;e.set_y(function(a){if(null!=e&&e.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");e.zpp_inner.validate();return e.zpp_inner.y}(this)*
a);this.zpp_inner.invalidate();if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");return Math.sqrt(function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this)*function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this)+function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.y}(this)*function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this))},lsq:function(){if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();var a=this.zpp_inner.x;if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
this.zpp_inner.validate();a*=this.zpp_inner.x;if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();var b=this.zpp_inner.y;if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();return a+b*this.zpp_inner.y},set:function(a){if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.immutable();
if(null==a)throw new f("Error: Cannot assign null Vec2");var b=this.setxy(function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this),function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this));a.zpp_inner.weak?(a.dispose(),!0):!1;return b},setxy:function(a,b){if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
this.zpp_inner.immutable();if(a!=a||b!=b)throw new f("Error: Vec2 components cannot be NaN");if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();var c;if(!(c=this.zpp_inner.x!=a)){if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();c=this.zpp_inner.y!=b}c&&(this.zpp_inner.x=a,this.zpp_inner.y=b,this.zpp_inner.invalidate());return this},get_angle:function(){if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();var a=this.zpp_inner.x;if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();if(a=a==this.zpp_inner.y){if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();a=0==this.zpp_inner.x}return a?0:Math.atan2(function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.y}(this),function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this))},set_angle:function(a){if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.immutable();if(a!=a)throw new f("Error: Vec2::angle cannot be NaN");var b;if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");b=Math.sqrt(function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.x}(this)*function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this)+function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this)*function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this));this.setxy(b*Math.cos(a),
b*Math.sin(a));if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();a=this.zpp_inner.x;if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();if(a=a==this.zpp_inner.y){if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();a=0==this.zpp_inner.x}return a?0:Math.atan2(function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.y}(this),function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this))},rotate:function(a){if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.immutable();if(a!=a)throw new f("Error: Cannot rotate Vec2 by NaN");if(0!=a%(2*Math.PI)){var b=Math.sin(a);a=Math.cos(a);var c=a*this.zpp_inner.x-b*this.zpp_inner.y;this.zpp_inner.y=this.zpp_inner.x*
b+this.zpp_inner.y*a;this.zpp_inner.x=c;this.zpp_inner.invalidate()}return this},reflect:function(a,b){null==b&&(b=!1);if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(0==function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");return Math.sqrt(function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();
return a.zpp_inner.x}(a)*function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(a)+function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(a)*function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(a))}(this))throw new f("Error: Cannot reflect in zero vector");
var c=function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");return E.get(function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(a),function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(a),!0)}(this).normalise(),c=a.sub(c.muleq(2*c.dot(a)),b);a.zpp_inner.weak?(a.dispose(),!0):!1;return c},normalise:function(){if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
this.zpp_inner.immutable();if(0==function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");return Math.sqrt(function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(a)*function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(a)+function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.y}(a)*function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(a))}(this))throw new f("Error: Cannot normalise vector of length 0");if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();var a=this.zpp_inner.x;if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();a*=this.zpp_inner.x;
if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();var b=this.zpp_inner.y;if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();var a=1/Math.sqrt(a+b*this.zpp_inner.y),c=this;c.set_x(function(a){if(null!=c&&c.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");c.zpp_inner.validate();return c.zpp_inner.x}(this)*a);var d=this;d.set_y(function(a){if(null!=d&&d.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
d.zpp_inner.validate();return d.zpp_inner.y}(this)*a);this.zpp_inner.invalidate();return this},unit:function(a){null==a&&(a=!1);if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(0==function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");return Math.sqrt(function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(a)*function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.x}(a)+function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(a)*function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(a))}(this))throw new f("Error: Cannot normalise vector of length 0");var b=1/Bc.sqrt(function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();
return a.zpp_inner.x}(this)*function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this)+function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this)*function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this));return E.get(function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.x}(this)*b,function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this)*b,a)},add:function(a,b){null==b&&(b=!1);if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Cannot add null vectors");var c=E.get(function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.x}(this)+function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this),function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this)+function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this),b);a.zpp_inner.weak?
(a.dispose(),!0):!1;return c},addMul:function(a,b,c){null==c&&(c=!1);if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Cannot add null vectors");b=E.get(function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this)+function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.x}(this)*b,function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this)+function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this)*b,c);a.zpp_inner.weak?(a.dispose(),!0):!1;return b},sub:function(a,b){null==b&&(b=!1);if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Cannot subtract null vectors");var c=E.get(function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this)-function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this),function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.y}(this)-function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this),b);a.zpp_inner.weak?(a.dispose(),!0):!1;return c},mul:function(a,b){null==b&&(b=!1);if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(a!=a)throw new f("Error: Cannot multiply with NaN");return E.get(function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.x}(this)*a,function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this)*a,b)},addeq:function(a){if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.immutable();if(null==a)throw new f("Error: Cannot add null vectors");this.setxy(function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.x}(this)+function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this),function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this)+function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this));a.zpp_inner.weak?
(a.dispose(),!0):!1;return this},subeq:function(a){if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.immutable();if(null==a)throw new f("Error: Cannot subtract null vectors");this.setxy(function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this)-function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.x}(this),function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this)-function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this));a.zpp_inner.weak?(a.dispose(),!0):!1;return this},muleq:function(a){if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.immutable();
if(a!=a)throw new f("Error: Cannot multiply with NaN");return this.setxy(function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this)*a,function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this)*a)},dot:function(a){if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
if(null==a)throw new f("Error: Cannot take dot product with null vector");var b;if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();b=this.zpp_inner.x;if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();b*=a.zpp_inner.x;if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();var c=this.zpp_inner.y;if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();b+=c*a.zpp_inner.y;a.zpp_inner.weak?(a.dispose(),!0):!1;return b},cross:function(a){if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Cannot take cross product with null vector");var b;if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();b=a.zpp_inner.y;if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
this.zpp_inner.validate();b*=this.zpp_inner.x;if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();var c=a.zpp_inner.x;if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();b-=c*this.zpp_inner.y;a.zpp_inner.weak?(a.dispose(),!0):!1;return b},perp:function(a){null==a&&(a=!1);if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");return E.get(-function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.y}(this),function(a){if(a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this),a)},toString:function(){if(this.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner.validate();return this.zpp_inner.toString()},__class__:E};var Oc=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null;if(!yd.internal)throw new f("Error: Cannot instantiate Vec2Iterator derp!");
};Oc.__name__=!0;Oc.get=function(a){var b;null==Oc.zpp_pool?(yd.internal=!0,b=new Oc,yd.internal=!1):(b=Oc.zpp_pool,Oc.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};Oc.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.zpp_gl();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=Oc.zpp_pool;Oc.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:Oc};var Ac=
function(){this.zpp_inner=null;this.zpp_inner=new yd;this.zpp_inner.outer=this};Ac.__name__=!0;Ac.fromArray=function(a){if(null==a)throw new f("Error: Cannot convert null Array to Nape list");for(var b=new Ac,c=0;c<a.length;){var d=a[c];++c;b.push(d)}return b};Ac.prototype={get_length:function(){return this.zpp_gl()},zpp_gl:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},
zpp_vm:function(){this.zpp_inner.valmod()},has:function(a){this.zpp_vm();return this.zpp_inner.inner.has(a.zpp_inner)},at:function(a){this.zpp_vm();if(0>a||a>=this.zpp_gl())throw new f("Error: Index out of bounds");this.zpp_inner.reverse_flag&&(a=this.zpp_gl()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;
return this.zpp_inner.at_ite.elt.wrapper()},push:function(a){if(this.zpp_inner.immutable)throw new f("Error: Vec2List is immutable");this.zpp_inner.modify_test();this.zpp_vm();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&(this.empty()?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.zpp_gl()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,
a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},unshift:function(a){if(this.zpp_inner.immutable)throw new f("Error: Vec2List is immutable");this.zpp_inner.modify_test();this.zpp_vm();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(this.empty()?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.zpp_gl()-1)),this.zpp_inner.push_ite=
this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)):this.zpp_inner.inner.add(a.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},pop:function(){if(this.zpp_inner.immutable)throw new f("Error: Vec2List is immutable");this.zpp_inner.modify_test();if(this.empty())throw new f("Error: Cannot remove from empty list");this.zpp_vm();var a=null;if(this.zpp_inner.reverse_flag){var a=this.zpp_inner.inner.head.elt,b=a.wrapper();null!=
this.zpp_inner.subber&&this.zpp_inner.subber(b);this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b=1==this.zpp_gl()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-2),a=null==b?this.zpp_inner.inner.head.elt:b.next.elt,c=a.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(c);this.zpp_inner.dontremove||this.zpp_inner.inner.erase(b)}this.zpp_inner.invalidate();return a.wrapper()},
shift:function(){if(this.zpp_inner.immutable)throw new f("Error: Vec2List is immutable");this.zpp_inner.modify_test();if(this.empty())throw new f("Error: Cannot remove from empty list");this.zpp_vm();var a=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b;b=1==this.zpp_gl()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-2);var a=null==b?this.zpp_inner.inner.head.elt:b.next.elt,c=a.wrapper();null!=this.zpp_inner.subber&&
this.zpp_inner.subber(c);this.zpp_inner.dontremove||this.zpp_inner.inner.erase(b)}else a=this.zpp_inner.inner.head.elt,b=a.wrapper(),null!=this.zpp_inner.subber&&this.zpp_inner.subber(b),this.zpp_inner.dontremove||this.zpp_inner.inner.pop();this.zpp_inner.invalidate();return a.wrapper()},add:function(a){return this.zpp_inner.reverse_flag?this.push(a):this.unshift(a)},remove:function(a){if(this.zpp_inner.immutable)throw new f("Error: Vec2List is immutable");this.zpp_inner.modify_test();this.zpp_vm();
var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),this.zpp_inner.invalidate());return b},clear:function(){if(this.zpp_inner.immutable)throw new f("Error: Vec2List is immutable");if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return 0==this.zpp_gl()},iterator:function(){this.zpp_vm();
return Oc.get(this)},copy:function(a){null==a&&(a=!1);for(var b=new Ac,c=this.iterator();c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b.push(a?function(a){if(null!=d&&d.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");return E.get(function(a){if(null!=d&&d.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");d.zpp_inner.validate();return d.zpp_inner.x}(a),function(a){if(null!=d&&d.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
d.zpp_inner.validate();return d.zpp_inner.y}(a),!1)}(this):d)}return b},merge:function(a){if(null==a)throw new f("Error: Cannot merge with null list");for(a=a.iterator();a.hasNext();){var b;a.zpp_critical=!1;b=a.zpp_inner.at(a.zpp_i++);this.has(b)||this.add(b)}},toString:function(){for(var a="[",b=!0,c=this.iterator();c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},foreach:function(a){if(null==a)throw new f("Error: Cannot execute null on list elements");
for(var b=this.iterator();b.hasNext();)try{var c=void 0;b.zpp_critical=!1;c=b.zpp_inner.at(b.zpp_i++);a(c)}catch(d){d instanceof f&&(d=d.val);b.zpp_next=Oc.zpp_pool;Oc.zpp_pool=b;b.zpp_inner=null;break}return this},filter:function(a){if(null==a)throw new f("Error: Cannot select elements of list with null");for(var b=0;b<this.zpp_gl();){var c=this.at(b);try{a(c)?b++:this.remove(c)}catch(d){d instanceof f&&(d=d.val);break}}return this},__class__:Ac};var N=function(a,b,c){null==c&&(c=0);null==b&&(b=
0);null==a&&(a=0);this.zpp_inner=this.zpp_pool=null;this.zpp_inner=new of;this.zpp_inner.outer=this;if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");if(this.zpp_inner.immutable)throw new f("Error: Vec3 is immutable");this.zpp_inner.x=a;if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");this.zpp_inner.validate();this.zpp_inner.x;if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");if(this.zpp_inner.immutable)throw new f("Error: Vec3 is immutable");
this.zpp_inner.y=b;if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");this.zpp_inner.validate();this.zpp_inner.y;if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");if(this.zpp_inner.immutable)throw new f("Error: Vec3 is immutable");this.zpp_inner.z=c;if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");this.zpp_inner.validate();this.zpp_inner.z};N.__name__=!0;N.get=function(a,b,c){null==c&&(c=0);null==b&&(b=
0);null==a&&(a=0);var d;null==ga.poolVec3?d=new N:(d=ga.poolVec3,ga.poolVec3=d.zpp_pool,d.zpp_pool=null,d.zpp_disp=!1,d==ga.nextVec3&&(ga.nextVec3=null));d.setxyz(a,b,c);d.zpp_inner.immutable=!1;d.zpp_inner._validate=null;return d};N.prototype={get_x:function(){if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");this.zpp_inner.validate();return this.zpp_inner.x},set_x:function(a){if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");if(this.zpp_inner.immutable)throw new f("Error: Vec3 is immutable");
this.zpp_inner.x=a;if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");this.zpp_inner.validate();return this.zpp_inner.x},get_y:function(){if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");this.zpp_inner.validate();return this.zpp_inner.y},set_y:function(a){if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");if(this.zpp_inner.immutable)throw new f("Error: Vec3 is immutable");this.zpp_inner.y=a;if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");
this.zpp_inner.validate();return this.zpp_inner.y},get_z:function(){if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");this.zpp_inner.validate();return this.zpp_inner.z},set_z:function(a){if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");if(this.zpp_inner.immutable)throw new f("Error: Vec3 is immutable");this.zpp_inner.z=a;if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");this.zpp_inner.validate();return this.zpp_inner.z},
dispose:function(){if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");if(this.zpp_inner.immutable)throw new f("Error: This Vec3 is not disposable");this.zpp_pool=null;null!=ga.nextVec3?ga.nextVec3.zpp_pool=this:ga.poolVec3=this;ga.nextVec3=this;this.zpp_disp=!0},get_length:function(){if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");return Math.sqrt(function(a){if(a.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.x}(this)*function(a){if(a.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this)+function(a){if(a.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this)*function(a){if(a.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this)+function(a){if(a.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.z}(this)*function(a){if(a.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.z}(this))},set_length:function(a){if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");if(a!=a)throw new f("Error: Vec3::length cannot be NaN");if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");this.zpp_inner.validate();var b=this.zpp_inner.x;if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");
this.zpp_inner.validate();b*=this.zpp_inner.x;if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");this.zpp_inner.validate();var c=this.zpp_inner.y;if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");this.zpp_inner.validate();b+=c*this.zpp_inner.y;if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");this.zpp_inner.validate();c=this.zpp_inner.z;if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");
this.zpp_inner.validate();if(0==b+c*this.zpp_inner.z)throw new f("Error: Cannot set length of a zero vector");a/=function(a){if(a.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");return Math.sqrt(function(a){if(a.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(a)*function(a){if(a.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(a)+function(a){if(a.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.y}(a)*function(a){if(a.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(a)+function(a){if(a.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.z}(a)*function(a){if(a.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.z}(a))}(this);var d=this;d.set_x(function(a){if(null!=
d&&d.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");d.zpp_inner.validate();return d.zpp_inner.x}(this)*a);var e=this;e.set_y(function(a){if(null!=e&&e.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");e.zpp_inner.validate();return e.zpp_inner.y}(this)*a);var h=this;h.set_z(function(a){if(null!=h&&h.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");h.zpp_inner.validate();return h.zpp_inner.z}(this)*a);if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");
return Math.sqrt(function(a){if(a.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this)*function(a){if(a.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this)+function(a){if(a.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this)*function(a){if(a.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.y}(this)+function(a){if(a.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.z}(this)*function(a){if(a.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.z}(this))},lsq:function(){if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");
this.zpp_inner.validate();var a=this.zpp_inner.x;if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");this.zpp_inner.validate();a*=this.zpp_inner.x;if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");this.zpp_inner.validate();var b=this.zpp_inner.y;if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");this.zpp_inner.validate();a+=b*this.zpp_inner.y;if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");
this.zpp_inner.validate();b=this.zpp_inner.z;if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");this.zpp_inner.validate();return a+b*this.zpp_inner.z},set:function(a){if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");if(null!=a&&a.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");if(null==a)throw new f("Error: Cannot assign null Vec3");return this.setxyz(function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.x}(this),function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this),function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.z}(this))},setxyz:function(a,b,c){if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");
if(this.zpp_inner.immutable)throw new f("Error: Vec3 is immutable");this.zpp_inner.x=a;if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");this.zpp_inner.validate();this.zpp_inner.x;if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");if(this.zpp_inner.immutable)throw new f("Error: Vec3 is immutable");this.zpp_inner.y=b;if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");this.zpp_inner.validate();this.zpp_inner.y;
if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");if(this.zpp_inner.immutable)throw new f("Error: Vec3 is immutable");this.zpp_inner.z=c;if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");this.zpp_inner.validate();this.zpp_inner.z;return this},xy:function(a){null==a&&(a=!1);if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");return E.get(function(a){if(a.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.x}(this),function(a){if(a.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this),a)},toString:function(){if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");this.zpp_inner.validate();var a="{ x: "+this.zpp_inner.x+" y: ";if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");
this.zpp_inner.validate();a=a+this.zpp_inner.y+" z: ";if(this.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");this.zpp_inner.validate();return a+this.zpp_inner.z+" }"},__class__:N};var gc=function(){if(!g.internal)throw new f("Error: Cannot instantiate Winding derp!");};gc.__name__=!0;gc.get_UNDEFINED=function(){null==g.Winding_UNDEFINED&&(g.internal=!0,g.Winding_UNDEFINED=new gc,g.internal=!1);return g.Winding_UNDEFINED};gc.get_CLOCKWISE=function(){null==g.Winding_CLOCKWISE&&
(g.internal=!0,g.Winding_CLOCKWISE=new gc,g.internal=!1);return g.Winding_CLOCKWISE};gc.get_ANTICLOCKWISE=function(){null==g.Winding_ANTICLOCKWISE&&(g.internal=!0,g.Winding_ANTICLOCKWISE=new gc,g.internal=!1);return g.Winding_ANTICLOCKWISE};gc.prototype={toString:function(){null==g.Winding_UNDEFINED&&(g.internal=!0,g.Winding_UNDEFINED=new gc,g.internal=!1);var a;this==g.Winding_UNDEFINED?a="UNDEFINED":(null==g.Winding_CLOCKWISE&&(g.internal=!0,g.Winding_CLOCKWISE=new gc,g.internal=!1),this==g.Winding_CLOCKWISE?
a="CLOCKWISE":(null==g.Winding_ANTICLOCKWISE&&(g.internal=!0,g.Winding_ANTICLOCKWISE=new gc,g.internal=!1),a=this==g.Winding_ANTICLOCKWISE?"ANTICLOCKWISE":""));return a},__class__:gc};var Ja=function(){this.zpp_inner_i=null;if(!Ja.zpp_internalAlloc)throw new f("Error: Cannot instantiate an Interactor, only Shape/Body/Compound");};Ja.__name__=!0;Ja.prototype={get_id:function(){return this.zpp_inner_i.id},get_userData:function(){null==this.zpp_inner_i.userData&&(this.zpp_inner_i.userData={});return this.zpp_inner_i.userData},
isShape:function(){return null!=this.zpp_inner_i.ishape},isBody:function(){return null!=this.zpp_inner_i.ibody},isCompound:function(){return null!=this.zpp_inner_i.icompound},get_castShape:function(){return null!=this.zpp_inner_i.ishape?this.zpp_inner_i.ishape.outer:null},get_castBody:function(){return null!=this.zpp_inner_i.ibody?this.zpp_inner_i.ibody.outer:null},get_castCompound:function(){return null!=this.zpp_inner_i.icompound?this.zpp_inner_i.icompound.outer:null},get_group:function(){return null==
this.zpp_inner_i.group?null:this.zpp_inner_i.group.outer},set_group:function(a){this.zpp_inner_i.immutable_midstep("Interactor::group");this.zpp_inner_i.setGroup(null==a?null:a.zpp_inner);return null==this.zpp_inner_i.group?null:this.zpp_inner_i.group.outer},get_cbTypes:function(){null==this.zpp_inner_i.wrap_cbTypes&&this.zpp_inner_i.setupcbTypes();return this.zpp_inner_i.wrap_cbTypes},toString:function(){return""},__class__:Ja};var ld=function(a,b){this.debugDraw=!0;this.zpp_inner=null;Ja.zpp_internalAlloc=
!0;Ja.call(this);Ja.zpp_internalAlloc=!1;this.zpp_inner=new H;this.zpp_inner.outer=this;this.zpp_inner.outer_i=this;this.zpp_inner_i=this.zpp_inner;if(null!=b){if(null!=b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null!=b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");b.zpp_inner.validate();this.zpp_inner.posx=b.zpp_inner.x;if(null!=b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");b.zpp_inner.validate();
this.zpp_inner.posy=b.zpp_inner.y}else this.zpp_inner.posx=0,this.zpp_inner.posy=0;this.set_type(null==a?function(a){null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new Ga,g.internal=!1);return g.BodyType_DYNAMIC}(this):a);null!=b&&(b.zpp_inner.weak?(b.dispose(),!0):!1);this.zpp_inner_i.insert_cbtype(Ha.ANY_BODY.zpp_inner)};ld.__name__=!0;ld.__super__=Ja;ld.prototype=I(Ja.prototype,{get_type:function(){return H.types[this.zpp_inner.type]},set_type:function(a){this.zpp_inner.immutable_midstep("Body::type");
if(this.zpp_inner.world)throw new f("Error: Space::world is immutable");if(H.types[this.zpp_inner.type]!=a){if(null==a)throw new f("Error: Cannot use null BodyType");null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new Ga,g.internal=!1);a==g.BodyType_DYNAMIC?a=2:(null==g.BodyType_KINEMATIC&&(g.internal=!0,g.BodyType_KINEMATIC=new Ga,g.internal=!1),a=a==g.BodyType_KINEMATIC?3:1);1==a&&null!=this.zpp_inner.space&&(this.zpp_inner.velx=0,this.zpp_inner.vely=0,this.zpp_inner.angvel=0);this.zpp_inner.invalidate_type();
null!=this.zpp_inner.space?this.zpp_inner.space.transmitType(this.zpp_inner,a):this.zpp_inner.type=a}return H.types[this.zpp_inner.type]},get_isBullet:function(){return this.zpp_inner.bulletEnabled},set_isBullet:function(a){this.zpp_inner.bulletEnabled=a;return this.zpp_inner.bulletEnabled},get_disableCCD:function(){return this.zpp_inner.disableCCD},set_disableCCD:function(a){this.zpp_inner.disableCCD=a;return this.zpp_inner.disableCCD},integrate:function(a){if(a!=a)throw new f("Cannot integrate by NaN time");
this.zpp_inner.immutable_midstep("Body::space");if(this.zpp_inner.world)throw new f("Error: Space::world is immutable");if(0==a)return this;var b=this.zpp_inner;b.sweepTime=0;b.sweep_angvel=b.angvel;b.sweepIntegrate(a);b.invalidate_pos();b.invalidate_rot();b.sweepTime=0;return this},isStatic:function(){return 1==this.zpp_inner.type},isDynamic:function(){return 2==this.zpp_inner.type},isKinematic:function(){return 3==this.zpp_inner.type},get_shapes:function(){return this.zpp_inner.wrap_shapes},get_compound:function(){return null==
this.zpp_inner.compound?null:this.zpp_inner.compound.outer},set_compound:function(a){(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer)!=a&&(null!=(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer)&&(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer).zpp_inner.wrap_bodies.remove(this),null!=a&&a.zpp_inner.wrap_bodies.add(this));return null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer},get_space:function(){return null==this.zpp_inner.space?
null:this.zpp_inner.space.outer},set_space:function(a){if(null!=this.zpp_inner.compound)throw new f("Error: Cannot set the space of a Body belonging to a Compound, only the root Compound space can be set");this.zpp_inner.immutable_midstep("Body::space");if(this.zpp_inner.world)throw new f("Error: Space::world is immutable");(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)!=a&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.component.woken=!1),null!=
(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(null==this.zpp_inner.space?null:this.zpp_inner.space.outer).zpp_inner.wrap_bodies.remove(this),null!=a&&a.zpp_inner.wrap_bodies.add(this));return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},get_arbiters:function(){null==this.zpp_inner.wrap_arbiters&&(this.zpp_inner.wrap_arbiters=qb.get(this.zpp_inner.arbiters,!0));return this.zpp_inner.wrap_arbiters},get_isSleeping:function(){if(null==this.zpp_inner.space)throw new f("Error: isSleeping makes no sense if the object is not contained within a Space");
return this.zpp_inner.component.sleeping},get_constraints:function(){null==this.zpp_inner.wrap_constraints&&(this.zpp_inner.wrap_constraints=mb.get(this.zpp_inner.constraints,!0));return this.zpp_inner.wrap_constraints},copy:function(){if(this.zpp_inner.world)throw new f("Error: Space::world cannot be copied");return this.zpp_inner.copy()},get_position:function(){null==this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition();return this.zpp_inner.wrap_pos},set_position:function(a){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
if(null==a)throw new f("Error: Body::position cannot be null");null==this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition();this.zpp_inner.wrap_pos.set(a);null==this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition();return this.zpp_inner.wrap_pos},get_velocity:function(){null==this.zpp_inner.wrap_vel&&this.zpp_inner.setupVelocity();return this.zpp_inner.wrap_vel},set_velocity:function(a){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Body::velocity cannot be null");
null==this.zpp_inner.wrap_vel&&this.zpp_inner.setupVelocity();this.zpp_inner.wrap_vel.set(a);null==this.zpp_inner.wrap_vel&&this.zpp_inner.setupVelocity();return this.zpp_inner.wrap_vel},setVelocityFromTarget:function(a,b,c){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Cannot set velocity for null target position");if(0==c)throw new f("deltaTime cannot be 0 for setVelocityFromTarget");c=1/c;null==this.zpp_inner.wrap_vel&&this.zpp_inner.setupVelocity();
this.zpp_inner.wrap_vel.set(a.sub(function(a){null==a.zpp_inner.wrap_pos&&a.zpp_inner.setupPosition();return a.zpp_inner.wrap_pos}(this),!0).muleq(c));this.set_angularVel((b-this.zpp_inner.rot)*c);a.zpp_inner.weak?(a.dispose(),!0):!1;return this},get_kinematicVel:function(){null==this.zpp_inner.wrap_kinvel&&this.zpp_inner.setupkinvel();return this.zpp_inner.wrap_kinvel},set_kinematicVel:function(a){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Body::kinematicVel cannot be null");
null==this.zpp_inner.wrap_kinvel&&this.zpp_inner.setupkinvel();this.zpp_inner.wrap_kinvel.set(a);null==this.zpp_inner.wrap_kinvel&&this.zpp_inner.setupkinvel();return this.zpp_inner.wrap_kinvel},get_surfaceVel:function(){null==this.zpp_inner.wrap_svel&&this.zpp_inner.setupsvel();return this.zpp_inner.wrap_svel},set_surfaceVel:function(a){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Body::surfaceVel cannot be null");null==this.zpp_inner.wrap_svel&&
this.zpp_inner.setupsvel();this.zpp_inner.wrap_svel.set(a);null==this.zpp_inner.wrap_svel&&this.zpp_inner.setupsvel();return this.zpp_inner.wrap_svel},get_force:function(){null==this.zpp_inner.wrap_force&&this.zpp_inner.setupForce();return this.zpp_inner.wrap_force},set_force:function(a){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Body::force cannot be null");null==this.zpp_inner.wrap_force&&this.zpp_inner.setupForce();this.zpp_inner.wrap_force.set(a);
null==this.zpp_inner.wrap_force&&this.zpp_inner.setupForce();return this.zpp_inner.wrap_force},get_constraintVelocity:function(){null==this.zpp_inner.wrapcvel&&this.zpp_inner.setup_cvel();return this.zpp_inner.wrapcvel},get_rotation:function(){return this.zpp_inner.rot},set_rotation:function(a){this.zpp_inner.immutable_midstep("Body::rotation");if(this.zpp_inner.world)throw new f("Error: Space::world is immutable");if(1==this.zpp_inner.type&&null!=this.zpp_inner.space)throw new f("Error: Static objects cannot be rotated once inside a Space");
if(this.zpp_inner.rot!=a){if(a!=a)throw new f("Error: Body::rotation cannot be NaN");this.zpp_inner.rot=a;this.zpp_inner.invalidate_rot();this.zpp_inner.wake()}return this.zpp_inner.rot},get_angularVel:function(){return this.zpp_inner.angvel},set_angularVel:function(a){if(this.zpp_inner.world)throw new f("Error: Space::world is immutable");if(this.zpp_inner.angvel!=a){if(a!=a)throw new f("Error: Body::angularVel cannot be NaN");if(1==this.zpp_inner.type)throw new f("Error: A static object cannot be given a velocity");
this.zpp_inner.angvel=a;this.zpp_inner.wake()}return this.zpp_inner.angvel},get_kinAngVel:function(){return this.zpp_inner.kinangvel},set_kinAngVel:function(a){if(this.zpp_inner.world)throw new f("Error: Space::world is immutable");if(this.zpp_inner.kinangvel!=a){if(a!=a)throw new f("Error: Body::kinAngVel cannot be NaN");this.zpp_inner.kinangvel=a;this.zpp_inner.wake()}return this.zpp_inner.kinangvel},get_torque:function(){return this.zpp_inner.torque},set_torque:function(a){if(this.zpp_inner.world)throw new f("Error: Space::world is immutable");
if(2!=this.zpp_inner.type)throw new f("Error: Non-dynamic body cannot have torque applied.");if(a!=a)throw new f("Error: Body::torque cannot be NaN");this.zpp_inner.torque!=a&&(this.zpp_inner.torque=a,this.zpp_inner.wake());return this.zpp_inner.torque},get_bounds:function(){if(this.zpp_inner.world)throw new f("Error: Space::world has no bounds");return this.zpp_inner.aabb.wrapper()},get_allowMovement:function(){return!this.zpp_inner.nomove},set_allowMovement:function(a){this.zpp_inner.immutable_midstep("Body::"+
(null==a?"null":""+a));!this.zpp_inner.nomove!=a&&(this.zpp_inner.nomove=!a,this.zpp_inner.invalidate_mass());return!this.zpp_inner.nomove},get_allowRotation:function(){return!this.zpp_inner.norotate},set_allowRotation:function(a){this.zpp_inner.immutable_midstep("Body::"+(null==a?"null":""+a));!this.zpp_inner.norotate!=a&&(this.zpp_inner.norotate=!a,this.zpp_inner.invalidate_inertia());return!this.zpp_inner.norotate},get_massMode:function(){null==g.MassMode_DEFAULT&&(g.internal=!0,g.MassMode_DEFAULT=
new yb,g.internal=!1);var a=g.MassMode_DEFAULT;null==g.MassMode_FIXED&&(g.internal=!0,g.MassMode_FIXED=new yb,g.internal=!1);return[a,g.MassMode_FIXED][this.zpp_inner.massMode]},set_massMode:function(a){this.zpp_inner.immutable_midstep("Body::massMode");if(this.zpp_inner.world)throw new f("Error: Space::world is immutable");if(null==a)throw new f("Error: cannot use null massMode");null==g.MassMode_DEFAULT&&(g.internal=!0,g.MassMode_DEFAULT=new yb,g.internal=!1);a==g.MassMode_DEFAULT?this.zpp_inner.massMode=
0:this.zpp_inner.massMode=1;this.zpp_inner.invalidate_mass();null==g.MassMode_DEFAULT&&(g.internal=!0,g.MassMode_DEFAULT=new yb,g.internal=!1);a=g.MassMode_DEFAULT;null==g.MassMode_FIXED&&(g.internal=!0,g.MassMode_FIXED=new yb,g.internal=!1);return[a,g.MassMode_FIXED][this.zpp_inner.massMode]},get_constraintMass:function(){this.zpp_inner.world||this.zpp_inner.validate_mass();return this.zpp_inner.smass},get_mass:function(){if(this.zpp_inner.world)throw new f("Error: Space::world has no mass");this.zpp_inner.validate_mass();
if(0==this.zpp_inner.massMode&&null==this.zpp_inner.shapes.head)throw new f("Error: Given current mass mode, Body::mass only makes sense if it contains shapes");return this.zpp_inner.cmass},set_mass:function(a){this.zpp_inner.immutable_midstep("Body::mass");if(this.zpp_inner.world)throw new f("Error: Space::world is immutable");if(a!=a)throw new f("Error: Mass cannot be NaN");if(0>=a)throw new f("Error: Mass must be strictly positive");if(Infinity<=a)throw new f("Error: Mass cannot be infinite, use allowMovement = false instead");
this.zpp_inner.massMode=1;this.zpp_inner.cmass=a;this.zpp_inner.invalidate_mass();if(this.zpp_inner.world)throw new f("Error: Space::world has no mass");this.zpp_inner.validate_mass();if(0==this.zpp_inner.massMode&&null==this.zpp_inner.shapes.head)throw new f("Error: Given current mass mode, Body::mass only makes sense if it contains shapes");return this.zpp_inner.cmass},get_gravMassMode:function(){null==g.GravMassMode_DEFAULT&&(g.internal=!0,g.GravMassMode_DEFAULT=new Da,g.internal=!1);var a=g.GravMassMode_DEFAULT;
null==g.GravMassMode_FIXED&&(g.internal=!0,g.GravMassMode_FIXED=new Da,g.internal=!1);var b=g.GravMassMode_FIXED;null==g.GravMassMode_SCALED&&(g.internal=!0,g.GravMassMode_SCALED=new Da,g.internal=!1);return[a,b,g.GravMassMode_SCALED][this.zpp_inner.massMode]},set_gravMassMode:function(a){this.zpp_inner.immutable_midstep("Body::gravMassMode");if(this.zpp_inner.world)throw new f("Error: Space::world is immutable");if(null==a)throw new f("Error: Cannot use null gravMassMode");null==g.GravMassMode_SCALED&&
(g.internal=!0,g.GravMassMode_SCALED=new Da,g.internal=!1);a==g.GravMassMode_SCALED?this.zpp_inner.gravMassMode=2:(null==g.GravMassMode_DEFAULT&&(g.internal=!0,g.GravMassMode_DEFAULT=new Da,g.internal=!1),a==g.GravMassMode_DEFAULT?this.zpp_inner.gravMassMode=0:this.zpp_inner.gravMassMode=1);this.zpp_inner.invalidate_gravMass();null==g.GravMassMode_DEFAULT&&(g.internal=!0,g.GravMassMode_DEFAULT=new Da,g.internal=!1);a=g.GravMassMode_DEFAULT;null==g.GravMassMode_FIXED&&(g.internal=!0,g.GravMassMode_FIXED=
new Da,g.internal=!1);var b=g.GravMassMode_FIXED;null==g.GravMassMode_SCALED&&(g.internal=!0,g.GravMassMode_SCALED=new Da,g.internal=!1);return[a,b,g.GravMassMode_SCALED][this.zpp_inner.massMode]},get_gravMass:function(){if(this.zpp_inner.world)throw new f("Error: Space::world has no gravMass");this.zpp_inner.validate_gravMass();if(null==this.zpp_inner.shapes.head&&0==this.zpp_inner.massMode&&1!=this.zpp_inner.gravMassMode)throw new f("Error: Given current mass/gravMass modes; Body::gravMass only makes sense if it contains Shapes");
return this.zpp_inner.gravMass},set_gravMass:function(a){this.zpp_inner.immutable_midstep("Body::gravMass");if(this.zpp_inner.world)throw new f("Error: Space::world is immutable");if(a!=a)throw new f("Error: gravMass cannot be NaN");this.zpp_inner.gravMassMode=1;this.zpp_inner.gravMass=a;this.zpp_inner.invalidate_gravMass();if(this.zpp_inner.world)throw new f("Error: Space::world has no gravMass");this.zpp_inner.validate_gravMass();if(null==this.zpp_inner.shapes.head&&0==this.zpp_inner.massMode&&
1!=this.zpp_inner.gravMassMode)throw new f("Error: Given current mass/gravMass modes; Body::gravMass only makes sense if it contains Shapes");return this.zpp_inner.gravMass},get_gravMassScale:function(){this.zpp_inner.validate_gravMassScale();if(null==this.zpp_inner.shapes.head&&0==this.zpp_inner.massMode&&2!=this.zpp_inner.gravMassMode)throw new f("Error: Given current mass/gravMass modes; Body::gravMassScale only makes sense if it contains Shapes");return this.zpp_inner.gravMassScale},set_gravMassScale:function(a){this.zpp_inner.immutable_midstep("Body::gravMassScale");
if(this.zpp_inner.world)throw new f("Error: Space::world is immutable");if(a!=a)throw new f("Error: gravMassScale cannot be NaN");this.zpp_inner.gravMassMode=2;this.zpp_inner.gravMassScale=a;this.zpp_inner.invalidate_gravMassScale();this.zpp_inner.validate_gravMassScale();if(null==this.zpp_inner.shapes.head&&0==this.zpp_inner.massMode&&2!=this.zpp_inner.gravMassMode)throw new f("Error: Given current mass/gravMass modes; Body::gravMassScale only makes sense if it contains Shapes");return this.zpp_inner.gravMassScale},
get_inertiaMode:function(){null==g.InertiaMode_DEFAULT&&(g.internal=!0,g.InertiaMode_DEFAULT=new Cc,g.internal=!1);var a=g.InertiaMode_DEFAULT;null==g.InertiaMode_FIXED&&(g.internal=!0,g.InertiaMode_FIXED=new Cc,g.internal=!1);return[a,g.InertiaMode_FIXED][this.zpp_inner.inertiaMode]},set_inertiaMode:function(a){this.zpp_inner.immutable_midstep("Body::inertiaMode");if(this.zpp_inner.world)throw new f("Error: Space::world is immutable");if(null==a)throw new f("Error: Cannot use null InertiaMode");
null==g.InertiaMode_FIXED&&(g.internal=!0,g.InertiaMode_FIXED=new Cc,g.internal=!1);a==g.InertiaMode_FIXED?this.zpp_inner.inertiaMode=1:this.zpp_inner.inertiaMode=0;this.zpp_inner.invalidate_inertia();null==g.InertiaMode_DEFAULT&&(g.internal=!0,g.InertiaMode_DEFAULT=new Cc,g.internal=!1);a=g.InertiaMode_DEFAULT;null==g.InertiaMode_FIXED&&(g.internal=!0,g.InertiaMode_FIXED=new Cc,g.internal=!1);return[a,g.InertiaMode_FIXED][this.zpp_inner.inertiaMode]},get_constraintInertia:function(){this.zpp_inner.world||
this.zpp_inner.validate_inertia();return this.zpp_inner.sinertia},get_inertia:function(){if(this.zpp_inner.world)throw new f("Error: Space::world has no inertia");this.zpp_inner.validate_inertia();if(0==this.zpp_inner.inertiaMode&&this.zpp_inner.wrap_shapes.empty())throw new f("Error: Given current inertia mode flag, Body::inertia only makes sense if Body contains Shapes");return this.zpp_inner.cinertia},set_inertia:function(a){this.zpp_inner.immutable_midstep("Body::inertia");if(this.zpp_inner.world)throw new f("Error: Space::world is immutable");
if(a!=a)throw new f("Error: Inertia cannot be NaN");if(0>=a)throw new f("Error: Inertia must be strictly positive");if(Infinity<=a)throw new f("Error: Inertia cannot be infinite, use allowRotation = false instead");this.zpp_inner.inertiaMode=1;this.zpp_inner.cinertia=a;this.zpp_inner.invalidate_inertia();if(this.zpp_inner.world)throw new f("Error: Space::world has no inertia");this.zpp_inner.validate_inertia();if(0==this.zpp_inner.inertiaMode&&this.zpp_inner.wrap_shapes.empty())throw new f("Error: Given current inertia mode flag, Body::inertia only makes sense if Body contains Shapes");
return this.zpp_inner.cinertia},connectedBodies:function(a,b){null==a&&(a=-1);return this.zpp_inner.connectedBodies(a,b)},interactingBodies:function(a,b,c){null==b&&(b=-1);null==a?a=F.COL|F.SENSOR|F.FLUID:(null==g.InteractionType_COLLISION&&(g.internal=!0,g.InteractionType_COLLISION=new ta,g.internal=!1),a==g.InteractionType_COLLISION?a=F.COL:(null==g.InteractionType_SENSOR&&(g.internal=!0,g.InteractionType_SENSOR=new ta,g.internal=!1),a=a==g.InteractionType_SENSOR?F.SENSOR:F.FLUID));return this.zpp_inner.interactingBodies(a,
b,c)},crushFactor:function(){if(null==(null==this.zpp_inner.space?null:this.zpp_inner.space.outer))throw new f("Error: Makes no sense to see how much an object not taking part in a simulation is being crushed");var a=0,b=E.get(null,null,null);null==this.zpp_inner.wrap_arbiters&&(this.zpp_inner.wrap_arbiters=qb.get(this.zpp_inner.arbiters,!0));for(var c=this.zpp_inner.wrap_arbiters.iterator();c.hasNext();){c.zpp_critical=!1;var d=c.zpp_inner.at(c.zpp_i++).totalImpulse(this),e=d.xy();b.addeq(e);if(null!=
e&&e.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a+=Math.sqrt(function(a){if(null!=e&&e.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");e.zpp_inner.validate();return e.zpp_inner.x}(this)*function(a){if(null!=e&&e.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");e.zpp_inner.validate();return e.zpp_inner.x}(this)+function(a){if(null!=e&&e.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");e.zpp_inner.validate();
return e.zpp_inner.y}(this)*function(a){if(null!=e&&e.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");e.zpp_inner.validate();return e.zpp_inner.y}(this));e.dispose();d.dispose()}null==this.zpp_inner.wrap_constraints&&(this.zpp_inner.wrap_constraints=mb.get(this.zpp_inner.constraints,!0));for(c=this.zpp_inner.wrap_constraints.iterator();c.hasNext();){c.zpp_critical=!1;var d=c.zpp_inner.at(c.zpp_i++).bodyImpulse(this),h=d.xy();b.addeq(h);if(null!=h&&h.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
a+=Math.sqrt(function(a){if(null!=h&&h.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");h.zpp_inner.validate();return h.zpp_inner.x}(this)*function(a){if(null!=h&&h.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");h.zpp_inner.validate();return h.zpp_inner.x}(this)+function(a){if(null!=h&&h.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");h.zpp_inner.validate();return h.zpp_inner.y}(this)*function(a){if(null!=h&&h.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
h.zpp_inner.validate();return h.zpp_inner.y}(this));h.dispose();d.dispose()}a-=function(a){if(null!=b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");return Math.sqrt(function(a){if(null!=b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");b.zpp_inner.validate();return b.zpp_inner.x}(a)*function(a){if(null!=b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");b.zpp_inner.validate();return b.zpp_inner.x}(a)+function(a){if(null!=
b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");b.zpp_inner.validate();return b.zpp_inner.y}(a)*function(a){if(null!=b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");b.zpp_inner.validate();return b.zpp_inner.y}(a))}(this);if(this.zpp_inner.world)throw new f("Error: Space::world has no mass");this.zpp_inner.validate_mass();if(0==this.zpp_inner.massMode&&null==this.zpp_inner.shapes.head)throw new f("Error: Given current mass mode, Body::mass only makes sense if it contains shapes");
a/=this.zpp_inner.cmass*(null==this.zpp_inner.space?null:this.zpp_inner.space.outer).zpp_inner.pre_dt;b.dispose();return a},localPointToWorld:function(a,b){null==b&&(b=!1);if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Cannot transform null Vec2");this.zpp_inner.validate_axis();var c=0,d=0,c=this.zpp_inner.axisy;if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();c*=a.zpp_inner.x;
d=this.zpp_inner.axisx;if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();c-=d*a.zpp_inner.y;if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();d=a.zpp_inner.x*this.zpp_inner.axisx;if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();d+=a.zpp_inner.y*this.zpp_inner.axisy;a.zpp_inner.weak?(a.dispose(),!0):!1;return E.get(c+
this.zpp_inner.posx,d+this.zpp_inner.posy,b)},worldPointToLocal:function(a,b){null==b&&(b=!1);if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Cannot transform null Vec2");this.zpp_inner.validate_axis();var c=0,d=0,e=d=0;if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();d=a.zpp_inner.x-this.zpp_inner.posx;if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();e=a.zpp_inner.y-this.zpp_inner.posy;c=d*this.zpp_inner.axisy+e*this.zpp_inner.axisx;d=e*this.zpp_inner.axisy-d*this.zpp_inner.axisx;a.zpp_inner.weak?(a.dispose(),!0):!1;return E.get(c,d,b)},localVectorToWorld:function(a,b){null==b&&(b=!1);if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Cannot transform null Vec2");this.zpp_inner.validate_axis();var c=0,d=0,c=this.zpp_inner.axisy;if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();c*=a.zpp_inner.x;d=this.zpp_inner.axisx;if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();c-=d*a.zpp_inner.y;if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();d=a.zpp_inner.x*this.zpp_inner.axisx;if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();d+=a.zpp_inner.y*this.zpp_inner.axisy;a.zpp_inner.weak?
(a.dispose(),!0):!1;return E.get(c,d,b)},worldVectorToLocal:function(a,b){null==b&&(b=!1);if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Cannot transform null Vec2");this.zpp_inner.validate_axis();var c=0,d=0;if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();c=a.zpp_inner.x*this.zpp_inner.axisy;if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();c+=a.zpp_inner.y*this.zpp_inner.axisx;if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();d=a.zpp_inner.y*this.zpp_inner.axisy;if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();d-=a.zpp_inner.x*this.zpp_inner.axisx;a.zpp_inner.weak?(a.dispose(),!0):!1;return E.get(c,d,b)},applyImpulse:function(a,b,c){null==c&&(c=!1);if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
if(null!=b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(this.zpp_inner.world)throw new f("Error: Space::world is immutable");if(null==a)throw new f("Error: Cannot apply null impulse to Body");var d;if(d=c){if(null==this.zpp_inner.space)throw new f("Error: isSleeping makes no sense if the object is not contained within a Space");d=this.zpp_inner.component.sleeping}if(d)return a.zpp_inner.weak?(a.dispose(),!0):!1,null!=b&&(b.zpp_inner.weak?(b.dispose(),!0):!1),this;
this.zpp_inner.validate_mass();d=this.zpp_inner.imass;var e=this.zpp_inner,h=this.zpp_inner.velx;if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();e.velx=h+a.zpp_inner.x*d;e=this.zpp_inner;h=this.zpp_inner.vely;if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();e.vely=h+a.zpp_inner.y*d;if(null!=b){var t=0;d=0;if(null!=b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
b.zpp_inner.validate();t=b.zpp_inner.x-this.zpp_inner.posx;if(null!=b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");b.zpp_inner.validate();d=b.zpp_inner.y-this.zpp_inner.posy;this.zpp_inner.validate_inertia();e=this.zpp_inner;h=this.zpp_inner.angvel;if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();t*=a.zpp_inner.y;if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();
e.angvel=h+(t-a.zpp_inner.x*d)*this.zpp_inner.iinertia;b.zpp_inner.weak?(b.dispose(),!0):!1}c||2==this.zpp_inner.type&&this.zpp_inner.wake();a.zpp_inner.weak?(a.dispose(),!0):!1;return this},applyAngularImpulse:function(a,b){null==b&&(b=!1);if(this.zpp_inner.world)throw new f("Error: Space::world is immutable");var c;if(c=b){if(null==this.zpp_inner.space)throw new f("Error: isSleeping makes no sense if the object is not contained within a Space");c=this.zpp_inner.component.sleeping}if(c)return this;
this.zpp_inner.validate_inertia();this.zpp_inner.angvel+=a*this.zpp_inner.iinertia;b||2==this.zpp_inner.type&&this.zpp_inner.wake();return this},translateShapes:function(a){this.zpp_inner.immutable_midstep("Body::translateShapes()");if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(this.zpp_inner.world)throw new f("Error: Space::world is immutable");if(null==a)throw new f("Error: Cannot displace by null Vec2");var b=a.zpp_inner.weak;a.zpp_inner.weak=!1;for(var c=
this.zpp_inner.shapes.head;null!=c;)c.elt.outer.translate(a),c=c.next;a.zpp_inner.weak=b;a.zpp_inner.weak?(a.dispose(),!0):!1;return this},rotateShapes:function(a){this.zpp_inner.immutable_midstep("Body::rotateShapes()");if(this.zpp_inner.world)throw new f("Error: Space::world is immutable");for(var b=this.zpp_inner.shapes.head;null!=b;)b.elt.outer.rotate(a),b=b.next;return this},scaleShapes:function(a,b){this.zpp_inner.immutable_midstep("Body::scaleShapes()");if(this.zpp_inner.world)throw new f("Error: Space::world is immutable");
for(var c=this.zpp_inner.shapes.head;null!=c;)c.elt.outer.scale(a,b),c=c.next;return this},transformShapes:function(a){this.zpp_inner.immutable_midstep("Body::transformShapes()");if(this.zpp_inner.world)throw new f("Error: Space::world is immutable");for(var b=this.zpp_inner.shapes.head;null!=b;)b.elt.outer.transform(a),b=b.next;return this},align:function(){this.zpp_inner.immutable_midstep("Body::align()");if(this.zpp_inner.world)throw new f("Error: Space::world is immutable");if(null==this.zpp_inner.shapes.head)throw new f("Error: Cannot align empty Body");
this.zpp_inner.validate_localCOM();var a=E.get(-this.zpp_inner.localCOMx,-this.zpp_inner.localCOMy,null);this.translateShapes(a);var b=this.localVectorToWorld(a);null==this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition();this.zpp_inner.wrap_pos.subeq(b);if(Infinity>this.zpp_inner.pre_posx){var c=this.zpp_inner,d=this.zpp_inner.pre_posx;if(null!=b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");b.zpp_inner.validate();c.pre_posx=d-1*b.zpp_inner.x;c=this.zpp_inner;d=this.zpp_inner.pre_posy;
if(null!=b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");b.zpp_inner.validate();c.pre_posy=d-1*b.zpp_inner.y}a.dispose();b.dispose();return this},rotate:function(a,b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Cannot rotate about a null Vec2");if(b!=b)throw new f("Error: Cannot rotate by NaN radians");var c=a.zpp_inner.weak;a.zpp_inner.weak=!1;null==this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition();
var d=this.zpp_inner.wrap_pos.sub(a);d.rotate(b);this.set_position(a.add(d,!0));d.dispose();this.set_rotation(this.zpp_inner.rot+b);a.zpp_inner.weak=c;a.zpp_inner.weak?(a.dispose(),!0):!1;return this},setShapeMaterials:function(a){this.zpp_inner.immutable_midstep("Body::setShapeMaterials()");if(this.zpp_inner.world)throw new f("Error: Space::world is immutable");for(var b=this.zpp_inner.shapes.head;null!=b;)b.elt.outer.set_material(a),b=b.next;return this},setShapeFilters:function(a){this.zpp_inner.immutable_midstep("Body::setShapeFilters()");
if(this.zpp_inner.world)throw new f("Error: Space::world is immutable");for(var b=this.zpp_inner.shapes.head;null!=b;)b.elt.outer.set_filter(a),b=b.next;return this},setShapeFluidProperties:function(a){this.zpp_inner.immutable_midstep("Body::setShapeFluidProperties()");if(this.zpp_inner.world)throw new f("Error: Space::world is immutable");for(var b=this.zpp_inner.shapes.head;null!=b;)b.elt.outer.set_fluidProperties(a),b=b.next;return this},get_localCOM:function(){if(this.zpp_inner.world)throw new f("Error: Space::world has no localCOM");
null==this.zpp_inner.wrap_localCOM&&(this.zpp_inner.wrap_localCOM=E.get(this.zpp_inner.localCOMx,this.zpp_inner.localCOMy,null),this.zpp_inner.wrap_localCOM.zpp_inner._inuse=!0,this.zpp_inner.wrap_localCOM.zpp_inner._immutable=!0,this.zpp_inner.wrap_localCOM.zpp_inner._validate=(fa=this.zpp_inner,w(fa,fa.getlocalCOM)));return this.zpp_inner.wrap_localCOM},get_worldCOM:function(){if(this.zpp_inner.world)throw new f("Error: Space::world has no worldCOM");null==this.zpp_inner.wrap_worldCOM&&(this.zpp_inner.wrap_worldCOM=
E.get(this.zpp_inner.worldCOMx,this.zpp_inner.worldCOMy,null),this.zpp_inner.wrap_worldCOM.zpp_inner._inuse=!0,this.zpp_inner.wrap_worldCOM.zpp_inner._immutable=!0,this.zpp_inner.wrap_worldCOM.zpp_inner._validate=(fa=this.zpp_inner,w(fa,fa.getworldCOM)));return this.zpp_inner.wrap_worldCOM},normalImpulse:function(a,b){null==b&&(b=!1);var c=0,d=0,e=0;null==this.zpp_inner.wrap_arbiters&&(this.zpp_inner.wrap_arbiters=qb.get(this.zpp_inner.arbiters,!0));for(var h=this.zpp_inner.wrap_arbiters.iterator();h.hasNext();){h.zpp_critical=
!1;var t=h.zpp_inner.at(h.zpp_i++).zpp_inner;if(t.type==F.COL&&(null==a||t.b2==a.zpp_inner||t.b1==a.zpp_inner)){t=t.wrapper().get_collisionArbiter().normalImpulse(this,b);if(null!=t&&t.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");t.zpp_inner.validate();c+=1*t.zpp_inner.x;if(null!=t&&t.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");t.zpp_inner.validate();d+=1*t.zpp_inner.y;if(null!=t&&t.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");
t.zpp_inner.validate();e+=1*t.zpp_inner.z;t.dispose()}}return N.get(c,d,e)},tangentImpulse:function(a,b){null==b&&(b=!1);var c=0,d=0,e=0;null==this.zpp_inner.wrap_arbiters&&(this.zpp_inner.wrap_arbiters=qb.get(this.zpp_inner.arbiters,!0));for(var h=this.zpp_inner.wrap_arbiters.iterator();h.hasNext();){h.zpp_critical=!1;var t=h.zpp_inner.at(h.zpp_i++).zpp_inner;if(t.type==F.COL&&(null==a||t.b2==a.zpp_inner||t.b1==a.zpp_inner)){t=t.wrapper().get_collisionArbiter().tangentImpulse(this,b);if(null!=t&&
t.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");t.zpp_inner.validate();c+=1*t.zpp_inner.x;if(null!=t&&t.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");t.zpp_inner.validate();d+=1*t.zpp_inner.y;if(null!=t&&t.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");t.zpp_inner.validate();e+=1*t.zpp_inner.z;t.dispose()}}return N.get(c,d,e)},totalContactsImpulse:function(a,b){null==b&&(b=!1);var c=0,d=0,e=0;null==this.zpp_inner.wrap_arbiters&&
(this.zpp_inner.wrap_arbiters=qb.get(this.zpp_inner.arbiters,!0));for(var h=this.zpp_inner.wrap_arbiters.iterator();h.hasNext();){h.zpp_critical=!1;var t=h.zpp_inner.at(h.zpp_i++).zpp_inner;if(t.type==F.COL&&(null==a||t.b2==a.zpp_inner||t.b1==a.zpp_inner)){t=t.wrapper().get_collisionArbiter().totalImpulse(this,b);if(null!=t&&t.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");t.zpp_inner.validate();c+=1*t.zpp_inner.x;if(null!=t&&t.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");
t.zpp_inner.validate();d+=1*t.zpp_inner.y;if(null!=t&&t.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");t.zpp_inner.validate();e+=1*t.zpp_inner.z;t.dispose()}}return N.get(c,d,e)},rollingImpulse:function(a,b){null==b&&(b=!1);var c=0;null==this.zpp_inner.wrap_arbiters&&(this.zpp_inner.wrap_arbiters=qb.get(this.zpp_inner.arbiters,!0));for(var d=this.zpp_inner.wrap_arbiters.iterator();d.hasNext();){d.zpp_critical=!1;var e=d.zpp_inner.at(d.zpp_i++).zpp_inner;e.type!=F.COL||null!=
a&&e.b2!=a.zpp_inner&&e.b1!=a.zpp_inner||(c+=e.wrapper().get_collisionArbiter().rollingImpulse(this,b))}return c},buoyancyImpulse:function(a){var b=0,c=0,d=0;null==this.zpp_inner.wrap_arbiters&&(this.zpp_inner.wrap_arbiters=qb.get(this.zpp_inner.arbiters,!0));for(var e=this.zpp_inner.wrap_arbiters.iterator();e.hasNext();){e.zpp_critical=!1;var h=e.zpp_inner.at(e.zpp_i++).zpp_inner;if(h.type==F.FLUID&&(null==a||h.b2==a.zpp_inner||h.b1==a.zpp_inner)){h=h.wrapper().get_fluidArbiter().buoyancyImpulse(this);
if(null!=h&&h.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");h.zpp_inner.validate();b+=1*h.zpp_inner.x;if(null!=h&&h.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");h.zpp_inner.validate();c+=1*h.zpp_inner.y;if(null!=h&&h.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");h.zpp_inner.validate();d+=1*h.zpp_inner.z;h.dispose()}}return N.get(b,c,d)},dragImpulse:function(a){var b=0,c=0,d=0;null==this.zpp_inner.wrap_arbiters&&(this.zpp_inner.wrap_arbiters=
qb.get(this.zpp_inner.arbiters,!0));for(var e=this.zpp_inner.wrap_arbiters.iterator();e.hasNext();){e.zpp_critical=!1;var h=e.zpp_inner.at(e.zpp_i++).zpp_inner;if(h.type==F.FLUID&&(null==a||h.b2==a.zpp_inner||h.b1==a.zpp_inner)){h=h.wrapper().get_fluidArbiter().dragImpulse(this);if(null!=h&&h.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");h.zpp_inner.validate();b+=1*h.zpp_inner.x;if(null!=h&&h.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");h.zpp_inner.validate();
c+=1*h.zpp_inner.y;if(null!=h&&h.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");h.zpp_inner.validate();d+=1*h.zpp_inner.z;h.dispose()}}return N.get(b,c,d)},totalFluidImpulse:function(a){var b=0,c=0,d=0;null==this.zpp_inner.wrap_arbiters&&(this.zpp_inner.wrap_arbiters=qb.get(this.zpp_inner.arbiters,!0));for(var e=this.zpp_inner.wrap_arbiters.iterator();e.hasNext();){e.zpp_critical=!1;var h=e.zpp_inner.at(e.zpp_i++).zpp_inner;if(h.type==F.FLUID&&(null==a||h.b2==a.zpp_inner||
h.b1==a.zpp_inner)){h=h.wrapper().get_fluidArbiter().totalImpulse(this);if(null!=h&&h.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");h.zpp_inner.validate();b+=1*h.zpp_inner.x;if(null!=h&&h.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");h.zpp_inner.validate();c+=1*h.zpp_inner.y;if(null!=h&&h.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");h.zpp_inner.validate();d+=1*h.zpp_inner.z;h.dispose()}}return N.get(b,c,d)},constraintsImpulse:function(){for(var a=
0,b=0,c=0,d=this.zpp_inner.constraints.head;null!=d;){var e=d.elt.outer.bodyImpulse(this);if(null!=e&&e.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");e.zpp_inner.validate();a+=1*e.zpp_inner.x;if(null!=e&&e.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");e.zpp_inner.validate();b+=1*e.zpp_inner.y;if(null!=e&&e.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");e.zpp_inner.validate();c+=1*e.zpp_inner.z;e.dispose();d=d.next}return N.get(a,
b,c)},totalImpulse:function(a,b){null==b&&(b=!1);var c=0,d=0,e=0;null==this.zpp_inner.wrap_arbiters&&(this.zpp_inner.wrap_arbiters=qb.get(this.zpp_inner.arbiters,!0));for(var h=this.zpp_inner.wrap_arbiters.iterator();h.hasNext();){h.zpp_critical=!1;var t=h.zpp_inner.at(h.zpp_i++).zpp_inner;if(t.type!=F.SENSOR&&(null==a||t.b2==a.zpp_inner||t.b1==a.zpp_inner)){t=t.wrapper().totalImpulse(this,b);if(null!=t&&t.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");t.zpp_inner.validate();
c+=1*t.zpp_inner.x;if(null!=t&&t.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");t.zpp_inner.validate();d+=1*t.zpp_inner.y;if(null!=t&&t.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");t.zpp_inner.validate();e+=1*t.zpp_inner.z;t.dispose()}}for(h=this.zpp_inner.constraints.head;null!=h;){t=h.elt;if(t.active){t=t.outer.bodyImpulse(this);if(null!=t&&t.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");t.zpp_inner.validate();c+=
1*t.zpp_inner.x;if(null!=t&&t.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");t.zpp_inner.validate();d+=1*t.zpp_inner.y;if(null!=t&&t.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");t.zpp_inner.validate();e+=1*t.zpp_inner.z;t.dispose()}h=h.next}return N.get(c,d,e)},contains:function(a){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Cannot check containment of null point");var b=
a.zpp_inner.weak;a.zpp_inner.weak=!1;var c;c=!1;for(var d=this.zpp_inner.shapes.head;null!=d;){if(d.elt.outer.contains(a)){c=!0;break}d=d.next}a.zpp_inner.weak=b;a.zpp_inner.weak?(a.dispose(),!0):!1;return c},toString:function(){return(this.zpp_inner.world?"(space::world":"("+(2==this.zpp_inner.type?"dynamic":1==this.zpp_inner.type?"static":"kinematic"))+")#"+this.zpp_inner_i.id},__class__:ld});var Ta=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null;if(!pc.internal)throw new f("Error: Cannot instantiate BodyIterator derp!");
};Ta.__name__=!0;Ta.get=function(a){var b;null==Ta.zpp_pool?(pc.internal=!0,b=new Ta,pc.internal=!1):(b=Ta.zpp_pool,Ta.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};Ta.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=Ta.zpp_pool;Ta.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:Ta};
var Ka=function(){this.zpp_inner=null;this.zpp_inner=new pc;this.zpp_inner.outer=this};Ka.__name__=!0;Ka.fromArray=function(a){if(null==a)throw new f("Error: Cannot convert null Array to Nape list");for(var b=new Ka,c=0;c<a.length;){var d=a[c];++c;b.push(d)}return b};Ka.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},has:function(a){this.zpp_inner.valmod();
return this.zpp_inner.inner.has(a.zpp_inner)},at:function(a){this.zpp_inner.valmod();if(0>a||a>=this.get_length())throw new f("Error: Index out of bounds");this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},
push:function(a){if(this.zpp_inner.immutable)throw new f("Error: BodyList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)),
this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},unshift:function(a){if(this.zpp_inner.immutable)throw new f("Error: BodyList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=
this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)):this.zpp_inner.inner.add(a.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},pop:function(){if(this.zpp_inner.immutable)throw new f("Error: BodyList is immutable");this.zpp_inner.modify_test();if(null==this.zpp_inner.inner.head)throw new f("Error: Cannot remove from empty list");this.zpp_inner.valmod();var a=null;if(this.zpp_inner.reverse_flag){var a=this.zpp_inner.inner.head.elt,
b=a.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(b);this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),a=null==b?this.zpp_inner.inner.head.elt:b.next.elt,c=a.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(c);this.zpp_inner.dontremove||this.zpp_inner.inner.erase(b)}this.zpp_inner.invalidate();
return a.outer},shift:function(){if(this.zpp_inner.immutable)throw new f("Error: BodyList is immutable");this.zpp_inner.modify_test();if(null==this.zpp_inner.inner.head)throw new f("Error: Cannot remove from empty list");this.zpp_inner.valmod();var a=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b;b=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2);var a=null==b?this.zpp_inner.inner.head.elt:
b.next.elt,c=a.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(c);this.zpp_inner.dontremove||this.zpp_inner.inner.erase(b)}else a=this.zpp_inner.inner.head.elt,b=a.outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(b),this.zpp_inner.dontremove||this.zpp_inner.inner.pop();this.zpp_inner.invalidate();return a.outer},add:function(a){return this.zpp_inner.reverse_flag?this.push(a):this.unshift(a)},remove:function(a){if(this.zpp_inner.immutable)throw new f("Error: BodyList is immutable");
this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),this.zpp_inner.invalidate());return b},clear:function(){if(this.zpp_inner.immutable)throw new f("Error: BodyList is immutable");if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=
this.zpp_inner.inner.head;)this.shift()},empty:function(){return null==this.zpp_inner.inner.head},iterator:function(){this.zpp_inner.valmod();return Ta.get(this)},copy:function(a){null==a&&(a=!1);var b=new Ka,c;this.zpp_inner.valmod();for(c=Ta.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b.push(a?function(a){throw new f("Error: Body is not a copyable type");}(this):d)}return b},merge:function(a){if(null==a)throw new f("Error: Cannot merge with null list");a.zpp_inner.valmod();
for(a=Ta.get(a);a.hasNext();){var b;a.zpp_critical=!1;b=a.zpp_inner.at(a.zpp_i++);this.has(b)||(this.zpp_inner.reverse_flag?this.push(b):this.unshift(b))}},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=Ta.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},foreach:function(a){if(null==a)throw new f("Error: Cannot execute null on list elements");var b;this.zpp_inner.valmod();for(b=Ta.get(this);b.hasNext();)try{var c=
void 0;b.zpp_critical=!1;c=b.zpp_inner.at(b.zpp_i++);a(c)}catch(d){d instanceof f&&(d=d.val);b.zpp_next=Ta.zpp_pool;Ta.zpp_pool=b;b.zpp_inner=null;break}return this},filter:function(a){if(null==a)throw new f("Error: Cannot select elements of list with null");for(var b=0;b<this.get_length();){var c=this.at(b);try{a(c)?b++:this.remove(c)}catch(d){d instanceof f&&(d=d.val);break}}return this},__class__:Ka};var Ga=function(){if(!g.internal)throw new f("Error: Cannot instantiate BodyType derp!");};Ga.__name__=
!0;Ga.get_STATIC=function(){null==g.BodyType_STATIC&&(g.internal=!0,g.BodyType_STATIC=new Ga,g.internal=!1);return g.BodyType_STATIC};Ga.get_DYNAMIC=function(){null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new Ga,g.internal=!1);return g.BodyType_DYNAMIC};Ga.get_KINEMATIC=function(){null==g.BodyType_KINEMATIC&&(g.internal=!0,g.BodyType_KINEMATIC=new Ga,g.internal=!1);return g.BodyType_KINEMATIC};Ga.prototype={toString:function(){null==g.BodyType_STATIC&&(g.internal=!0,g.BodyType_STATIC=
new Ga,g.internal=!1);var a;this==g.BodyType_STATIC?a="STATIC":(null==g.BodyType_DYNAMIC&&(g.internal=!0,g.BodyType_DYNAMIC=new Ga,g.internal=!1),this==g.BodyType_DYNAMIC?a="DYNAMIC":(null==g.BodyType_KINEMATIC&&(g.internal=!0,g.BodyType_KINEMATIC=new Ga,g.internal=!1),a=this==g.BodyType_KINEMATIC?"KINEMATIC":""));return a},__class__:Ga};var Qe=function(){this.zpp_inner=null;Ja.zpp_internalAlloc=!0;Ja.call(this);Ja.zpp_internalAlloc=!1;this.zpp_inner=new Pe;this.zpp_inner.outer=this;this.zpp_inner.outer_i=
this;this.zpp_inner_i=this.zpp_inner;this.zpp_inner.insert_cbtype(Ha.ANY_COMPOUND.zpp_inner)};Qe.__name__=!0;Qe.__super__=Ja;Qe.prototype=I(Ja.prototype,{get_bodies:function(){return this.zpp_inner.wrap_bodies},get_constraints:function(){return this.zpp_inner.wrap_constraints},get_compounds:function(){return this.zpp_inner.wrap_compounds},get_compound:function(){return null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer},set_compound:function(a){this.zpp_inner.immutable_midstep("Compound::compound");
(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer)!=a&&(null!=(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer)&&(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer).zpp_inner.wrap_compounds.remove(this),null!=a&&a.zpp_inner.wrap_compounds.add(this));return null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer},get_space:function(){return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},set_space:function(a){if(null!=this.zpp_inner.compound)throw new f("Error: Cannot set the space of an inner Compound, only the root Compound space can be set");
this.zpp_inner.immutable_midstep("Compound::space");(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)!=a&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(null==this.zpp_inner.space?null:this.zpp_inner.space.outer).zpp_inner.wrap_compounds.remove(this),null!=a&&a.zpp_inner.wrap_compounds.add(this));return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},toString:function(){return"Compound"+this.zpp_inner_i.id},copy:function(){return this.zpp_inner.copy()},
breakApart:function(){this.zpp_inner.breakApart()},visitBodies:function(a){if(null==a)throw new f("Error: lambda cannot be null for Compound::visitBodies");for(var b=this.zpp_inner.wrap_bodies.iterator();b.hasNext();){var c;b.zpp_critical=!1;c=b.zpp_inner.at(b.zpp_i++);a(c)}for(b=this.zpp_inner.wrap_compounds.iterator();b.hasNext();)b.zpp_critical=!1,b.zpp_inner.at(b.zpp_i++).visitBodies(a)},visitConstraints:function(a){if(null==a)throw new f("Error: lambda cannot be null for Compound::visitConstraints");
for(var b=this.zpp_inner.wrap_constraints.iterator();b.hasNext();){var c;b.zpp_critical=!1;c=b.zpp_inner.at(b.zpp_i++);a(c)}for(b=this.zpp_inner.wrap_compounds.iterator();b.hasNext();)b.zpp_critical=!1,b.zpp_inner.at(b.zpp_i++).visitConstraints(a)},visitCompounds:function(a){if(null==a)throw new f("Error: lambda cannot be null for Compound::visitConstraints");for(var b=this.zpp_inner.wrap_compounds.iterator();b.hasNext();){var c;b.zpp_critical=!1;c=b.zpp_inner.at(b.zpp_i++);a(c);c.visitCompounds(a)}},
COM:function(a){null==a&&(a=!1);var b=E.get(0,0,a),c=0;this.visitBodies(function(a){if(!a.zpp_inner.wrap_shapes.empty()){b.addeq(function(b){if(a.zpp_inner.world)throw new f("Error: Space::world has no worldCOM");null==a.zpp_inner.wrap_worldCOM&&(a.zpp_inner.wrap_worldCOM=E.get(a.zpp_inner.worldCOMx,a.zpp_inner.worldCOMy,null),a.zpp_inner.wrap_worldCOM.zpp_inner._inuse=!0,a.zpp_inner.wrap_worldCOM.zpp_inner._immutable=!0,a.zpp_inner.wrap_worldCOM.zpp_inner._validate=(fa=a.zpp_inner,w(fa,fa.getworldCOM)));
return a.zpp_inner.wrap_worldCOM}(this).mul(function(b){if(a.zpp_inner.world)throw new f("Error: Space::world has no mass");a.zpp_inner.validate_mass();if(0==a.zpp_inner.massMode&&null==a.zpp_inner.shapes.head)throw new f("Error: Given current mass mode, Body::mass only makes sense if it contains shapes");return a.zpp_inner.cmass}(this),!0));if(a.zpp_inner.world)throw new f("Error: Space::world has no mass");a.zpp_inner.validate_mass();if(0==a.zpp_inner.massMode&&null==a.zpp_inner.shapes.head)throw new f("Error: Given current mass mode, Body::mass only makes sense if it contains shapes");
c+=a.zpp_inner.cmass}});if(0==c)throw new f("Error: COM of an empty Compound is undefined silly");b.muleq(1/c);return b},translate:function(a){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Cannot translate by null Vec2");var b=a.zpp_inner.weak;a.zpp_inner.weak=!1;this.visitBodies(function(b){null==b.zpp_inner.wrap_pos&&b.zpp_inner.setupPosition();b.zpp_inner.wrap_pos.addeq(a)});a.zpp_inner.weak=b;a.zpp_inner.weak?(a.dispose(),
!0):!1;return this},rotate:function(a,b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Cannot rotate about a null Vec2");if(b!=b)throw new f("Error: Cannot rotate by NaN radians");var c=a.zpp_inner.weak;a.zpp_inner.weak=!1;this.visitBodies(function(c){c.rotate(a,b)});a.zpp_inner.weak=c;a.zpp_inner.weak?(a.dispose(),!0):!1;return this},__class__:Qe});var Wb=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=
null;if(!Jc.internal)throw new f("Error: Cannot instantiate CompoundIterator derp!");};Wb.__name__=!0;Wb.get=function(a){var b;null==Wb.zpp_pool?(Jc.internal=!0,b=new Wb,Jc.internal=!1):(b=Wb.zpp_pool,Wb.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};Wb.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=Wb.zpp_pool;Wb.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=
!1;return this.zpp_inner.at(this.zpp_i++)},__class__:Wb};var Vd=function(){this.zpp_inner=null;this.zpp_inner=new Jc;this.zpp_inner.outer=this};Vd.__name__=!0;Vd.fromArray=function(a){if(null==a)throw new f("Error: Cannot convert null Array to Nape list");for(var b=new Vd,c=0;c<a.length;){var d=a[c];++c;b.push(d)}return b};Vd.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},
has:function(a){this.zpp_inner.valmod();return this.zpp_inner.inner.has(a.zpp_inner)},at:function(a){this.zpp_inner.valmod();if(0>a||a>=this.get_length())throw new f("Error: Index out of bounds");this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;
return this.zpp_inner.at_ite.elt.outer},push:function(a){if(this.zpp_inner.immutable)throw new f("Error: CompoundList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,
a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},unshift:function(a){if(this.zpp_inner.immutable)throw new f("Error: CompoundList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-
1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)):this.zpp_inner.inner.add(a.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},pop:function(){if(this.zpp_inner.immutable)throw new f("Error: CompoundList is immutable");this.zpp_inner.modify_test();if(null==this.zpp_inner.inner.head)throw new f("Error: Cannot remove from empty list");this.zpp_inner.valmod();var a=null;if(this.zpp_inner.reverse_flag){var a=
this.zpp_inner.inner.head.elt,b=a.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(b);this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),a=null==b?this.zpp_inner.inner.head.elt:b.next.elt,c=a.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(c);this.zpp_inner.dontremove||this.zpp_inner.inner.erase(b)}this.zpp_inner.invalidate();
return a.outer},shift:function(){if(this.zpp_inner.immutable)throw new f("Error: CompoundList is immutable");this.zpp_inner.modify_test();if(null==this.zpp_inner.inner.head)throw new f("Error: Cannot remove from empty list");this.zpp_inner.valmod();var a=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b;b=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2);var a=null==b?this.zpp_inner.inner.head.elt:
b.next.elt,c=a.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(c);this.zpp_inner.dontremove||this.zpp_inner.inner.erase(b)}else a=this.zpp_inner.inner.head.elt,b=a.outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(b),this.zpp_inner.dontremove||this.zpp_inner.inner.pop();this.zpp_inner.invalidate();return a.outer},add:function(a){return this.zpp_inner.reverse_flag?this.push(a):this.unshift(a)},remove:function(a){if(this.zpp_inner.immutable)throw new f("Error: CompoundList is immutable");
this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),this.zpp_inner.invalidate());return b},clear:function(){if(this.zpp_inner.immutable)throw new f("Error: CompoundList is immutable");if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=
this.zpp_inner.inner.head;)this.shift()},empty:function(){return null==this.zpp_inner.inner.head},iterator:function(){this.zpp_inner.valmod();return Wb.get(this)},copy:function(a){null==a&&(a=!1);var b=new Vd,c;this.zpp_inner.valmod();for(c=Wb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b.push(a?function(a){throw new f("Error: Compound is not a copyable type");}(this):d)}return b},merge:function(a){if(null==a)throw new f("Error: Cannot merge with null list");a.zpp_inner.valmod();
for(a=Wb.get(a);a.hasNext();){var b;a.zpp_critical=!1;b=a.zpp_inner.at(a.zpp_i++);this.has(b)||(this.zpp_inner.reverse_flag?this.push(b):this.unshift(b))}},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=Wb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},foreach:function(a){if(null==a)throw new f("Error: Cannot execute null on list elements");var b;this.zpp_inner.valmod();for(b=Wb.get(this);b.hasNext();)try{var c=
void 0;b.zpp_critical=!1;c=b.zpp_inner.at(b.zpp_i++);a(c)}catch(d){d instanceof f&&(d=d.val);b.zpp_next=Wb.zpp_pool;Wb.zpp_pool=b;b.zpp_inner=null;break}return this},filter:function(a){if(null==a)throw new f("Error: Cannot select elements of list with null");for(var b=0;b<this.get_length();){var c=this.at(b);try{a(c)?b++:this.remove(c)}catch(d){d instanceof f&&(d=d.val);break}}return this},__class__:Vd};var Md=function(a,b){null==b&&(b=1);null==a&&(a=1);this.zpp_inner=null;null==Sc.zpp_pool?this.zpp_inner=
new Sc:(this.zpp_inner=Sc.zpp_pool,Sc.zpp_pool=this.zpp_inner.next,this.zpp_inner.next=null);null;this.zpp_inner.outer=this;if(a!=1E3*this.zpp_inner.density){if(a!=a)throw new f("Error: FluidProperties::density cannot be NaN");this.zpp_inner.density=a/1E3;this.zpp_inner.invalidate()}1E3*this.zpp_inner.density;if(b!=this.zpp_inner.viscosity){if(b!=b)throw new f("Error: FluidProperties::viscosity cannot be NaN");if(0>b)throw new f("Error: FluidProperties::viscosity ("+b+") must be >= 0");this.zpp_inner.viscosity=
b/1;this.zpp_inner.invalidate()}this.zpp_inner.viscosity};Md.__name__=!0;Md.prototype={get_userData:function(){null==this.zpp_inner.userData&&(this.zpp_inner.userData={});return this.zpp_inner.userData},get_shapes:function(){null==this.zpp_inner.wrap_shapes&&(this.zpp_inner.wrap_shapes=Zc.get(this.zpp_inner.shapes,!0));return this.zpp_inner.wrap_shapes},copy:function(){var a=new Md(1E3*this.zpp_inner.density,this.zpp_inner.viscosity);null!=this.zpp_inner.userData&&(a.zpp_inner.userData=ub.copy(this.zpp_inner.userData));
a.set_gravity(this.zpp_inner.wrap_gravity);return a},get_density:function(){return 1E3*this.zpp_inner.density},set_density:function(a){if(a!=1E3*this.zpp_inner.density){if(a!=a)throw new f("Error: FluidProperties::density cannot be NaN");this.zpp_inner.density=a/1E3;this.zpp_inner.invalidate()}return 1E3*this.zpp_inner.density},get_viscosity:function(){return this.zpp_inner.viscosity},set_viscosity:function(a){if(a!=this.zpp_inner.viscosity){if(a!=a)throw new f("Error: FluidProperties::viscosity cannot be NaN");
if(0>a)throw new f("Error: FluidProperties::viscosity ("+a+") must be >= 0");this.zpp_inner.viscosity=a/1;this.zpp_inner.invalidate()}return this.zpp_inner.viscosity},get_gravity:function(){return this.zpp_inner.wrap_gravity},set_gravity:function(a){if(null==a)null!=this.zpp_inner.wrap_gravity&&(this.zpp_inner.wrap_gravity.zpp_inner._inuse=!1,this.zpp_inner.wrap_gravity.dispose(),this.zpp_inner.wrap_gravity=null);else{if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
null==this.zpp_inner.wrap_gravity&&this.zpp_inner.getgravity();this.zpp_inner.wrap_gravity.set(a)}return this.zpp_inner.wrap_gravity},toString:function(){return"{ density: "+1E3*this.zpp_inner.density+" viscosity: "+this.zpp_inner.viscosity+" gravity: "+Za.string(this.zpp_inner.wrap_gravity)+" }"},__class__:Md};var Da=function(){if(!g.internal)throw new f("Error: Cannot instantiate GravMassMode derp!");};Da.__name__=!0;Da.get_DEFAULT=function(){null==g.GravMassMode_DEFAULT&&(g.internal=!0,g.GravMassMode_DEFAULT=
new Da,g.internal=!1);return g.GravMassMode_DEFAULT};Da.get_FIXED=function(){null==g.GravMassMode_FIXED&&(g.internal=!0,g.GravMassMode_FIXED=new Da,g.internal=!1);return g.GravMassMode_FIXED};Da.get_SCALED=function(){null==g.GravMassMode_SCALED&&(g.internal=!0,g.GravMassMode_SCALED=new Da,g.internal=!1);return g.GravMassMode_SCALED};Da.prototype={toString:function(){null==g.GravMassMode_DEFAULT&&(g.internal=!0,g.GravMassMode_DEFAULT=new Da,g.internal=!1);var a;this==g.GravMassMode_DEFAULT?a="DEFAULT":
(null==g.GravMassMode_FIXED&&(g.internal=!0,g.GravMassMode_FIXED=new Da,g.internal=!1),this==g.GravMassMode_FIXED?a="FIXED":(null==g.GravMassMode_SCALED&&(g.internal=!0,g.GravMassMode_SCALED=new Da,g.internal=!1),a=this==g.GravMassMode_SCALED?"SCALED":""));return a},__class__:Da};var Cc=function(){if(!g.internal)throw new f("Error: Cannot instantiate InertiaMode derp!");};Cc.__name__=!0;Cc.get_DEFAULT=function(){null==g.InertiaMode_DEFAULT&&(g.internal=!0,g.InertiaMode_DEFAULT=new Cc,g.internal=!1);
return g.InertiaMode_DEFAULT};Cc.get_FIXED=function(){null==g.InertiaMode_FIXED&&(g.internal=!0,g.InertiaMode_FIXED=new Cc,g.internal=!1);return g.InertiaMode_FIXED};Cc.prototype={toString:function(){null==g.InertiaMode_DEFAULT&&(g.internal=!0,g.InertiaMode_DEFAULT=new Cc,g.internal=!1);var a;this==g.InertiaMode_DEFAULT?a="DEFAULT":(null==g.InertiaMode_FIXED&&(g.internal=!0,g.InertiaMode_FIXED=new Cc,g.internal=!1),a=this==g.InertiaMode_FIXED?"FIXED":"");return a},__class__:Cc};var qc=function(){this.zpp_next=
null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null;if(!od.internal)throw new f("Error: Cannot instantiate InteractorIterator derp!");};qc.__name__=!0;qc.get=function(a){var b;null==qc.zpp_pool?(od.internal=!0,b=new qc,od.internal=!1):(b=qc.zpp_pool,qc.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};qc.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=qc.zpp_pool;
qc.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:qc};var Wd=function(){this.zpp_inner=null;this.zpp_inner=new od;this.zpp_inner.outer=this};Wd.__name__=!0;Wd.fromArray=function(a){if(null==a)throw new f("Error: Cannot convert null Array to Nape list");for(var b=new Wd,c=0;c<a.length;){var d=a[c];++c;b.push(d)}return b};Wd.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=
!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},has:function(a){this.zpp_inner.valmod();return this.zpp_inner.inner.has(a.zpp_inner_i)},at:function(a){this.zpp_inner.valmod();if(0>a||a>=this.get_length())throw new f("Error: Index out of bounds");this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=
a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer_i},push:function(a){if(this.zpp_inner.immutable)throw new f("Error: InteractorList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner_i):(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-
1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner_i)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},unshift:function(a){if(this.zpp_inner.immutable)throw new f("Error: InteractorList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==
this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner_i)):this.zpp_inner.inner.add(a.zpp_inner_i),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},pop:function(){if(this.zpp_inner.immutable)throw new f("Error: InteractorList is immutable");this.zpp_inner.modify_test();if(null==this.zpp_inner.inner.head)throw new f("Error: Cannot remove from empty list");
this.zpp_inner.valmod();var a=null;if(this.zpp_inner.reverse_flag){var a=this.zpp_inner.inner.head.elt,b=a.outer_i;null!=this.zpp_inner.subber&&this.zpp_inner.subber(b);this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),a=null==b?this.zpp_inner.inner.head.elt:b.next.elt,c=a.outer_i;null!=this.zpp_inner.subber&&this.zpp_inner.subber(c);
this.zpp_inner.dontremove||this.zpp_inner.inner.erase(b)}this.zpp_inner.invalidate();return a.outer_i},shift:function(){if(this.zpp_inner.immutable)throw new f("Error: InteractorList is immutable");this.zpp_inner.modify_test();if(null==this.zpp_inner.inner.head)throw new f("Error: Cannot remove from empty list");this.zpp_inner.valmod();var a=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b;b=1==this.get_length()?
null:this.zpp_inner.inner.iterator_at(this.get_length()-2);var a=null==b?this.zpp_inner.inner.head.elt:b.next.elt,c=a.outer_i;null!=this.zpp_inner.subber&&this.zpp_inner.subber(c);this.zpp_inner.dontremove||this.zpp_inner.inner.erase(b)}else a=this.zpp_inner.inner.head.elt,b=a.outer_i,null!=this.zpp_inner.subber&&this.zpp_inner.subber(b),this.zpp_inner.dontremove||this.zpp_inner.inner.pop();this.zpp_inner.invalidate();return a.outer_i},add:function(a){return this.zpp_inner.reverse_flag?this.push(a):
this.unshift(a)},remove:function(a){if(this.zpp_inner.immutable)throw new f("Error: InteractorList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner_i){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner_i),this.zpp_inner.invalidate());return b},clear:function(){if(this.zpp_inner.immutable)throw new f("Error: InteractorList is immutable");
if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},empty:function(){return null==this.zpp_inner.inner.head},iterator:function(){this.zpp_inner.valmod();return qc.get(this)},copy:function(a){null==a&&(a=!1);var b=new Wd,c;this.zpp_inner.valmod();for(c=qc.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b.push(a?function(a){throw new f("Error: Interactor is not a copyable type");}(this):
d)}return b},merge:function(a){if(null==a)throw new f("Error: Cannot merge with null list");a.zpp_inner.valmod();for(a=qc.get(a);a.hasNext();){var b;a.zpp_critical=!1;b=a.zpp_inner.at(a.zpp_i++);this.has(b)||(this.zpp_inner.reverse_flag?this.push(b):this.unshift(b))}},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=qc.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},foreach:function(a){if(null==
a)throw new f("Error: Cannot execute null on list elements");var b;this.zpp_inner.valmod();for(b=qc.get(this);b.hasNext();)try{var c=void 0;b.zpp_critical=!1;c=b.zpp_inner.at(b.zpp_i++);a(c)}catch(d){d instanceof f&&(d=d.val);b.zpp_next=qc.zpp_pool;qc.zpp_pool=b;b.zpp_inner=null;break}return this},filter:function(a){if(null==a)throw new f("Error: Cannot select elements of list with null");for(var b=0;b<this.get_length();){var c=this.at(b);try{a(c)?b++:this.remove(c)}catch(d){d instanceof f&&(d=d.val);
break}}return this},__class__:Wd};var yb=function(){if(!g.internal)throw new f("Error: Cannot instantiate MassMode derp!");};yb.__name__=!0;yb.get_DEFAULT=function(){null==g.MassMode_DEFAULT&&(g.internal=!0,g.MassMode_DEFAULT=new yb,g.internal=!1);return g.MassMode_DEFAULT};yb.get_FIXED=function(){null==g.MassMode_FIXED&&(g.internal=!0,g.MassMode_FIXED=new yb,g.internal=!1);return g.MassMode_FIXED};yb.prototype={toString:function(){null==g.MassMode_DEFAULT&&(g.internal=!0,g.MassMode_DEFAULT=new yb,
g.internal=!1);var a;this==g.MassMode_DEFAULT?a="DEFAULT":(null==g.MassMode_FIXED&&(g.internal=!0,g.MassMode_FIXED=new yb,g.internal=!1),a=this==g.MassMode_FIXED?"FIXED":"");return a},__class__:yb};var hb=function(a,b,c,d,e){null==e&&(e=.001);null==d&&(d=1);null==c&&(c=2);null==b&&(b=1);null==a&&(a=0);this.zpp_inner=null;null==W.zpp_pool?this.zpp_inner=new W:(this.zpp_inner=W.zpp_pool,W.zpp_pool=this.zpp_inner.next,this.zpp_inner.next=null);null;this.zpp_inner.outer=this;if(a!=this.zpp_inner.elasticity){if(a!=
a)throw new f("Error: Material::elasticity cannot be NaN");this.zpp_inner.elasticity=a/1;this.zpp_inner.invalidate(W.WAKE|W.ARBITERS)}this.zpp_inner.elasticity;if(b!=this.zpp_inner.dynamicFriction){if(b!=b)throw new f("Error: Material::dynamicFriction cannot be NaN");if(0>b)throw new f("Error: Material::dynamicFriction cannot be negative");this.zpp_inner.dynamicFriction=b/1;this.zpp_inner.invalidate(W.WAKE|W.ANGDRAG|W.ARBITERS)}this.zpp_inner.dynamicFriction;if(c!=this.zpp_inner.staticFriction){if(c!=
c)throw new f("Error: Material::staticFriction cannot be NaN");if(0>c)throw new f("Error: Material::staticFriction cannot be negative");this.zpp_inner.staticFriction=c/1;this.zpp_inner.invalidate(W.WAKE|W.ARBITERS)}this.zpp_inner.staticFriction;if(d!=1E3*this.zpp_inner.density){if(d!=d)throw new f("Error: Material::density cannot be NaN");if(0>d)throw new f("Error: Material::density must be positive");if(0>d)throw new f("Error: Material::density cannot be negative");this.zpp_inner.density=d/1E3;this.zpp_inner.invalidate(W.WAKE|
W.PROPS)}1E3*this.zpp_inner.density;if(e!=this.zpp_inner.rollingFriction){if(e!=e)throw new f("Error: Material::rollingFriction cannot be NaN");if(0>e)throw new f("Error: Material::rollingFriction cannot be negative");this.zpp_inner.rollingFriction=e/1;this.zpp_inner.invalidate(W.WAKE|W.ARBITERS)}this.zpp_inner.rollingFriction};hb.__name__=!0;hb.wood=function(){return new hb(.4,.2,.38,.7,.005)};hb.steel=function(){return new hb(.2,.57,.74,7.8,.001)};hb.ice=function(){return new hb(.3,.03,.1,.9,1E-4)};
hb.rubber=function(){return new hb(.8,1,1.4,1.5,.01)};hb.glass=function(){return new hb(.4,.4,.94,2.6,.002)};hb.sand=function(){return new hb(-1,.45,.6,1.6,16)};hb.prototype={get_userData:function(){null==this.zpp_inner.userData&&(this.zpp_inner.userData={});return this.zpp_inner.userData},get_shapes:function(){null==this.zpp_inner.wrap_shapes&&(this.zpp_inner.wrap_shapes=Zc.get(this.zpp_inner.shapes,!0));return this.zpp_inner.wrap_shapes},copy:function(){var a=new hb(this.zpp_inner.elasticity,this.zpp_inner.dynamicFriction,
this.zpp_inner.staticFriction,1E3*this.zpp_inner.density,this.zpp_inner.rollingFriction);null!=this.zpp_inner.userData&&(a.zpp_inner.userData=ub.copy(this.zpp_inner.userData));return a},get_elasticity:function(){return this.zpp_inner.elasticity},set_elasticity:function(a){if(a!=this.zpp_inner.elasticity){if(a!=a)throw new f("Error: Material::elasticity cannot be NaN");this.zpp_inner.elasticity=a/1;this.zpp_inner.invalidate(W.WAKE|W.ARBITERS)}return this.zpp_inner.elasticity},get_dynamicFriction:function(){return this.zpp_inner.dynamicFriction},
set_dynamicFriction:function(a){if(a!=this.zpp_inner.dynamicFriction){if(a!=a)throw new f("Error: Material::dynamicFriction cannot be NaN");if(0>a)throw new f("Error: Material::dynamicFriction cannot be negative");this.zpp_inner.dynamicFriction=a/1;this.zpp_inner.invalidate(W.WAKE|W.ANGDRAG|W.ARBITERS)}return this.zpp_inner.dynamicFriction},get_staticFriction:function(){return this.zpp_inner.staticFriction},set_staticFriction:function(a){if(a!=this.zpp_inner.staticFriction){if(a!=a)throw new f("Error: Material::staticFriction cannot be NaN");
if(0>a)throw new f("Error: Material::staticFriction cannot be negative");this.zpp_inner.staticFriction=a/1;this.zpp_inner.invalidate(W.WAKE|W.ARBITERS)}return this.zpp_inner.staticFriction},get_density:function(){return 1E3*this.zpp_inner.density},set_density:function(a){if(a!=1E3*this.zpp_inner.density){if(a!=a)throw new f("Error: Material::density cannot be NaN");if(0>a)throw new f("Error: Material::density must be positive");if(0>a)throw new f("Error: Material::density cannot be negative");this.zpp_inner.density=
a/1E3;this.zpp_inner.invalidate(W.WAKE|W.PROPS)}return 1E3*this.zpp_inner.density},get_rollingFriction:function(){return this.zpp_inner.rollingFriction},set_rollingFriction:function(a){if(a!=this.zpp_inner.rollingFriction){if(a!=a)throw new f("Error: Material::rollingFriction cannot be NaN");if(0>a)throw new f("Error: Material::rollingFriction cannot be negative");this.zpp_inner.rollingFriction=a/1;this.zpp_inner.invalidate(W.WAKE|W.ARBITERS)}return this.zpp_inner.rollingFriction},toString:function(){return"{ elasticity: "+
this.zpp_inner.elasticity+" dynamicFriction: "+this.zpp_inner.dynamicFriction+" staticFriction: "+this.zpp_inner.staticFriction+" density: "+1E3*this.zpp_inner.density+" rollingFriction: "+this.zpp_inner.rollingFriction+" }"},__class__:hb};var Ua=function(){this.zpp_inner=null;Ja.zpp_internalAlloc=!0;Ja.call(this);Ja.zpp_internalAlloc=!1;if(!Ua.zpp_internalAlloc)throw new f("Error: Shape cannot be instantiated derp!");};Ua.__name__=!0;Ua.__super__=Ja;Ua.prototype=I(Ja.prototype,{get_type:function(){return cd.types[this.zpp_inner.type]},
isCircle:function(){return 0==this.zpp_inner.type},isPolygon:function(){return 1==this.zpp_inner.type},get_body:function(){return null!=this.zpp_inner.body?this.zpp_inner.body.outer:null},set_body:function(a){this.zpp_inner.immutable_midstep("Shape::body");(null!=this.zpp_inner.body?this.zpp_inner.body.outer:null)!=a&&(null!=this.zpp_inner.body&&(null!=this.zpp_inner.body?this.zpp_inner.body.outer:null).zpp_inner.wrap_shapes.remove(this),null!=a&&a.zpp_inner.wrap_shapes.add(this));return null!=this.zpp_inner.body?
this.zpp_inner.body.outer:null},get_castCircle:function(){return 0==this.zpp_inner.type?this.zpp_inner.circle.outer_zn:null},get_castPolygon:function(){return 1==this.zpp_inner.type?this.zpp_inner.polygon.outer_zn:null},get_worldCOM:function(){null==this.zpp_inner.wrap_worldCOM&&(this.zpp_inner.wrap_worldCOM=E.get(this.zpp_inner.worldCOMx,this.zpp_inner.worldCOMy,null),this.zpp_inner.wrap_worldCOM.zpp_inner._inuse=!0,this.zpp_inner.wrap_worldCOM.zpp_inner._immutable=!0,this.zpp_inner.wrap_worldCOM.zpp_inner._validate=
(fa=this.zpp_inner,w(fa,fa.getworldCOM)));return this.zpp_inner.wrap_worldCOM},get_localCOM:function(){null==this.zpp_inner.wrap_localCOM&&(0==this.zpp_inner.type?this.zpp_inner.circle.setupLocalCOM():this.zpp_inner.polygon.setupLocalCOM());return this.zpp_inner.wrap_localCOM},set_localCOM:function(a){this.zpp_inner.immutable_midstep("Body::localCOM");if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null!=this.zpp_inner.body&&null!=this.zpp_inner.body.space&&
1==this.zpp_inner.body.type)throw new f("Error: Cannot modify Shape belonging to a static Object once inside a Space");if(null==a)throw new f("Error: Shape::localCOM cannot be null");null==this.zpp_inner.wrap_localCOM&&(0==this.zpp_inner.type?this.zpp_inner.circle.setupLocalCOM():this.zpp_inner.polygon.setupLocalCOM());this.zpp_inner.wrap_localCOM.set(a);null==this.zpp_inner.wrap_localCOM&&(0==this.zpp_inner.type?this.zpp_inner.circle.setupLocalCOM():this.zpp_inner.polygon.setupLocalCOM());return this.zpp_inner.wrap_localCOM},
get_area:function(){this.zpp_inner.validate_area_inertia();return this.zpp_inner.area},get_inertia:function(){this.zpp_inner.validate_area_inertia();return this.zpp_inner.inertia},get_angDrag:function(){this.zpp_inner.validate_angDrag();return this.zpp_inner.angDrag},get_material:function(){return this.zpp_inner.material.wrapper()},set_material:function(a){this.zpp_inner.immutable_midstep("Shape::material");if(null==a)throw new f("Error: Cannot assign null as Shape material");this.zpp_inner.setMaterial(a.zpp_inner);
return this.zpp_inner.material.wrapper()},get_filter:function(){return this.zpp_inner.filter.wrapper()},set_filter:function(a){this.zpp_inner.immutable_midstep("Shape::filter");if(null==a)throw new f("Error: Cannot assign null as Shape filter");this.zpp_inner.setFilter(a.zpp_inner);return this.zpp_inner.filter.wrapper()},get_fluidProperties:function(){this.zpp_inner.immutable_midstep("Shape::fluidProperties");null==this.zpp_inner.fluidProperties&&this.zpp_inner.setFluid((new Md).zpp_inner);return this.zpp_inner.fluidProperties.wrapper()},
set_fluidProperties:function(a){if(null==a)throw new f("Error: Cannot assign null as Shape fluidProperties, disable fluids by setting fluidEnabled to false");this.zpp_inner.setFluid(a.zpp_inner);this.zpp_inner.immutable_midstep("Shape::fluidProperties");null==this.zpp_inner.fluidProperties&&this.zpp_inner.setFluid((new Md).zpp_inner);return this.zpp_inner.fluidProperties.wrapper()},get_fluidEnabled:function(){return this.zpp_inner.fluidEnabled},set_fluidEnabled:function(a){this.zpp_inner.immutable_midstep("Shape::fluidEnabled");
(this.zpp_inner.fluidEnabled=a)&&null==this.zpp_inner.fluidProperties&&this.set_fluidProperties(new Md);this.zpp_inner.wake();return this.zpp_inner.fluidEnabled},get_sensorEnabled:function(){return this.zpp_inner.sensorEnabled},set_sensorEnabled:function(a){this.zpp_inner.immutable_midstep("Shape::sensorEnabled");this.zpp_inner.sensorEnabled=a;this.zpp_inner.wake();return this.zpp_inner.sensorEnabled},get_bounds:function(){return this.zpp_inner.aabb.wrapper()},translate:function(a){this.zpp_inner.immutable_midstep("Shape::translate()");
if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null!=this.zpp_inner.body&&null!=this.zpp_inner.body.space&&1==this.zpp_inner.body.type)throw new f("Error: Cannot modify Shape belonging to a static Object once inside a Space");if(null==a)throw new f("Error: Cannot displace Shape by null Vec2");0<a.lsq()&&(0==this.zpp_inner.type?this.zpp_inner.circle.__translate(function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.x}(this),function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this)):this.zpp_inner.polygon.__translate(function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this),function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();
return a.zpp_inner.y}(this)));a.zpp_inner.weak?(a.dispose(),!0):!1;return this},scale:function(a,b){this.zpp_inner.immutable_midstep("Shape::scale()");if(null!=this.zpp_inner.body&&null!=this.zpp_inner.body.space&&1==this.zpp_inner.body.type)throw new f("Error: Cannot modify Shape belonging to a static Object once inside a Space");if(a!=a||b!=b)throw new f("Error: Cannot scale Shape by NaN");if(0==a||0==b)throw new f("Error: Cannot Scale shape by a factor of 0");if(0==this.zpp_inner.type){var c=a*
a-b*b;if(c*c<u.epsilon*u.epsilon)this.zpp_inner.circle.__scale(a,b);else throw new f("Error: Cannot perform a non equal scaling on a Circle");}else this.zpp_inner.polygon.__scale(a,b);return this},rotate:function(a){this.zpp_inner.immutable_midstep("Shape::rotate()");if(null!=this.zpp_inner.body&&null!=this.zpp_inner.body.space&&1==this.zpp_inner.body.type)throw new f("Error: Cannot modify Shape belonging to a static Object once inside a Space");if(a!=a)throw new f("Error: Cannot rotate Shape by NaN");
if(0!=a%(2*Math.PI)){var b=Math.cos(a);a=Math.sin(a);0==this.zpp_inner.type?this.zpp_inner.circle.__rotate(a,b):this.zpp_inner.polygon.__rotate(a,b)}return this},transform:function(a){this.zpp_inner.immutable_midstep("Shape::transform()");if(null!=this.zpp_inner.body&&null!=this.zpp_inner.body.space&&1==this.zpp_inner.body.type)throw new f("Error: Cannot modify Shape belonging to a static Object once inside a Space");if(null==a)throw new f("Error: Cannot transform Shape by null matrix");if(a.singular())throw new f("Error: Cannot transform Shape by a singular matrix");
if(0==this.zpp_inner.type)if(a.equiorthogonal())this.zpp_inner.circle.__transform(a);else throw new f("Error: Cannot transform Circle by a non equiorthogonal matrix");else this.zpp_inner.polygon.__transform(a);return this},contains:function(a){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Cannot check null point for containment");if(null==(null!=this.zpp_inner.body?this.zpp_inner.body.outer:null))throw new f("Error: Shape is not well defined without a Body");
Pf.validateShape(this.zpp_inner);a.zpp_inner.validate();var b=C.shapeContains(this.zpp_inner,a.zpp_inner);a.zpp_inner.weak?(a.dispose(),!0):!1;return b},copy:function(){return this.zpp_inner.copy()},toString:function(){return(0==this.zpp_inner.type?"Circle":"Polygon")+"#"+this.zpp_inner_i.id},__class__:Ua});var Gd=function(a,b,c,d){this.zpp_inner_zn=null;Ua.zpp_internalAlloc=!0;Ua.call(this);Ua.zpp_internalAlloc=!1;this.zpp_inner_zn=new Re;this.zpp_inner_zn.outer=this;this.zpp_inner_zn.outer_zn=this;
this.zpp_inner_i=this.zpp_inner=this.zpp_inner_zn;this.zpp_inner_i.outer_i=this;this.zpp_inner.immutable_midstep("Circle::radius");if(null!=this.zpp_inner.body&&1==this.zpp_inner.body.type&&null!=this.zpp_inner.body.space)throw new f("Error: Cannot modifiy radius of Circle contained in static object once added to space");if(a!=this.zpp_inner_zn.radius){if(a!=a)throw new f("Error: Circle::radius cannot be NaN");if(a<u.epsilon)throw new f("Error: Circle::radius ("+a+") must be > Config.epsilon");if(1E100<
a)throw new f("Error: Circle::radius ("+a+") must be < PR(Const).FMAX");this.zpp_inner_zn.radius=a;this.zpp_inner_zn.invalidate_radius()}this.zpp_inner_zn.radius;if(null==b)this.zpp_inner.localCOMx=0,this.zpp_inner.localCOMy=0;else{if(null!=b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null!=b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");b.zpp_inner.validate();this.zpp_inner.localCOMx=b.zpp_inner.x;if(null!=b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
b.zpp_inner.validate();this.zpp_inner.localCOMy=b.zpp_inner.y;b.zpp_inner.weak?(b.dispose(),!0):!1}if(null==c)null==W.zpp_pool?this.zpp_inner.material=new W:(this.zpp_inner.material=W.zpp_pool,W.zpp_pool=this.zpp_inner.material.next,this.zpp_inner.material.next=null),null;else{this.zpp_inner.immutable_midstep("Shape::material");if(null==c)throw new f("Error: Cannot assign null as Shape material");this.zpp_inner.setMaterial(c.zpp_inner);this.zpp_inner.material.wrapper()}if(null==d)null==za.zpp_pool?
this.zpp_inner.filter=new za:(this.zpp_inner.filter=za.zpp_pool,za.zpp_pool=this.zpp_inner.filter.next,this.zpp_inner.filter.next=null),null;else{this.zpp_inner.immutable_midstep("Shape::filter");if(null==d)throw new f("Error: Cannot assign null as Shape filter");this.zpp_inner.setFilter(d.zpp_inner);this.zpp_inner.filter.wrapper()}this.zpp_inner_i.insert_cbtype(Ha.ANY_SHAPE.zpp_inner)};Gd.__name__=!0;Gd.__super__=Ua;Gd.prototype=I(Ua.prototype,{get_radius:function(){return this.zpp_inner_zn.radius},
set_radius:function(a){this.zpp_inner.immutable_midstep("Circle::radius");if(null!=this.zpp_inner.body&&1==this.zpp_inner.body.type&&null!=this.zpp_inner.body.space)throw new f("Error: Cannot modifiy radius of Circle contained in static object once added to space");if(a!=this.zpp_inner_zn.radius){if(a!=a)throw new f("Error: Circle::radius cannot be NaN");if(a<u.epsilon)throw new f("Error: Circle::radius ("+a+") must be > Config.epsilon");if(1E100<a)throw new f("Error: Circle::radius ("+a+") must be < PR(Const).FMAX");
this.zpp_inner_zn.radius=a;this.zpp_inner_zn.invalidate_radius()}return this.zpp_inner_zn.radius},__class__:Gd});var pf=function(){this.zpp_inner=null;if(!Ca.internal)throw new f("Error: Cannot instantiate an Edge derp!");};pf.__name__=!0;pf.prototype={get_polygon:function(){if(null==this.zpp_inner.polygon)throw new f("Error: Edge not current in use");return this.zpp_inner.polygon.outer_zn},get_localNormal:function(){if(null==this.zpp_inner.polygon)throw new f("Error: Edge not current in use");null==
this.zpp_inner.wrap_lnorm&&this.zpp_inner.getlnorm();return this.zpp_inner.wrap_lnorm},get_worldNormal:function(){if(null==this.zpp_inner.polygon)throw new f("Error: Edge not current in use");null==this.zpp_inner.wrap_gnorm&&this.zpp_inner.getgnorm();return this.zpp_inner.wrap_gnorm},get_length:function(){if(null==this.zpp_inner.polygon)throw new f("Error: Edge not current in use");this.zpp_inner.polygon.validate_laxi();return this.zpp_inner.length},get_localProjection:function(){if(null==this.zpp_inner.polygon)throw new f("Error: Edge not current in use");
this.zpp_inner.polygon.validate_laxi();return this.zpp_inner.lprojection},get_worldProjection:function(){if(null==this.zpp_inner.polygon)throw new f("Error: Edge not current in use");if(null==this.zpp_inner.polygon.body)throw new f("Error: Edge world projection only makes sense for Polygons contained within a rigid body");this.zpp_inner.polygon.validate_gaxi();return this.zpp_inner.gprojection},get_localVertex1:function(){if(null==this.zpp_inner.polygon)throw new f("Error: Edge not current in use");
this.zpp_inner.polygon.validate_laxi();return this.zpp_inner.lp0.wrapper()},get_localVertex2:function(){if(null==this.zpp_inner.polygon)throw new f("Error: Edge not current in use");this.zpp_inner.polygon.validate_laxi();return this.zpp_inner.lp1.wrapper()},get_worldVertex1:function(){if(null==this.zpp_inner.polygon)throw new f("Error: Edge not current in use");this.zpp_inner.polygon.validate_gaxi();return this.zpp_inner.gp0.wrapper()},get_worldVertex2:function(){if(null==this.zpp_inner.polygon)throw new f("Error: Edge not current in use");
this.zpp_inner.polygon.validate_gaxi();return this.zpp_inner.gp1.wrapper()},toString:function(){if(null==this.zpp_inner.polygon)return"Edge(object-pooled)";if(null==this.zpp_inner.polygon.body)return this.zpp_inner.polygon.validate_laxi(),"{ localNormal : "+("{ x: "+this.zpp_inner.lnormx+" y: "+this.zpp_inner.lnormy+" }")+" }";this.zpp_inner.polygon.validate_gaxi();return"{ localNormal : "+("{ x: "+this.zpp_inner.lnormx+" y: "+this.zpp_inner.lnormy+" }")+" worldNormal : "+("{ x: "+this.zpp_inner.gnormx+
" y: "+this.zpp_inner.gnormy+" }")+" }"},__class__:pf};var sb=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null;if(!hd.internal)throw new f("Error: Cannot instantiate EdgeIterator derp!");};sb.__name__=!0;sb.get=function(a){var b;null==sb.zpp_pool?(hd.internal=!0,b=new sb,hd.internal=!1):(b=sb.zpp_pool,sb.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};sb.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var a=this.zpp_inner.get_length();
this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=sb.zpp_pool;sb.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:sb};var Xd=function(){this.zpp_inner=null;this.zpp_inner=new hd;this.zpp_inner.outer=this};Xd.__name__=!0;Xd.fromArray=function(a){if(null==a)throw new f("Error: Cannot convert null Array to Nape list");for(var b=new Xd,c=0;c<a.length;){var d=a[c];++c;b.push(d)}return b};Xd.prototype={get_length:function(){this.zpp_inner.valmod();
this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},has:function(a){this.zpp_inner.valmod();return this.zpp_inner.inner.has(a.zpp_inner)},at:function(a){this.zpp_inner.valmod();if(0>a||a>=this.get_length())throw new f("Error: Index out of bounds");this.zpp_inner.reverse_flag&&a!=this.get_length()-1&&(a=this.get_length()-2-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=
a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.wrapper()},push:function(a){if(this.zpp_inner.immutable)throw new f("Error: EdgeList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&
(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},unshift:function(a){if(this.zpp_inner.immutable)throw new f("Error: EdgeList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):
!0)this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)):this.zpp_inner.inner.add(a.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},pop:function(){if(this.zpp_inner.immutable)throw new f("Error: EdgeList is immutable");this.zpp_inner.modify_test();
if(null==this.zpp_inner.inner.head)throw new f("Error: Cannot remove from empty list");this.zpp_inner.valmod();var a=null;if(this.zpp_inner.reverse_flag){var a=this.zpp_inner.inner.head.elt,b=a.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(b);this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),a=null==
b?this.zpp_inner.inner.head.elt:b.next.elt,c=a.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(c);this.zpp_inner.dontremove||this.zpp_inner.inner.erase(b)}this.zpp_inner.invalidate();return a.wrapper()},shift:function(){if(this.zpp_inner.immutable)throw new f("Error: EdgeList is immutable");this.zpp_inner.modify_test();if(null==this.zpp_inner.inner.head)throw new f("Error: Cannot remove from empty list");this.zpp_inner.valmod();var a=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&
null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b;b=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2);var a=null==b?this.zpp_inner.inner.head.elt:b.next.elt,c=a.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(c);this.zpp_inner.dontremove||this.zpp_inner.inner.erase(b)}else a=this.zpp_inner.inner.head.elt,b=a.wrapper(),null!=this.zpp_inner.subber&&this.zpp_inner.subber(b),this.zpp_inner.dontremove||this.zpp_inner.inner.pop();this.zpp_inner.invalidate();
return a.wrapper()},add:function(a){return this.zpp_inner.reverse_flag?this.push(a):this.unshift(a)},remove:function(a){if(this.zpp_inner.immutable)throw new f("Error: EdgeList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),this.zpp_inner.invalidate());return b},
clear:function(){if(this.zpp_inner.immutable)throw new f("Error: EdgeList is immutable");if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},empty:function(){return null==this.zpp_inner.inner.head},iterator:function(){this.zpp_inner.valmod();return sb.get(this)},copy:function(a){null==a&&(a=!1);var b=new Xd,c;this.zpp_inner.valmod();for(c=sb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);
b.push(a?function(a){throw new f("Error: Edge is not a copyable type");}(this):d)}return b},merge:function(a){if(null==a)throw new f("Error: Cannot merge with null list");a.zpp_inner.valmod();for(a=sb.get(a);a.hasNext();){var b;a.zpp_critical=!1;b=a.zpp_inner.at(a.zpp_i++);this.has(b)||(this.zpp_inner.reverse_flag?this.push(b):this.unshift(b))}},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=sb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=
",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},foreach:function(a){if(null==a)throw new f("Error: Cannot execute null on list elements");var b;this.zpp_inner.valmod();for(b=sb.get(this);b.hasNext();)try{var c=void 0;b.zpp_critical=!1;c=b.zpp_inner.at(b.zpp_i++);a(c)}catch(d){d instanceof f&&(d=d.val);b.zpp_next=sb.zpp_pool;sb.zpp_pool=b;b.zpp_inner=null;break}return this},filter:function(a){if(null==a)throw new f("Error: Cannot select elements of list with null");for(var b=0;b<this.get_length();){var c=
this.at(b);try{a(c)?b++:this.remove(c)}catch(d){d instanceof f&&(d=d.val);break}}return this},__class__:Xd};var Ea=function(a,b,c){this.zpp_inner_zn=null;Ua.zpp_internalAlloc=!0;Ua.call(this);Ua.zpp_internalAlloc=!1;if(null==a)throw new f("Error: localVerts cannot be null");this.zpp_inner_zn=new Se;this.zpp_inner_zn.outer=this;this.zpp_inner_zn.outer_zn=this;this.zpp_inner_i=this.zpp_inner=this.zpp_inner_zn;this.zpp_inner_i.outer_i=this;if(a instanceof Array&&null==a.__enum__)for(var d=0;d<a.length;){var e=
a[d];++d;if(null==e)throw new f("Error: Array<Vec2> contains null objects");if(!ca.__instanceof(e,E))throw new f("Error: Array<Vec2> contains non Vec2 objects");var h=e;if(null!=h&&h.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");null==this.zpp_inner_zn.wrap_lverts&&this.zpp_inner_zn.getlverts();this.zpp_inner_zn.wrap_lverts.push(function(a){if(null!=h&&h.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");return E.get(function(a){if(null!=h&&h.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
h.zpp_inner.validate();return h.zpp_inner.x}(a),function(a){if(null!=h&&h.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");h.zpp_inner.validate();return h.zpp_inner.y}(a),!1)}(this))}else if(ca.__instanceof(a,Ac))for(d=a.iterator();d.hasNext();){var t;d.zpp_critical=!1;t=d.zpp_inner.at(d.zpp_i++);if(null==t)throw new f("Error: Vec2List contains null objects");if(null!=t&&t.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");null==this.zpp_inner_zn.wrap_lverts&&
this.zpp_inner_zn.getlverts();this.zpp_inner_zn.wrap_lverts.push(function(a){if(null!=t&&t.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");return E.get(function(a){if(null!=t&&t.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");t.zpp_inner.validate();return t.zpp_inner.x}(a),function(a){if(null!=t&&t.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");t.zpp_inner.validate();return t.zpp_inner.y}(a),!1)}(this))}else if(ca.__instanceof(a,
Ic)){if(null!=a&&a.zpp_disp)throw new f("Error: GeomPoly has been disposed and cannot be used!");d=a.zpp_inner.vertices;if(null!=d){e=d;do{var q=E.get(e.x,e.y,null),e=e.next;null==this.zpp_inner_zn.wrap_lverts&&this.zpp_inner_zn.getlverts();this.zpp_inner_zn.wrap_lverts.push(function(a){if(null!=q&&q.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");return E.get(function(a){if(null!=q&&q.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");q.zpp_inner.validate();
return q.zpp_inner.x}(a),function(a){if(null!=q&&q.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");q.zpp_inner.validate();return q.zpp_inner.y}(a),!1)}(this));q.dispose()}while(e!=d)}}else throw new f("Error: Invalid type for polygon object, should be Array<Vec2>, Vec2List, GeomPoly or for flash10+ flash.Vector<Vec2>");if(a instanceof Array&&null==a.__enum__)for(d=0;d<a.length;){var e=a[d],g;if(g=e.zpp_inner.weak)e.dispose(),g=!0;g?a.splice(d,1):d++}else if(ca.__instanceof(a,
Ac))for(null!=a.zpp_inner._validate&&a.zpp_inner._validate(),a=a.zpp_inner.inner,d=null,e=a.head;null!=e;)g=e.elt,g.outer.zpp_inner.weak?(e=a.erase(d),g.outer.zpp_inner.weak?(g.outer.dispose(),!0):!1):(d=e,e=e.next);if(null==b)null==W.zpp_pool?this.zpp_inner.material=new W:(this.zpp_inner.material=W.zpp_pool,W.zpp_pool=this.zpp_inner.material.next,this.zpp_inner.material.next=null),null;else{this.zpp_inner.immutable_midstep("Shape::material");if(null==b)throw new f("Error: Cannot assign null as Shape material");
this.zpp_inner.setMaterial(b.zpp_inner);this.zpp_inner.material.wrapper()}if(null==c)null==za.zpp_pool?this.zpp_inner.filter=new za:(this.zpp_inner.filter=za.zpp_pool,za.zpp_pool=this.zpp_inner.filter.next,this.zpp_inner.filter.next=null),null;else{this.zpp_inner.immutable_midstep("Shape::filter");if(null==c)throw new f("Error: Cannot assign null as Shape filter");this.zpp_inner.setFilter(c.zpp_inner);this.zpp_inner.filter.wrapper()}this.zpp_inner_i.insert_cbtype(Ha.ANY_SHAPE.zpp_inner)};Ea.__name__=
!0;Ea.rect=function(a,b,c,d,e){null==e&&(e=!1);if(a!=a||b!=b||c!=c||d!=d)throw new f("Error: Polygon.rect cannot accept NaN arguments");return[E.get(a,b,e),E.get(a+c,b,e),E.get(a+c,b+d,e),E.get(a,b+d,e)]};Ea.box=function(a,b,c){null==c&&(c=!1);if(a!=a||b!=b)throw new f("Error: Polygon.box cannot accept NaN arguments");return Ea.rect(-a/2,-b/2,a,b,c)};Ea.regular=function(a,b,c,d,e){null==e&&(e=!1);null==d&&(d=0);if(a!=a||b!=b||d!=d)throw new f("Error: Polygon.regular cannot accept NaN arguments");
for(var h=[],t=2*Math.PI/c,q=0;q<c;){var g=q++*t+d,g=E.get(Math.cos(g)*a,Math.sin(g)*b,e);h.push(g)}return h};Ea.__super__=Ua;Ea.prototype=I(Ua.prototype,{get_localVerts:function(){null==this.zpp_inner_zn.wrap_lverts&&this.zpp_inner_zn.getlverts();return this.zpp_inner_zn.wrap_lverts},get_worldVerts:function(){null==this.zpp_inner_zn.wrap_gverts&&this.zpp_inner_zn.getgverts();return this.zpp_inner_zn.wrap_gverts},get_edges:function(){null==this.zpp_inner_zn.wrap_edges&&this.zpp_inner_zn.getedges();
return this.zpp_inner_zn.wrap_edges},validity:function(){return this.zpp_inner_zn.valid()},__class__:Ea});var zb=function(){this.zpp_next=null;this.zpp_critical=!1;this.zpp_i=0;this.zpp_inner=null;if(!Zc.internal)throw new f("Error: Cannot instantiate ShapeIterator derp!");};zb.__name__=!0;zb.get=function(a){var b;null==zb.zpp_pool?(Zc.internal=!0,b=new zb,Zc.internal=!1):(b=zb.zpp_pool,zb.zpp_pool=b.zpp_next);b.zpp_i=0;b.zpp_inner=a;b.zpp_critical=!1;return b};zb.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();
var a=this.zpp_inner.get_length();this.zpp_critical=!0;if(this.zpp_i<a)return!0;this.zpp_next=zb.zpp_pool;zb.zpp_pool=this;this.zpp_inner=null;return!1},next:function(){this.zpp_critical=!1;return this.zpp_inner.at(this.zpp_i++)},__class__:zb};var Ab=function(){this.zpp_inner=null;this.zpp_inner=new Zc;this.zpp_inner.outer=this};Ab.__name__=!0;Ab.fromArray=function(a){if(null==a)throw new f("Error: Cannot convert null Array to Nape list");for(var b=new Ab,c=0;c<a.length;){var d=a[c];++c;b.push(d)}return b};
Ab.prototype={get_length:function(){this.zpp_inner.valmod();this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length);return this.zpp_inner.user_length},has:function(a){this.zpp_inner.valmod();return this.zpp_inner.inner.has(a.zpp_inner)},at:function(a){this.zpp_inner.valmod();if(0>a||a>=this.get_length())throw new f("Error: Index out of bounds");this.zpp_inner.reverse_flag&&(a=this.get_length()-1-a);if(a<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=
a,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(a);else for(;this.zpp_inner.at_index!=a;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},push:function(a){if(this.zpp_inner.immutable)throw new f("Error: ShapeList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):!0)this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(a.zpp_inner):(null==this.zpp_inner.push_ite&&
(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},unshift:function(a){if(this.zpp_inner.immutable)throw new f("Error: ShapeList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):
!0)this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(this.zpp_inner.push_ite=null==this.zpp_inner.inner.head?null:this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,a.zpp_inner)):this.zpp_inner.inner.add(a.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a);return b},pop:function(){if(this.zpp_inner.immutable)throw new f("Error: ShapeList is immutable");this.zpp_inner.modify_test();
if(null==this.zpp_inner.inner.head)throw new f("Error: Cannot remove from empty list");this.zpp_inner.valmod();var a=null;if(this.zpp_inner.reverse_flag){var a=this.zpp_inner.inner.head.elt,b=a.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(b);this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),a=null==b?
this.zpp_inner.inner.head.elt:b.next.elt,c=a.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(c);this.zpp_inner.dontremove||this.zpp_inner.inner.erase(b)}this.zpp_inner.invalidate();return a.outer},shift:function(){if(this.zpp_inner.immutable)throw new f("Error: ShapeList is immutable");this.zpp_inner.modify_test();if(null==this.zpp_inner.inner.head)throw new f("Error: Cannot remove from empty list");this.zpp_inner.valmod();var a=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&
null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var b;b=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2);var a=null==b?this.zpp_inner.inner.head.elt:b.next.elt,c=a.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(c);this.zpp_inner.dontremove||this.zpp_inner.inner.erase(b)}else a=this.zpp_inner.inner.head.elt,b=a.outer,null!=this.zpp_inner.subber&&this.zpp_inner.subber(b),this.zpp_inner.dontremove||this.zpp_inner.inner.pop();this.zpp_inner.invalidate();
return a.outer},add:function(a){return this.zpp_inner.reverse_flag?this.push(a):this.unshift(a)},remove:function(a){if(this.zpp_inner.immutable)throw new f("Error: ShapeList is immutable");this.zpp_inner.modify_test();this.zpp_inner.valmod();var b;b=!1;for(var c=this.zpp_inner.inner.head;null!=c;){if(c.elt==a.zpp_inner){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(a.zpp_inner),this.zpp_inner.invalidate());return b},
clear:function(){if(this.zpp_inner.immutable)throw new f("Error: ShapeList is immutable");if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},empty:function(){return null==this.zpp_inner.inner.head},iterator:function(){this.zpp_inner.valmod();return zb.get(this)},copy:function(a){null==a&&(a=!1);var b=new Ab,c;this.zpp_inner.valmod();for(c=zb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);
b.push(a?function(a){throw new f("Error: Shape is not a copyable type");}(this):d)}return b},merge:function(a){if(null==a)throw new f("Error: Cannot merge with null list");a.zpp_inner.valmod();for(a=zb.get(a);a.hasNext();){var b;a.zpp_critical=!1;b=a.zpp_inner.at(a.zpp_i++);this.has(b)||(this.zpp_inner.reverse_flag?this.push(b):this.unshift(b))}},toString:function(){var a="[",b=!0,c;this.zpp_inner.valmod();for(c=zb.get(this);c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);b||(a+=
",");a=null==d?a+"NULL":a+d.toString();b=!1}return a+"]"},foreach:function(a){if(null==a)throw new f("Error: Cannot execute null on list elements");var b;this.zpp_inner.valmod();for(b=zb.get(this);b.hasNext();)try{var c=void 0;b.zpp_critical=!1;c=b.zpp_inner.at(b.zpp_i++);a(c)}catch(d){d instanceof f&&(d=d.val);b.zpp_next=zb.zpp_pool;zb.zpp_pool=b;b.zpp_inner=null;break}return this},filter:function(a){if(null==a)throw new f("Error: Cannot select elements of list with null");for(var b=0;b<this.get_length();){var c=
this.at(b);try{a(c)?b++:this.remove(c)}catch(d){d instanceof f&&(d=d.val);break}}return this},__class__:Ab};var Tc=function(){if(!g.internal)throw new f("Error: Cannot instantiate ShapeType derp!");};Tc.__name__=!0;Tc.get_CIRCLE=function(){null==g.ShapeType_CIRCLE&&(g.internal=!0,g.ShapeType_CIRCLE=new Tc,g.internal=!1);return g.ShapeType_CIRCLE};Tc.get_POLYGON=function(){null==g.ShapeType_POLYGON&&(g.internal=!0,g.ShapeType_POLYGON=new Tc,g.internal=!1);return g.ShapeType_POLYGON};Tc.prototype={toString:function(){null==
g.ShapeType_CIRCLE&&(g.internal=!0,g.ShapeType_CIRCLE=new Tc,g.internal=!1);var a;this==g.ShapeType_CIRCLE?a="CIRCLE":(null==g.ShapeType_POLYGON&&(g.internal=!0,g.ShapeType_POLYGON=new Tc,g.internal=!1),a=this==g.ShapeType_POLYGON?"POLYGON":"");return a},__class__:Tc};var xa=function(){if(!g.internal)throw new f("Error: Cannot instantiate ValidationResult derp!");};xa.__name__=!0;xa.get_VALID=function(){null==g.ValidationResult_VALID&&(g.internal=!0,g.ValidationResult_VALID=new xa,g.internal=!1);
return g.ValidationResult_VALID};xa.get_DEGENERATE=function(){null==g.ValidationResult_DEGENERATE&&(g.internal=!0,g.ValidationResult_DEGENERATE=new xa,g.internal=!1);return g.ValidationResult_DEGENERATE};xa.get_CONCAVE=function(){null==g.ValidationResult_CONCAVE&&(g.internal=!0,g.ValidationResult_CONCAVE=new xa,g.internal=!1);return g.ValidationResult_CONCAVE};xa.get_SELF_INTERSECTING=function(){null==g.ValidationResult_SELF_INTERSECTING&&(g.internal=!0,g.ValidationResult_SELF_INTERSECTING=new xa,
g.internal=!1);return g.ValidationResult_SELF_INTERSECTING};xa.prototype={toString:function(){null==g.ValidationResult_VALID&&(g.internal=!0,g.ValidationResult_VALID=new xa,g.internal=!1);var a;this==g.ValidationResult_VALID?a="VALID":(null==g.ValidationResult_DEGENERATE&&(g.internal=!0,g.ValidationResult_DEGENERATE=new xa,g.internal=!1),this==g.ValidationResult_DEGENERATE?a="DEGENERATE":(null==g.ValidationResult_CONCAVE&&(g.internal=!0,g.ValidationResult_CONCAVE=new xa,g.internal=!1),this==g.ValidationResult_CONCAVE?
a="CONCAVE":(null==g.ValidationResult_SELF_INTERSECTING&&(g.internal=!0,g.ValidationResult_SELF_INTERSECTING=new xa,g.internal=!1),a=this==g.ValidationResult_SELF_INTERSECTING?"SELF_INTERSECTING":"")));return a},__class__:xa};var dd=function(){if(!g.internal)throw new f("Error: Cannot instantiate Broadphase derp!");};dd.__name__=!0;dd.get_DYNAMIC_AABB_TREE=function(){null==g.Broadphase_DYNAMIC_AABB_TREE&&(g.internal=!0,g.Broadphase_DYNAMIC_AABB_TREE=new dd,g.internal=!1);return g.Broadphase_DYNAMIC_AABB_TREE};
dd.get_SWEEP_AND_PRUNE=function(){null==g.Broadphase_SWEEP_AND_PRUNE&&(g.internal=!0,g.Broadphase_SWEEP_AND_PRUNE=new dd,g.internal=!1);return g.Broadphase_SWEEP_AND_PRUNE};dd.prototype={toString:function(){null==g.Broadphase_DYNAMIC_AABB_TREE&&(g.internal=!0,g.Broadphase_DYNAMIC_AABB_TREE=new dd,g.internal=!1);var a;this==g.Broadphase_DYNAMIC_AABB_TREE?a="DYNAMIC_AABB_TREE":(null==g.Broadphase_SWEEP_AND_PRUNE&&(g.internal=!0,g.Broadphase_SWEEP_AND_PRUNE=new dd,g.internal=!1),a=this==g.Broadphase_SWEEP_AND_PRUNE?
"SWEEP_AND_PRUNE":"");return a},__class__:dd};var rf=function(a,b){this.zpp_inner=null;if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");this.zpp_inner=new qf(null==a?null:a.zpp_inner,b);this.zpp_inner.outer=this;null!=a&&(a.zpp_inner.weak?(a.dispose(),!0):!1)};rf.__name__=!0;rf.prototype={get_userData:function(){null==this.zpp_inner.userData&&(this.zpp_inner.userData={});return this.zpp_inner.userData},get_gravity:function(){null==this.zpp_inner.wrap_gravity&&
this.zpp_inner.getgravity();return this.zpp_inner.wrap_gravity},set_gravity:function(a){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Space::gravity cannot be null");null==this.zpp_inner.wrap_gravity&&this.zpp_inner.getgravity();this.zpp_inner.wrap_gravity.set(a);null==this.zpp_inner.wrap_gravity&&this.zpp_inner.getgravity();return this.zpp_inner.wrap_gravity},get_broadphase:function(){if(this.zpp_inner.bphase.is_sweep)return null==
g.Broadphase_SWEEP_AND_PRUNE&&(g.internal=!0,g.Broadphase_SWEEP_AND_PRUNE=new dd,g.internal=!1),g.Broadphase_SWEEP_AND_PRUNE;null==g.Broadphase_DYNAMIC_AABB_TREE&&(g.internal=!0,g.Broadphase_DYNAMIC_AABB_TREE=new dd,g.internal=!1);return g.Broadphase_DYNAMIC_AABB_TREE},get_sortContacts:function(){return this.zpp_inner.sortcontacts},set_sortContacts:function(a){this.zpp_inner.sortcontacts=a;return this.zpp_inner.sortcontacts},get_worldAngularDrag:function(){return this.zpp_inner.global_ang_drag},set_worldAngularDrag:function(a){if(a!=
a)throw new f("Error: Space::worldAngularDrag cannot be NaN");this.zpp_inner.global_ang_drag=a;return this.zpp_inner.global_ang_drag},get_worldLinearDrag:function(){return this.zpp_inner.global_lin_drag},set_worldLinearDrag:function(a){if(a!=a)throw new f("Error: Space::worldLinearDrag cannot be NaN");this.zpp_inner.global_lin_drag=a;return this.zpp_inner.global_lin_drag},get_compounds:function(){return this.zpp_inner.wrap_compounds},get_bodies:function(){return this.zpp_inner.wrap_bodies},get_liveBodies:function(){return this.zpp_inner.wrap_live},
get_constraints:function(){return this.zpp_inner.wrap_constraints},get_liveConstraints:function(){return this.zpp_inner.wrap_livecon},visitBodies:function(a){if(null==a)throw new f("Error: lambda cannot be null for Space::visitBodies");for(var b=this.zpp_inner.wrap_bodies.iterator();b.hasNext();){var c;b.zpp_critical=!1;c=b.zpp_inner.at(b.zpp_i++);a(c)}for(b=this.zpp_inner.wrap_compounds.iterator();b.hasNext();)b.zpp_critical=!1,b.zpp_inner.at(b.zpp_i++).visitBodies(a)},visitConstraints:function(a){if(null==
a)throw new f("Error: lambda cannot be null for Space::visitConstraints");for(var b=this.zpp_inner.wrap_constraints.iterator();b.hasNext();){var c;b.zpp_critical=!1;c=b.zpp_inner.at(b.zpp_i++);a(c)}for(b=this.zpp_inner.wrap_compounds.iterator();b.hasNext();)b.zpp_critical=!1,b.zpp_inner.at(b.zpp_i++).visitConstraints(a)},visitCompounds:function(a){if(null==a)throw new f("Error: lambda cannot be null for Space::visitCompounds");for(var b=this.zpp_inner.wrap_compounds.iterator();b.hasNext();){var c;
b.zpp_critical=!1;c=b.zpp_inner.at(b.zpp_i++);a(c);c.visitCompounds(a)}},get_world:function(){return this.zpp_inner.__static},get_arbiters:function(){if(null==this.zpp_inner.wrap_arbiters){var a=new Te;a.space=this.zpp_inner;this.zpp_inner.wrap_arbiters=a}return this.zpp_inner.wrap_arbiters},get_listeners:function(){return this.zpp_inner.wrap_listeners},clear:function(){if(this.zpp_inner.midstep)throw new f("Error: Space::clear() cannot be called during space step()");this.zpp_inner.clear()},step:function(a,
b,c){null==c&&(c=10);null==b&&(b=10);if(a!=a)throw new f("Error: deltaTime cannot be NaN");if(0>=a)throw new f("Error: deltaTime must be strictly positive");if(0>=b)throw new f("Error: must use atleast one velocity iteration");if(0>=c)throw new f("Error: must use atleast one position iteration");this.zpp_inner.step(a,b,c)},get_timeStamp:function(){return this.zpp_inner.stamp},get_elapsedTime:function(){return this.zpp_inner.time},interactionType:function(a,b){if(null==a||null==b)throw new f("Error: Cannot evaluate interaction type for null shapes");
if(null==(null!=a.zpp_inner.body?a.zpp_inner.body.outer:null)||null==(null!=b.zpp_inner.body?b.zpp_inner.body.outer:null))throw new f("Error: Cannot evaluate interaction type for shapes not part of a Body");if(1==(null!=a.zpp_inner.body?a.zpp_inner.body.outer:null).zpp_inner.type&&1==(null!=b.zpp_inner.body?b.zpp_inner.body.outer:null).zpp_inner.type||(null!=a.zpp_inner.body?a.zpp_inner.body.outer:null)==(null!=b.zpp_inner.body?b.zpp_inner.body.outer:null))return null;var c=a.zpp_inner,d=b.zpp_inner;
switch(this.zpp_inner.interactionType(c,d,c.body,d.body)){case 0:return null==g.InteractionType_FLUID&&(g.internal=!0,g.InteractionType_FLUID=new ta,g.internal=!1),g.InteractionType_FLUID;case 1:return null==g.InteractionType_COLLISION&&(g.internal=!0,g.InteractionType_COLLISION=new ta,g.internal=!1),g.InteractionType_COLLISION;case 2:return null==g.InteractionType_SENSOR&&(g.internal=!0,g.InteractionType_SENSOR=new ta,g.internal=!1),g.InteractionType_SENSOR;default:return null}},shapesUnderPoint:function(a,
b,c){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Cannot evaluate shapes under a null point :)");b=this.zpp_inner.shapesUnderPoint(function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this),function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this),
null==b?null:b.zpp_inner,c);a.zpp_inner.weak?(a.dispose(),!0):!1;return b},bodiesUnderPoint:function(a,b,c){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Cannot evaluate objects under a null point :)");b=this.zpp_inner.bodiesUnderPoint(function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this),function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
a.zpp_inner.validate();return a.zpp_inner.y}(this),null==b?null:b.zpp_inner,c);a.zpp_inner.weak?(a.dispose(),!0):!1;return b},shapesInAABB:function(a,b,c,d,e){null==c&&(c=!0);null==b&&(b=!1);if(null==a)throw new f("Error: Cannot evaluate shapes in a null AABB :)");a.zpp_inner.validate();var h;(h=0==a.zpp_inner.width())||(a.zpp_inner.validate(),h=0==a.zpp_inner.height());if(h)throw new f("Error: Cannot evaluate shapes in degenerate AABB :/");return this.zpp_inner.shapesInAABB(a,c,b,null==d?null:d.zpp_inner,
e)},bodiesInAABB:function(a,b,c,d,e){null==c&&(c=!0);null==b&&(b=!1);if(null==a)throw new f("Error: Cannot evaluate objects in a null AABB :)");a.zpp_inner.validate();var h;(h=0==a.zpp_inner.width())||(a.zpp_inner.validate(),h=0==a.zpp_inner.height());if(h)throw new f("Error: Cannot evaluate objects in degenerate AABB :/");return this.zpp_inner.bodiesInAABB(a,c,b,null==d?null:d.zpp_inner,e)},shapesInCircle:function(a,b,c,d,e){null==c&&(c=!1);if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
if(null==a)throw new f("Error: Cannot evaluate shapes at null circle :)");if(b!=b)throw new f("Error: Circle radius cannot be NaN");if(0>=b)throw new f("Error: Circle radius must be strictly positive");b=this.zpp_inner.shapesInCircle(a,b,c,null==d?null:d.zpp_inner,e);a.zpp_inner.weak?(a.dispose(),!0):!1;return b},bodiesInCircle:function(a,b,c,d,e){null==c&&(c=!1);if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");if(null==a)throw new f("Error: Cannot evaluate objects at null circle :)");
if(b!=b)throw new f("Error: Circle radius cannot be NaN");if(0>=b)throw new f("Error: Circle radius must be strictly positive");b=this.zpp_inner.bodiesInCircle(a,b,c,null==d?null:d.zpp_inner,e);a.zpp_inner.weak?(a.dispose(),!0):!1;return b},shapesInShape:function(a,b,c,d){null==b&&(b=!1);if(null==a)throw new f("Error: Cannot evaluate shapes in a null shapes :)");if(null==(null!=a.zpp_inner.body?a.zpp_inner.body.outer:null))throw new f("Error: Query shape needs to be inside a Body to be well defined :)");
if(1==a.zpp_inner.type){var e=a.zpp_inner.polygon.valid();null==g.ValidationResult_VALID&&(g.internal=!0,g.ValidationResult_VALID=new xa,g.internal=!1);if(e!=g.ValidationResult_VALID)throw new f("Error: Polygon query shape is invalid : "+e.toString());}return this.zpp_inner.shapesInShape(a.zpp_inner,b,null==c?null:c.zpp_inner,d)},bodiesInShape:function(a,b,c,d){null==b&&(b=!1);if(null==a)throw new f("Error: Cannot evaluate bodies in a null shapes :)");if(null==(null!=a.zpp_inner.body?a.zpp_inner.body.outer:
null))throw new f("Error: Query shape needs to be inside a Body to be well defined :)");if(1==a.zpp_inner.type){var e=a.zpp_inner.polygon.valid();null==g.ValidationResult_VALID&&(g.internal=!0,g.ValidationResult_VALID=new xa,g.internal=!1);if(e!=g.ValidationResult_VALID)throw new f("Error: Polygon query shape is invalid : "+e.toString());}return this.zpp_inner.bodiesInShape(a.zpp_inner,b,null==c?null:c.zpp_inner,d)},shapesInBody:function(a,b,c){if(null==a)throw new f("Error: Cannot evaluate shapes in null body");
c=null==c?new Ab:c;for(a=a.zpp_inner.wrap_shapes.iterator();a.hasNext();){var d;a.zpp_critical=!1;d=a.zpp_inner.at(a.zpp_i++);this.shapesInShape(d,!1,b,c)}return c},bodiesInBody:function(a,b,c){if(null==a)throw new f("Error: Cannot evaluate shapes in null body");c=null==c?new Ka:c;for(a=a.zpp_inner.wrap_shapes.iterator();a.hasNext();){var d;a.zpp_critical=!1;d=a.zpp_inner.at(a.zpp_i++);this.bodiesInShape(d,!1,b,c)}return c},convexCast:function(a,b,c,d){null==c&&(c=!1);if(null==a)throw new f("Error: Cannot cast null shape :)");
if(null==(null!=a.zpp_inner.body?a.zpp_inner.body.outer:null))throw new f("Error: Shape must belong to a body to be cast.");if(0>b||b!=b)throw new f("Error: deltaTime must be positive");return this.zpp_inner.convexCast(a.zpp_inner,b,d,c)},convexMultiCast:function(a,b,c,d,e){null==c&&(c=!1);if(null==a)throw new f("Error: Cannot cast null shape :)");if(null==(null!=a.zpp_inner.body?a.zpp_inner.body.outer:null))throw new f("Error: Shape must belong to a body to be cast.");if(0>b||b!=b)throw new f("Error: deltaTime must be positive");
return this.zpp_inner.convexMultiCast(a.zpp_inner,b,d,c,e)},rayCast:function(a,b,c){null==b&&(b=!1);if(null==a)throw new f("Error: Cannot cast null ray :)");return this.zpp_inner.rayCast(a,b,c)},rayMultiCast:function(a,b,c,d){null==b&&(b=!1);if(null==a)throw new f("Error: Cannot cast null ray :)");return this.zpp_inner.rayMultiCast(a,b,c,d)},__class__:rf};var fe=function(){this.isExplosionsEnabled=!1;this.dragData=this.background=null;PIXI.Container.call(this);this.drawBackground();this.animationManager=
ed.getInstance();this.setUpPhysics();this.initBalls();this.funButton=new le;this.funButton.x=this.funButton.y=0;this.addChild(this.funButton);this.initListeners()};fe.__name__=!0;fe.__super__=PIXI.Container;fe.prototype=I(PIXI.Container.prototype,{initBalls:function(){var a=this,b=window.sessionStorage.getItem("worldState");if(null!=b)this.worldModel.fromJson(b,function(b){a.spawnBall(b)});else for(b=0;10>b;)b++,this.spawnBall()},initListeners:function(){this.worldModel.space.zpp_inner.wrap_listeners.add(new oe(function(a){null==
g.InteractionType_COLLISION&&(g.internal=!0,g.InteractionType_COLLISION=new ta,g.internal=!1);return g.InteractionType_COLLISION}(this),this.wallCollisionType,Ha.ANY_BODY,w(this,this.wallCollisionHandler),0,!0));this.funButton.on("mousedown",w(this,this.toggleFunMode));this.funButton.on("touchstart",w(this,this.toggleFunMode))},toggleFunMode:function(a){this.isExplosionsEnabled=!this.isExplosionsEnabled;this.funButton.toggle();this.worldModel.space.set_gravity(this.isExplosionsEnabled?E.weak(0,la.getCurrentHeight()):
E.get(0,0,!0));a=this.children;for(var b,c=0,d=a.length;c<d;)b=c++,b=a[b],Object.prototype.hasOwnProperty.call(b,"model")&&b.toggleTexture(this.isExplosionsEnabled)},update:function(a){this.worldModel.space.step(.016666666666666666);this.dragJoint.zpp_inner.active&&null!=this.dragData&&(a=ca.__cast(this.dragData.target,Fd),a=this.dragData.data.getLocalPosition(a.parent),this.dragJoint.get_anchor1().setxy(a.x,a.y));this.worldModel.update()},drawBackground:function(){null==this.background&&(this.background=
new PIXI.Graphics,this.addChild(this.background));this.background.beginFill(0,.8);this.background.lineStyle(2,0);this.background.drawRect(la.getCurrentWidth()/2,0,la.getCurrentWidth()/2,la.getCurrentHeight())},setUpPhysics:function(){this.worldModel=new he;var a=E.get(0,0,!0);this.worldModel.space=new rf(a);this.wallCollisionType=new vb;a=ld;null==g.BodyType_STATIC&&(g.internal=!0,g.BodyType_STATIC=new Ga,g.internal=!1);a=new a(g.BodyType_STATIC);a.zpp_inner.wrap_shapes.add(new Ea(Ea.rect(0,0,la.getCurrentWidth(),
-1)));a.zpp_inner.wrap_shapes.add(new Ea(Ea.rect(0,la.getCurrentHeight(),la.getCurrentWidth(),1)));a.zpp_inner.wrap_shapes.add(new Ea(Ea.rect(0,0,-1,la.getCurrentHeight())));a.zpp_inner.wrap_shapes.add(new Ea(Ea.rect(la.getCurrentWidth(),0,1,la.getCurrentHeight())));a.zpp_inner.wrap_shapes.add(new Ea(Ea.rect(la.getCurrentWidth()/2,0,1,la.getCurrentHeight())));null==a.zpp_inner_i.wrap_cbTypes&&a.zpp_inner_i.setupcbTypes();a.zpp_inner_i.wrap_cbTypes.add(this.wallCollisionType);a.setShapeMaterials(hb.wood());
a.set_space(this.worldModel.space);this.dragJoint=new Ud(this.worldModel.space.zpp_inner.__static,null,E.get(0,0,!0),E.get(0,0,!0));this.dragJoint.set_space(this.worldModel.space);this.dragJoint.set_active(!1);this.dragJoint.set_stiff(!1)},spawnBall:function(a){null==a&&(a=new Hd,a.set_x(Za.random(la.getCurrentWidth()/2-40)+40),a.set_y(la.getCurrentHeight()-40),a.set_rotation(0),this.worldModel.addBall(a));var b=new Fd(a);a.assignSpace(this.worldModel.space);b.on("mousedown",w(this,this.onDragStart));
b.on("touchstart",w(this,this.onDragStart));b.on("mouseup",w(this,this.onDragEnd));b.on("mouseupoutside",w(this,this.onDragEnd));b.on("touchend",w(this,this.onDragEnd));b.on("touchendoutside",w(this,this.onDragEnd));this.addChild(b);a.get_x()<la.getCurrentWidth()/2&&b.freeze()},onDragEnd:function(a){null!=this.dragData&&(a=ca.__cast(this.dragData.target,Fd),this.dragData=null,a.stopDrag(),this.dragJoint.set_active(!1),a.x>la.getCurrentWidth()/2?a.revive():a.freeze())},onDragStart:function(a){if(null!=
this.dragData)this.onDragEnd(this.dragData);else{this.dragData=a;a=ca.__cast(this.dragData.target,Fd);a.startDrag();var b=this.dragData.data.getLocalPosition(a.parent),b=E.get(b.x,b.y,null);a=a.getBody();this.dragJoint.set_body2(a);this.dragJoint.get_anchor2().set(a.worldPointToLocal(b,!0));this.dragJoint.set_active(!0)}},onGameExit:function(a){window.sessionStorage.setItem("worldState",this.worldModel.toJson());return""},wallCollisionHandler:function(a){if(.5<Math.random()&&this.isExplosionsEnabled){var b=
a.zpp_inner.pre_arbiter.wrapper().get_body2().get_position();this.animationManager.explodeAt(function(a){if(null!=b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");b.zpp_inner.validate();return b.zpp_inner.x}(this),function(a){if(null!=b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");b.zpp_inner.validate();return b.zpp_inner.y}(this),this)}null==g.PreFlag_ACCEPT&&(g.internal=!0,g.PreFlag_ACCEPT=new ja,g.internal=!1);return g.PreFlag_ACCEPT},
__class__:fe});var ed=function(){this.explosionPool=[]};ed.__name__=!0;ed.getInstance=function(){null==ed.instance&&(ed.instance=new ed);return ed.instance};ed.prototype={explodeAt:function(a,b,c){for(var d=null,e=0,h=this.explosionPool.length;e<h;){var t=e++;if(null==this.explosionPool[t].parent){d=this.explosionPool[t];break}}null==d&&(d=new ge,this.explosionPool.push(d));d.x=a;d.y=b;c.addChild(d);d.gotoAndPlay(0)},__class__:ed};var na=function(){};na.__name__=!0;na.Constraint=function(){return na._Constraint++};
na.Interactor=function(){return na._Interactor++};na.CbType=function(){return na._CbType++};na.CbSet=function(){return na._CbSet++};na.Listener=function(){return na._Listener++};na.ZPP_SimpleVert=function(){return na._ZPP_SimpleVert++};na.ZPP_SimpleSeg=function(){return na._ZPP_SimpleSeg++};na.Space=function(){return na._Space++};na.InteractionGroup=function(){return na._InteractionGroup++};var Ra=function(){this.body=this.constraint=null;this.pre_swapped=!1;this.int1=this.int2=this.set=this.wrap_arbiters=
this.pre_arbiter=null;this.length=0;this.next=this.prev=null;this.index=0;this.listener=this.space=null;this.event=0;this.outer_body=this.outer_con=this.outer_int=null;this.length=0};Ra.__name__=!0;Ra.prototype={wrapper_body:function(){null==this.outer_body&&(Ra.internal=!0,this.outer_body=new me,Ra.internal=!1,this.outer_body.zpp_inner=this);return this.outer_body},wrapper_con:function(){null==this.outer_con&&(Ra.internal=!0,this.outer_con=new Id,Ra.internal=!1,this.outer_con.zpp_inner=this);return this.outer_con},
wrapper_int:function(){null==this.outer_int&&(Ra.internal=!0,this.outer_int=new Rd,Ra.internal=!1,this.outer_int.zpp_inner=this);null==this.wrap_arbiters?this.wrap_arbiters=qb.get(this.set.arbiters,!0):this.wrap_arbiters.zpp_inner.inner=this.set.arbiters;this.wrap_arbiters.zpp_inner.zip_length=!0;this.wrap_arbiters.zpp_inner.at_ite=null;return this.outer_int},push:function(a){null!=this.prev?this.prev.next=a:this.next=a;a.prev=this.prev;a.next=null;this.prev=a;this.length++},push_rev:function(a){null!=
this.next?this.next.prev=a:this.prev=a;a.next=this.next;a.prev=null;this.next=a;this.length++},pop:function(){var a=this.next;this.next=a.next;null==this.next?this.prev=null:this.next.prev=null;this.length--;return a},pop_rev:function(){var a=this.prev;this.prev=a.prev;null==this.prev?this.next=null:this.prev.next=null;this.length--;return a},empty:function(){return null==this.next},clear:function(){for(;!this.empty();)this.pop()},splice:function(a){var b=a.next;null==a.prev?(this.next=a.next,null!=
this.next?this.next.prev=null:this.prev=null):(a.prev.next=a.next,null!=a.next?a.next.prev=a.prev:this.prev=a.prev);this.length--;return b},rotateL:function(){this.push(this.pop())},rotateR:function(){this.push_rev(this.pop_rev())},cycleNext:function(a){return null==a.next?this.next:a.next},cyclePrev:function(a){return null==a.prev?this.prev:a.prev},at:function(a){for(var b=this.next;0!=a--;)b=b.next;return b},rev_at:function(a){for(var b=this.prev;0!=a--;)b=b.prev;return b},free:function(){this.listener=
this.constraint=this.body=this.int1=this.int2=null;null!=this.wrap_arbiters&&(this.wrap_arbiters.zpp_inner.inner=null);this.set=null},alloc:function(){},genarbs:function(){null==this.wrap_arbiters?this.wrap_arbiters=qb.get(this.set.arbiters,!0):this.wrap_arbiters.zpp_inner.inner=this.set.arbiters;this.wrap_arbiters.zpp_inner.zip_length=!0;this.wrap_arbiters.zpp_inner.at_ite=null},__class__:Ra};var oa=function(){this.interactors=this.wrap_interactors=this.constraints=this.wrap_constraints=null;this.zip_conlisteners=
!1;this.conlisteners=null;this.zip_bodylisteners=!1;this.bodylisteners=null;this.zip_listeners=!1;this.manager=this.cbpairs=this.listeners=null;this.id=0;this.next=null;this.count=0;this.cbTypes=null;this.cbTypes=new Uc;this.listeners=new Yd;this.zip_listeners=!0;this.bodylisteners=new Ue;this.zip_bodylisteners=!0;this.conlisteners=new Ve;this.zip_conlisteners=!0;this.constraints=new md;this.interactors=new Xb;this.id=na.CbSet();this.cbpairs=new sf};oa.__name__=!0;oa.setlt=function(a,b){for(var c=
a.cbTypes.head,d=b.cbTypes.head;null!=c&&null!=d;){var e=c.elt,h=d.elt;if(e.id<h.id)return!0;if(h.id<e.id)return!1;c=c.next;d=d.next}return null!=d&&null==c};oa.get=function(a){var b;null==oa.zpp_pool?b=new oa:(b=oa.zpp_pool,oa.zpp_pool=b.next,b.next=null);null;var c=null;for(a=a.head;null!=a;){var d=a.elt,c=b.cbTypes.insert(c,d);d.cbsets.add(b);a=a.next}return b};oa.compatible=function(a,b,c){return a.options1.compatible(b.cbTypes)&&a.options2.compatible(c.cbTypes)||a.options2.compatible(b.cbTypes)&&
a.options1.compatible(c.cbTypes)};oa.empty_intersection=function(a,b){return a.manager.pair(a,b).empty_intersection()};oa.single_intersection=function(a,b,c){return a.manager.pair(a,b).single_intersection(c)};oa.find_all=function(a,b,c,d){a.manager.pair(a,b).forall(c,d)};oa.prototype={increment:function(){this.count++},decrement:function(){return 0==--this.count},invalidate_pairs:function(){for(var a=this.cbpairs.head;null!=a;)a.elt.zip_listeners=!0,a=a.next},invalidate_listeners:function(){this.zip_listeners=
!0;this.invalidate_pairs()},validate_listeners:function(){this.zip_listeners&&(this.zip_listeners=!1,this.realvalidate_listeners())},realvalidate_listeners:function(){this.listeners.clear();for(var a=this.cbTypes.head;null!=a;){for(var b=null,c=this.listeners.head,d=a.elt.listeners.head;null!=d;){var e=d.elt;null!=c&&c.elt==e?(d=d.next,b=c,c=c.next):null==c||va.setlt(e,c.elt)?(e.space==this.manager.space&&(b=this.listeners.inlined_insert(b,e)),d=d.next):(b=c,c=c.next)}a=a.next}},invalidate_bodylisteners:function(){this.zip_bodylisteners=
!0},validate_bodylisteners:function(){this.zip_bodylisteners&&(this.zip_bodylisteners=!1,this.realvalidate_bodylisteners())},realvalidate_bodylisteners:function(){this.bodylisteners.clear();for(var a=this.cbTypes.head;null!=a;){for(var b=null,c=this.bodylisteners.head,d=a.elt.bodylisteners.head;null!=d;){var e=d.elt;null!=c&&c.elt==e?(d=d.next,b=c,c=c.next):null==c||va.setlt(e,c.elt)?(e.options.excluded(this.cbTypes)||e.space!=this.manager.space||(b=this.bodylisteners.inlined_insert(b,e)),d=d.next):
(b=c,c=c.next)}a=a.next}},invalidate_conlisteners:function(){this.zip_conlisteners=!0},validate_conlisteners:function(){this.zip_conlisteners&&(this.zip_conlisteners=!1,this.realvalidate_conlisteners())},realvalidate_conlisteners:function(){this.conlisteners.clear();for(var a=this.cbTypes.head;null!=a;){for(var b=null,c=this.conlisteners.head,d=a.elt.conlisteners.head;null!=d;){var e=d.elt;null!=c&&c.elt==e?(d=d.next,b=c,c=c.next):null==c||va.setlt(e,c.elt)?(e.options.excluded(this.cbTypes)||e.space!=
this.manager.space||(b=this.conlisteners.inlined_insert(b,e)),d=d.next):(b=c,c=c.next)}a=a.next}},validate:function(){this.zip_listeners&&(this.zip_listeners=!1,this.realvalidate_listeners());this.zip_bodylisteners&&(this.zip_bodylisteners=!1,this.realvalidate_bodylisteners());this.zip_conlisteners&&(this.zip_conlisteners=!1,this.realvalidate_conlisteners())},addConstraint:function(a){this.constraints.add(a)},addInteractor:function(a){this.interactors.add(a)},remConstraint:function(a){this.constraints.remove(a)},
remInteractor:function(a){this.interactors.remove(a)},free:function(){this.listeners.clear();this.zip_listeners=!0;this.bodylisteners.clear();this.zip_bodylisteners=!0;this.conlisteners.clear();for(this.zip_conlisteners=!0;null!=this.cbTypes.head;)this.cbTypes.pop_unsafe().cbsets.remove(this)},alloc:function(){},__class__:oa};var Yb=function(){this.listeners=null;this.zip_listeners=!1;this.a=this.b=this.next=null;this.listeners=new Yd};Yb.__name__=!0;Yb.get=function(a,b){var c;null==Yb.zpp_pool?c=
new Yb:(c=Yb.zpp_pool,Yb.zpp_pool=c.next,c.next=null);c.zip_listeners=!0;oa.setlt(a,b)?(c.a=a,c.b=b):(c.a=b,c.b=a);return c};Yb.setlt=function(a,b){return oa.setlt(a.a,b.a)||a.a==b.a&&oa.setlt(a.b,b.b)};Yb.prototype={free:function(){this.a=this.b=null;this.listeners.clear()},alloc:function(){this.zip_listeners=!0},compatible:function(a){return a.options1.compatible(this.a.cbTypes)&&a.options2.compatible(this.b.cbTypes)||a.options2.compatible(this.a.cbTypes)&&a.options1.compatible(this.b.cbTypes)},
invalidate:function(){this.zip_listeners=!0},validate:function(){this.zip_listeners&&(this.zip_listeners=!1,this.__validate())},__validate:function(){this.listeners.clear();for(var a=this.a.listeners.head,b=this.b.listeners.head;null!=a&&null!=b;){var c=a.elt,d=b.elt;c==d?((c.options1.compatible(this.a.cbTypes)&&c.options2.compatible(this.b.cbTypes)||c.options2.compatible(this.a.cbTypes)&&c.options1.compatible(this.b.cbTypes))&&this.listeners.add(c),a=a.next,b=b.next):c.precedence>d.precedence||c.precedence==
d.precedence&&c.id>d.id?a=a.next:b=b.next}},empty_intersection:function(){return null==this.listeners.head},single_intersection:function(a){var b=this.listeners.head;return null!=b&&b.elt==a&&null==b.next},forall:function(a,b){for(var c=this.listeners.head;null!=c;){var d=c.elt;d.event==a&&b(d);c=c.next}},__class__:Yb};var Yd=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Yd.__name__=!0;Yd.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=
this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==rc.zpp_pool?b=new rc:(b=rc.zpp_pool,rc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==rc.zpp_pool?c=new rc:(c=rc.zpp_pool,rc.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=
this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=rc.zpp_pool;rc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=
null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));
a=b;a.elt=null;a.next=rc.zpp_pool;rc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},
size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:Yd};var Ue=function(){this.length=0;this.modified=
this.pushmod=!1;this.head=null};Ue.__name__=!0;Ue.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==cc.zpp_pool?b=new cc:(b=cc.zpp_pool,cc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,
b)},inlined_insert:function(a,b){var c;null==cc.zpp_pool?c=new cc:(c=cc.zpp_pool,cc.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=cc.zpp_pool;cc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},
inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,
c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=cc.zpp_pool;cc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=
this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=
b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:Ue};var Ve=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Ve.__name__=!0;Ve.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==hc.zpp_pool?b=new hc:(b=hc.zpp_pool,hc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=
!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==hc.zpp_pool?c=new hc:(c=hc.zpp_pool,hc.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=hc.zpp_pool;
hc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=
c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=hc.zpp_pool;hc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();
this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=
this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:Ve};var md=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};md.__name__=!0;md.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Bb.zpp_pool?
b=new Bb:(b=Bb.zpp_pool,Bb.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Bb.zpp_pool?c=new Bb:(c=Bb.zpp_pool,Bb.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},
inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Bb.zpp_pool;Bb.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},
inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Bb.zpp_pool;Bb.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);
return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=
!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:md};var Xb=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Xb.__name__=!0;Xb.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=
!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Cb.zpp_pool?b=new Cb:(b=Cb.zpp_pool,Cb.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Cb.zpp_pool?c=new Cb:(c=Cb.zpp_pool,Cb.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,
this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Cb.zpp_pool;Cb.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=
null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));
a=b;a.elt=null;a.next=Cb.zpp_pool;Cb.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},
size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:Xb};var zd=function(){this.length=0;this.modified=
this.pushmod=!1;this.head=null};zd.__name__=!0;zd.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==ic.zpp_pool?b=new ic:(b=ic.zpp_pool,ic.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,
b)},inlined_insert:function(a,b){var c;null==ic.zpp_pool?c=new ic:(c=ic.zpp_pool,ic.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=ic.zpp_pool;ic.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},
inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,
c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=ic.zpp_pool;ic.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=
this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=
b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:zd};var Ha=function(){this.cbsets=this.listeners=this.bodylisteners=this.conlisteners=null;this.id=0;this.outer=this.userData=null;this.id=na.CbType();this.listeners=new Yd;this.bodylisteners=new Ue;this.conlisteners=new Ve;this.constraints=new md;this.interactors=new Xb;this.cbsets=new zd};Ha.__name__=!0;Ha.setlt=function(a,b){return a.id<b.id};Ha.prototype={addConstraint:function(a){this.constraints.add(a)},
addInteractor:function(a){this.interactors.add(a)},remConstraint:function(a){this.constraints.remove(a)},remInteractor:function(a){this.interactors.remove(a)},addint:function(a){for(var b=null,c=this.listeners.head;null!=c;){var d=c.elt;if(a.precedence>d.precedence||a.precedence==d.precedence&&a.id>d.id)break;b=c;c=c.next}this.listeners.inlined_insert(b,a);this.invalidateint()},removeint:function(a){this.listeners.remove(a);this.invalidateint()},invalidateint:function(){for(var a=this.cbsets.head;null!=
a;){var b=a.elt;b.zip_listeners=!0;b.invalidate_pairs();a=a.next}},addbody:function(a){for(var b=null,c=this.bodylisteners.head;null!=c;){var d=c.elt;if(a.precedence>d.precedence||a.precedence==d.precedence&&a.id>d.id)break;b=c;c=c.next}this.bodylisteners.inlined_insert(b,a);this.invalidatebody()},removebody:function(a){this.bodylisteners.remove(a);this.invalidatebody()},invalidatebody:function(){for(var a=this.cbsets.head;null!=a;)a.elt.zip_bodylisteners=!0,a=a.next},addconstraint:function(a){for(var b=
null,c=this.conlisteners.head;null!=c;){var d=c.elt;if(a.precedence>d.precedence||a.precedence==d.precedence&&a.id>d.id)break;b=c;c=c.next}this.conlisteners.inlined_insert(b,a);this.invalidateconstraint()},removeconstraint:function(a){this.conlisteners.remove(a);this.invalidateconstraint()},invalidateconstraint:function(){for(var a=this.cbsets.head;null!=a;)a.elt.zip_conlisteners=!0,a=a.next},__class__:Ha};var g=function(){};g.__name__=!0;var va=function(){this.body=this.constraint=this.interaction=
this.space=null;this.id=this.type=this.event=this.precedence=0;this.outer=null;this.id=na.Listener()};va.__name__=!0;va.setlt=function(a,b){return a.precedence>b.precedence||a.precedence==b.precedence&&a.id>b.id};va.prototype={swapEvent:function(a){},invalidate_precedence:function(){},addedToSpace:function(){},removedFromSpace:function(){},__class__:va};var Qd=function(a,b,c){this.outer_zn=this.options=this.handler=null;va.call(this);this.event=b;this.handler=c;this.body=this;this.type=0;this.options=
a.zpp_inner};Qd.__name__=!0;Qd.__super__=va;Qd.prototype=I(va.prototype,{immutable_options:function(){if(null!=this.space&&this.space.midstep)throw new f("Error: Cannot change listener type options during space.step()");},addedToSpace:function(){this.options.handler=w(this,this.cbtype_change);for(var a=this.options.includes.head;null!=a;)a.elt.addbody(this),a=a.next},removedFromSpace:function(){for(var a=this.options.includes.head;null!=a;){var b=a.elt;b.bodylisteners.remove(this);b.invalidatebody();
a=a.next}this.options.handler=null},cbtype_change:function(a,b,c){this.removedFromSpace();this.options.effect_change(a,b,c);this.addedToSpace()},invalidate_precedence:function(){null!=this.space&&(this.removedFromSpace(),this.addedToSpace())},swapEvent:function(a){if(2!=a&&3!=a)throw new f("Error: BodyListener event must be either WAKE or SLEEP only");this.removedFromSpace();this.event=a;this.addedToSpace()},__class__:Qd});var ne=function(a,b,c){this.outer_zn=this.options=this.handler=null;va.call(this);
this.event=b;this.handler=c;this.constraint=this;this.type=1;this.options=a.zpp_inner};ne.__name__=!0;ne.__super__=va;ne.prototype=I(va.prototype,{immutable_options:function(){if(null!=this.space&&this.space.midstep)throw new f("Error: Cannot change listener type options during space.step()");},addedToSpace:function(){this.options.handler=w(this,this.cbtype_change);for(var a=this.options.includes.head;null!=a;)a.elt.addconstraint(this),a=a.next},removedFromSpace:function(){for(var a=this.options.includes.head;null!=
a;){var b=a.elt;b.conlisteners.remove(this);b.invalidateconstraint();a=a.next}this.options.handler=null},cbtype_change:function(a,b,c){this.removedFromSpace();this.options.effect_change(a,b,c);this.addedToSpace()},invalidate_precedence:function(){null!=this.space&&(this.removedFromSpace(),this.addedToSpace())},swapEvent:function(a){if(2!=a&&3!=a&&4!=a)throw new f("Error: ConstraintListener event must be either WAKE or SLEEP only");this.removedFromSpace();this.event=a;this.addedToSpace()},__class__:ne});
var Uc=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Uc.__name__=!0;Uc.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==sc.zpp_pool?b=new sc:(b=sc.zpp_pool,sc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},
insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==sc.zpp_pool?c=new sc:(c=sc.zpp_pool,sc.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=sc.zpp_pool;sc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},
inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,
c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=sc.zpp_pool;sc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=
this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=
b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:Uc};var Lb=function(a,b,c,d){this.handlerp=null;this.allowSleepingCallbacks=this.pure=!1;this.options1=this.options2=this.handleri=null;this.itype=0;this.outer_zni=this.outer_znp=null;va.call(this);this.type=d;this.interaction=this;this.event=c;this.options1=a.zpp_inner;this.options2=b.zpp_inner;this.allowSleepingCallbacks=!1};Lb.__name__=!0;Lb.__super__=va;Lb.prototype=I(va.prototype,{setInteractionType:function(a){this.itype=
a},wake:function(){this.with_union(function(a){for(a=a.interactors.head;null!=a;)a.elt.wake(),a=a.next})},CbSetset:function(a,b,c){var d=Lb.UCbSet,e=Lb.VCbSet,h=Lb.WCbSet;a=a.head;for(var t=b.head;null!=a&&null!=t;){var f=a.elt,g=t.elt;f==g?(h.inlined_add(f),a=a.next,t=t.next):oa.setlt(f,g)?(d.inlined_add(f),a=a.next):(e.inlined_add(g),t=t.next)}for(;null!=a;)d.inlined_add(a.elt),a=a.next;for(;null!=t;)e.inlined_add(t.elt),t=t.next;for(;null!=d.head;)for(a=d.pop_unsafe(),t=b.head;null!=t;)c(a,t.elt),
t=t.next;for(;null!=e.head;)for(b=e.pop_unsafe(),d=h.head;null!=d;)c(b,d.elt),d=d.next;for(;null!=h.head;)for(e=h.pop_unsafe(),c(e,e),b=h.head;null!=b;)c(e,b.elt),b=b.next},CbTypeset:function(a,b,c){var d=Lb.UCbType,e=Lb.VCbType,h=Lb.WCbType;a=a.head;for(var t=b.head;null!=a&&null!=t;){var f=a.elt,g=t.elt;f==g?(h.inlined_add(f),a=a.next,t=t.next):f.id<g.id?(d.inlined_add(f),a=a.next):(e.inlined_add(g),t=t.next)}for(;null!=a;)d.inlined_add(a.elt),a=a.next;for(;null!=t;)e.inlined_add(t.elt),t=t.next;
for(;null!=d.head;)for(a=d.pop_unsafe(),t=b.head;null!=t;)c(a,t.elt),t=t.next;for(;null!=e.head;)for(b=e.pop_unsafe(),d=h.head;null!=d;)c(b,d.elt),d=d.next;for(;null!=h.head;)for(e=h.pop_unsafe(),c(e,e),b=h.head;null!=b;)c(e,b.elt),b=b.next},with_uniquesets:function(a){var b=this,c;null==ba.zpp_pool?c=new ba:(c=ba.zpp_pool,ba.zpp_pool=c.next,c.next=null);null;c.lt=Yb.setlt;this.CbTypeset(this.options1.includes,this.options2.includes,function(a,d){b.CbSetset(a.cbsets,d.cbsets,function(a,d){a.validate();
d.validate();oa.single_intersection(a,d,b)&&c.try_insert(Yb.get(a,d))})});c.clear_with(function(c){a?b.space.freshListenerType(c.a,c.b):b.space.nullListenerType(c.a,c.b);c.a=c.b=null;c.listeners.clear();c.next=Yb.zpp_pool;Yb.zpp_pool=c});var d=c;d.data=null;d.lt=null;d.swapped=null;d.next=ba.zpp_pool;ba.zpp_pool=d},with_union:function(a){for(var b=this.options1.includes.head,c=this.options2.includes.head;null!=b&&null!=c;){var d=b.elt,e=c.elt;d==e?(a(d),b=b.next,c=c.next):d.id<e.id?(a(d),b=b.next):
(a(e),c=c.next)}for(;null!=b;)a(b.elt),b=b.next;for(;null!=c;)a(c.elt),c=c.next},addedToSpace:function(){var a=this,b=3==this.type;this.with_union(function(c){c.addint(a);if(b)for(c=c.interactors.head;null!=c;)c.elt.wake(),c=c.next});this.options1.handler=w(this,this.cbtype_change1);this.options2.handler=w(this,this.cbtype_change2);this.with_uniquesets(!0)},removedFromSpace:function(){var a=this;this.with_uniquesets(!1);var b=3==this.type;this.with_union(function(c){c.listeners.remove(a);c.invalidateint();
if(b)for(c=c.interactors.head;null!=c;)c.elt.wake(),c=c.next});this.options1.handler=null;this.options2.handler=null},invalidate_precedence:function(){var a=this;if(null!=this.space){var b=3==this.type;this.with_union(function(c){c.listeners.remove(a);c.invalidateint();c.addint(a);if(b)for(c=c.interactors.head;null!=c;)c.elt.wake(),c=c.next})}},cbtype_change1:function(a,b,c){this.cbtype_change(this.options1,a,b,c)},cbtype_change2:function(a,b,c){this.cbtype_change(this.options2,a,b,c)},cbtype_change:function(a,
b,c,d){this.removedFromSpace();a.effect_change(b,c,d);this.addedToSpace();null},swapEvent:function(a){if(3==this.type)throw new f("Error: PreListener event can only be PRE");if(0!=a&&1!=a&&6!=a)throw new f("Error: InteractionListener event must be either BEGIN, END, ONGOING");this.removedFromSpace();this.event=a;this.addedToSpace()},__class__:Lb});var Yc=function(){this.outer=this.handler=this.includes=this.excludes=this.wrap_includes=this.wrap_excludes=null;this.includes=new Uc;this.excludes=new Uc};
Yc.__name__=!0;Yc.argument=function(a){return null==a?new nd:ca.__instanceof(a,nd)?a:(new nd).including(a)};Yc.prototype={setup_includes:function(){this.wrap_includes=Vb.get(this.includes,!0)},setup_excludes:function(){this.wrap_excludes=Vb.get(this.excludes,!0)},excluded:function(a){return this.nonemptyintersection(a,this.excludes)},included:function(a){return this.nonemptyintersection(a,this.includes)},compatible:function(a){return this.nonemptyintersection(a,this.includes)&&!this.nonemptyintersection(a,
this.excludes)},nonemptyintersection:function(a,b){for(var c=!1,d=a.head,e=b.head;null!=e&&null!=d;){var h=e.elt,t=d.elt;if(h==t){c=!0;break}else h.id<t.id?e=e.next:d=d.next}return c},effect_change:function(a,b,c){if(b)if(c){b=null;for(c=this.includes.head;null!=c&&!(a.id<c.elt.id);)b=c,c=c.next;this.includes.inlined_insert(b,a)}else this.includes.remove(a);else if(c){b=null;for(c=this.excludes.head;null!=c&&!(a.id<c.elt.id);)b=c,c=c.next;this.excludes.inlined_insert(b,a)}else this.excludes.remove(a)},
append_type:function(a,b){a==this.includes?this.includes.has(b)||(this.excludes.has(b)?null!=this.handler?this.handler(b,!1,!1):this.effect_change(b,!1,!1):null!=this.handler?this.handler(b,!0,!0):this.effect_change(b,!0,!0)):this.excludes.has(b)||(this.includes.has(b)?null!=this.handler?this.handler(b,!0,!1):this.effect_change(b,!0,!1):null!=this.handler?this.handler(b,!1,!0):this.effect_change(b,!1,!0))},set:function(a){if(a!=this){for(;null!=this.includes.head;)this.append_type(this.excludes,this.includes.head.elt);
for(;null!=this.excludes.head;)this.append_type(this.includes,this.excludes.head.elt);for(var b=a.excludes.head;null!=b;)this.append_type(this.excludes,b.elt),b=b.next;for(a=a.includes.head;null!=a;)this.append_type(this.includes,a.elt),a=a.next}return this},append:function(a,b){if(null==b)throw new f("Error: Cannot append null, only CbType and CbType list values");if(ca.__instanceof(b,vb))this.append_type(a,b.zpp_inner);else if(ca.__instanceof(b,pd)){var c;b.zpp_inner.valmod();for(c=db.get(b);c.hasNext();){var d;
c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);this.append_type(a,d.zpp_inner)}}else if(b instanceof Array&&null==b.__enum__)for(c=0;c<b.length;){d=b[c];++c;if(!ca.__instanceof(d,vb))throw new f("Error: Cannot append non-CbType or CbType list value");this.append_type(a,d.zpp_inner)}else throw new f("Error: Cannot append non-CbType or CbType list value");},__class__:Yc};var ra=function(){this.pre_dt=0;this.cbTypes=this.cbSet=this.wrap_cbTypes=null;this.ignore=this.__velocity=!1;this.component=null;
this.breakUnderForce=this.breakUnderError=this.removeOnBreak=!1;this.frequency=this.damping=this.maxForce=this.maxError=0;this.active=this.stiff=!1;this.userData=this.compound=this.space=null;this.id=0;this.outer=null;this.__velocity=!1;this.id=na.Constraint();this.active=this.stiff=!0;this.ignore=!1;this.frequency=10;this.damping=1;this.maxError=this.maxForce=Infinity;this.breakUnderForce=!1;this.removeOnBreak=!0;this.pre_dt=-1;this.cbTypes=new Uc};ra.__name__=!0;ra.prototype={clear:function(){},
immutable_midstep:function(a){if(null!=this.space&&this.space.midstep)throw new f("Error: Constraint::"+a+" cannot be set during space step()");},setupcbTypes:function(){this.wrap_cbTypes=Vb.get(this.cbTypes);this.wrap_cbTypes.zpp_inner.adder=w(this,this.wrap_cbTypes_adder);this.wrap_cbTypes.zpp_inner.subber=w(this,this.wrap_cbTypes_subber);this.wrap_cbTypes.zpp_inner.dontremove=!0;this.wrap_cbTypes.zpp_inner._modifiable=w(this,this.immutable_cbTypes)},immutable_cbTypes:function(){this.immutable_midstep("Constraint::cbTypes")},
wrap_cbTypes_subber:function(a){a=a.zpp_inner;this.cbTypes.has(a)&&(null!=this.space&&(this.dealloc_cbSet(),a.constraints.remove(this)),this.cbTypes.remove(a),null!=this.space&&(this.alloc_cbSet(),this.wake()))},wrap_cbTypes_adder:function(a){this.insert_cbtype(a.zpp_inner);return!1},insert_cbtype:function(a){if(!this.cbTypes.has(a)){null!=this.space&&(this.dealloc_cbSet(),a.constraints.add(this));for(var b=null,c=this.cbTypes.head;null!=c&&!(a.id<c.elt.id);)b=c,c=c.next;this.cbTypes.inlined_insert(b,
a);null!=this.space&&(this.alloc_cbSet(),this.wake())}},alloc_cbSet:function(){null!=(this.cbSet=this.space.cbsets.get(this.cbTypes))&&(this.cbSet.count++,this.cbSet.constraints.add(this))},dealloc_cbSet:function(){if(null!=this.cbSet){this.cbSet.constraints.remove(this);if(0==--this.cbSet.count){this.space.cbsets.remove(this.cbSet);var a=this.cbSet;a.free();a.next=oa.zpp_pool;oa.zpp_pool=a}this.cbSet=null}},activate:function(){null!=this.space&&this.activeInSpace()},deactivate:function(){null!=this.space&&
this.inactiveOrOutSpace()},addedToSpace:function(){this.active&&this.activeInSpace();this.activeBodies();for(var a=this.cbTypes.head;null!=a;)a.elt.constraints.add(this),a=a.next},removedFromSpace:function(){this.active&&this.inactiveOrOutSpace();this.inactiveBodies();for(var a=this.cbTypes.head;null!=a;)a.elt.constraints.remove(this),a=a.next},activeInSpace:function(){this.alloc_cbSet();null==Fa.zpp_pool?this.component=new Fa:(this.component=Fa.zpp_pool,Fa.zpp_pool=this.component.next,this.component.next=
null);null;this.component.isBody=!1;this.component.constraint=this},inactiveOrOutSpace:function(){this.dealloc_cbSet();var a=this.component;a.body=null;a.constraint=null;null;a.next=Fa.zpp_pool;Fa.zpp_pool=a;this.component=null},activeBodies:function(){},inactiveBodies:function(){},clearcache:function(){},validate:function(){},wake_connected:function(){},forest:function(){},pair_exists:function(a,b){return!1},broken:function(){},warmStart:function(){},preStep:function(a){return!1},applyImpulseVel:function(){return!1},
applyImpulsePos:function(){return!1},wake:function(){null!=this.space&&this.space.wake_constraint(this)},draw:function(a){},copy:function(a,b){return null},copyto:function(a){var b=this.outer;null==b.zpp_inner.wrap_cbTypes&&b.zpp_inner.setupcbTypes();for(var c=b.zpp_inner.wrap_cbTypes.iterator();c.hasNext();){var d;c.zpp_critical=!1;d=c.zpp_inner.at(c.zpp_i++);null==a.zpp_inner.wrap_cbTypes&&a.zpp_inner.setupcbTypes();a.zpp_inner.wrap_cbTypes.add(d)}a.zpp_inner.removeOnBreak=b.zpp_inner.removeOnBreak;
a.zpp_inner.removeOnBreak;a.set_breakUnderError(b.zpp_inner.breakUnderError);a.set_breakUnderForce(b.zpp_inner.breakUnderForce);a.set_maxError(b.zpp_inner.maxError);a.set_maxForce(b.zpp_inner.maxForce);a.set_damping(b.zpp_inner.damping);a.set_frequency(b.zpp_inner.frequency);a.set_stiff(b.zpp_inner.stiff);a.set_ignore(b.zpp_inner.ignore);a.set_active(b.zpp_inner.active)},__class__:ra};var pe=function(){this.stepped=!1;this.kMass=this.jAcc=this.jMax=this.gamma=this.bias=0;this.b1=this.b2=null;this.scale=
0;this.slack=this.equal=!1;this.ratio=this.jointMin=this.jointMax=0;this.outer_zn=null;ra.call(this);this.ratio=1;this.jAcc=0;this.slack=!1;this.jMax=Infinity;this.stepped=!1};pe.__name__=!0;pe.__super__=ra;pe.prototype=I(ra.prototype,{is_slack:function(){var a,b=this.ratio*this.b2.rot-this.b1.rot;this.equal?(b-=this.jointMax,a=!1,this.scale=1):b<this.jointMin?(b=this.jointMin-b,this.scale=-1,a=!1):b>this.jointMax?(b-=this.jointMax,this.scale=1,a=!1):(b=this.scale=0,a=!0);b;return a},bodyImpulse:function(a){return this.stepped?
a==this.b1?N.get(0,0,-this.scale*this.jAcc):N.get(0,0,this.ratio*this.scale*this.jAcc):N.get(0,0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this);this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this);this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},copy:function(a,b){var c=new qe(null,null,this.jointMin,this.jointMax,this.ratio);this.copyto(c);if(null!=a&&null!=this.b1){for(var d=
null,e=0;e<a.length;){var h=a[e];++e;if(h.id==this.b1.id){d=h.bc;break}}null!=d?c.zpp_inner_zn.b1=d.zpp_inner:b.push(ka.todo(this.b1.id,function(a){c.zpp_inner_zn.b1=a.zpp_inner}))}if(null!=a&&null!=this.b2){d=null;for(e=0;e<a.length;)if(h=a[e],++e,h.id==this.b2.id){d=h.bc;break}null!=d?c.zpp_inner_zn.b2=d.zpp_inner:b.push(ka.todo(this.b2.id,function(a){c.zpp_inner_zn.b2=a.zpp_inner}))}return c},validate:function(){if(null==this.b1||null==this.b2)throw new f("Error: AngleJoint cannot be simulated null bodies");
if(this.b1==this.b2)throw new f("Error: AngleJoint cannot be simulated with body1 == body2");if(this.b1.space!=this.space||this.b2.space!=this.space)throw new f("Error: Constraints must have each body within the same space to which the constraint has been assigned");if(this.jointMin>this.jointMax)throw new f("Error: AngleJoint must have jointMin <= jointMax");if(2!=this.b1.type&&2!=this.b2.type)throw new f("Error: Constraints cannot have both bodies non-dynamic");},wake_connected:function(){null!=
this.b1&&2==this.b1.type&&this.b1.wake();null!=this.b2&&2==this.b2.type&&this.b2.wake()},forest:function(){if(2==this.b1.type){var a;if(this.b1.component==this.b1.component.parent)a=this.b1.component;else{a=this.b1.component;for(var b=null;a!=a.parent;){var c=a.parent;a.parent=b;b=a;a=c}for(;null!=b;)c=b.parent,b.parent=a,b=c}if(this.component==this.component.parent)b=this.component;else{b=this.component;for(c=null;b!=b.parent;){var d=b.parent;b.parent=c;c=b;b=d}for(;null!=c;)d=c.parent,c.parent=
b,c=d}a!=b&&(a.rank<b.rank?a.parent=b:a.rank>b.rank?b.parent=a:(b.parent=a,a.rank++))}if(2==this.b2.type){if(this.b2.component==this.b2.component.parent)a=this.b2.component;else{a=this.b2.component;for(b=null;a!=a.parent;)c=a.parent,a.parent=b,b=a,a=c;for(;null!=b;)c=b.parent,b.parent=a,b=c}if(this.component==this.component.parent)b=this.component;else{b=this.component;for(c=null;b!=b.parent;)d=b.parent,b.parent=c,c=b,b=d;for(;null!=c;)d=c.parent,c.parent=b,c=d}a!=b&&(a.rank<b.rank?a.parent=b:a.rank>
b.rank?b.parent=a:(b.parent=a,a.rank++))}},pair_exists:function(a,b){return this.b1.id==a&&this.b2.id==b||this.b1.id==b&&this.b2.id==a},clearcache:function(){this.jAcc=0;this.pre_dt=-1;this.slack=!1},preStep:function(a){-1==this.pre_dt&&(this.pre_dt=a);var b=a/this.pre_dt;this.pre_dt=a;this.stepped=!0;this.equal=this.jointMin==this.jointMax;var c;c=this.ratio*this.b2.rot-this.b1.rot;this.equal?(c-=this.jointMax,this.slack=!1,this.scale=1):c<this.jointMin?(c=this.jointMin-c,this.scale=-1,this.slack=
!1):c>this.jointMax?(c-=this.jointMax,this.scale=1,this.slack=!1):(c=this.scale=0,this.slack=!0);if(!this.slack){this.kMass=this.b1.sinertia+this.ratio*this.ratio*this.b2.sinertia;0!=this.kMass?this.kMass=1/this.kMass:this.jAcc=0;if(this.stiff)this.gamma=this.bias=0;else{if(this.breakUnderError&&c*c>this.maxError*this.maxError)return!0;var d;d=2*Math.PI*this.frequency;this.gamma=1/(a*d*(2*this.damping+d*a));var e=1/(1+this.gamma);d=a*d*d*this.gamma;this.gamma*=e;this.kMass*=e;this.bias=-c*d;this.bias<
-this.maxError?this.bias=-this.maxError:this.bias>this.maxError&&(this.bias=this.maxError)}this.jAcc*=b;this.jMax=this.maxForce*a}return!1},warmStart:function(){this.slack||(this.b1.angvel-=this.scale*this.b1.iinertia*this.jAcc,this.b2.angvel+=this.ratio*this.scale*this.b2.iinertia*this.jAcc)},applyImpulseVel:function(){if(this.slack)return!1;var a=this.kMass*(this.bias-this.scale*(this.ratio*(this.b2.angvel+this.b2.kinangvel)-this.b1.angvel-this.b1.kinangvel))-this.jAcc*this.gamma,b=this.jAcc;this.jAcc+=
a;!this.equal&&0<this.jAcc&&(this.jAcc=0);if(this.breakUnderForce&&(this.jAcc>this.jMax||this.jAcc<-this.jMax))return!0;this.stiff||(this.jAcc>this.jMax?this.jAcc=this.jMax:this.jAcc<-this.jMax&&(this.jAcc=-this.jMax));a=this.jAcc-b;this.b1.angvel-=this.scale*this.b1.iinertia*a;this.b2.angvel+=this.ratio*this.scale*this.b2.iinertia*a;return!1},applyImpulsePos:function(){var a,b;a=this.ratio*this.b2.rot-this.b1.rot;this.equal?(a-=this.jointMax,b=!1,this.scale=1):a<this.jointMin?(a=this.jointMin-a,
this.scale=-1,b=!1):a>this.jointMax?(a-=this.jointMax,this.scale=1,b=!1):(a=this.scale=0,b=!0);if(!b){if(this.breakUnderError&&a*a>this.maxError*this.maxError)return!0;b=-(.5*a)*this.kMass;if(this.equal||0>b)this.b1.delta_rot(-this.scale*b*this.b1.iinertia),this.b2.delta_rot(this.ratio*this.scale*b*this.b2.iinertia)}return!1},draw:function(a){},__class__:pe});var ka=function(){this.bc=this.cb=null;this.id=0};ka.__name__=!0;ka.dict=function(a,b){var c=new ka;c.id=a;c.bc=b;return c};ka.todo=function(a,
b){var c=new ka;c.id=a;c.cb=b;return c};ka.prototype={__class__:ka};var ze=function(){this.stepped=!1;this.kMass=this.jAcc=this.jMax=this.gamma=this.bias=0;this.wrap_a2=null;this.a2localx=this.a2localy=this.a2relx=this.a2rely=0;this.wrap_a1=this.b2=null;this.a1localx=this.a1localy=this.a1relx=this.a1rely=0;this.b1=null;this.nx=this.ny=this.cx1=this.cx2=0;this.slack=this.equal=!1;this.jointMin=this.jointMax=0;this.outer_zn=null;ra.call(this);this.jAcc=this.a2rely=this.a2relx=this.a2localy=this.a2localx=
this.a1rely=this.a1relx=this.a1localy=this.a1localx=0;this.jMax=Infinity;this.stepped=!1;this.cx1=this.cx2=0};ze.__name__=!0;ze.__super__=ra;ze.prototype=I(ra.prototype,{is_slack:function(){var a;this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy;this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy;this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy;this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var b=a=0;a=this.b2.posx+this.a2relx-
(this.b1.posx+this.a1relx);b=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely);b=a*a+b*b;b<u.epsilon?(b=0,a=!0):(b=Math.sqrt(b),this.equal?(b-=this.jointMax,a=!1):b<this.jointMin?(b=this.jointMin-b,a=!1):b>this.jointMax?(b-=this.jointMax,a=!1):(b=0,a=!0));b;return a},bodyImpulse:function(a){return this.stepped?a==this.b1?N.get(-this.jAcc*this.nx,-this.jAcc*this.ny,-this.cx1*this.jAcc):N.get(this.jAcc*this.nx,this.jAcc*this.ny,this.cx2*this.jAcc):N.get(0,0,0)},activeBodies:function(){null!=this.b1&&
this.b1.constraints.add(this);this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this);this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},validate_a1:function(){this.wrap_a1.zpp_inner.x=this.a1localx;this.wrap_a1.zpp_inner.y=this.a1localy},invalidate_a1:function(a){this.immutable_midstep("Constraint::a1");this.a1localx=a.x;this.a1localy=a.y;this.wake()},setup_a1:function(){this.wrap_a1=E.get(this.a1localx,
this.a1localy,null);this.wrap_a1.zpp_inner._inuse=!0;this.wrap_a1.zpp_inner._validate=w(this,this.validate_a1);this.wrap_a1.zpp_inner._invalidate=w(this,this.invalidate_a1)},validate_a2:function(){this.wrap_a2.zpp_inner.x=this.a2localx;this.wrap_a2.zpp_inner.y=this.a2localy},invalidate_a2:function(a){this.immutable_midstep("Constraint::a2");this.a2localx=a.x;this.a2localy=a.y;this.wake()},setup_a2:function(){this.wrap_a2=E.get(this.a2localx,this.a2localy,null);this.wrap_a2.zpp_inner._inuse=!0;this.wrap_a2.zpp_inner._validate=
w(this,this.validate_a2);this.wrap_a2.zpp_inner._invalidate=w(this,this.invalidate_a2)},copy:function(a,b){var c=new Ae(null,null,this.outer_zn.get_anchor1(),this.outer_zn.get_anchor2(),this.jointMin,this.jointMax);this.copyto(c);if(null!=a&&null!=this.b1){for(var d=null,e=0;e<a.length;){var h=a[e];++e;if(h.id==this.b1.id){d=h.bc;break}}null!=d?c.zpp_inner_zn.b1=d.zpp_inner:b.push(ka.todo(this.b1.id,function(a){c.zpp_inner_zn.b1=a.zpp_inner}))}if(null!=a&&null!=this.b2){d=null;for(e=0;e<a.length;)if(h=
a[e],++e,h.id==this.b2.id){d=h.bc;break}null!=d?c.zpp_inner_zn.b2=d.zpp_inner:b.push(ka.todo(this.b2.id,function(a){c.zpp_inner_zn.b2=a.zpp_inner}))}return c},validate:function(){if(null==this.b1||null==this.b2)throw new f("Error: DistanceJoint cannot be simulated null bodies");if(this.b1==this.b2)throw new f("Error: DistanceJoint cannot be simulated with body1 == body2");if(this.b1.space!=this.space||this.b2.space!=this.space)throw new f("Error: Constraints must have each body within the same space to which the constraint has been assigned");
if(this.jointMin>this.jointMax)throw new f("Error: DistanceJoint must have jointMin <= jointMax");if(2!=this.b1.type&&2!=this.b2.type)throw new f("Error: Constraints cannot have both bodies non-dynamic");},wake_connected:function(){null!=this.b1&&2==this.b1.type&&this.b1.wake();null!=this.b2&&2==this.b2.type&&this.b2.wake()},forest:function(){if(2==this.b1.type){var a;if(this.b1.component==this.b1.component.parent)a=this.b1.component;else{a=this.b1.component;for(var b=null;a!=a.parent;){var c=a.parent;
a.parent=b;b=a;a=c}for(;null!=b;)c=b.parent,b.parent=a,b=c}if(this.component==this.component.parent)b=this.component;else{b=this.component;for(c=null;b!=b.parent;){var d=b.parent;b.parent=c;c=b;b=d}for(;null!=c;)d=c.parent,c.parent=b,c=d}a!=b&&(a.rank<b.rank?a.parent=b:a.rank>b.rank?b.parent=a:(b.parent=a,a.rank++))}if(2==this.b2.type){if(this.b2.component==this.b2.component.parent)a=this.b2.component;else{a=this.b2.component;for(b=null;a!=a.parent;)c=a.parent,a.parent=b,b=a,a=c;for(;null!=b;)c=b.parent,
b.parent=a,b=c}if(this.component==this.component.parent)b=this.component;else{b=this.component;for(c=null;b!=b.parent;)d=b.parent,b.parent=c,c=b,b=d;for(;null!=c;)d=c.parent,c.parent=b,c=d}a!=b&&(a.rank<b.rank?a.parent=b:a.rank>b.rank?b.parent=a:(b.parent=a,a.rank++))}},pair_exists:function(a,b){return this.b1.id==a&&this.b2.id==b||this.b1.id==b&&this.b2.id==a},clearcache:function(){this.jAcc=0;this.pre_dt=-1},preStep:function(a){-1==this.pre_dt&&(this.pre_dt=a);var b=a/this.pre_dt;this.pre_dt=a;
this.stepped=!0;this.equal=this.jointMin==this.jointMax;this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy;this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy;this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy;this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var c;this.nx=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx);this.ny=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely);c=this.nx*this.nx+this.ny*this.ny;if(c<u.epsilon)c=
this.ny=this.nx=0,this.slack=!0;else{c=Math.sqrt(c);var d=1/c;this.nx*=d;this.ny*=d;this.equal?(c-=this.jointMax,this.slack=!1):c<this.jointMin?(c=this.jointMin-c,this.nx=-this.nx,this.ny=-this.ny,this.slack=!1):c>this.jointMax?(c-=this.jointMax,this.slack=!1):(c=this.ny=this.nx=0,this.slack=!0)}if(!this.slack){this.cx1=this.ny*this.a1relx-this.nx*this.a1rely;this.cx2=this.ny*this.a2relx-this.nx*this.a2rely;this.kMass=this.b1.smass+this.b2.smass+this.cx1*this.cx1*this.b1.sinertia+this.cx2*this.cx2*
this.b2.sinertia;0!=this.kMass?this.kMass=1/this.kMass:this.jAcc=0;if(this.stiff)this.gamma=this.bias=0;else{if(this.breakUnderError&&c*c>this.maxError*this.maxError)return!0;var e;e=2*Math.PI*this.frequency;this.gamma=1/(a*e*(2*this.damping+e*a));d=1/(1+this.gamma);e=a*e*e*this.gamma;this.gamma*=d;this.kMass*=d;this.bias=-c*e;this.bias<-this.maxError?this.bias=-this.maxError:this.bias>this.maxError&&(this.bias=this.maxError)}this.jAcc*=b;this.jMax=this.maxForce*a}return!1},warmStart:function(){if(!this.slack){var a=
this.b1.imass*this.jAcc;this.b1.velx-=this.nx*a;this.b1.vely-=this.ny*a;a=this.b2.imass*this.jAcc;this.b2.velx+=this.nx*a;this.b2.vely+=this.ny*a;this.b1.angvel-=this.cx1*this.b1.iinertia*this.jAcc;this.b2.angvel+=this.cx2*this.b2.iinertia*this.jAcc}},applyImpulseVel:function(){if(this.slack)return!1;var a=this.kMass*(this.bias-(this.nx*(this.b2.velx+this.b2.kinvelx-this.b1.velx-this.b1.kinvelx)+this.ny*(this.b2.vely+this.b2.kinvely-this.b1.vely-this.b1.kinvely)+(this.b2.angvel+this.b2.kinangvel)*
this.cx2-(this.b1.angvel+this.b1.kinangvel)*this.cx1))-this.jAcc*this.gamma,b=this.jAcc;this.jAcc+=a;!this.equal&&0<this.jAcc&&(this.jAcc=0);if(this.breakUnderForce&&this.jAcc<-this.jMax)return!0;!this.stiff&&this.jAcc<-this.jMax&&(this.jAcc=-this.jMax);a=this.jAcc-b;b=this.b1.imass*a;this.b1.velx-=this.nx*b;this.b1.vely-=this.ny*b;b=this.b2.imass*a;this.b2.velx+=this.nx*b;this.b2.vely+=this.ny*b;this.b1.angvel-=this.cx1*this.b1.iinertia*a;this.b2.angvel+=this.cx2*this.b2.iinertia*a;return!1},applyImpulsePos:function(){var a,
b,c=0,d=0,c=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,d=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,e=0,h=0,e=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,h=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy,t=0,f=0,t=this.b2.posx+e-(this.b1.posx+c),f=this.b2.posy+h-(this.b1.posy+d);a=t*t+f*f;a<u.epsilon?(a=f=t=0,b=!0):(a=Math.sqrt(a),b=1/a,t*=b,f*=b,this.equal?(a-=this.jointMax,b=!1):a<this.jointMin?(a=this.jointMin-a,t=-t,f=-f,b=!1):a>this.jointMax?(a-=
this.jointMax,b=!1):(a=f=t=0,b=!0));if(!b){if(this.breakUnderError&&a*a>this.maxError*this.maxError)return!0;if(a*a<u.constraintLinearSlop*u.constraintLinearSlop)return!1;a*=.5;6<a*a&&(b=this.b1.smass+this.b2.smass,b>u.epsilon&&(b=.75/b*-a,this.equal||0>b))&&(a=b*this.b1.imass,this.b1.posx-=t*a,this.b1.posy-=f*a,a=b*this.b2.imass,this.b2.posx+=t*a,this.b2.posy+=f*a,t=this.b2.posx+e-(this.b1.posx+c),f=this.b2.posy+h-(this.b1.posy+d),a=t*t+f*f,a<u.epsilon?a=f=t=0:(a=Math.sqrt(a),b=1/a,t*=b,f*=b,this.equal?
a-=this.jointMax:a<this.jointMin?(a=this.jointMin-a,t=-t,f=-f):a>this.jointMax?a-=this.jointMax:a=f=t=0),a*=.5);c=f*c-t*d;e=f*e-t*h;h=this.b1.smass+this.b2.smass+c*c*this.b1.sinertia+e*e*this.b2.sinertia;0!=h&&(h=1/h);b=-a*h;if(this.equal||0>b)h=this.b1.imass*b,this.b1.posx-=t*h,this.b1.posy-=f*h,h=this.b2.imass*b,this.b2.posx+=t*h,this.b2.posy+=f*h,this.b1.delta_rot(-c*this.b1.iinertia*b),this.b2.delta_rot(e*this.b2.iinertia*b)}return!1},draw:function(a){},__class__:ze});var Be=function(){this.kMassa=
this.kMassb=this.kMassc=this.jAccx=this.jAccy=this.biasx=this.biasy=0;this.wrap_n=null;this.nlocalx=this.nlocaly=this.nrelx=this.nrely=0;this.wrap_a2=null;this.a2localx=this.a2localy=this.a2relx=this.a2rely=0;this.wrap_a1=null;this.dot1=this.dot2=this.cx1=this.cx2=this.a1localx=this.a1localy=this.a1relx=this.a1rely=0;this.equal=!1;this.scale=this.jointMin=this.jointMax=0;this.outer_zn=null;ra.call(this);this.jAccy=this.jAccx=this.nrely=this.nrelx=this.nlocaly=this.nlocalx=this.a2rely=this.a2relx=
this.a2localy=this.a2localx=this.a1rely=this.a1relx=this.a1localy=this.a1localx=0;this.jMax=Infinity;this.jointMin=-Infinity;this.jointMax=Infinity;this.stepped=!1};Be.__name__=!0;Be.__super__=ra;Be.prototype=I(ra.prototype,{bodyImpulse:function(a){if(this.stepped){var b=this.scale*this.nrelx*this.jAccy-this.nrely*this.jAccx,c=this.nrelx*this.jAccx+this.scale*this.nrely*this.jAccy;return a==this.b1?N.get(-b,-c,this.scale*this.cx1*c-this.dot1*b):N.get(b,c,this.scale*this.cx1*c-this.dot1*b)}return N.get(0,
0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this);this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this);this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},validate_a1:function(){this.wrap_a1.zpp_inner.x=this.a1localx;this.wrap_a1.zpp_inner.y=this.a1localy},invalidate_a1:function(a){this.immutable_midstep("Constraint::a1");this.a1localx=a.x;this.a1localy=a.y;this.wake()},setup_a1:function(){this.wrap_a1=
E.get(this.a1localx,this.a1localy,null);this.wrap_a1.zpp_inner._inuse=!0;this.wrap_a1.zpp_inner._validate=w(this,this.validate_a1);this.wrap_a1.zpp_inner._invalidate=w(this,this.invalidate_a1)},validate_a2:function(){this.wrap_a2.zpp_inner.x=this.a2localx;this.wrap_a2.zpp_inner.y=this.a2localy},invalidate_a2:function(a){this.immutable_midstep("Constraint::a2");this.a2localx=a.x;this.a2localy=a.y;this.wake()},setup_a2:function(){this.wrap_a2=E.get(this.a2localx,this.a2localy,null);this.wrap_a2.zpp_inner._inuse=
!0;this.wrap_a2.zpp_inner._validate=w(this,this.validate_a2);this.wrap_a2.zpp_inner._invalidate=w(this,this.invalidate_a2)},validate_n:function(){this.wrap_n.zpp_inner.x=this.nlocalx;this.wrap_n.zpp_inner.y=this.nlocaly},invalidate_n:function(a){this.immutable_midstep("Constraint::n");this.nlocalx=a.x;this.nlocaly=a.y;this.zip_n=!0;this.wake()},setup_n:function(){this.wrap_n=E.get(this.nlocalx,this.nlocaly,null);this.wrap_n.zpp_inner._inuse=!0;this.wrap_n.zpp_inner._validate=w(this,this.validate_n);
this.wrap_n.zpp_inner._invalidate=w(this,this.invalidate_n)},validate_norm:function(){if(this.zip_n){this.zip_n=!1;var a=1/Math.sqrt(this.nlocalx*this.nlocalx+this.nlocaly*this.nlocaly);this.nlocalx*=a;this.nlocaly*=a}},copy:function(a,b){var c=new Ce(null,null,this.outer_zn.get_anchor1(),this.outer_zn.get_anchor2(),this.outer_zn.get_direction(),this.jointMin,this.jointMax);this.copyto(c);if(null!=a&&null!=this.b1){for(var d=null,e=0;e<a.length;){var h=a[e];++e;if(h.id==this.b1.id){d=h.bc;break}}null!=
d?c.zpp_inner_zn.b1=d.zpp_inner:b.push(ka.todo(this.b1.id,function(a){c.zpp_inner_zn.b1=a.zpp_inner}))}if(null!=a&&null!=this.b2){d=null;for(e=0;e<a.length;)if(h=a[e],++e,h.id==this.b2.id){d=h.bc;break}null!=d?c.zpp_inner_zn.b2=d.zpp_inner:b.push(ka.todo(this.b2.id,function(a){c.zpp_inner_zn.b2=a.zpp_inner}))}return c},validate:function(){if(null==this.b1||null==this.b2)throw new f("Error: AngleJoint cannot be simulated null bodies");if(this.b1==this.b2)throw new f("Error: DistanceJoint cannot be simulated with body1 == body2");
if(this.b1.space!=this.space||this.b2.space!=this.space)throw new f("Error: Constraints must have each body within the same space to which the constraint has been assigned");if(this.jointMin>this.jointMax)throw new f("Error: DistanceJoint must have jointMin <= jointMax");if(this.nlocalx*this.nlocalx+this.nlocaly*this.nlocaly<u.epsilon)throw new f("Error: DistanceJoint direction must be non-degenerate");if(2!=this.b1.type&&2!=this.b2.type)throw new f("Error: Constraints cannot have both bodies non-dynamic");
},wake_connected:function(){null!=this.b1&&2==this.b1.type&&this.b1.wake();null!=this.b2&&2==this.b2.type&&this.b2.wake()},forest:function(){if(2==this.b1.type){var a;if(this.b1.component==this.b1.component.parent)a=this.b1.component;else{a=this.b1.component;for(var b=null;a!=a.parent;){var c=a.parent;a.parent=b;b=a;a=c}for(;null!=b;)c=b.parent,b.parent=a,b=c}if(this.component==this.component.parent)b=this.component;else{b=this.component;for(c=null;b!=b.parent;){var d=b.parent;b.parent=c;c=b;b=d}for(;null!=
c;)d=c.parent,c.parent=b,c=d}a!=b&&(a.rank<b.rank?a.parent=b:a.rank>b.rank?b.parent=a:(b.parent=a,a.rank++))}if(2==this.b2.type){if(this.b2.component==this.b2.component.parent)a=this.b2.component;else{a=this.b2.component;for(b=null;a!=a.parent;)c=a.parent,a.parent=b,b=a,a=c;for(;null!=b;)c=b.parent,b.parent=a,b=c}if(this.component==this.component.parent)b=this.component;else{b=this.component;for(c=null;b!=b.parent;)d=b.parent,b.parent=c,c=b,b=d;for(;null!=c;)d=c.parent,c.parent=b,c=d}a!=b&&(a.rank<
b.rank?a.parent=b:a.rank>b.rank?b.parent=a:(b.parent=a,a.rank++))}},pair_exists:function(a,b){return this.b1.id==a&&this.b2.id==b||this.b1.id==b&&this.b2.id==a},clearcache:function(){this.jAccy=this.jAccx=0;this.pre_dt=-1},preStep:function(a){-1==this.pre_dt&&(this.pre_dt=a);var b=a/this.pre_dt;this.pre_dt=a;this.equal=this.jointMin==this.jointMax;this.stepped=!0;this.validate_norm();this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy;this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*
this.b1.axisy;this.nrelx=this.b1.axisy*this.nlocalx-this.b1.axisx*this.nlocaly;this.nrely=this.nlocalx*this.b1.axisx+this.nlocaly*this.b1.axisy;this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy;this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var c=0,d=0,e=0,h=0,c=this.b2.posx+this.a2relx-this.b1.posx-this.a1relx,d=this.b2.posy+this.a2rely-this.b1.posy-this.a1rely,e=d*this.nrelx-c*this.nrely,h=this.nrelx*c+this.nrely*d;this.equal?(h-=this.jointMin,this.scale=1):
h>this.jointMax?(h-=this.jointMax,this.scale=1):h<this.jointMin?(h=this.jointMin-h,this.scale=-1):this.scale=h=0;var t=0,f=0,t=c+this.a1relx,f=d+this.a1rely;this.dot1=this.nrelx*t+this.nrely*f;this.cx1=f*this.nrelx-t*this.nrely;this.dot2=this.nrelx*this.a2relx+this.nrely*this.a2rely;this.cx2=this.a2rely*this.nrelx-this.a2relx*this.nrely;this.kMassa=this.b1.smass+this.b2.smass+this.dot1*this.dot1*this.b1.sinertia+this.dot2*this.dot2*this.b2.sinertia;this.kMassb=-this.scale*(this.dot1*this.cx1*this.b1.sinertia+
this.dot2*this.cx2*this.b2.sinertia);this.kMassc=this.scale*this.scale*(this.b1.smass+this.b2.smass+this.cx1*this.cx1*this.b1.sinertia+this.cx2*this.cx2*this.b2.sinertia);c=this.kMassa*this.kMassc-this.kMassb*this.kMassb;c!=c?(this.kMassa=this.kMassb=this.kMassc=0,c=3):0==c?(c=0,0!=this.kMassa?this.kMassa=1/this.kMassa:(this.kMassa=0,c|=1),0!=this.kMassc?this.kMassc=1/this.kMassc:(this.kMassc=0,c|=2),this.kMassb=0):(c=1/c,d=this.kMassc*c,this.kMassc=this.kMassa*c,this.kMassa=d,this.kMassb*=-c,c=0);
0!=(c&1)&&(this.jAccx=0);0!=(c&2)&&(this.jAccy=0);if(this.stiff)this.biasy=this.biasx=this.gamma=0;else{if(this.breakUnderError&&e*e+h*h>this.maxError*this.maxError)return!0;d=2*Math.PI*this.frequency;this.gamma=1/(a*d*(2*this.damping+d*a));c=1/(1+this.gamma);d=a*d*d*this.gamma;this.gamma*=c;this.kMassa*=c;this.kMassb*=c;this.kMassc*=c;this.biasx=e;this.biasy=h;e=-d;this.biasx*=e;this.biasy*=e;e=this.maxError;h=this.biasx*this.biasx+this.biasy*this.biasy;h>e*e&&(e*=1/Math.sqrt(h),this.biasx*=e,this.biasy*=
e)}this.jAccx*=b;this.jAccy*=b;this.jMax=this.maxForce*a;return!1},warmStart:function(){var a=this.scale*this.nrelx*this.jAccy-this.nrely*this.jAccx,b=this.nrelx*this.jAccx+this.scale*this.nrely*this.jAccy,c=this.b1.imass;this.b1.velx-=a*c;this.b1.vely-=b*c;c=this.b2.imass;this.b2.velx+=a*c;this.b2.vely+=b*c;this.b1.angvel+=(this.scale*this.cx1*this.jAccy-this.dot1*this.jAccx)*this.b1.iinertia;this.b2.angvel+=(this.dot2*this.jAccx-this.scale*this.cx2*this.jAccy)*this.b2.iinertia},applyImpulseVel:function(){var a=
0,b=0,c=0,d=0,c=this.b2.velx-this.b1.velx,d=this.b2.vely-this.b1.vely,c=c+(this.b2.kinvelx-this.b1.kinvelx),d=d+(this.b2.kinvely-this.b1.kinvely),a=d*this.nrelx-c*this.nrely+(this.b2.angvel+this.b2.kinangvel)*this.dot2-(this.b1.angvel+this.b1.kinangvel)*this.dot1,b=this.scale*(this.nrelx*c+this.nrely*d-(this.b2.angvel+this.b2.kinangvel)*this.cx2+(this.b1.angvel+this.b1.kinangvel)*this.cx1),d=c=0,c=this.biasx-a,d=this.biasy-b,a=this.kMassa*c+this.kMassb*d,d=this.kMassb*c+this.kMassc*d,b=this.gamma,
c=a-this.jAccx*b,d=d-this.jAccy*b,b=a=0,a=this.jAccx,b=this.jAccy;this.jAccx+=1*c;this.jAccy+=1*d;0<this.jAccy&&(this.jAccy=0);if(this.breakUnderForce){if(this.jAccx*this.jAccx+this.jAccy*this.jAccy>this.jMax*this.jMax)return!0}else this.stiff||(c=this.jMax,d=this.jAccx*this.jAccx+this.jAccy*this.jAccy,d>c*c&&(c*=1/Math.sqrt(d),this.jAccx*=c,this.jAccy*=c));var c=this.jAccx-a,d=this.jAccy-b,a=this.scale*this.nrelx*d-this.nrely*c,b=this.nrelx*c+this.scale*this.nrely*d,e=this.b1.imass;this.b1.velx-=
a*e;this.b1.vely-=b*e;e=this.b2.imass;this.b2.velx+=a*e;this.b2.vely+=b*e;this.b1.angvel+=(this.scale*this.cx1*d-this.dot1*c)*this.b1.iinertia;this.b2.angvel+=(this.dot2*c-this.scale*this.cx2*d)*this.b2.iinertia;return!1},applyImpulsePos:function(){var a=0,b=0,a=this.b1.axisy*this.nlocalx-this.b1.axisx*this.nlocaly,b=this.nlocalx*this.b1.axisx+this.nlocaly*this.b1.axisy,c=0,d=0,c=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,d=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,e=0,
h=0,e=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,h=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy,t=0,f=0,g,l=0,n=0,t=this.b2.posx+e-this.b1.posx-c,f=this.b2.posy+h-this.b1.posy-d,l=f*a-t*b,n=a*t+b*f;this.equal?(n-=this.jointMin,g=1):n>this.jointMax?(n-=this.jointMax,g=1):n<this.jointMin?(n=this.jointMin-n,g=-1):g=n=0;if(this.breakUnderError&&l*l+n*n>this.maxError*this.maxError)return!0;if(l*l+n*n<u.constraintLinearSlop*u.constraintLinearSlop)return!1;var r=0,z=0,l=.5*l,n=.5*
n;6<l*l+n*n&&(r=this.b1.smass+this.b2.smass,r>u.epsilon&&(r=.8/r,z=r*(b*l-g*a*n),g=r*(a*l*g-b*l),r=this.b1.imass,this.b1.posx-=z*r,this.b1.posy-=g*r,r=this.b2.imass,this.b2.posx+=z*r,this.b2.posy+=g*r,t=this.b2.posx+e-this.b1.posx-c,f=this.b2.posy+h-this.b1.posy-d,n=a*t+b*f,this.equal?(n-=this.jointMin,g=1):n>this.jointMax?(n-=this.jointMax,g=1):n<this.jointMin?(n=this.jointMin-n,g=-1):g=n=0,l=.5*(f*a-t*b),n*=.5));var x=0,p=0,y=0,z=r=0,r=t+c,z=f+d,c=a*r+b*z,t=z*a-r*b,d=a*e+b*h,e=h*a-e*b,x=this.b1.smass+
this.b2.smass+c*c*this.b1.sinertia+d*d*this.b2.sinertia,p=-g*(c*t*this.b1.sinertia+d*e*this.b2.sinertia),y=g*g*(this.b1.smass+this.b2.smass+t*t*this.b1.sinertia+e*e*this.b2.sinertia),r=-l,z=-n,h=x*y-p*p;h!=h?r=z=0:0==h?(r=0!=x?r/x:0,z=0!=y?z/y:0):(h=1/h,l=h*(y*r-p*z),z=h*(x*z-p*r),r=l);0<z&&(z=0);h=g*a*z-b*r;a=a*r+g*b*z;b=this.b1.imass;this.b1.posx-=h*b;this.b1.posy-=a*b;b=this.b2.imass;this.b2.posx+=h*b;this.b2.posy+=a*b;this.b1.delta_rot((g*t*z-c*r)*this.b1.iinertia);this.b2.delta_rot((d*r-g*e*
z)*this.b2.iinertia);return!1},draw:function(a){},__class__:Be});var De=function(){this.stepped=!1;this.kMass=this.jAcc=this.jMax=0;this.b1=this.b2=null;this.ratio=this.rate=0;this.outer_zn=null;ra.call(this);this.jAcc=0;this.stepped=!1;this.__velocity=!0};De.__name__=!0;De.__super__=ra;De.prototype=I(ra.prototype,{bodyImpulse:function(a){return this.stepped?a==this.b1?N.get(0,0,-this.jAcc):N.get(0,0,this.ratio*this.jAcc):N.get(0,0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this);
this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this);this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},copy:function(a,b){var c=new Ee(null,null,this.rate,this.ratio);this.copyto(c);if(null!=a&&null!=this.b1){for(var d=null,e=0;e<a.length;){var h=a[e];++e;if(h.id==this.b1.id){d=h.bc;break}}null!=d?c.zpp_inner_zn.b1=d.zpp_inner:b.push(ka.todo(this.b1.id,function(a){c.zpp_inner_zn.b1=a.zpp_inner}))}if(null!=
a&&null!=this.b2){d=null;for(e=0;e<a.length;)if(h=a[e],++e,h.id==this.b2.id){d=h.bc;break}null!=d?c.zpp_inner_zn.b2=d.zpp_inner:b.push(ka.todo(this.b2.id,function(a){c.zpp_inner_zn.b2=a.zpp_inner}))}return c},validate:function(){if(null==this.b1||null==this.b2)throw new f("Error: AngleJoint cannot be simulated null bodies");if(this.b1==this.b2)throw new f("Error: MotorJoint cannot be simulated with body1 == body2");if(this.b1.space!=this.space||this.b2.space!=this.space)throw new f("Error: Constraints must have each body within the same space to which the constraint has been assigned");
if(2!=this.b1.type&&2!=this.b2.type)throw new f("Error: Constraints cannot have both bodies non-dynamic");},wake_connected:function(){null!=this.b1&&2==this.b1.type&&this.b1.wake();null!=this.b2&&2==this.b2.type&&this.b2.wake()},forest:function(){if(2==this.b1.type){var a;if(this.b1.component==this.b1.component.parent)a=this.b1.component;else{a=this.b1.component;for(var b=null;a!=a.parent;){var c=a.parent;a.parent=b;b=a;a=c}for(;null!=b;)c=b.parent,b.parent=a,b=c}if(this.component==this.component.parent)b=
this.component;else{b=this.component;for(c=null;b!=b.parent;){var d=b.parent;b.parent=c;c=b;b=d}for(;null!=c;)d=c.parent,c.parent=b,c=d}a!=b&&(a.rank<b.rank?a.parent=b:a.rank>b.rank?b.parent=a:(b.parent=a,a.rank++))}if(2==this.b2.type){if(this.b2.component==this.b2.component.parent)a=this.b2.component;else{a=this.b2.component;for(b=null;a!=a.parent;)c=a.parent,a.parent=b,b=a,a=c;for(;null!=b;)c=b.parent,b.parent=a,b=c}if(this.component==this.component.parent)b=this.component;else{b=this.component;
for(c=null;b!=b.parent;)d=b.parent,b.parent=c,c=b,b=d;for(;null!=c;)d=c.parent,c.parent=b,c=d}a!=b&&(a.rank<b.rank?a.parent=b:a.rank>b.rank?b.parent=a:(b.parent=a,a.rank++))}},pair_exists:function(a,b){return this.b1.id==a&&this.b2.id==b||this.b1.id==b&&this.b2.id==a},clearcache:function(){this.jAcc=0;this.pre_dt=-1},preStep:function(a){-1==this.pre_dt&&(this.pre_dt=a);var b=a/this.pre_dt;this.pre_dt=a;this.stepped=!0;this.kMass=this.b1.sinertia+this.ratio*this.ratio*this.b2.sinertia;this.kMass=1/
this.kMass;this.jAcc*=b;this.jMax=this.maxForce*a;return!1},warmStart:function(){this.b1.angvel-=this.b1.iinertia*this.jAcc;this.b2.angvel+=this.ratio*this.b2.iinertia*this.jAcc},applyImpulseVel:function(){var a=-this.kMass*(this.ratio*(this.b2.angvel+this.b2.kinangvel)-this.b1.angvel-this.b1.kinangvel-this.rate),b=this.jAcc;this.jAcc+=a;if(this.breakUnderForce){if(this.jAcc>this.jMax||this.jAcc<-this.jMax)return!0}else this.jAcc<-this.jMax?this.jAcc=-this.jMax:this.jAcc>this.jMax&&(this.jAcc=this.jMax);
a=this.jAcc-b;this.b1.angvel-=this.b1.iinertia*a;this.b2.angvel+=this.ratio*this.b2.iinertia*a;return!1},applyImpulsePos:function(){return!1},__class__:De});var Fe=function(){this.stepped=!1;this.kMassa=this.kMassb=this.kMassc=this.jAccx=this.jAccy=this.jMax=this.gamma=this.biasx=this.biasy=0;this.wrap_a2=null;this.a2localx=this.a2localy=this.a2relx=this.a2rely=0;this.wrap_a1=this.b2=null;this.a1localx=this.a1localy=this.a1relx=this.a1rely=0;this.outer_zn=this.b1=null;ra.call(this);this.stepped=!1;
this.jAccy=this.jAccx=0;this.jMax=Infinity;this.a2rely=this.a2relx=this.a2localy=this.a2localx=this.a1rely=this.a1relx=this.a1localy=this.a1localx=0};Fe.__name__=!0;Fe.__super__=ra;Fe.prototype=I(ra.prototype,{bodyImpulse:function(a){return this.stepped?a==this.b1?N.get(-this.jAccx,-this.jAccy,-(this.jAccy*this.a1relx-this.jAccx*this.a1rely)):N.get(this.jAccx,this.jAccy,this.jAccy*this.a2relx-this.jAccx*this.a2rely):N.get(0,0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this);
this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this);this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},validate_a1:function(){this.wrap_a1.zpp_inner.x=this.a1localx;this.wrap_a1.zpp_inner.y=this.a1localy},invalidate_a1:function(a){this.immutable_midstep("Constraint::a1");this.a1localx=a.x;this.a1localy=a.y;this.wake()},setup_a1:function(){this.wrap_a1=E.get(this.a1localx,this.a1localy,null);this.wrap_a1.zpp_inner._inuse=
!0;this.wrap_a1.zpp_inner._validate=w(this,this.validate_a1);this.wrap_a1.zpp_inner._invalidate=w(this,this.invalidate_a1)},validate_a2:function(){this.wrap_a2.zpp_inner.x=this.a2localx;this.wrap_a2.zpp_inner.y=this.a2localy},invalidate_a2:function(a){this.immutable_midstep("Constraint::a2");this.a2localx=a.x;this.a2localy=a.y;this.wake()},setup_a2:function(){this.wrap_a2=E.get(this.a2localx,this.a2localy,null);this.wrap_a2.zpp_inner._inuse=!0;this.wrap_a2.zpp_inner._validate=w(this,this.validate_a2);
this.wrap_a2.zpp_inner._invalidate=w(this,this.invalidate_a2)},copy:function(a,b){var c=new Ud(null,null,this.outer_zn.get_anchor1(),this.outer_zn.get_anchor2());this.copyto(c);if(null!=a&&null!=this.b1){for(var d=null,e=0;e<a.length;){var h=a[e];++e;if(h.id==this.b1.id){d=h.bc;break}}null!=d?c.zpp_inner_zn.b1=d.zpp_inner:b.push(ka.todo(this.b1.id,function(a){c.zpp_inner_zn.b1=a.zpp_inner}))}if(null!=a&&null!=this.b2){d=null;for(e=0;e<a.length;)if(h=a[e],++e,h.id==this.b2.id){d=h.bc;break}null!=d?
c.zpp_inner_zn.b2=d.zpp_inner:b.push(ka.todo(this.b2.id,function(a){c.zpp_inner_zn.b2=a.zpp_inner}))}return c},validate:function(){if(null==this.b1||null==this.b2)throw new f("Error: PivotJoint cannot be simulated null bodies");if(this.b1==this.b2)throw new f("Error: PivotJoint cannot be simulated with body1 == body2 (body1=body2="+this.b1.outer.toString()+")");if(this.b1.space!=this.space||this.b2.space!=this.space)throw new f("Error: Constraints must have each body within the same space to which the constraint has been assigned (body1="+
this.b1.outer.toString()+", body2="+this.b2.outer.toString()+")");if(2!=this.b1.type&&2!=this.b2.type)throw new f("Error: Constraints cannot have both bodies non-dynamic (body1="+this.b1.outer.toString()+", body2="+this.b2.outer.toString()+")");},wake_connected:function(){null!=this.b1&&2==this.b1.type&&this.b1.wake();null!=this.b2&&2==this.b2.type&&this.b2.wake()},forest:function(){if(2==this.b1.type){var a;if(this.b1.component==this.b1.component.parent)a=this.b1.component;else{a=this.b1.component;
for(var b=null;a!=a.parent;){var c=a.parent;a.parent=b;b=a;a=c}for(;null!=b;)c=b.parent,b.parent=a,b=c}if(this.component==this.component.parent)b=this.component;else{b=this.component;for(c=null;b!=b.parent;){var d=b.parent;b.parent=c;c=b;b=d}for(;null!=c;)d=c.parent,c.parent=b,c=d}a!=b&&(a.rank<b.rank?a.parent=b:a.rank>b.rank?b.parent=a:(b.parent=a,a.rank++))}if(2==this.b2.type){if(this.b2.component==this.b2.component.parent)a=this.b2.component;else{a=this.b2.component;for(b=null;a!=a.parent;)c=a.parent,
a.parent=b,b=a,a=c;for(;null!=b;)c=b.parent,b.parent=a,b=c}if(this.component==this.component.parent)b=this.component;else{b=this.component;for(c=null;b!=b.parent;)d=b.parent,b.parent=c,c=b,b=d;for(;null!=c;)d=c.parent,c.parent=b,c=d}a!=b&&(a.rank<b.rank?a.parent=b:a.rank>b.rank?b.parent=a:(b.parent=a,a.rank++))}},pair_exists:function(a,b){return this.b1.id==a&&this.b2.id==b||this.b1.id==b&&this.b2.id==a},clearcache:function(){this.jAccy=this.jAccx=0;this.pre_dt=-1},preStep:function(a){-1==this.pre_dt&&
(this.pre_dt=a);var b=a/this.pre_dt;this.pre_dt=a;this.stepped=!0;this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy;this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy;this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy;this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var c=this.b1.smass+this.b2.smass;this.kMassa=c;this.kMassb=0;this.kMassc=c;if(0!=this.b1.sinertia){var c=this.a1relx*this.b1.sinertia,d=this.a1rely*this.b1.sinertia;
this.kMassa+=d*this.a1rely;this.kMassb+=-d*this.a1relx;this.kMassc+=c*this.a1relx}0!=this.b2.sinertia&&(c=this.a2relx*this.b2.sinertia,d=this.a2rely*this.b2.sinertia,this.kMassa+=d*this.a2rely,this.kMassb+=-d*this.a2relx,this.kMassc+=c*this.a2relx);c=this.kMassa*this.kMassc-this.kMassb*this.kMassb;c!=c?(this.kMassa=this.kMassb=this.kMassc=0,c=3):0==c?(c=0,0!=this.kMassa?this.kMassa=1/this.kMassa:(this.kMassa=0,c|=1),0!=this.kMassc?this.kMassc=1/this.kMassc:(this.kMassc=0,c|=2),this.kMassb=0):(c=1/
c,d=this.kMassc*c,this.kMassc=this.kMassa*c,this.kMassa=d,this.kMassb*=-c,c=0);0!=(c&1)&&(this.jAccx=0);0!=(c&2)&&(this.jAccy=0);if(this.stiff)this.gamma=this.biasy=this.biasx=0;else{d=2*Math.PI*this.frequency;this.gamma=1/(a*d*(2*this.damping+d*a));c=1/(1+this.gamma);d=a*d*d*this.gamma;this.gamma*=c;this.kMassa*=c;this.kMassb*=c;this.kMassc*=c;this.biasx=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx);this.biasy=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely);if(this.breakUnderError&&this.biasx*
this.biasx+this.biasy*this.biasy>this.maxError*this.maxError)return!0;c=-d;this.biasx*=c;this.biasy*=c;c=this.maxError;d=this.biasx*this.biasx+this.biasy*this.biasy;d>c*c&&(c*=1/Math.sqrt(d),this.biasx*=c,this.biasy*=c)}this.jAccx*=b;this.jAccy*=b;this.jMax=this.maxForce*a;return!1},warmStart:function(){var a=this.b1.imass;this.b1.velx-=this.jAccx*a;this.b1.vely-=this.jAccy*a;a=this.b2.imass;this.b2.velx+=this.jAccx*a;this.b2.vely+=this.jAccy*a;this.b1.angvel-=(this.jAccy*this.a1relx-this.jAccx*this.a1rely)*
this.b1.iinertia;this.b2.angvel+=(this.jAccy*this.a2relx-this.jAccx*this.a2rely)*this.b2.iinertia},applyImpulseVel:function(){var a=0,b=0,a=this.b2.velx+this.b2.kinvelx-this.a2rely*(this.b2.angvel+this.b2.kinangvel)-(this.b1.velx+this.b1.kinvelx-this.a1rely*(this.b1.angvel+this.b1.kinangvel)),b=this.b2.vely+this.b2.kinvely+this.a2relx*(this.b2.angvel+this.b2.kinangvel)-(this.b1.vely+this.b1.kinvely+this.a1relx*(this.b1.angvel+this.b1.kinangvel)),c=0,d=0,c=this.biasx-a,d=this.biasy-b,a=this.kMassa*
c+this.kMassb*d,d=this.kMassb*c+this.kMassc*d,b=this.gamma,c=a-this.jAccx*b,d=d-this.jAccy*b,b=a=0,a=this.jAccx,b=this.jAccy;this.jAccx+=1*c;this.jAccy+=1*d;if(this.breakUnderForce){if(this.jAccx*this.jAccx+this.jAccy*this.jAccy>this.jMax*this.jMax)return!0}else this.stiff||(c=this.jMax,d=this.jAccx*this.jAccx+this.jAccy*this.jAccy,d>c*c&&(c*=1/Math.sqrt(d),this.jAccx*=c,this.jAccy*=c));c=this.jAccx-a;d=this.jAccy-b;a=this.b1.imass;this.b1.velx-=c*a;this.b1.vely-=d*a;a=this.b2.imass;this.b2.velx+=
c*a;this.b2.vely+=d*a;this.b1.angvel-=(d*this.a1relx-c*this.a1rely)*this.b1.iinertia;this.b2.angvel+=(d*this.a2relx-c*this.a2rely)*this.b2.iinertia;return!1},applyImpulsePos:function(){var a=0,b=0,a=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,b=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,c=0,d=0,c=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,d=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy,e=0,h=0,e=this.b2.posx+c-(this.b1.posx+a),h=this.b2.posy+d-(this.b1.posy+
b);if(this.breakUnderError&&e*e+h*h>this.maxError*this.maxError)return!0;if(e*e+h*h<u.constraintLinearSlop*u.constraintLinearSlop)return!1;var e=.5*e,h=.5*h,t=0,f=0;if(6<e*e+h*h&&(f=this.b1.smass+this.b2.smass,f>u.epsilon)){var f=.75/f,t=-e*f,f=-h*f,g=t*t+f*f;400<g&&(g=1/Math.sqrt(g)*20,t*=g,f*=g);g=this.b1.imass;this.b1.posx-=t*g;this.b1.posy-=f*g;g=this.b2.imass;this.b2.posx+=t*g;this.b2.posy+=f*g;e=this.b2.posx+c-(this.b1.posx+a);h=this.b2.posy+d-(this.b1.posy+b);e*=.5;h*=.5}var l=g=0,n=0,g=t=
this.b1.smass+this.b2.smass,l=0,n=t;0!=this.b1.sinertia&&(t=a*this.b1.sinertia,f=b*this.b1.sinertia,g+=f*b,l+=-f*a,n+=t*a);0!=this.b2.sinertia&&(t=c*this.b2.sinertia,f=d*this.b2.sinertia,g+=f*d,l+=-f*c,n+=t*c);t=-e;f=-h;e=t*t+f*f;36<e&&(e=1/Math.sqrt(e)*6,t*=e,f*=e);e=g*n-l*l;e!=e?t=f=0:0==e?(t=0!=g?t/g:0,f=0!=n?f/n:0):(e=1/e,n=e*(n*t-l*f),f=e*(g*f-l*t),t=n);g=this.b1.imass;this.b1.posx-=t*g;this.b1.posy-=f*g;g=this.b2.imass;this.b2.posx+=t*g;this.b2.posy+=f*g;this.b1.delta_rot(-(f*a-t*b)*this.b1.iinertia);
this.b2.delta_rot((f*c-t*d)*this.b2.iinertia);return!1},draw:function(a){},__class__:Fe});var Ge=function(){this.stepped=!1;this.kMass=this.jAcc=this.jMax=this.gamma=this.bias=0;this.wrap_a4=null;this.a4localx=this.a4localy=this.a4relx=this.a4rely=0;this.wrap_a3=this.b4=null;this.a3localx=this.a3localy=this.a3relx=this.a3rely=0;this.wrap_a2=this.b3=null;this.a2localx=this.a2localy=this.a2relx=this.a2rely=0;this.wrap_a1=this.b2=null;this.a1localx=this.a1localy=this.a1relx=this.a1rely=0;this.b1=null;
this.n12x=this.n12y=this.n34x=this.n34y=this.cx1=this.cx2=this.cx3=this.cx4=0;this.slack=this.equal=!1;this.jointMin=this.jointMax=0;this.ratio=1;this.outer_zn=null;ra.call(this);this.a4rely=this.a4relx=this.a4localy=this.a4localx=this.a3rely=this.a3relx=this.a3localy=this.a3localx=this.a2rely=this.a2relx=this.a2localy=this.a2localx=this.a1rely=this.a1relx=this.a1localy=this.a1localx=0;this.n12x=1;this.n12y=0;this.n34x=1;this.jAcc=this.n34y=0;this.jMax=Infinity;this.stepped=!1;this.cx1=this.cx2=this.cx3=
this.cx4=0};Ge.__name__=!0;Ge.__super__=ra;Ge.prototype=I(ra.prototype,{is_slack:function(){var a;this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy;this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy;this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy;this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;this.a3relx=this.b3.axisy*this.a3localx-this.b3.axisx*this.a3localy;this.a3rely=this.a3localx*this.b3.axisx+this.a3localy*this.b3.axisy;
this.a4relx=this.b4.axisy*this.a4localx-this.b4.axisx*this.a4localy;this.a4rely=this.a4localx*this.b4.axisx+this.a4localy*this.b4.axisy;var b=a=0,c=0,d=0;a=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx);b=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely);c=this.b4.posx+this.a4relx-(this.b3.posx+this.a3relx);d=this.b4.posy+this.a4rely-(this.b3.posy+this.a3rely);b=Math.sqrt(a*a+b*b)+this.ratio*Math.sqrt(c*c+d*d);this.equal?(b-=this.jointMax,a=!1):b<this.jointMin?(b=this.jointMin-b,a=!1):b>this.jointMax?
(b-=this.jointMax,a=!1):(b=0,a=!0);b;return a},bodyImpulse:function(a){if(this.stepped){var b=N.get();a==this.b1&&(b.set_x(function(a){if(null!=b&&b.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");b.zpp_inner.validate();return b.zpp_inner.x}(this)-this.jAcc*this.n12x),b.set_y(function(a){if(null!=b&&b.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");b.zpp_inner.validate();return b.zpp_inner.y}(this)-this.jAcc*this.n12y),b.set_z(function(a){if(null!=
b&&b.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");b.zpp_inner.validate();return b.zpp_inner.z}(this)-this.cx1*this.jAcc));a==this.b2&&(b.set_x(function(a){if(null!=b&&b.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");b.zpp_inner.validate();return b.zpp_inner.x}(this)+this.jAcc*this.n12x),b.set_y(function(a){if(null!=b&&b.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");b.zpp_inner.validate();return b.zpp_inner.y}(this)+
this.jAcc*this.n12y),b.set_z(function(a){if(null!=b&&b.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");b.zpp_inner.validate();return b.zpp_inner.z}(this)+this.cx2*this.jAcc));a==this.b3&&(b.set_x(function(a){if(null!=b&&b.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");b.zpp_inner.validate();return b.zpp_inner.x}(this)-this.jAcc*this.n34x),b.set_y(function(a){if(null!=b&&b.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");
b.zpp_inner.validate();return b.zpp_inner.y}(this)-this.jAcc*this.n34y),b.set_z(function(a){if(null!=b&&b.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");b.zpp_inner.validate();return b.zpp_inner.z}(this)-this.cx3*this.jAcc));a==this.b4&&(b.set_x(function(a){if(null!=b&&b.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");b.zpp_inner.validate();return b.zpp_inner.x}(this)+this.jAcc*this.n34x),b.set_y(function(a){if(null!=b&&b.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");
b.zpp_inner.validate();return b.zpp_inner.y}(this)+this.jAcc*this.n34y),b.set_z(function(a){if(null!=b&&b.zpp_disp)throw new f("Error: Vec3 has been disposed and cannot be used!");b.zpp_inner.validate();return b.zpp_inner.z}(this)+this.cx4*this.jAcc));return b}return N.get(0,0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this);this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this);this.b3!=this.b1&&this.b3!=this.b2&&null!=this.b3&&this.b3.constraints.add(this);this.b4!=
this.b1&&this.b4!=this.b2&&this.b4!=this.b3&&null!=this.b4&&this.b4.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this);this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this);this.b3!=this.b1&&this.b3!=this.b2&&null!=this.b3&&this.b3.constraints.remove(this);this.b4!=this.b1&&this.b4!=this.b2&&this.b4!=this.b3&&null!=this.b4&&this.b4.constraints.remove(this)},validate_a1:function(){this.wrap_a1.zpp_inner.x=this.a1localx;this.wrap_a1.zpp_inner.y=
this.a1localy},invalidate_a1:function(a){this.immutable_midstep("Constraint::a1");this.a1localx=a.x;this.a1localy=a.y;this.wake()},setup_a1:function(){this.wrap_a1=E.get(this.a1localx,this.a1localy,null);this.wrap_a1.zpp_inner._inuse=!0;this.wrap_a1.zpp_inner._validate=w(this,this.validate_a1);this.wrap_a1.zpp_inner._invalidate=w(this,this.invalidate_a1)},validate_a2:function(){this.wrap_a2.zpp_inner.x=this.a2localx;this.wrap_a2.zpp_inner.y=this.a2localy},invalidate_a2:function(a){this.immutable_midstep("Constraint::a2");
this.a2localx=a.x;this.a2localy=a.y;this.wake()},setup_a2:function(){this.wrap_a2=E.get(this.a2localx,this.a2localy,null);this.wrap_a2.zpp_inner._inuse=!0;this.wrap_a2.zpp_inner._validate=w(this,this.validate_a2);this.wrap_a2.zpp_inner._invalidate=w(this,this.invalidate_a2)},validate_a3:function(){this.wrap_a3.zpp_inner.x=this.a3localx;this.wrap_a3.zpp_inner.y=this.a3localy},invalidate_a3:function(a){this.immutable_midstep("Constraint::a3");this.a3localx=a.x;this.a3localy=a.y;this.wake()},setup_a3:function(){this.wrap_a3=
E.get(this.a3localx,this.a3localy,null);this.wrap_a3.zpp_inner._inuse=!0;this.wrap_a3.zpp_inner._validate=w(this,this.validate_a3);this.wrap_a3.zpp_inner._invalidate=w(this,this.invalidate_a3)},validate_a4:function(){this.wrap_a4.zpp_inner.x=this.a4localx;this.wrap_a4.zpp_inner.y=this.a4localy},invalidate_a4:function(a){this.immutable_midstep("Constraint::a4");this.a4localx=a.x;this.a4localy=a.y;this.wake()},setup_a4:function(){this.wrap_a4=E.get(this.a4localx,this.a4localy,null);this.wrap_a4.zpp_inner._inuse=
!0;this.wrap_a4.zpp_inner._validate=w(this,this.validate_a4);this.wrap_a4.zpp_inner._invalidate=w(this,this.invalidate_a4)},copy:function(a,b){var c=new He(null,null,null,null,this.outer_zn.get_anchor1(),this.outer_zn.get_anchor2(),this.outer_zn.get_anchor3(),this.outer_zn.get_anchor4(),this.jointMin,this.jointMax,this.ratio);this.copyto(c);if(null!=a&&null!=this.b1){for(var d=null,e=0;e<a.length;){var h=a[e];++e;if(h.id==this.b1.id){d=h.bc;break}}null!=d?c.zpp_inner_zn.b1=d.zpp_inner:b.push(ka.todo(this.b1.id,
function(a){c.zpp_inner_zn.b1=a.zpp_inner}))}if(null!=a&&null!=this.b2){d=null;for(e=0;e<a.length;)if(h=a[e],++e,h.id==this.b2.id){d=h.bc;break}null!=d?c.zpp_inner_zn.b2=d.zpp_inner:b.push(ka.todo(this.b2.id,function(a){c.zpp_inner_zn.b2=a.zpp_inner}))}if(null!=a&&null!=this.b3){d=null;for(e=0;e<a.length;)if(h=a[e],++e,h.id==this.b3.id){d=h.bc;break}null!=d?c.zpp_inner_zn.b3=d.zpp_inner:b.push(ka.todo(this.b3.id,function(a){c.zpp_inner_zn.b3=a.zpp_inner}))}if(null!=a&&null!=this.b4){d=null;for(e=
0;e<a.length;)if(h=a[e],++e,h.id==this.b4.id){d=h.bc;break}null!=d?c.zpp_inner_zn.b4=d.zpp_inner:b.push(ka.todo(this.b4.id,function(a){c.zpp_inner_zn.b4=a.zpp_inner}))}return c},validate:function(){if(null==this.b1||null==this.b2||null==this.b3||null==this.b4)throw new f("Error: PulleyJoint cannot be simulated with null bodies");if(this.b1==this.b2||this.b3==this.b4)throw new f("Error: PulleyJoint cannot have body1==body2 or body3==body4");if(this.b1.space!=this.space||this.b2.space!=this.space||
this.b3.space!=this.space||this.b4.space!=this.space)throw new f("Error: Constraints must have each body within the same space to which the constraint has been assigned");if(this.jointMin>this.jointMax)throw new f("Error: PulleyJoint must have jointMin <= jointMax");if(2!=this.b1.type&&2!=this.b2.type)throw new f("Error: PulleyJoint cannot have both bodies in a linked pair non-dynamic");if(2!=this.b3.type&&2!=this.b4.type)throw new f("Error: PulleyJoint cannot have both bodies in a linked pair non-dynamic");
},wake_connected:function(){null!=this.b1&&2==this.b1.type&&this.b1.wake();null!=this.b2&&2==this.b2.type&&this.b2.wake();null!=this.b3&&2==this.b3.type&&this.b3.wake();null!=this.b4&&2==this.b4.type&&this.b4.wake()},forest:function(){if(2==this.b1.type){var a;if(this.b1.component==this.b1.component.parent)a=this.b1.component;else{a=this.b1.component;for(var b=null;a!=a.parent;){var c=a.parent;a.parent=b;b=a;a=c}for(;null!=b;)c=b.parent,b.parent=a,b=c}if(this.component==this.component.parent)b=this.component;
else{b=this.component;for(c=null;b!=b.parent;){var d=b.parent;b.parent=c;c=b;b=d}for(;null!=c;)d=c.parent,c.parent=b,c=d}a!=b&&(a.rank<b.rank?a.parent=b:a.rank>b.rank?b.parent=a:(b.parent=a,a.rank++))}if(2==this.b2.type){if(this.b2.component==this.b2.component.parent)a=this.b2.component;else{a=this.b2.component;for(b=null;a!=a.parent;)c=a.parent,a.parent=b,b=a,a=c;for(;null!=b;)c=b.parent,b.parent=a,b=c}if(this.component==this.component.parent)b=this.component;else{b=this.component;for(c=null;b!=
b.parent;)d=b.parent,b.parent=c,c=b,b=d;for(;null!=c;)d=c.parent,c.parent=b,c=d}a!=b&&(a.rank<b.rank?a.parent=b:a.rank>b.rank?b.parent=a:(b.parent=a,a.rank++))}if(2==this.b3.type){if(this.b3.component==this.b3.component.parent)a=this.b3.component;else{a=this.b3.component;for(b=null;a!=a.parent;)c=a.parent,a.parent=b,b=a,a=c;for(;null!=b;)c=b.parent,b.parent=a,b=c}if(this.component==this.component.parent)b=this.component;else{b=this.component;for(c=null;b!=b.parent;)d=b.parent,b.parent=c,c=b,b=d;for(;null!=
c;)d=c.parent,c.parent=b,c=d}a!=b&&(a.rank<b.rank?a.parent=b:a.rank>b.rank?b.parent=a:(b.parent=a,a.rank++))}if(2==this.b4.type){if(this.b4.component==this.b4.component.parent)a=this.b4.component;else{a=this.b4.component;for(b=null;a!=a.parent;)c=a.parent,a.parent=b,b=a,a=c;for(;null!=b;)c=b.parent,b.parent=a,b=c}if(this.component==this.component.parent)b=this.component;else{b=this.component;for(c=null;b!=b.parent;)d=b.parent,b.parent=c,c=b,b=d;for(;null!=c;)d=c.parent,c.parent=b,c=d}a!=b&&(a.rank<
b.rank?a.parent=b:a.rank>b.rank?b.parent=a:(b.parent=a,a.rank++))}},pair_exists:function(a,b){return this.b1.id==a&&(this.b2.id==b||this.b3.id==b||this.b4.id==b)||this.b2.id==a&&(this.b3.id==b||this.b4.id==b||this.b1.id==b)||this.b3.id==a&&(this.b4.id==b||this.b1.id==b||this.b2.id==b)||this.b4.id==a&&(this.b1.id==b||this.b2.id==b||this.b3.id==b)},clearcache:function(){this.jAcc=0;this.pre_dt=-1},preStep:function(a){-1==this.pre_dt&&(this.pre_dt=a);var b=a/this.pre_dt;this.pre_dt=a;this.stepped=!0;
this.equal=this.jointMin==this.jointMax;this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy;this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy;this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy;this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;this.a3relx=this.b3.axisy*this.a3localx-this.b3.axisx*this.a3localy;this.a3rely=this.a3localx*this.b3.axisx+this.a3localy*this.b3.axisy;this.a4relx=this.b4.axisy*this.a4localx-this.b4.axisx*
this.a4localy;this.a4rely=this.a4localx*this.b4.axisx+this.a4localy*this.b4.axisy;var c,d=0,e=0,h=0,t=0,d=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx),e=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely),h=this.b4.posx+this.a4relx-(this.b3.posx+this.a3relx),t=this.b4.posy+this.a4rely-(this.b3.posy+this.a3rely);c=Math.sqrt(d*d+e*e);var f=Math.sqrt(h*h+t*t);if(0!=c){var g=1/c;this.n12x=d*g;this.n12y=e*g}0!=f?(d=1/f,this.n34x=h*d,this.n34y=t*d,h=this.ratio):h=this.ratio/Math.sqrt(this.n34x*this.n34x+
this.n34y*this.n34y);this.n34x*=h;this.n34y*=h;c+=this.ratio*f;this.equal?(c-=this.jointMax,this.slack=!1):c<this.jointMin?(c=this.jointMin-c,this.n12x=-this.n12x,this.n12y=-this.n12y,this.n34x=-this.n34x,this.n34y=-this.n34y,this.slack=!1):c>this.jointMax?(c-=this.jointMax,this.slack=!1):(c=this.n34y=this.n34x=this.n12y=this.n12x=0,this.slack=!0);if(!this.slack){this.cx1=this.n12y*this.a1relx-this.n12x*this.a1rely;this.cx2=this.n12y*this.a2relx-this.n12x*this.a2rely;this.cx3=this.n34y*this.a3relx-
this.n34x*this.a3rely;this.cx4=this.n34y*this.a4relx-this.n34x*this.a4rely;f=this.b1.smass+this.b2.smass+this.ratio*this.ratio*(this.b3.smass+this.b4.smass)+this.b1.sinertia*this.cx1*this.cx1+this.b2.sinertia*this.cx2*this.cx2+this.b3.sinertia*this.cx3*this.cx3+this.b4.sinertia*this.cx4*this.cx4;this.b1==this.b4&&(f-=2*((this.n12x*this.n34x+this.n12y*this.n34y)*this.b1.smass+this.cx1*this.cx4*this.b1.sinertia));this.b1==this.b3&&(f+=2*((this.n12x*this.n34x+this.n12y*this.n34y)*this.b1.smass+this.cx1*
this.cx3*this.b1.sinertia));this.b2==this.b3&&(f-=2*((this.n12x*this.n34x+this.n12y*this.n34y)*this.b2.smass+this.cx2*this.cx3*this.b2.sinertia));this.b2==this.b4&&(f+=2*((this.n12x*this.n34x+this.n12y*this.n34y)*this.b2.smass+this.cx2*this.cx4*this.b2.sinertia));this.kMass=f;0!=this.kMass?this.kMass=1/this.kMass:this.jAcc=0;if(this.stiff)this.gamma=this.bias=0;else{if(this.breakUnderError&&c*c>this.maxError*this.maxError)return!0;h=2*Math.PI*this.frequency;this.gamma=1/(a*h*(2*this.damping+h*a));
f=1/(1+this.gamma);h=a*h*h*this.gamma;this.gamma*=f;this.kMass*=f;this.bias=-c*h;this.bias<-this.maxError?this.bias=-this.maxError:this.bias>this.maxError&&(this.bias=this.maxError)}this.jAcc*=b;this.jMax=this.maxForce*a}return!1},warmStart:function(){if(!this.slack){var a=this.b1.imass*this.jAcc;this.b1.velx-=this.n12x*a;this.b1.vely-=this.n12y*a;a=this.b2.imass*this.jAcc;this.b2.velx+=this.n12x*a;this.b2.vely+=this.n12y*a;a=this.b3.imass*this.jAcc;this.b3.velx-=this.n34x*a;this.b3.vely-=this.n34y*
a;a=this.b4.imass*this.jAcc;this.b4.velx+=this.n34x*a;this.b4.vely+=this.n34y*a;this.b1.angvel-=this.cx1*this.b1.iinertia*this.jAcc;this.b2.angvel+=this.cx2*this.b2.iinertia*this.jAcc;this.b3.angvel-=this.cx3*this.b3.iinertia*this.jAcc;this.b4.angvel+=this.cx4*this.b4.iinertia*this.jAcc}},applyImpulseVel:function(){if(this.slack)return!1;var a=this.kMass*(this.bias-(this.n12x*(this.b2.velx+this.b2.kinvelx-this.b1.velx-this.b1.kinvelx)+this.n12y*(this.b2.vely+this.b2.kinvely-this.b1.vely-this.b1.kinvely)+
this.n34x*(this.b4.velx+this.b4.kinvelx-this.b3.velx-this.b3.kinvelx)+this.n34y*(this.b4.vely+this.b4.kinvely-this.b3.vely-this.b3.kinvely)+(this.b2.angvel+this.b2.kinangvel)*this.cx2-(this.b1.angvel+this.b1.kinangvel)*this.cx1+(this.b4.angvel+this.b4.kinangvel)*this.cx4-(this.b3.angvel+this.b3.kinangvel)*this.cx3))-this.jAcc*this.gamma,b=this.jAcc;this.jAcc+=a;!this.equal&&0<this.jAcc&&(this.jAcc=0);if(this.breakUnderForce&&this.jAcc<-this.jMax)return!0;!this.stiff&&this.jAcc<-this.jMax&&(this.jAcc=
-this.jMax);a=this.jAcc-b;b=this.b1.imass*a;this.b1.velx-=this.n12x*b;this.b1.vely-=this.n12y*b;b=this.b2.imass*a;this.b2.velx+=this.n12x*b;this.b2.vely+=this.n12y*b;b=this.b3.imass*a;this.b3.velx-=this.n34x*b;this.b3.vely-=this.n34y*b;b=this.b4.imass*a;this.b4.velx+=this.n34x*b;this.b4.vely+=this.n34y*b;this.b1.angvel-=this.cx1*this.b1.iinertia*a;this.b2.angvel+=this.cx2*this.b2.iinertia*a;this.b3.angvel-=this.cx3*this.b3.iinertia*a;this.b4.angvel+=this.cx4*this.b4.iinertia*a;return!1},applyImpulsePos:function(){var a,
b,c=0,d=0,c=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,d=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,e=0,h=0,e=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,h=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy,f=0,g=0,f=this.b3.axisy*this.a3localx-this.b3.axisx*this.a3localy,g=this.a3localx*this.b3.axisx+this.a3localy*this.b3.axisy,k=0,l=0,k=this.b4.axisy*this.a4localx-this.b4.axisx*this.a4localy,l=this.a4localx*this.b4.axisx+this.a4localy*this.b4.axisy,n=0,
r=0,z=0,x=0,n=this.n12x,r=this.n12y,z=this.n34x,x=this.n34y,p=0,y=0,w=0,A=0,p=this.b2.posx+e-(this.b1.posx+c),y=this.b2.posy+h-(this.b1.posy+d),w=this.b4.posx+k-(this.b3.posx+f),A=this.b4.posy+l-(this.b3.posy+g);b=Math.sqrt(p*p+y*y);a=Math.sqrt(w*w+A*A);0!=b&&(r=1/b,n=p*r,r*=y);0!=a?(x=1/a,p=this.ratio,z=w*x*p,x=A*x*p):(w=this.ratio/Math.sqrt(z*z+x*x),z*=w,x*=w);a=b+this.ratio*a;this.equal?(a-=this.jointMax,b=!1):a<this.jointMin?(a=this.jointMin-a,n=-n,r=-r,z=-z,x=-x,b=!1):a>this.jointMax?(a-=this.jointMax,
b=!1):(a=x=z=r=n=0,b=!0);if(!b){if(this.breakUnderError&&a*a>this.maxError*this.maxError)return!0;if(a*a<u.constraintLinearSlop*u.constraintLinearSlop)return!1;a*=.5;6<a*a&&(b=this.b1.smass+this.b2.smass,b>u.epsilon&&(b=.75/b*-a,this.equal||0>b))&&(a=b*this.b1.imass,this.b1.posx-=n*a,this.b1.posy-=r*a,a=b*this.b2.imass,this.b2.posx+=n*a,this.b2.posy+=r*a,a=b*this.b3.imass,this.b3.posx-=z*a,this.b3.posy-=x*a,b*=this.b4.imass,this.b4.posx+=z*b,this.b4.posy+=x*b,A=w=y=p=0,p=this.b2.posx+e-(this.b1.posx+
c),y=this.b2.posy+h-(this.b1.posy+d),w=this.b4.posx+k-(this.b3.posx+f),A=this.b4.posy+l-(this.b3.posy+g),b=Math.sqrt(p*p+y*y),a=Math.sqrt(w*w+A*A),0!=b&&(r=1/b,n=p*r,r*=y),0!=a?(x=1/a,p=this.ratio,z=w*x*p,x=A*x*p):(w=this.ratio/Math.sqrt(z*z+x*x),z*=w,x*=w),b+=this.ratio*a,this.equal?b-=this.jointMax:b<this.jointMin?(b=this.jointMin-b,n=-n,r=-r,z=-z,x=-x):b>this.jointMax?b-=this.jointMax:b=x=z=r=n=0,a=.5*b);c=r*c-n*d;e=r*e-n*h;f=x*f-z*g;k=x*k-z*l;l=this.b1.smass+this.b2.smass+this.ratio*this.ratio*
(this.b3.smass+this.b4.smass)+this.b1.sinertia*c*c+this.b2.sinertia*e*e+this.b3.sinertia*f*f+this.b4.sinertia*k*k;this.b1==this.b4&&(l-=2*((n*z+r*x)*this.b1.smass+c*k*this.b1.sinertia));this.b1==this.b3&&(l+=2*((n*z+r*x)*this.b1.smass+c*f*this.b1.sinertia));this.b2==this.b3&&(l-=2*((n*z+r*x)*this.b2.smass+e*f*this.b2.sinertia));this.b2==this.b4&&(l+=2*((n*z+r*x)*this.b2.smass+e*k*this.b2.sinertia));0!=l&&(l=1/l);b=-a*l;if(this.equal||0>b)l=this.b1.imass*b,this.b1.posx-=n*l,this.b1.posy-=r*l,l=this.b2.imass*
b,this.b2.posx+=n*l,this.b2.posy+=r*l,n=this.b3.imass*b,this.b3.posx-=z*n,this.b3.posy-=x*n,n=this.b4.imass*b,this.b4.posx+=z*n,this.b4.posy+=x*n,this.b1.delta_rot(-c*this.b1.iinertia*b),this.b2.delta_rot(e*this.b2.iinertia*b),this.b3.delta_rot(-f*this.b3.iinertia*b),this.b4.delta_rot(k*this.b4.iinertia*b)}return!1},draw:function(a){},__class__:Ge});var Ie=function(a,b){this.Keff=this.vec3=this.J=this.jOld=null;this.jMax=0;this.velonly=!1;this.soft=this.gamma=0;this.L=this.y=null;this.stepped=!1;
this.jAcc=this.bias=null;this.dim=0;this.outer_zn=this.bodies=null;ra.call(this);this.bodies=[];this.dim=a;this.velonly=b;this.jAcc=[];this.bias=[];this.L=[];this.J=[];this.jOld=[];this.y=[];this.Keff=[];this.vec3=N.get(0,0,0);for(var c=0;c<a;)for(var d=c++,e=this.jAcc[d]=this.bias[d]=this.J[d]=this.jOld[d]=this.y[d]=0;e<a;){var h=e++;this.L[d*a+h]=0}this.stepped=!1};Ie.__name__=!0;Ie.__super__=ra;Ie.prototype=I(ra.prototype,{bindVec2_invalidate:function(a){this.outer_zn.__invalidate()},addBody:function(a){for(var b=
null,c=0,d=this.bodies;c<d.length;){var e=d[c];++c;if(e.body==a){b=e;break}}null==b?(this.bodies.push(new tf(1,a)),this.active&&null!=this.space&&null!=a&&a.constraints.add(this)):b.cnt++},remBody:function(a){for(var b=null,c=this.bodies.length|0,d=0;d<c;){var e=this.bodies[d];if(e.body==a){e.cnt--;0==e.cnt&&(0<c&&(this.bodies[d]=this.bodies[c-1]),this.bodies.pop(),this.active&&null!=this.space&&null!=a&&a.constraints.remove(this));b=e;break}d++}return null!=b},bodyImpulse:function(a){for(var b=0,
c=this.dim;b<c;){var d=b++;this.J[d]=this.jAcc[d]}b=N.get(0,0,0);this.stepped&&this.outer_zn.__impulse(this.J,a.outer,b);return b},activeBodies:function(){for(var a=0,b=this.bodies;a<b.length;){var c=b[a];++a;null!=c.body&&c.body.constraints.add(this)}},inactiveBodies:function(){for(var a=0,b=this.bodies;a<b.length;){var c=b[a];++a;null!=c.body&&c.body.constraints.remove(this)}},copy:function(a,b){var c=this.outer_zn.__copy();this.copyto(c);throw new f("not done yet");},validate:function(){for(var a=
0,b=this.bodies;a<b.length;){var c=b[a];++a;if(c.body.space!=this.space)throw new f("Error: Constraints must have each body within the same sapce to which the constraint has been assigned");}this.outer_zn.__validate()},wake_connected:function(){for(var a=0,b=this.bodies;a<b.length;){var c=b[a];++a;2==c.body.type&&c.body.wake()}},forest:function(){for(var a=0,b=this.bodies;a<b.length;){var c=b[a];++a;if(2==c.body.type){if(c.body.component==c.body.component.parent)c=c.body.component;else{for(var c=
c.body.component,d=null;c!=c.parent;){var e=c.parent;c.parent=d;d=c;c=e}for(;null!=d;)e=d.parent,d.parent=c,d=e}if(this.component==this.component.parent)d=this.component;else{d=this.component;for(e=null;d!=d.parent;){var h=d.parent;d.parent=e;e=d;d=h}for(;null!=e;)h=e.parent,e.parent=d,e=h}c!=d&&(c.rank<d.rank?c.parent=d:c.rank>d.rank?d.parent=c:(d.parent=c,c.rank++))}}},pair_exists:function(a,b){for(var c=!1,d=this.bodies.length|0,e=0;e<d;){for(var h=e++,f=this.bodies[h].body,h=h+1;h<d;){var g=h++,
g=this.bodies[g].body;if(f.id==a&&g.id==b||f.id==b&&g.id==a){c=!0;break}}if(c)break}return c},broken:function(){this.outer_zn.__broken()},clearcache:function(){for(var a=0,b=this.dim;a<b;){var c=a++;this.jAcc[c]=0}this.pre_dt=-1},lsq:function(a){for(var b=0,c=0,d=this.dim;c<d;)var e=c++,b=b+a[e]*a[e];return b},_clamp:function(a,b){var c=this.lsq(a);if(c>b*b)for(var c=b/Math.sqrt(c),d=0,e=this.dim;d<e;){var h=d++;a[h]*=c}},solve:function(a){for(var b=0,c=0,d=this.dim;c<d;){for(var e=c++,h=0,f=0,g=
e-1;f<g;)var k=f++,h=h+this.L[e*this.dim+k]*this.L[e*this.dim+k];h=Math.sqrt(a[b++]-h);this.L[e*this.dim+e]=h;if(0!=h)for(h=1/h,f=e+1,g=this.dim;f<g;){for(var k=f++,l=0,n=0,r=e-1;n<r;)var z=n++,l=l+this.L[k*this.dim+z]*this.L[e*this.dim+z];this.L[k*this.dim+e]=h*(a[b++]-l)}else{h=e+1;for(f=this.dim;h<f;)g=h++,this.L[g*this.dim+e]=0;b+=this.dim-e-1}}return this.L},transform:function(a,b){for(var c=0,d=this.dim;c<d;){var e=c++,h=b[e],f=a[e*this.dim+e];if(0!=f){for(var g=0;g<e;)var k=g++,h=h-a[e*this.dim+
k]*this.y[k];this.y[e]=h/f}else this.y[e]=0}c=0;for(d=this.dim;c<d;)if(e=c++,e=this.dim-1-e,h=a[e*this.dim+e],0!=h){f=this.y[e];g=e+1;for(k=this.dim;g<k;)var l=g++,f=f-a[l*this.dim+e]*b[l];b[e]=f/h}else b[e]=0},preStep:function(a){-1==this.pre_dt&&(this.pre_dt=a);var b=a/this.pre_dt;this.pre_dt=a;this.stepped=!0;this.outer_zn.__prepare();this.outer_zn.__eff_mass(this.Keff);this.L=this.solve(this.Keff);if(this.stiff||this.velonly){for(var c=0,d=this.dim;c<d;){var e=c++;this.bias[e]=0}this.gamma=0;
this.soft=1}else{c=2*Math.PI*this.frequency;this.gamma=1/(a*c*(2*this.damping+c*a));d=1/(1+this.gamma);c=a*c*c*this.gamma;this.gamma*=d;this.soft=d;this.outer_zn.__position(this.bias);if(this.breakUnderError&&this.lsq(this.bias)>this.maxError*this.maxError)return!0;d=0;for(e=this.dim;d<e;){var h=d++;this.bias[h]*=-c}this._clamp(this.bias,this.maxError)}c=0;for(d=this.dim;c<d;)e=c++,this.jAcc[e]*=b;this.jMax=this.maxForce*a;return!1},warmStart:function(){for(var a=0,b=this.bodies;a<b.length;){var c=
b[a];++a;c=c.body;this.outer_zn.__impulse(this.jAcc,c.outer,this.vec3);var d=c.imass;c.velx+=this.vec3.get_x()*d;c.vely+=this.vec3.get_y()*d;c.angvel+=this.vec3.get_z()*c.iinertia}},applyImpulseVel:function(){this.outer_zn.__velocity(this.J);for(var a=0,b=this.dim;a<b;){var c=a++;this.J[c]=this.bias[c]-this.J[c]}this.transform(this.L,this.J);a=0;for(b=this.dim;a<b;)c=a++,this.jOld[c]=this.jAcc[c],this.jAcc[c]+=this.J[c]=this.J[c]*this.soft-this.jAcc[c]*this.gamma;this.outer_zn.__clamp(this.jAcc);
if((this.breakUnderForce||!this.stiff)&&this.lsq(this.jAcc)>this.jMax*this.jMax){if(this.breakUnderForce)return!0;this.stiff||this._clamp(this.jAcc,this.jMax)}a=0;for(b=this.dim;a<b;)c=a++,this.J[c]=this.jAcc[c]-this.jOld[c];a=0;for(b=this.bodies;a<b.length;){c=b[a];++a;c=c.body;this.outer_zn.__impulse(this.J,c.outer,this.vec3);var d=c.imass;c.velx+=this.vec3.get_x()*d;c.vely+=this.vec3.get_y()*d;c.angvel+=this.vec3.get_z()*c.iinertia}return!1},applyImpulsePos:function(){if(this.velonly)return!1;
this.outer_zn.__prepare();this.outer_zn.__position(this.J);var a=this.lsq(this.J);if(this.breakUnderError&&a>this.maxError*this.maxError)return!0;if(a<u.constraintLinearSlop*u.constraintLinearSlop)return!1;for(var a=0,b=this.dim;a<b;){var c=a++;this.J[c]*=-1}this.outer_zn.__eff_mass(this.Keff);this.transform(this.solve(this.Keff),this.J);this.outer_zn.__clamp(this.J);a=0;for(b=this.bodies;a<b.length;){c=b[a];++a;c=c.body;this.outer_zn.__impulse(this.J,c.outer,this.vec3);var d=c.imass;c.posx+=this.vec3.get_x()*
d;c.posy+=this.vec3.get_y()*d;c.delta_rot(this.vec3.get_z()*c.iinertia)}return!1},draw:function(a){this.outer_zn.__draw(a)},__class__:Ie});var tf=function(a,b){this.body=null;this.cnt=0;this.cnt=a;this.body=b};tf.__name__=!0;tf.prototype={__class__:tf};var Je=function(){this.stepped=!1;this.phase=this.kMassa=this.kMassb=this.kMassd=this.kMassc=this.kMasse=this.kMassf=this.jAccx=this.jAccy=this.jAccz=this.jMax=this.gamma=this.biasx=this.biasy=this.biasz=0;this.wrap_a2=null;this.a2localx=this.a2localy=
this.a2relx=this.a2rely=0;this.wrap_a1=this.b2=null;this.a1localx=this.a1localy=this.a1relx=this.a1rely=0;this.outer_zn=this.b1=null;ra.call(this);this.jAccz=this.jAccy=this.jAccx=this.phase=0;this.jMax=Infinity;this.stepped=!1;this.a2rely=this.a2relx=this.a2localy=this.a2localx=this.a1rely=this.a1relx=this.a1localy=this.a1localx=0};Je.__name__=!0;Je.__super__=ra;Je.prototype=I(ra.prototype,{bodyImpulse:function(a){return this.stepped?a==this.b1?N.get(-this.jAccx,-this.jAccy,-(this.jAccy*this.a1relx-
this.jAccx*this.a1rely+this.jAccz)):N.get(this.jAccx,this.jAccy,this.jAccy*this.a2relx-this.jAccx*this.a2rely+this.jAccz):N.get(0,0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this);this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this);this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},validate_a1:function(){this.wrap_a1.zpp_inner.x=this.a1localx;this.wrap_a1.zpp_inner.y=this.a1localy},
invalidate_a1:function(a){this.immutable_midstep("Constraint::a1");this.a1localx=a.x;this.a1localy=a.y;this.wake()},setup_a1:function(){this.wrap_a1=E.get(this.a1localx,this.a1localy,null);this.wrap_a1.zpp_inner._inuse=!0;this.wrap_a1.zpp_inner._validate=w(this,this.validate_a1);this.wrap_a1.zpp_inner._invalidate=w(this,this.invalidate_a1)},validate_a2:function(){this.wrap_a2.zpp_inner.x=this.a2localx;this.wrap_a2.zpp_inner.y=this.a2localy},invalidate_a2:function(a){this.immutable_midstep("Constraint::a2");
this.a2localx=a.x;this.a2localy=a.y;this.wake()},setup_a2:function(){this.wrap_a2=E.get(this.a2localx,this.a2localy,null);this.wrap_a2.zpp_inner._inuse=!0;this.wrap_a2.zpp_inner._validate=w(this,this.validate_a2);this.wrap_a2.zpp_inner._invalidate=w(this,this.invalidate_a2)},copy:function(a,b){var c=new Ke(null,null,this.outer_zn.get_anchor1(),this.outer_zn.get_anchor2());this.copyto(c);if(null!=a&&null!=this.b1){for(var d=null,e=0;e<a.length;){var h=a[e];++e;if(h.id==this.b1.id){d=h.bc;break}}null!=
d?c.zpp_inner_zn.b1=d.zpp_inner:b.push(ka.todo(this.b1.id,function(a){c.zpp_inner_zn.b1=a.zpp_inner}))}if(null!=a&&null!=this.b2){d=null;for(e=0;e<a.length;)if(h=a[e],++e,h.id==this.b2.id){d=h.bc;break}null!=d?c.zpp_inner_zn.b2=d.zpp_inner:b.push(ka.todo(this.b2.id,function(a){c.zpp_inner_zn.b2=a.zpp_inner}))}return c},validate:function(){if(null==this.b1||null==this.b2)throw new f("Error: AngleJoint cannot be simulated null bodies");if(this.b1==this.b2)throw new f("Error: WeldJoint cannot be simulated with body1 == body2");
if(this.b1.space!=this.space||this.b2.space!=this.space)throw new f("Error: Constraints must have each body within the same space to which the constraint has been assigned");if(2!=this.b1.type&&2!=this.b2.type)throw new f("Error: Constraints cannot have both bodies non-dynamic");},wake_connected:function(){null!=this.b1&&2==this.b1.type&&this.b1.wake();null!=this.b2&&2==this.b2.type&&this.b2.wake()},forest:function(){if(2==this.b1.type){var a;if(this.b1.component==this.b1.component.parent)a=this.b1.component;
else{a=this.b1.component;for(var b=null;a!=a.parent;){var c=a.parent;a.parent=b;b=a;a=c}for(;null!=b;)c=b.parent,b.parent=a,b=c}if(this.component==this.component.parent)b=this.component;else{b=this.component;for(c=null;b!=b.parent;){var d=b.parent;b.parent=c;c=b;b=d}for(;null!=c;)d=c.parent,c.parent=b,c=d}a!=b&&(a.rank<b.rank?a.parent=b:a.rank>b.rank?b.parent=a:(b.parent=a,a.rank++))}if(2==this.b2.type){if(this.b2.component==this.b2.component.parent)a=this.b2.component;else{a=this.b2.component;for(b=
null;a!=a.parent;)c=a.parent,a.parent=b,b=a,a=c;for(;null!=b;)c=b.parent,b.parent=a,b=c}if(this.component==this.component.parent)b=this.component;else{b=this.component;for(c=null;b!=b.parent;)d=b.parent,b.parent=c,c=b,b=d;for(;null!=c;)d=c.parent,c.parent=b,c=d}a!=b&&(a.rank<b.rank?a.parent=b:a.rank>b.rank?b.parent=a:(b.parent=a,a.rank++))}},pair_exists:function(a,b){return this.b1.id==a&&this.b2.id==b||this.b1.id==b&&this.b2.id==a},clearcache:function(){this.jAccz=this.jAccy=this.jAccx=0;this.pre_dt=
-1},preStep:function(a){-1==this.pre_dt&&(this.pre_dt=a);var b=a/this.pre_dt;this.pre_dt=a;this.stepped=!0;this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy;this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy;this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy;this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var c=this.b1.smass+this.b2.smass;this.kMassa=c;this.kMassb=0;this.kMassd=c;this.kMassf=this.kMasse=this.kMassc=0;if(0!=this.b1.sinertia){var c=
this.a1relx*this.b1.sinertia,d=this.a1rely*this.b1.sinertia;this.kMassa+=d*this.a1rely;this.kMassb+=-d*this.a1relx;this.kMassd+=c*this.a1relx;this.kMassc+=-d;this.kMasse+=c;this.kMassf+=this.b1.sinertia}0!=this.b2.sinertia&&(c=this.a2relx*this.b2.sinertia,d=this.a2rely*this.b2.sinertia,this.kMassa+=d*this.a2rely,this.kMassb+=-d*this.a2relx,this.kMassd+=c*this.a2relx,this.kMassc+=-d,this.kMasse+=c,this.kMassf+=this.b2.sinertia);c=this.kMassa*(this.kMassd*this.kMassf-this.kMasse*this.kMasse)+this.kMassb*
(this.kMassc*this.kMasse-this.kMassb*this.kMassf)+this.kMassc*(this.kMassb*this.kMasse-this.kMassc*this.kMassd);if(c!=c)this.kMassf=this.kMasse=this.kMassc=this.kMassd=this.kMassb=this.kMassa=0,c=7;else if(0==c)c=0,0!=this.kMassa?this.kMassa=1/this.kMassa:(this.kMassa=0,c|=1),0!=this.kMassd?this.kMassd=1/this.kMassd:(this.kMassd=0,c|=2),0!=this.kMassf?this.kMassf=1/this.kMassf:(this.kMassf=0,c|=4),this.kMassb=this.kMassc=this.kMasse=0;else{var c=1/c,d=c*(this.kMasse*this.kMassc-this.kMassb*this.kMassf),
e=c*(this.kMassa*this.kMassf-this.kMassc*this.kMassc),h=c*(this.kMassb*this.kMasse-this.kMassc*this.kMassd),f=c*(this.kMassb*this.kMassc-this.kMassa*this.kMasse),g=c*(this.kMassa*this.kMassd-this.kMassb*this.kMassb);this.kMassa=c*(this.kMassd*this.kMassf-this.kMasse*this.kMasse);this.kMassb=d;this.kMassd=e;this.kMassc=h;this.kMasse=f;this.kMassf=g;c=0}0!=(c&1)&&(this.jAccx=0);0!=(c&2)&&(this.jAccy=0);0!=(c&4)&&(this.jAccz=0);if(this.stiff)this.gamma=this.biasz=this.biasy=this.biasx=0;else{d=2*Math.PI*
this.frequency;this.gamma=1/(a*d*(2*this.damping+d*a));c=1/(1+this.gamma);d=a*d*d*this.gamma;this.gamma*=c;this.kMassa*=c;this.kMassb*=c;this.kMassd*=c;this.kMassc*=c;this.kMasse*=c;this.kMassf*=c;this.biasx=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx);this.biasy=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely);this.biasz=this.b2.rot-this.b1.rot-this.phase;if(this.breakUnderError&&this.biasx*this.biasx+this.biasy*this.biasy+this.biasz*this.biasz>this.maxError*this.maxError)return!0;c=-d;
this.biasx*=c;this.biasy*=c;this.biasz*=c;c=this.maxError;d=this.biasx*this.biasx+this.biasy*this.biasy+this.biasz*this.biasz;d>c*c&&(c*=1/Math.sqrt(d),this.biasx*=c,this.biasy*=c,this.biasz*=c)}this.jAccx*=b;this.jAccy*=b;this.jAccz*=b;this.jMax=this.maxForce*a;return!1},warmStart:function(){var a=this.b1.imass;this.b1.velx-=this.jAccx*a;this.b1.vely-=this.jAccy*a;a=this.b2.imass;this.b2.velx+=this.jAccx*a;this.b2.vely+=this.jAccy*a;this.b1.angvel-=(this.jAccy*this.a1relx-this.jAccx*this.a1rely+
this.jAccz)*this.b1.iinertia;this.b2.angvel+=(this.jAccy*this.a2relx-this.jAccx*this.a2rely+this.jAccz)*this.b2.iinertia},applyImpulseVel:function(){var a=0,b=0,c=0,a=this.b2.velx+this.b2.kinvelx-this.a2rely*(this.b2.angvel+this.b2.kinangvel)-(this.b1.velx+this.b1.kinvelx-this.a1rely*(this.b1.angvel+this.b1.kinangvel)),b=this.b2.vely+this.b2.kinvely+this.a2relx*(this.b2.angvel+this.b2.kinangvel)-(this.b1.vely+this.b1.kinvely+this.a1relx*(this.b1.angvel+this.b1.kinangvel)),c=this.b2.angvel+this.b2.kinangvel-
this.b1.angvel-this.b1.kinangvel,d=0,e=0,h=0,d=this.biasx-a,e=this.biasy-b,h=this.biasz-c,a=this.kMassa*d+this.kMassb*e+this.kMassc*h,b=this.kMassb*d+this.kMassd*e+this.kMasse*h,h=this.kMassc*d+this.kMasse*e+this.kMassf*h,c=this.gamma,d=a-this.jAccx*c,e=b-this.jAccy*c,h=h-this.jAccz*c,c=b=a=0,a=this.jAccx,b=this.jAccy,c=this.jAccz;this.jAccx+=1*d;this.jAccy+=1*e;this.jAccz+=1*h;if(this.breakUnderForce){if(this.jAccx*this.jAccx+this.jAccy*this.jAccy+this.jAccz*this.jAccz>this.jMax*this.jMax)return!0}else this.stiff||
(d=this.jMax,e=this.jAccx*this.jAccx+this.jAccy*this.jAccy+this.jAccz*this.jAccz,e>d*d&&(d*=1/Math.sqrt(e),this.jAccx*=d,this.jAccy*=d,this.jAccz*=d));d=this.jAccx-a;e=this.jAccy-b;h=this.jAccz-c;a=this.b1.imass;this.b1.velx-=d*a;this.b1.vely-=e*a;a=this.b2.imass;this.b2.velx+=d*a;this.b2.vely+=e*a;this.b1.angvel-=(e*this.a1relx-d*this.a1rely+h)*this.b1.iinertia;this.b2.angvel+=(e*this.a2relx-d*this.a2rely+h)*this.b2.iinertia;return!1},applyImpulsePos:function(){var a=0,b=0,a=this.b1.axisy*this.a1localx-
this.b1.axisx*this.a1localy,b=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,c=0,d=0,c=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,d=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy,e=0,h=0,f=0,e=this.b2.posx+c-(this.b1.posx+a),h=this.b2.posy+d-(this.b1.posy+b),f=this.b2.rot-this.b1.rot-this.phase,g=0,k=0,l=0;if(this.breakUnderError&&e*e+h*h+f*f>this.maxError*this.maxError)return!0;g=!0;e*e+h*h<u.constraintLinearSlop*u.constraintLinearSlop&&(g=!1,h=e=0);if(f*f<Bc.sqr(u.constraintAngularSlop))if(g)f=
0;else return!1;e*=.5;h*=.5;f*=.5;if(6<e*e+h*h&&(k=this.b1.smass+this.b2.smass,k>u.epsilon)){var k=.75/k,g=-e*k,k=-h*k,n=g*g+k*k;400<n&&(n=1/Math.sqrt(n)*20,g*=n,k*=n);n=this.b1.imass;this.b1.posx-=g*n;this.b1.posy-=k*n;n=this.b2.imass;this.b2.posx+=g*n;this.b2.posy+=k*n;e=this.b2.posx+c-(this.b1.posx+a);h=this.b2.posy+d-(this.b1.posy+b);f=this.b2.rot-this.b1.rot-this.phase;e*=.5;h*=.5;f*=.5}var r=n=0,z=0,x=0,p=0,y=0,n=g=this.b1.smass+this.b2.smass,r=0,z=g,y=p=x=0;0!=this.b1.sinertia&&(g=a*this.b1.sinertia,
k=b*this.b1.sinertia,n+=k*b,r+=-k*a,z+=g*a,x+=-k,p+=g,y+=this.b1.sinertia);0!=this.b2.sinertia&&(g=c*this.b2.sinertia,k=d*this.b2.sinertia,n+=k*d,r+=-k*c,z+=g*c,x+=-k,p+=g,y+=this.b2.sinertia);g=-e;k=-h;l=-f;e=g*g+k*k;36<e&&(e=1/Math.sqrt(e)*6,g*=e,k*=e);Bc.clamp(l,-.25,.25);e=n*(z*y-p*p)+r*(x*p-r*y)+x*(r*p-x*z);if(e!=e)g=k=l=0;else if(0==e)g=0!=n?g/n:0,k=0!=z?k/z:0,l=0!=y?l/y:0;else var e=1/e,w=p*x-r*y,h=r*p-x*z,f=r*x-n*p,p=e*(g*(z*y-p*p)+k*w+l*h),x=e*(g*w+k*(n*y-x*x)+l*f),l=e*(g*h+k*f+l*(n*z-r*
r)),g=p,k=x;n=this.b1.imass;this.b1.posx-=g*n;this.b1.posy-=k*n;n=this.b2.imass;this.b2.posx+=g*n;this.b2.posy+=k*n;this.b1.delta_rot(-(k*a-g*b+l)*this.b1.iinertia);this.b2.delta_rot((k*c-g*d+l)*this.b2.iinertia);return!1},draw:function(a){},__class__:Je});var F=function(){this.colarb=this.fluidarb=this.sensorarb=null;this.type=0;this.b1=this.b2=this.ws1=this.ws2=this.pair=null;this.invalidated=!1;this.immState=0;this.intchange=this.presentable=this.continuous=this.fresh=!1;this.present=0;this.active=
this.cleared=this.sleeping=!1;this.id=this.di=this.stamp=this.up_stamp=this.sleep_stamp=this.endGenerated=0;this.outer=this.hnext=null};F.__name__=!0;F.prototype={wrapper:function(){null==this.outer&&(F.internal=!0,this.type==F.COL?(this.colarb.outer_zn=new Le,this.outer=this.colarb.outer_zn):this.type==F.FLUID?(this.fluidarb.outer_zn=new Me,this.outer=this.fluidarb.outer_zn):this.outer=new rd,this.outer.zpp_inner=this,F.internal=!1);return this.outer},inactiveme:function(){return!this.active},acting:function(){return this.active&&
0!=(this.immState&1)},swap_features:function(){var a=this.b1;this.b1=this.b2;this.b2=a;a=this.ws1;this.ws1=this.ws2;this.ws2=a;a=this.colarb.s1;this.colarb.s1=this.colarb.s2;this.colarb.s2=a},lazyRetire:function(a,b){this.cleared=!0;null!=b&&this.b2!=b||this.b1.arbiters.inlined_try_remove(this);null!=b&&this.b1!=b||this.b2.arbiters.inlined_try_remove(this);null!=this.pair&&(this.pair=this.pair.arb=null);this.active=!1;a.f_arbiters.modified=!0},sup_assign:function(a,b,c,d){this.b1=a.body;this.ws1=
a;this.b2=b.body;this.ws2=b;this.id=c;this.di=d;this.b1.arbiters.inlined_add(this);this.b2.arbiters.inlined_add(this);this.active=!0;this.present=0;this.presentable=this.fresh=this.sleeping=this.cleared=!1},sup_retire:function(){this.cleared||(this.b1.arbiters.inlined_try_remove(this),this.b2.arbiters.inlined_try_remove(this),null!=this.pair&&(this.pair=this.pair.arb=null));this.b1=this.b2=null;this.intchange=this.active=!1},__class__:F};var Db=function(){this.next=null;F.call(this);this.type=F.SENSOR;
this.sensorarb=this};Db.__name__=!0;Db.__super__=F;Db.prototype=I(F.prototype,{alloc:function(){},free:function(){},assign:function(a,b,c,d){this.b1=a.body;this.ws1=a;this.b2=b.body;this.ws2=b;this.id=c;this.di=d;this.b1.arbiters.inlined_add(this);this.b2.arbiters.inlined_add(this);this.active=!0;this.present=0;this.presentable=this.fresh=this.sleeping=this.cleared=!1},retire:function(){this.cleared||(this.b1.arbiters.inlined_try_remove(this),this.b2.arbiters.inlined_try_remove(this),null!=this.pair&&
(this.pair=this.pair.arb=null));this.b1=this.b2=null;this.intchange=this.active=!1;this.next=Db.zpp_pool;Db.zpp_pool=this},makemutable:function(){},makeimmutable:function(){},__class__:Db});var nb=function(){this.pre_dt=0;this.mutable=!1;this.wrap_position=null;this.wMass=this.adamp=this.agamma=this.vMassa=this.vMassb=this.vMassc=this.dampx=this.dampy=this.lgamma=this.nx=this.ny=this.buoyx=this.buoyy=0;this.nodrag=!1;this.centroidx=this.centroidy=this.overlap=this.r1x=this.r1y=this.r2x=this.r2y=0;
this.outer_zn=this.next=null;F.call(this);this.type=F.FLUID;this.fluidarb=this;this.buoyy=this.buoyx=0;this.pre_dt=-1};nb.__name__=!0;nb.__super__=F;nb.prototype=I(F.prototype,{alloc:function(){},free:function(){},position_validate:function(){if(!this.active)throw new f("Error: Arbiter not currently in use");this.wrap_position.zpp_inner.x=this.centroidx;this.wrap_position.zpp_inner.y=this.centroidy},position_invalidate:function(a){this.centroidx=a.x;this.centroidy=a.y},getposition:function(){this.wrap_position=
E.get(null,null,null);this.wrap_position.zpp_inner._inuse=!0;this.wrap_position.zpp_inner._immutable=!this.mutable;this.wrap_position.zpp_inner._validate=w(this,this.position_validate);this.wrap_position.zpp_inner._invalidate=w(this,this.position_invalidate)},assign:function(a,b,c,d){this.b1=a.body;this.ws1=a;this.b2=b.body;this.ws2=b;this.id=c;this.di=d;this.b1.arbiters.inlined_add(this);this.b2.arbiters.inlined_add(this);this.active=!0;this.present=0;this.presentable=this.fresh=this.sleeping=this.cleared=
!1;this.nx=0;this.ny=1;this.adamp=this.dampy=this.dampx=0},retire:function(){this.cleared||(this.b1.arbiters.inlined_try_remove(this),this.b2.arbiters.inlined_try_remove(this),null!=this.pair&&(this.pair=this.pair.arb=null));this.b1=this.b2=null;this.intchange=this.active=!1;this.next=nb.zpp_pool;nb.zpp_pool=this;this.pre_dt=-1},makemutable:function(){this.mutable=!0;null!=this.wrap_position&&(this.wrap_position.zpp_inner._immutable=!1)},makeimmutable:function(){this.mutable=!1;null!=this.wrap_position&&
(this.wrap_position.zpp_inner._immutable=!0)},inject:function(a,b,c){this.overlap=a;this.centroidx=b;this.centroidy=c},preStep:function(a,b){-1==this.pre_dt&&(this.pre_dt=b);var c=b/this.pre_dt;this.pre_dt=b;this.r1x=this.centroidx-this.b1.posx;this.r1y=this.centroidy-this.b1.posy;this.r2x=this.centroidx-this.b2.posx;this.r2y=this.centroidy-this.b2.posy;var d=0,e=0;this.ws1.fluidEnabled&&null!=this.ws1.fluidProperties.wrap_gravity?(d=this.ws1.fluidProperties.gravityx,e=this.ws1.fluidProperties.gravityy):
(d=a.gravityx,e=a.gravityy);var h=0,f=0;this.ws2.fluidEnabled&&null!=this.ws2.fluidProperties.wrap_gravity?(h=this.ws2.fluidProperties.gravityx,f=this.ws2.fluidProperties.gravityy):(h=a.gravityx,f=a.gravityy);var g=0,k=0;if(this.ws1.fluidEnabled&&this.ws2.fluidEnabled){var l=this.overlap*this.ws1.fluidProperties.density,n=this.overlap*this.ws2.fluidProperties.density;if(l>n)h=l+n,g-=d*h,k-=e*h;else if(l<n)d=l+n,g+=h*d,k+=f*d;else{var r=0,z=0,r=.5*(d+h),z=.5*(e+f);this.ws1.worldCOMx*r+this.ws1.worldCOMy*
z>this.ws2.worldCOMx*r+this.ws2.worldCOMy*z?(d=l+n,g-=r*d,k-=z*d):(d=l+n,g+=r*d,k+=z*d)}}else this.ws1.fluidEnabled?(h=this.overlap*this.ws1.fluidProperties.density,g-=d*h,k-=e*h):this.ws2.fluidEnabled&&(d=this.overlap*this.ws2.fluidProperties.density,g+=h*d,k+=f*d);g*=b;k*=b;this.buoyx=g;this.buoyy=k;2==this.b1.type&&(d=this.b1.imass,this.b1.velx-=g*d,this.b1.vely-=k*d,this.b1.angvel-=(k*this.r1x-g*this.r1y)*this.b1.iinertia);2==this.b2.type&&(d=this.b2.imass,this.b2.velx+=g*d,this.b2.vely+=k*d,
this.b2.angvel+=(k*this.r2x-g*this.r2y)*this.b2.iinertia);if(this.ws1.fluidEnabled&&0!=this.ws1.fluidProperties.viscosity||this.ws2.fluidEnabled&&0!=this.ws2.fluidProperties.viscosity){this.nodrag=!1;g=0;this.ws1.fluidEnabled&&(this.ws2.validate_angDrag(),g+=this.ws1.fluidProperties.viscosity*this.ws2.angDrag*this.overlap/this.ws2.area);this.ws2.fluidEnabled&&(this.ws1.validate_angDrag(),g+=this.ws2.fluidProperties.viscosity*this.ws1.angDrag*this.overlap/this.ws1.area);0!=g?(k=this.b1.sinertia+this.b2.sinertia,
this.wMass=0!=k?1/k:0,g*=8E-4*Math.PI,this.agamma=1/(b*g*(2+g*b)),g=1/(1+this.agamma),this.agamma*=g,this.wMass*=g):this.agamma=this.wMass=0;g=this.b2.velx+this.b2.kinvelx-this.r2y*(this.b2.angvel+this.b2.kinangvel)-(this.b1.velx+this.b1.kinvelx-this.r1y*(this.b2.angvel+this.b2.kinangvel));k=this.b2.vely+this.b2.kinvely+this.r2x*(this.b2.angvel+this.b2.kinangvel)-(this.b1.vely+this.b1.kinvely+this.r1x*(this.b1.angvel+this.b1.kinangvel));g*g+k*k<u.epsilon*u.epsilon||(d=1/Math.sqrt(g*g+k*k),this.nx=
g*d,this.ny=k*d);g=0;if(this.ws1.fluidEnabled)if(k=-this.ws1.fluidProperties.viscosity*this.overlap/this.ws2.area,0==this.ws2.type)g-=k*this.ws2.circle.radius*u.fluidLinearDrag/(2*this.ws2.circle.radius*Math.PI);else{e=d=0;for(h=this.ws2.polygon.edges.head;null!=h;)f=h.elt,d+=f.length,f=k*f.length*(f.gnormx*this.nx+f.gnormy*this.ny),0<f&&(f=f*=-u.fluidVacuumDrag),e-=.5*f*u.fluidLinearDrag,h=h.next;g+=e/d}if(this.ws2.fluidEnabled)if(k=-this.ws2.fluidProperties.viscosity*this.overlap/this.ws1.area,
0==this.ws1.type)g-=k*this.ws1.circle.radius*u.fluidLinearDrag/(2*this.ws1.circle.radius*Math.PI);else{e=d=0;for(h=this.ws1.polygon.edges.head;null!=h;)f=h.elt,d+=f.length,f=k*f.length*(f.gnormx*this.nx+f.gnormy*this.ny),0<f&&(f=f*=-u.fluidVacuumDrag),e-=.5*f*u.fluidLinearDrag,h=h.next;g+=e/d}0!=g?(h=this.b1.smass+this.b2.smass,e=d=k=0,k=h,d=0,e=h,0!=this.b1.sinertia&&(h=this.r1x*this.b1.sinertia,f=this.r1y*this.b1.sinertia,k+=f*this.r1y,d+=-f*this.r1x,e+=h*this.r1x),0!=this.b2.sinertia&&(h=this.r2x*
this.b2.sinertia,f=this.r2y*this.b2.sinertia,k+=f*this.r2y,d+=-f*this.r2x,e+=h*this.r2x),h=k*e-d*d,h!=h?(k=d=e=0,3):0==h?(h=0,0!=k?k=1/k:(k=0,h|=1),0!=e?e=1/e:(e=0,h|=2),d=0,h):(h=1/h,f=e*h,e=k*h,k=f,d*=-h,0),this.vMassa=k,this.vMassb=d,this.vMassc=e,g*=2*Math.PI,this.lgamma=1/(b*g*(2+g*b)),g=1/(1+this.lgamma),this.lgamma*=g,this.vMassa*=g,this.vMassb*=g,this.vMassc*=g):this.lgamma=this.vMassc=this.vMassb=this.vMassa=0}else this.nodrag=!0,this.adamp=this.dampy=this.dampx=0;this.dampx*=c;this.dampy*=
c;this.adamp*=c},warmStart:function(){var a=this.b1.imass;this.b1.velx-=this.dampx*a;this.b1.vely-=this.dampy*a;a=this.b2.imass;this.b2.velx+=this.dampx*a;this.b2.vely+=this.dampy*a;this.b1.angvel-=this.b1.iinertia*(this.dampy*this.r1x-this.dampx*this.r1y);this.b2.angvel+=this.b2.iinertia*(this.dampy*this.r2x-this.dampx*this.r2y);this.b1.angvel-=this.adamp*this.b1.iinertia;this.b2.angvel+=this.adamp*this.b2.iinertia},applyImpulseVel:function(){if(!this.nodrag){var a=this.b1.angvel+this.b1.kinangvel,
b=this.b2.angvel+this.b2.kinangvel,c=this.b1.velx+this.b1.kinvelx-this.r1y*a-(this.b2.velx+this.b2.kinvelx-this.r2y*b),d=this.b1.vely+this.b1.kinvely+this.r1x*a-(this.b2.vely+this.b2.kinvely+this.r2x*b),e=this.vMassa*c+this.vMassb*d,d=this.vMassb*c+this.vMassc*d,h=this.lgamma,c=e-this.dampx*h,d=d-this.dampy*h;this.dampx+=1*c;this.dampy+=1*d;e=this.b1.imass;this.b1.velx-=c*e;this.b1.vely-=d*e;e=this.b2.imass;this.b2.velx+=c*e;this.b2.vely+=d*e;this.b1.angvel-=this.b1.iinertia*(d*this.r1x-c*this.r1y);
this.b2.angvel+=this.b2.iinertia*(d*this.r2x-c*this.r2y);a=(a-b)*this.wMass-this.adamp*this.agamma;this.adamp+=a;this.b1.angvel-=a*this.b1.iinertia;this.b2.angvel+=a*this.b2.iinertia}},__class__:nb});var dc=function(){this.pre_dt=0;this.stat=this.mutable=!1;this.next=null;this.hc2=this.hpc2=!1;this.c1=this.oc1=this.c2=this.oc2=null;this.__ref_vertex=0;this.__ref_edge1=this.__ref_edge2=null;this.biasCoef=0;this.rev=!1;this.kMassa=this.kMassb=this.kMassc=this.Ka=this.Kb=this.Kc=this.rMass=this.jrAcc=
this.rn1a=this.rt1a=this.rn1b=this.rt1b=this.rn2a=this.rt2a=this.rn2b=this.rt2b=this.k1x=this.k1y=this.k2x=this.k2y=this.surfacex=this.surfacey=this.lnormx=this.lnormy=this.lproj=this.radius=0;this.wrap_normal=null;this.nx=this.ny=0;this.s1=this.s2=this.contacts=this.wrap_contacts=this.innards=null;this.userdef_dyn_fric=this.userdef_stat_fric=this.userdef_restitution=this.userdef_rfric=!1;this.dyn_fric=this.stat_fric=this.restitution=this.rfric=0;this.outer_zn=null;F.call(this);this.pre_dt=-1;this.contacts=
new Ia;this.innards=new We;this.type=F.COL;this.colarb=this};dc.__name__=!0;dc.__super__=F;dc.prototype=I(F.prototype,{normal_validate:function(){if(this.cleared)throw new f("Error: Arbiter not currently in use");this.wrap_normal.zpp_inner.x=this.nx;this.wrap_normal.zpp_inner.y=this.ny;this.ws1.id>this.ws2.id&&(this.wrap_normal.zpp_inner.x=-this.wrap_normal.zpp_inner.x,this.wrap_normal.zpp_inner.y=-this.wrap_normal.zpp_inner.y)},getnormal:function(){this.wrap_normal=E.get(0,0,null);this.wrap_normal.zpp_inner._immutable=
!0;this.wrap_normal.zpp_inner._inuse=!0;this.wrap_normal.zpp_inner._validate=w(this,this.normal_validate)},alloc:function(){},free:function(){this.userdef_rfric=this.userdef_restitution=this.userdef_stat_fric=this.userdef_dyn_fric=!1;this.__ref_edge1=this.__ref_edge2=null},injectContact:function(a,b,c,d,e,h,f){null==f&&(f=!1);for(var g=null,k=this.contacts.next;null!=k;){var l=k;if(h==l.hash){g=l;break}k=k.next}null==g?(null==Ia.zpp_pool?g=new Ia:(g=Ia.zpp_pool,Ia.zpp_pool=g.next,g.next=null),null,
k=g.inner,k.jnAcc=k.jtAcc=0,g.hash=h,g.fresh=!0,g.arbiter=this,this.jrAcc=0,this.contacts.inlined_add(g),this.innards.add(k)):g.fresh=!1;g.px=a;g.py=b;this.nx=c;this.ny=d;g.dist=e;g.stamp=this.stamp;g.posOnly=f;return g},assign:function(a,b,c,d){this.b1=a.body;this.ws1=a;this.b2=b.body;this.ws2=b;this.id=c;this.di=d;this.b1.arbiters.inlined_add(this);this.b2.arbiters.inlined_add(this);this.active=!0;this.present=0;this.presentable=this.fresh=this.sleeping=this.cleared=!1;this.s1=a;this.s2=b;this.userdef_restitution||
(this.restitution=-Infinity>=this.s1.material.elasticity||-Infinity>=this.s2.material.elasticity?0:Infinity<=this.s1.material.elasticity||Infinity<=this.s2.material.elasticity?1:(this.s1.material.elasticity+this.s2.material.elasticity)/2,0>this.restitution&&(this.restitution=0),1<this.restitution&&(this.restitution=1));this.userdef_dyn_fric||(this.dyn_fric=Math.sqrt(this.s1.material.dynamicFriction*this.s2.material.dynamicFriction));this.userdef_stat_fric||(this.stat_fric=Math.sqrt(this.s1.material.staticFriction*
this.s2.material.staticFriction));this.userdef_rfric||(this.rfric=Math.sqrt(this.s1.material.rollingFriction*this.s2.material.rollingFriction))},calcProperties:function(){this.userdef_restitution||(this.restitution=-Infinity>=this.s1.material.elasticity||-Infinity>=this.s2.material.elasticity?0:Infinity<=this.s1.material.elasticity||Infinity<=this.s2.material.elasticity?1:(this.s1.material.elasticity+this.s2.material.elasticity)/2,0>this.restitution&&(this.restitution=0),1<this.restitution&&(this.restitution=
1));this.userdef_dyn_fric||(this.dyn_fric=Math.sqrt(this.s1.material.dynamicFriction*this.s2.material.dynamicFriction));this.userdef_stat_fric||(this.stat_fric=Math.sqrt(this.s1.material.staticFriction*this.s2.material.staticFriction));this.userdef_rfric||(this.rfric=Math.sqrt(this.s1.material.rollingFriction*this.s2.material.rollingFriction))},validate_props:function(){this.invalidated&&(this.invalidated=!1,this.userdef_restitution||(this.restitution=-Infinity>=this.s1.material.elasticity||-Infinity>=
this.s2.material.elasticity?0:Infinity<=this.s1.material.elasticity||Infinity<=this.s2.material.elasticity?1:(this.s1.material.elasticity+this.s2.material.elasticity)/2,0>this.restitution&&(this.restitution=0),1<this.restitution&&(this.restitution=1)),this.userdef_dyn_fric||(this.dyn_fric=Math.sqrt(this.s1.material.dynamicFriction*this.s2.material.dynamicFriction)),this.userdef_stat_fric||(this.stat_fric=Math.sqrt(this.s1.material.staticFriction*this.s2.material.staticFriction)),this.userdef_rfric||
(this.rfric=Math.sqrt(this.s1.material.rollingFriction*this.s2.material.rollingFriction)))},retire:function(){this.cleared||(this.b1.arbiters.inlined_try_remove(this),this.b2.arbiters.inlined_try_remove(this),null!=this.pair&&(this.pair=this.pair.arb=null));this.b1=this.b2=null;for(this.intchange=this.active=!1;null!=this.contacts.next;){var a=this.contacts.inlined_pop_unsafe();a.arbiter=null;a.next=Ia.zpp_pool;Ia.zpp_pool=a;this.innards.inlined_pop()}this.userdef_rfric=this.userdef_restitution=this.userdef_stat_fric=
this.userdef_dyn_fric=!1;this.__ref_edge1=this.__ref_edge2=null;this.next=dc.zpp_pool;dc.zpp_pool=this;this.pre_dt=-1},makemutable:function(){this.mutable=!0;null!=this.wrap_normal&&(this.wrap_normal.zpp_inner._immutable=!1);null!=this.wrap_contacts&&(this.wrap_contacts.zpp_inner.immutable=!1)},makeimmutable:function(){this.mutable=!1;null!=this.wrap_normal&&(this.wrap_normal.zpp_inner._immutable=!0);null!=this.wrap_contacts&&(this.wrap_contacts.zpp_inner.immutable=!0)},contacts_adder:function(a){throw new f("Error: Cannot add new contacts, information required is far too specific and detailed :)");
},contacts_subber:function(a){for(var b=null,c=null,d=this.innards.next,e=this.contacts.next;null!=e;){var h=e;if(h==a.zpp_inner){this.contacts.erase(b);this.innards.erase(c);a=h;a.arbiter=null;a.next=Ia.zpp_pool;Ia.zpp_pool=a;break}b=e;c=d;d=d.next;e=e.next}},setupcontacts:function(){this.wrap_contacts=td.get(this.contacts,!0);this.wrap_contacts.zpp_inner.immutable=!this.mutable;this.wrap_contacts.zpp_inner.adder=w(this,this.contacts_adder);this.wrap_contacts.zpp_inner.dontremove=!0;this.wrap_contacts.zpp_inner.subber=
w(this,this.contacts_subber)},cleanupContacts:function(){var a=!0,b=null,c=null,d=this.innards.next;this.hc2=!1;for(var e=this.contacts.next;null!=e;){var h=e;h.stamp+u.arbiterExpirationDelay<this.stamp?(e=this.contacts.inlined_erase(b),d=this.innards.inlined_erase(c),h.arbiter=null,h.next=Ia.zpp_pool,Ia.zpp_pool=h):(b=h.inner,c=h.active,h.active=h.stamp==this.stamp,h.active&&(a?(a=!1,this.c1=b,this.oc1=h):(this.hc2=!0,this.c2=b,this.oc2=h)),c!=h.active&&(this.contacts.modified=!0),b=e,c=d,d=d.next,
e=e.next)}this.hc2?(this.hpc2=!0,this.oc1.posOnly?(d=this.c1,this.c1=this.c2,this.c2=d,d=this.oc1,this.oc1=this.oc2,this.oc2=d,this.hc2=!1):this.oc2.posOnly&&(this.hc2=!1),this.oc1.posOnly&&(a=!0)):this.hpc2=!1;return a},preStep:function(a){this.invalidated&&(this.invalidated=!1,this.userdef_restitution||(this.restitution=-Infinity>=this.s1.material.elasticity||-Infinity>=this.s2.material.elasticity?0:Infinity<=this.s1.material.elasticity||Infinity<=this.s2.material.elasticity?1:(this.s1.material.elasticity+
this.s2.material.elasticity)/2,0>this.restitution&&(this.restitution=0),1<this.restitution&&(this.restitution=1)),this.userdef_dyn_fric||(this.dyn_fric=Math.sqrt(this.s1.material.dynamicFriction*this.s2.material.dynamicFriction)),this.userdef_stat_fric||(this.stat_fric=Math.sqrt(this.s1.material.staticFriction*this.s2.material.staticFriction)),this.userdef_rfric||(this.rfric=Math.sqrt(this.s1.material.rollingFriction*this.s2.material.rollingFriction)));-1==this.pre_dt&&(this.pre_dt=a);var b=a/this.pre_dt;
this.pre_dt=a;var c=this.b1.smass+this.b2.smass;this.hc2=!1;a=!0;this.biasCoef=2!=this.b1.type||2!=this.b2.type?this.continuous?u.contactContinuousStaticBiasCoef:u.contactStaticBiasCoef:this.continuous?u.contactContinuousBiasCoef:u.contactBiasCoef;this.continuous=!1;for(var d=null,e=null,h=this.innards.next,f=this.contacts.next;null!=f;){var g=f;if(g.stamp+u.arbiterExpirationDelay<this.stamp)f=this.contacts.inlined_erase(d),h=this.innards.inlined_erase(e),g.arbiter=null,g.next=Ia.zpp_pool,Ia.zpp_pool=
g;else{d=g.inner;e=g.active;g.active=g.stamp==this.stamp;if(g.active){a?(a=!1,this.c1=d,this.oc1=g):(this.hc2=!0,this.c2=d,this.oc2=g);d.r2x=g.px-this.b2.posx;d.r2y=g.py-this.b2.posy;d.r1x=g.px-this.b1.posx;d.r1y=g.py-this.b1.posy;var k=c+this.b2.sinertia*Bc.sqr(d.r2x*this.nx+d.r2y*this.ny),k=k+this.b1.sinertia*Bc.sqr(d.r1x*this.nx+d.r1y*this.ny);d.tMass=k<u.epsilon*u.epsilon?0:1/k;k=c+this.b2.sinertia*Bc.sqr(this.ny*d.r2x-this.nx*d.r2y);k+=this.b1.sinertia*Bc.sqr(this.ny*d.r1x-this.nx*d.r1y);d.nMass=
k<u.epsilon*u.epsilon?0:1/k;var l=k=0,n=this.b2.angvel+this.b2.kinangvel,k=this.b2.velx+this.b2.kinvelx-d.r2y*n,l=this.b2.vely+this.b2.kinvely+d.r2x*n,n=this.b1.angvel+this.b1.kinangvel,k=k-(this.b1.velx+this.b1.kinvelx-d.r1y*n),l=l-(this.b1.vely+this.b1.kinvely+d.r1x*n),n=this.nx*k+this.ny*l;g.elasticity=this.restitution;d.bounce=n*g.elasticity;d.bounce>-u.elasticThreshold&&(d.bounce=0);n=l*this.nx-k*this.ny;k=u.staticFrictionThreshold;d.friction=n*n>k*k?this.dyn_fric:this.stat_fric;d.jnAcc*=b;d.jtAcc*=
b}e!=g.active&&(this.contacts.modified=!0);d=f;e=h;h=h.next;f=f.next}}this.hc2?(this.hpc2=!0,this.oc1.posOnly?(h=this.c1,this.c1=this.c2,this.c2=h,h=this.oc1,this.oc1=this.oc2,this.oc2=h,this.hc2=!1):this.oc2.posOnly&&(this.hc2=!1),this.oc1.posOnly&&(a=!0)):this.hpc2=!1;this.jrAcc*=b;a||(this.rn1a=this.ny*this.c1.r1x-this.nx*this.c1.r1y,this.rt1a=this.c1.r1x*this.nx+this.c1.r1y*this.ny,this.rn1b=this.ny*this.c1.r2x-this.nx*this.c1.r2y,this.rt1b=this.c1.r2x*this.nx+this.c1.r2y*this.ny,this.k1x=this.b2.kinvelx-
this.c1.r2y*this.b2.kinangvel-(this.b1.kinvelx-this.c1.r1y*this.b1.kinangvel),this.k1y=this.b2.kinvely+this.c1.r2x*this.b2.kinangvel-(this.b1.kinvely+this.c1.r1x*this.b1.kinangvel));this.hc2&&(this.rn2a=this.ny*this.c2.r1x-this.nx*this.c2.r1y,this.rt2a=this.c2.r1x*this.nx+this.c2.r1y*this.ny,this.rn2b=this.ny*this.c2.r2x-this.nx*this.c2.r2y,this.rt2b=this.c2.r2x*this.nx+this.c2.r2y*this.ny,this.k2x=this.b2.kinvelx-this.c2.r2y*this.b2.kinangvel-(this.b1.kinvelx-this.c2.r1y*this.b1.kinangvel),this.k2y=
this.b2.kinvely+this.c2.r2x*this.b2.kinangvel-(this.b1.kinvely+this.c2.r1x*this.b1.kinangvel),this.kMassa=c+this.b1.sinertia*this.rn1a*this.rn1a+this.b2.sinertia*this.rn1b*this.rn1b,this.kMassb=c+this.b1.sinertia*this.rn1a*this.rn2a+this.b2.sinertia*this.rn1b*this.rn2b,this.kMassc=c+this.b1.sinertia*this.rn2a*this.rn2a+this.b2.sinertia*this.rn2b*this.rn2b,this.kMassa*this.kMassa+2*this.kMassb*this.kMassb+this.kMassc*this.kMassc<u.illConditionedThreshold*(this.kMassa*this.kMassc-this.kMassb*this.kMassb)?
(this.Ka=this.kMassa,this.Kb=this.kMassb,this.Kc=this.kMassc,b=this.kMassa*this.kMassc-this.kMassb*this.kMassb,b!=b?(this.kMassa=this.kMassb=this.kMassc=0,3):0==b?(b=0,0!=this.kMassa?this.kMassa=1/this.kMassa:(this.kMassa=0,b|=1),0!=this.kMassc?this.kMassc=1/this.kMassc:(this.kMassc=0,b|=2),this.kMassb=0,b):(b=1/b,c=this.kMassc*b,this.kMassc=this.kMassa*b,this.kMassa=c,this.kMassb*=-b,0)):(this.hc2=!1,this.oc2.dist<this.oc1.dist&&(b=this.c1,this.c1=this.c2,this.c2=b),this.oc2.active=!1,this.contacts.modified=
!0));this.surfacex=this.b2.svelx;this.surfacey=this.b2.svely;this.surfacex+=1*this.b1.svelx;this.surfacey+=1*this.b1.svely;this.surfacex=-this.surfacex;this.surfacey=-this.surfacey;this.rMass=this.b1.sinertia+this.b2.sinertia;0!=this.rMass&&(this.rMass=1/this.rMass);return a},warmStart:function(){var a=this.nx*this.c1.jnAcc-this.ny*this.c1.jtAcc,b=this.ny*this.c1.jnAcc+this.nx*this.c1.jtAcc,c=this.b1.imass;this.b1.velx-=a*c;this.b1.vely-=b*c;this.b1.angvel-=this.b1.iinertia*(b*this.c1.r1x-a*this.c1.r1y);
c=this.b2.imass;this.b2.velx+=a*c;this.b2.vely+=b*c;this.b2.angvel+=this.b2.iinertia*(b*this.c1.r2x-a*this.c1.r2y);this.hc2&&(a=this.nx*this.c2.jnAcc-this.ny*this.c2.jtAcc,b=this.ny*this.c2.jnAcc+this.nx*this.c2.jtAcc,c=this.b1.imass,this.b1.velx-=a*c,this.b1.vely-=b*c,this.b1.angvel-=this.b1.iinertia*(b*this.c2.r1x-a*this.c2.r1y),c=this.b2.imass,this.b2.velx+=a*c,this.b2.vely+=b*c,this.b2.angvel+=this.b2.iinertia*(b*this.c2.r2x-a*this.c2.r2y));this.b2.angvel+=this.jrAcc*this.b2.iinertia;this.b1.angvel-=
this.jrAcc*this.b1.iinertia},applyImpulseVel:function(){var a,b,c,d,e;d=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel);var h=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel);c=(h*this.nx-d*this.ny+this.surfacex)*this.c1.tMass;d=this.c1.friction*this.c1.jnAcc;a=this.c1.jtAcc;e=a-c;e>d?e=d:e<-d&&(e=-d);c=e-a;this.c1.jtAcc=e;a=-this.ny*c;b=this.nx*c;this.b2.velx+=a*this.b2.imass;this.b2.vely+=b*this.b2.imass;this.b1.velx-=
a*this.b1.imass;this.b1.vely-=b*this.b1.imass;this.b2.angvel+=this.rt1b*c*this.b2.iinertia;this.b1.angvel-=this.rt1a*c*this.b1.iinertia;this.hc2?(e=this.k2x+this.b2.velx-this.c2.r2y*this.b2.angvel-(this.b1.velx-this.c2.r1y*this.b1.angvel),b=this.k2y+this.b2.vely+this.c2.r2x*this.b2.angvel-(this.b1.vely+this.c2.r1x*this.b1.angvel),c=(b*this.nx-e*this.ny+this.surfacex)*this.c2.tMass,d=this.c2.friction*this.c2.jnAcc,a=this.c2.jtAcc,e=a-c,e>d?e=d:e<-d&&(e=-d),c=e-a,this.c2.jtAcc=e,a=-this.ny*c,b=this.nx*
c,this.b2.velx+=a*this.b2.imass,this.b2.vely+=b*this.b2.imass,this.b1.velx-=a*this.b1.imass,this.b1.vely-=b*this.b1.imass,this.b2.angvel+=this.rt2b*c*this.b2.iinertia,this.b1.angvel-=this.rt2a*c*this.b1.iinertia,d=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel),h=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel),e=this.k2x+this.b2.velx-this.c2.r2y*this.b2.angvel-(this.b1.velx-this.c2.r1y*this.b1.angvel),b=this.k2y+
this.b2.vely+this.c2.r2x*this.b2.angvel-(this.b1.vely+this.c2.r1x*this.b1.angvel),c=this.c1.jnAcc,a=this.c2.jnAcc,d=d*this.nx+h*this.ny+this.surfacey+this.c1.bounce-(this.Ka*c+this.Kb*a),e=e*this.nx+b*this.ny+this.surfacey+this.c2.bounce-(this.Kb*c+this.Kc*a),b=-(this.kMassa*d+this.kMassb*e),h=-(this.kMassb*d+this.kMassc*e),0<=b&&0<=h?(d=b-c,e=h-a,this.c1.jnAcc=b,this.c2.jnAcc=h):(b=-this.c1.nMass*d,0<=b&&0<=this.Kb*b+e?(d=b-c,e=-a,this.c1.jnAcc=b,this.c2.jnAcc=0):(h=-this.c2.nMass*e,0<=h&&0<=this.Kb*
h+d?(d=-c,e=h-a,this.c1.jnAcc=0,this.c2.jnAcc=h):0<=d&&0<=e?(d=-c,e=-a,this.c1.jnAcc=this.c2.jnAcc=0):e=d=0)),c=d+e,a=this.nx*c,b=this.ny*c,this.b2.velx+=a*this.b2.imass,this.b2.vely+=b*this.b2.imass,this.b1.velx-=a*this.b1.imass,this.b1.vely-=b*this.b1.imass,this.b2.angvel+=(this.rn1b*d+this.rn2b*e)*this.b2.iinertia,this.b1.angvel-=(this.rn1a*d+this.rn2a*e)*this.b1.iinertia):(0!=this.radius&&(c=(this.b2.angvel-this.b1.angvel)*this.rMass,d=this.rfric*this.c1.jnAcc,a=this.jrAcc,this.jrAcc-=c,this.jrAcc>
d?this.jrAcc=d:this.jrAcc<-d&&(this.jrAcc=-d),c=this.jrAcc-a,this.b2.angvel+=c*this.b2.iinertia,this.b1.angvel-=c*this.b1.iinertia),d=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel),h=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel),c=(this.c1.bounce+(this.nx*d+this.ny*h)+this.surfacey)*this.c1.nMass,a=this.c1.jnAcc,e=a-c,0>e&&(e=0),c=e-a,this.c1.jnAcc=e,a=this.nx*c,b=this.ny*c,this.b2.velx+=a*this.b2.imass,this.b2.vely+=
b*this.b2.imass,this.b1.velx-=a*this.b1.imass,this.b1.vely-=b*this.b1.imass,this.b2.angvel+=this.rn1b*c*this.b2.iinertia,this.b1.angvel-=this.rn1a*c*this.b1.iinertia)},applyImpulsePos:function(){if(2==this.ptype){var a=this.c1,b=0,c=0,b=this.b2.axisy*a.lr2x-this.b2.axisx*a.lr2y,c=a.lr2x*this.b2.axisx+a.lr2y*this.b2.axisy,b=b+1*this.b2.posx,c=c+1*this.b2.posy,d=0,e=0,d=this.b1.axisy*a.lr1x-this.b1.axisx*a.lr1y,e=a.lr1x*this.b1.axisx+a.lr1y*this.b1.axisy,d=d+1*this.b1.posx,e=e+1*this.b1.posy,h=a=0,
a=b-d,h=c-e,f=Math.sqrt(a*a+h*h),g=this.radius-u.collisionSlop,k=f-g;0>a*this.nx+h*this.ny&&(a=-a,h=-h,k-=this.radius);0>k&&(f<u.epsilon?0!=this.b1.smass?this.b1.posx+=10*u.epsilon:this.b2.posx+=10*u.epsilon:(k=1/f,a*=k,h*=k,b=.5*(d+b),c=.5*(e+c),d=b-this.b1.posx,e=c-this.b1.posy,b-=this.b2.posx,c-=this.b2.posy,d=h*d-a*e,b=h*b-a*c,c=this.b2.smass+b*b*this.b2.sinertia+this.b1.smass+d*d*this.b1.sinertia,0!=c&&(f=-this.biasCoef*(f-g)/c,c=g=0,g=a*f,c=h*f,a=this.b1.imass,this.b1.posx-=g*a,this.b1.posy-=
c*a,this.b1.delta_rot(-d*this.b1.iinertia*f),a=this.b2.imass,this.b2.posx+=g*a,this.b2.posy+=c*a,this.b2.delta_rot(b*this.b2.iinertia*f))))}else{var l=k=h=a=0,e=g=0;0==this.ptype?(a=this.b1.axisy*this.lnormx-this.b1.axisx*this.lnormy,h=this.lnormx*this.b1.axisx+this.lnormy*this.b1.axisy,f=this.lproj+(a*this.b1.posx+h*this.b1.posy),k=this.b2.axisy*this.c1.lr1x-this.b2.axisx*this.c1.lr1y,l=this.c1.lr1x*this.b2.axisx+this.c1.lr1y*this.b2.axisy,k+=1*this.b2.posx,l+=1*this.b2.posy,this.hpc2&&(g=this.b2.axisy*
this.c2.lr1x-this.b2.axisx*this.c2.lr1y,e=this.c2.lr1x*this.b2.axisx+this.c2.lr1y*this.b2.axisy,g+=1*this.b2.posx,e+=1*this.b2.posy)):(a=this.b2.axisy*this.lnormx-this.b2.axisx*this.lnormy,h=this.lnormx*this.b2.axisx+this.lnormy*this.b2.axisy,f=this.lproj+(a*this.b2.posx+h*this.b2.posy),k=this.b1.axisy*this.c1.lr1x-this.b1.axisx*this.c1.lr1y,l=this.c1.lr1x*this.b1.axisx+this.c1.lr1y*this.b1.axisy,k+=1*this.b1.posx,l+=1*this.b1.posy,this.hpc2&&(g=this.b1.axisy*this.c2.lr1x-this.b1.axisx*this.c2.lr1y,
e=this.c2.lr1x*this.b1.axisx+this.c2.lr1y*this.b1.axisy,g+=1*this.b1.posx,e+=1*this.b1.posy));b=k*a+l*h-f-this.radius;b+=u.collisionSlop;c=0;this.hpc2&&(c=g*a+e*h-f-this.radius,c+=u.collisionSlop);if(0>b||0>c){this.rev&&(a=-a,h=-h);var n=0,r=0,n=k-this.b1.posx,r=l-this.b1.posy,d=f=0,f=k-this.b2.posx,d=l-this.b2.posy,z=0,x=0,l=k=0;if(this.hpc2){z=g-this.b1.posx;x=e-this.b1.posy;k=g-this.b2.posx;l=e-this.b2.posy;g=h*n-a*r;f=h*f-a*d;e=h*z-a*x;d=h*k-a*l;k=this.b1.smass+this.b2.smass;this.kMassa=k+this.b1.sinertia*
g*g+this.b2.sinertia*f*f;this.kMassb=k+this.b1.sinertia*g*e+this.b2.sinertia*f*d;this.kMassc=k+this.b1.sinertia*e*e+this.b2.sinertia*d*d;l=k=n=0;n=this.kMassa;k=this.kMassb;l=this.kMassc;r=b*this.biasCoef;z=c*this.biasCoef;c=b=0;b=-r;c=-z;x=this.kMassa*this.kMassc-this.kMassb*this.kMassb;if(x!=x)b=c=0;else if(0==x)b=0!=this.kMassa?b/this.kMassa:0,c=0!=this.kMassc?c/this.kMassc:0;else var x=1/x,p=x*(this.kMassc*b-this.kMassb*c),c=x*(this.kMassa*c-this.kMassb*b),b=p;0<=b&&0<=c?(k=(b+c)*this.b1.imass,
this.b1.posx-=a*k,this.b1.posy-=h*k,this.b1.delta_rot(-this.b1.iinertia*(g*b+e*c)),g=(b+c)*this.b2.imass,this.b2.posx+=a*g,this.b2.posy+=h*g,this.b2.delta_rot(this.b2.iinertia*(f*b+d*c))):(b=-r/n,c=0,n=k*b+z,0<=b&&0<=n?(k=(b+c)*this.b1.imass,this.b1.posx-=a*k,this.b1.posy-=h*k,this.b1.delta_rot(-this.b1.iinertia*(g*b+e*c)),g=(b+c)*this.b2.imass,this.b2.posx+=a*g,this.b2.posy+=h*g,this.b2.delta_rot(this.b2.iinertia*(f*b+d*c))):(b=0,c=-z/l,k=k*c+r,0<=c&&0<=k&&(k=(b+c)*this.b1.imass,this.b1.posx-=a*
k,this.b1.posy-=h*k,this.b1.delta_rot(-this.b1.iinertia*(g*b+e*c)),g=(b+c)*this.b2.imass,this.b2.posx+=a*g,this.b2.posy+=h*g,this.b2.delta_rot(this.b2.iinertia*(f*b+d*c)))))}else g=h*n-a*r,f=h*f-a*d,c=this.b2.smass+f*f*this.b2.sinertia+this.b1.smass+g*g*this.b1.sinertia,0!=c&&(b=-this.biasCoef*b/c,d=c=0,c=a*b,d=h*b,a=this.b1.imass,this.b1.posx-=c*a,this.b1.posy-=d*a,this.b1.delta_rot(-g*this.b1.iinertia*b),a=this.b2.imass,this.b2.posx+=c*a,this.b2.posy+=d*a,this.b2.delta_rot(f*this.b2.iinertia*b))}}},
__class__:dc});var Ia=function(){this.length=0;this._inuse=this.modified=this.pushmod=!1;this.next=null;this.dist=this.elasticity=0;this.fresh=!1;this.stamp=this.hash=0;this.active=this.posOnly=!1;this.wrap_position=this.arbiter=this.inner=null;this.px=this.py=0;this.outer=null;this.inner=new We};Ia.__name__=!0;Ia.prototype={wrapper:function(){null==this.outer&&(Ia.internal=!0,this.outer=new hf,Ia.internal=!1,this.outer.zpp_inner=this);return this.outer},position_validate:function(){if(this.inactiveme())throw new f("Error: Contact not currently in use");
this.wrap_position.zpp_inner.x=this.px;this.wrap_position.zpp_inner.y=this.py},getposition:function(){this.wrap_position=E.get(null,null,null);this.wrap_position.zpp_inner._inuse=!0;this.wrap_position.zpp_inner._immutable=!0;this.wrap_position.zpp_inner._validate=w(this,this.position_validate)},inactiveme:function(){return!(this.active&&null!=this.arbiter&&this.arbiter.active)},free:function(){this.arbiter=null},alloc:function(){},elem:function(){return this},begin:function(){return this.next},setbegin:function(a){this.next=
a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){a._inuse=!0;a.next=this.next;this.next=a;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.next;null!=a;)this.add(a),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){b._inuse=!0;null==a?(b.next=this.next,this.next=b):(b.next=a.next,a.next=b);this.pushmod=this.modified=!0;this.length++;return b},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=
this.next;this.next=a.next;a._inuse=!1;null==this.next&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.next;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.next,d=!1;null!=c;){if(c==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=
this.next,d=!1;null!=c;){if(c==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.next,this.next=c=b.next,null==this.next&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));b._inuse=!1;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){},inlined_clear:function(){},reverse:function(){for(var a=
this.next,b=null;null!=a;){var c=a.next;a.next=b;b=this.next=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.next},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.next;null!=c;){if(c==a){b=!0;break}c=c.next}return b},front:function(){return this.next},back:function(){for(var a=this.next,b=a;null!=b;)a=b,b=b.next;return a},iterator_at:function(a){for(var b=this.next;0<a--&&null!=b;)b=b.next;return b},
at:function(a){a=this.iterator_at(a);return null!=a?a:null},__class__:Ia};var We=function(){this.length=0;this._inuse=this.modified=this.pushmod=!1;this.next=null;this.r1x=this.r1y=this.r2x=this.r2y=this.nMass=this.tMass=this.bounce=this.friction=this.jnAcc=this.jtAcc=this.lr1x=this.lr1y=this.lr2x=this.lr2y=0};We.__name__=!0;We.prototype={elem:function(){return this},begin:function(){return this.next},setbegin:function(a){this.next=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},
inlined_add:function(a){a._inuse=!0;a.next=this.next;this.next=a;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.next;null!=a;)this.add(a),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){b._inuse=!0;null==a?(b.next=this.next,this.next=b):(b.next=a.next,a.next=b);this.pushmod=this.modified=!0;this.length++;return b},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.next;this.next=a.next;a._inuse=!1;null==this.next&&
(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.next;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.next,d=!1;null!=c;){if(c==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.next,d=!1;null!=c;){if(c==a){this.inlined_erase(b);
d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.next,this.next=c=b.next,null==this.next&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));b._inuse=!1;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){},inlined_clear:function(){},reverse:function(){for(var a=this.next,b=null;null!=a;){var c=
a.next;a.next=b;b=this.next=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.next},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.next;null!=c;){if(c==a){b=!0;break}c=c.next}return b},front:function(){return this.next},back:function(){for(var a=this.next,b=a;null!=b;)a=b,b=b.next;return a},iterator_at:function(a){for(var b=this.next;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);
return null!=a?a:null},__class__:We};var za=function(){this.collisionGroup=this.collisionMask=this.sensorGroup=this.sensorMask=this.fluidGroup=this.fluidMask=0;this.next=this.userData=this.outer=this.shapes=this.wrap_shapes=null;this.shapes=new ua;this.collisionGroup=this.sensorGroup=this.fluidGroup=1;this.collisionMask=this.sensorMask=this.fluidMask=-1};za.__name__=!0;za.prototype={wrapper:function(){if(null==this.outer){this.outer=new Ne;var a=this.outer.zpp_inner;a.outer=null;a.next=za.zpp_pool;
za.zpp_pool=a;this.outer.zpp_inner=this}return this.outer},free:function(){this.outer=null},alloc:function(){},feature_cons:function(){this.shapes=new ua},addShape:function(a){this.shapes.add(a)},remShape:function(a){this.shapes.remove(a)},copy:function(){var a;null==za.zpp_pool?a=new za:(a=za.zpp_pool,za.zpp_pool=a.next,a.next=null);null;a.collisionGroup=this.collisionGroup;a.collisionMask=this.collisionMask;a.sensorGroup=this.sensorGroup;a.sensorMask=this.sensorMask;a.fluidGroup=this.fluidGroup;
a.fluidMask=this.fluidMask;return a},shouldCollide:function(a){return 0!=(this.collisionMask&a.collisionGroup)&&0!=(a.collisionMask&this.collisionGroup)},shouldSense:function(a){return 0!=(this.sensorMask&a.sensorGroup)&&0!=(a.sensorMask&this.sensorGroup)},shouldFlow:function(a){return 0!=(this.fluidMask&a.fluidGroup)&&0!=(a.fluidMask&this.fluidGroup)},invalidate:function(){for(var a=this.shapes.head;null!=a;)a.elt.invalidate_filter(),a=a.next},__class__:za};var Te=function(){this.at_index_0=this.at_index_1=
this.at_index_2=this.at_index_3=0;this.lengths=this.ite_0=this.ite_1=this.ite_2=this.ite_3=null;this.zip_length=!1;this._length=0;this.space=null;sd.call(this);this.at_index_3=this.at_index_2=this.at_index_1=this.at_index_0=0;this.zip_length=!0;this._length=0;this.lengths=[];for(var a=0;4>a;)a++,this.lengths.push(0)};Te.__name__=!0;Te.__super__=sd;Te.prototype=I(sd.prototype,{zpp_gl:function(){this.zpp_vm();if(this.zip_length){for(var a=this._length=0,b=0,c=this.space.c_arbiters_true.head;null!=c;)c.elt.active&&
b++,c=c.next;this.lengths[a++]=b;this._length+=b;b=0;for(c=this.space.c_arbiters_false.head;null!=c;)c.elt.active&&b++,c=c.next;this.lengths[a++]=b;this._length+=b;b=0;for(c=this.space.f_arbiters.head;null!=c;)c.elt.active&&b++,c=c.next;this.lengths[a++]=b;this._length+=b;b=0;for(c=this.space.s_arbiters.head;null!=c;)c.elt.active&&b++,c=c.next;this.lengths[a++]=b;this._length+=b;this.zip_length=!1}return this._length},zpp_vm:function(){var a=!1;this.space.c_arbiters_true.modified&&(a=!0,this.space.c_arbiters_true.modified=
!1);this.space.c_arbiters_false.modified&&(a=!0,this.space.c_arbiters_false.modified=!1);this.space.f_arbiters.modified&&(a=!0,this.space.f_arbiters.modified=!1);this.space.s_arbiters.modified&&(a=!0,this.space.s_arbiters.modified=!1);a&&(this.zip_length=!0,this._length=0,this.ite_3=this.ite_2=this.ite_1=this.ite_0=null)},push:function(a){throw new f("Error: ArbiterList is immutable");},pop:function(){throw new f("Error: ArbiterList is immutable");},unshift:function(a){throw new f("Error: ArbiterList is immutable");
},shift:function(){throw new f("Error: ArbiterList is immutable");},remove:function(a){throw new f("Error: ArbiterList is immutable");},clear:function(){throw new f("Error: ArbiterList is immutable");},at:function(a){this.zpp_vm();if(0>a||a>=this.zpp_gl())throw new f("Error: Index out of bounds");var b=null,c=0;if(null==b)if(a<c+this.lengths[0]){b=a-c;if(b<this.at_index_0||null==this.ite_0)for(this.at_index_0=0,this.ite_0=this.space.c_arbiters_true.head;!this.ite_0.elt.active;)this.ite_0=this.ite_0.next;
for(;this.at_index_0!=b;)for(this.at_index_0++,this.ite_0=this.ite_0.next;!this.ite_0.elt.active;)this.ite_0=this.ite_0.next;b=this.ite_0.elt.wrapper()}else c+=this.lengths[0];if(null==b)if(a<c+this.lengths[1]){b=a-c;if(b<this.at_index_1||null==this.ite_1)for(this.at_index_1=0,this.ite_1=this.space.c_arbiters_false.head;!this.ite_1.elt.active;)this.ite_1=this.ite_1.next;for(;this.at_index_1!=b;)for(this.at_index_1++,this.ite_1=this.ite_1.next;!this.ite_1.elt.active;)this.ite_1=this.ite_1.next;b=this.ite_1.elt.wrapper()}else c+=
this.lengths[1];if(null==b)if(a<c+this.lengths[2]){b=a-c;if(b<this.at_index_2||null==this.ite_2)for(this.at_index_2=0,this.ite_2=this.space.f_arbiters.head;!this.ite_2.elt.active;)this.ite_2=this.ite_2.next;for(;this.at_index_2!=b;)for(this.at_index_2++,this.ite_2=this.ite_2.next;!this.ite_2.elt.active;)this.ite_2=this.ite_2.next;b=this.ite_2.elt.wrapper()}else c+=this.lengths[2];if(null==b&&a<c+this.lengths[3]){a-=c;if(a<this.at_index_3||null==this.ite_3)for(this.at_index_3=0,this.ite_3=this.space.s_arbiters.head;!this.ite_3.elt.active;)this.ite_3=
this.ite_3.next;for(;this.at_index_3!=a;)for(this.at_index_3++,this.ite_3=this.ite_3.next;!this.ite_3.elt.active;)this.ite_3=this.ite_3.next;b=this.ite_3.elt.wrapper()}return b},__class__:Te});var X=function(){this.wrap_max=null;this.maxx=this.maxy=0;this.wrap_min=null;this.minx=this.miny=0;this.outer=this.next=null;this._immutable=!1;this._invalidate=this._validate=null};X.__name__=!0;X.get=function(a,b,c,d){var e;null==X.zpp_pool?e=new X:(e=X.zpp_pool,X.zpp_pool=e.next,e.next=null);null;e.minx=
a;e.miny=b;e.maxx=c;e.maxy=d;return e};X.prototype={validate:function(){null!=this._validate&&this._validate()},invalidate:function(){null!=this._invalidate&&this._invalidate(this)},wrapper:function(){if(null==this.outer){this.outer=new Oe;var a=this.outer.zpp_inner;null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null);a.wrap_min=a.wrap_max=null;a._invalidate=null;a._validate=null;a.next=X.zpp_pool;X.zpp_pool=a;this.outer.zpp_inner=this}return this.outer},alloc:function(){},free:function(){null!=this.outer&&
(this.outer=this.outer.zpp_inner=null);this._validate=this._invalidate=this.wrap_min=this.wrap_max=null},copy:function(){return X.get(this.minx,this.miny,this.maxx,this.maxy)},width:function(){return this.maxx-this.minx},height:function(){return this.maxy-this.miny},perimeter:function(){return 2*(this.maxx-this.minx+(this.maxy-this.miny))},getmin:function(){null==this.wrap_min&&(this.wrap_min=E.get(this.minx,this.miny,null),this.wrap_min.zpp_inner._inuse=!0,this._immutable?this.wrap_min.zpp_inner._immutable=
!0:this.wrap_min.zpp_inner._invalidate=w(this,this.mod_min),this.wrap_min.zpp_inner._validate=w(this,this.dom_min));return this.wrap_min},dom_min:function(){null!=this._validate&&this._validate();this.wrap_min.zpp_inner.x=this.minx;this.wrap_min.zpp_inner.y=this.miny},mod_min:function(a){if(a.x!=this.minx||a.y!=this.miny)this.minx=a.x,this.miny=a.y,null!=this._invalidate&&this._invalidate(this)},getmax:function(){null==this.wrap_max&&(this.wrap_max=E.get(this.maxx,this.maxy,null),this.wrap_max.zpp_inner._inuse=
!0,this._immutable?this.wrap_max.zpp_inner._immutable=!0:this.wrap_max.zpp_inner._invalidate=w(this,this.mod_max),this.wrap_max.zpp_inner._validate=w(this,this.dom_max));return this.wrap_max},dom_max:function(){null!=this._validate&&this._validate();this.wrap_max.zpp_inner.x=this.maxx;this.wrap_max.zpp_inner.y=this.maxy},mod_max:function(a){if(a.x!=this.maxx||a.y!=this.maxy)this.maxx=a.x,this.maxy=a.y,null!=this._invalidate&&this._invalidate(this)},intersectX:function(a){return!(a.minx>this.maxx||
this.minx>a.maxx)},intersectY:function(a){return!(a.miny>this.maxy||this.miny>a.maxy)},intersect:function(a){return a.miny<=this.maxy&&this.miny<=a.maxy&&a.minx<=this.maxx&&this.minx<=a.maxx},combine:function(a){a.minx<this.minx&&(this.minx=a.minx);a.maxx>this.maxx&&(this.maxx=a.maxx);a.miny<this.miny&&(this.miny=a.miny);a.maxy>this.maxy&&(this.maxy=a.maxy)},contains:function(a){return a.minx>=this.minx&&a.miny>=this.miny&&a.maxx<=this.maxx&&a.maxy<=this.maxy},containsPoint:function(a){return a.x>=
this.minx&&a.x<=this.maxx&&a.y>=this.miny&&a.y<=this.maxy},setCombine:function(a,b){this.minx=a.minx<b.minx?a.minx:b.minx;this.miny=a.miny<b.miny?a.miny:b.miny;this.maxx=a.maxx>b.maxx?a.maxx:b.maxx;this.maxy=a.maxy>b.maxy?a.maxy:b.maxy},setExpand:function(a,b){this.minx=a.minx-b;this.miny=a.miny-b;this.maxx=a.maxx+b;this.maxy=a.maxy+b},setExpandPoint:function(a,b){a<this.minx&&(this.minx=a);a>this.maxx&&(this.maxx=a);b<this.miny&&(this.miny=b);b>this.maxy&&(this.maxy=b)},toString:function(){return"{ x: "+
this.minx+" y: "+this.miny+" w: "+(this.maxx-this.minx)+" h: "+(this.maxy-this.miny)+" }"},__class__:X};var ie=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};ie.__name__=!0;ie.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Va.zpp_pool?b=new Va:(b=Va.zpp_pool,Va.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=
!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Va.zpp_pool?c=new Va:(c=Va.zpp_pool,Va.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Va.zpp_pool;
Va.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=
c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Va.zpp_pool;Va.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();
this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=
this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:ie};var C=function(){};C.__name__=!0;C.circleContains=function(a,b){var c=0,d=0,c=b.x-a.worldCOMx,d=b.y-a.worldCOMy;return c*c+d*d<a.radius*a.radius};C.polyContains=function(a,b){var c;c=!0;for(var d=a.edges.head;null!=d;){var e=d.elt;if(e.gnormx*b.x+e.gnormy*b.y<=e.gprojection)d=d.next;else{c=!1;
break}}return c};C.shapeContains=function(a,b){return 0==a.type?C.circleContains(a.circle,b):C.polyContains(a.polygon,b)};C.bodyContains=function(a,b){var c;c=!1;for(var d=a.shapes.head;null!=d;){if(C.shapeContains(d.elt,b)){c=!0;break}d=d.next}return c};C.containTest=function(a,b){if(a.aabb.contains(b.aabb)){if(0==a.type){if(0==b.type){var c=a.circle.radius+-b.circle.radius,d=0,e=0,d=b.circle.worldCOMx-a.circle.worldCOMx,e=b.circle.worldCOMy-a.circle.worldCOMy;return d*d+e*e<=c*c}c=!0;for(d=b.polygon.gverts.next;null!=
d;){var h=d;if(function(b){b=a.circle.radius;var c=0,d=0,c=h.x-a.circle.worldCOMx,d=h.y-a.circle.worldCOMy;return c*c+d*d<=b*b}(this))d=d.next;else{c=!1;break}}return c}if(0==b.type){c=!0;for(d=a.polygon.edges.head;null!=d;)if(e=d.elt,e.gnormx*b.circle.worldCOMx+e.gnormy*b.circle.worldCOMy+b.circle.radius<=e.gprojection)d=d.next;else{c=!1;break}return c}c=!0;for(d=a.polygon.edges.head;null!=d;){var f=d.elt;if(function(a){a=-1E100;for(var c=b.polygon.gverts.next;null!=c;){var d=c,d=f.gnormx*d.x+f.gnormy*
d.y;d>a&&(a=d);c=c.next}return a<=f.gprojection}(this))d=d.next;else{c=!1;break}}return c}return!1};C.contactCollide=function(a,b,c,d){if(1==b.type)if(1==a.type){for(var e=!0,h=-1E100,f=-1,g=null,k=null,l=a.polygon.edges.head;null!=l;){for(var n=l.elt,r=1E100,z=b.polygon.gverts.next;null!=z;){var x=z,x=n.gnormx*x.x+n.gnormy*x.y;x<r&&(r=x);if(r-n.gprojection<=h)break;z=z.next}r-=n.gprojection;if(0<=r){e=!1;break}r>h&&(h=r,g=n,f=1);l=l.next}if(e){for(l=b.polygon.edges.head;null!=l;){n=l.elt;r=1E100;
for(z=a.polygon.gverts.next;null!=z;){x=z;x=n.gnormx*x.x+n.gnormy*x.y;x<r&&(r=x);if(r-n.gprojection<=h)break;z=z.next}r-=n.gprojection;if(0<=r){e=!1;break}r>h&&(h=r,k=n,f=2);l=l.next}if(e){1==f?(a=b.polygon,b=g,k=1):(a=a.polygon,b=k,k=-1);g=null;e=1E100;for(h=a.edges.head;null!=h;)l=h.elt,n=b.gnormx*l.gnormx+b.gnormy*l.gnormy,n<e&&(e=n,g=l),h=h.next;var h=e=0,e=g.gp0.x,h=g.gp0.y,n=l=0,l=g.gp1.x,n=g.gp1.y,z=r=0,r=l-e,z=n-h,p=b.gnormy*e-b.gnormx*h,x=b.gnormy*l-b.gnormx*n,y=1/(x-p),p=(-b.tp1-p)*y;p>
u.epsilon&&(e+=r*p,h+=z*p);x=(-b.tp0-x)*y;x<-u.epsilon&&(l+=r*x,n+=z*x);z=r=0;z=k;r=b.gnormx*z;z*=b.gnormy;c.lnormx=b.lnormx;c.lnormy=b.lnormy;c.lproj=b.lprojection;c.radius=0;c.rev=d!=(-1==k);c.ptype=c.rev?1:0;x=e*b.gnormx+h*b.gnormy-b.gprojection;k=l*b.gnormx+n*b.gnormy-b.gprojection;if(0<x&&0<k)return!1;d&&(r=-r,z=-z);d=c.injectContact(e-b.gnormx*x*.5,h-b.gnormy*x*.5,r,z,x,c.rev?1:0,0<x);e-=1*a.body.posx;h-=1*a.body.posy;d.inner.lr1x=e*a.body.axisy+h*a.body.axisx;d.inner.lr1y=h*a.body.axisy-e*
a.body.axisx;d=c.injectContact(l-b.gnormx*k*.5,n-b.gnormy*k*.5,r,z,k,c.rev?0:1,0<k);l-=1*a.body.posx;n-=1*a.body.posy;d.inner.lr1x=l*a.body.axisy+n*a.body.axisx;d.inner.lr1y=n*a.body.axisy-l*a.body.axisx;1==f?(c.__ref_edge1=b,c.__ref_edge2=g):(c.__ref_edge2=b,c.__ref_edge1=g);return!0}}}else{k=-1E100;g=!0;e=f=null;h=b.polygon.gverts.next;for(l=b.polygon.edges.head;null!=l;){n=l.elt;r=n.gnormx*a.circle.worldCOMx+n.gnormy*a.circle.worldCOMy-n.gprojection-a.circle.radius;if(0<r){g=!1;break}r>k&&(k=r,
f=n,e=h);h=h.next;l=l.next}if(g){g=e;e=null==e.next?b.polygon.gverts.next:e.next;h=a.circle.worldCOMy*f.gnormx-a.circle.worldCOMx*f.gnormy;if(h<=g.y*f.gnormx-g.x*f.gnormy)return k=a.circle.radius,h=e=0,e=g.x-a.circle.worldCOMx,h=g.y-a.circle.worldCOMy,l=e*e+h*h,l>k*k?k=null:l<u.epsilon*u.epsilon?k=c.injectContact(a.circle.worldCOMx,a.circle.worldCOMy,1,0,-k,0,null):(l=1/Math.sqrt(l),n=l<u.epsilon?1E100:1/l,r=.5+(a.circle.radius-.5*k)*l,k=d?c.injectContact(a.circle.worldCOMx+e*r,a.circle.worldCOMy+
h*r,-e*l,-h*l,n-k,0,null):c.injectContact(a.circle.worldCOMx+e*r,a.circle.worldCOMy+h*r,e*l,h*l,n-k,0,null)),null!=k&&(e=k.inner,c.ptype=2,l=h=0,h=g.x-b.polygon.body.posx,l=g.y-b.polygon.body.posy,c.__ref_edge1=f,c.__ref_vertex=-1,d?(e.lr1x=h*b.polygon.body.axisy+l*b.polygon.body.axisx,e.lr1y=l*b.polygon.body.axisy-h*b.polygon.body.axisx,e.lr2x=a.circle.localCOMx,e.lr2y=a.circle.localCOMy):(e.lr2x=h*b.polygon.body.axisy+l*b.polygon.body.axisx,e.lr2y=l*b.polygon.body.axisy-h*b.polygon.body.axisx,e.lr1x=
a.circle.localCOMx,e.lr1y=a.circle.localCOMy),c.radius=a.circle.radius),null!=k;if(h>=e.y*f.gnormx-e.x*f.gnormy)return g=a.circle.radius,h=k=0,k=e.x-a.circle.worldCOMx,h=e.y-a.circle.worldCOMy,l=k*k+h*h,l>g*g?g=null:l<u.epsilon*u.epsilon?g=c.injectContact(a.circle.worldCOMx,a.circle.worldCOMy,1,0,-g,0,null):(l=1/Math.sqrt(l),n=l<u.epsilon?1E100:1/l,r=.5+(a.circle.radius-.5*g)*l,g=d?c.injectContact(a.circle.worldCOMx+k*r,a.circle.worldCOMy+h*r,-k*l,-h*l,n-g,0,null):c.injectContact(a.circle.worldCOMx+
k*r,a.circle.worldCOMy+h*r,k*l,h*l,n-g,0,null)),null!=g&&(k=g.inner,c.ptype=2,l=h=0,h=e.x-b.polygon.body.posx,l=e.y-b.polygon.body.posy,c.__ref_edge1=f,c.__ref_vertex=1,d?(k.lr1x=h*b.polygon.body.axisy+l*b.polygon.body.axisx,k.lr1y=l*b.polygon.body.axisy-h*b.polygon.body.axisx,k.lr2x=a.circle.localCOMx,k.lr2y=a.circle.localCOMy):(k.lr2x=h*b.polygon.body.axisy+l*b.polygon.body.axisx,k.lr2y=l*b.polygon.body.axisy-h*b.polygon.body.axisx,k.lr1x=a.circle.localCOMx,k.lr1y=a.circle.localCOMy),c.radius=a.circle.radius),
null!=g;g=b=0;g=a.circle.radius+.5*k;b=f.gnormx*g;g*=f.gnormy;h=e=0;e=a.circle.worldCOMx-b;h=a.circle.worldCOMy-g;b=d?c.injectContact(e,h,f.gnormx,f.gnormy,k,0,null):c.injectContact(e,h,-f.gnormx,-f.gnormy,k,0,null);c.ptype=d?0:1;c.lnormx=f.lnormx;c.lnormy=f.lnormy;c.rev=!d;c.lproj=f.lprojection;c.radius=a.circle.radius;b.inner.lr1x=a.circle.localCOMx;b.inner.lr1y=a.circle.localCOMy;c.__ref_edge1=f;c.__ref_vertex=0;return!0}}else if(f=a.circle.radius+b.circle.radius,k=g=0,g=b.circle.worldCOMx-a.circle.worldCOMx,
k=b.circle.worldCOMy-a.circle.worldCOMy,e=g*g+k*k,e>f*f?f=null:e<u.epsilon*u.epsilon?f=c.injectContact(a.circle.worldCOMx,a.circle.worldCOMy,1,0,-f,0,null):(e=1/Math.sqrt(e),h=e<u.epsilon?1E100:1/e,l=.5+(a.circle.radius-.5*f)*e,f=d?c.injectContact(a.circle.worldCOMx+g*l,a.circle.worldCOMy+k*l,-g*e,-k*e,h-f,0,null):c.injectContact(a.circle.worldCOMx+g*l,a.circle.worldCOMy+k*l,g*e,k*e,h-f,0,null)),null!=f)return f=f.inner,d?(f.lr1x=b.circle.localCOMx,f.lr1y=b.circle.localCOMy,f.lr2x=a.circle.localCOMx,
f.lr2y=a.circle.localCOMy):(f.lr1x=a.circle.localCOMx,f.lr1y=a.circle.localCOMy,f.lr2x=b.circle.localCOMx,f.lr2y=b.circle.localCOMy),c.radius=a.circle.radius+b.circle.radius,c.ptype=2,!0;return!1};C.testCollide_safe=function(a,b){if(0==b.type){var c=a;a=b;b=c}return C.testCollide(a,b)};C.testCollide=function(a,b){if(1==b.type){if(1==a.type){for(var c=!0,d=a.polygon.edges.head;null!=d;){for(var e=d.elt,h=1E100,f=b.polygon.gverts.next;null!=f;){var g=f,g=e.gnormx*g.x+e.gnormy*g.y;g<h&&(h=g);f=f.next}h-=
e.gprojection;if(0<h){c=!1;break}d=d.next}if(c){for(d=b.polygon.edges.head;null!=d;){e=d.elt;h=1E100;for(f=a.polygon.gverts.next;null!=f;)g=f,g=e.gnormx*g.x+e.gnormy*g.y,g<h&&(h=g),f=f.next;h-=e.gprojection;if(0<h){c=!1;break}d=d.next}return c}}else{d=c=null;e=!0;h=-1E100;f=b.polygon.gverts.next;for(g=b.polygon.edges.head;null!=g;){var k=g.elt,l=k.gnormx*a.circle.worldCOMx+k.gnormy*a.circle.worldCOMy-k.gprojection-a.circle.radius;if(0<l){e=!1;break}l>h&&(h=l,c=k,d=f);f=f.next;g=g.next}if(e)return e=
d,d=null==d.next?b.polygon.gverts.next:d.next,h=a.circle.worldCOMy*c.gnormx-a.circle.worldCOMx*c.gnormy,h<=e.y*c.gnormx-e.x*c.gnormy?(c=a.circle.radius,h=d=0,d=e.x-a.circle.worldCOMx,h=e.y-a.circle.worldCOMy,d*d+h*h<=c*c):h>=d.y*c.gnormx-d.x*c.gnormy?(c=a.circle.radius,h=e=0,e=d.x-a.circle.worldCOMx,h=d.y-a.circle.worldCOMy,e*e+h*h<=c*c):!0}return!1}c=a.circle.radius+b.circle.radius;e=d=0;d=b.circle.worldCOMx-a.circle.worldCOMx;e=b.circle.worldCOMy-a.circle.worldCOMy;return d*d+e*e<=c*c};C.flowCollide=
function(a,b,c){if(1==b.type){if(1==a.type){for(var d=[],e=[],h=!0,f=!0,g=a.polygon.edges.head;null!=g;){for(var k=g.elt,l=1E100,n=0,r=b.polygon.gverts.next;null!=r;){var z=r,x=k.gnormx*z.x+k.gnormy*z.y;x<l&&(l=x);x>=k.gprojection+u.epsilon&&(e[n]=!0,f=!1);n++;r=r.next}l-=k.gprojection;if(0<l){h=!1;break}g=g.next}if(f)return b.polygon.validate_worldCOM(),c.overlap=b.polygon.area,c.centroidx=b.polygon.worldCOMx,c.centroidy=b.polygon.worldCOMy,null,!0;if(h){for(var f=!0,p=b.polygon.edges.head;null!=
p;){for(var y=p.elt,w=1E100,A=0,v=a.polygon.gverts.next;null!=v;){var E=v,B=y.gnormx*E.x+y.gnormy*E.y;B<w&&(w=B);B>=y.gprojection+u.epsilon&&(d[A]=!0,f=!1);A++;v=v.next}w-=y.gprojection;if(0<w){h=!1;break}p=p.next}if(f)return a.polygon.validate_worldCOM(),c.overlap=a.polygon.area,c.centroidx=a.polygon.worldCOMx,c.centroidy=a.polygon.worldCOMy,null,!0;if(h){for(;null!=C.flowpoly.head;){var m=C.flowpoly.pop_unsafe();if(!m._inuse){var N=m;null!=N.outer&&(N.outer.zpp_inner=null,N.outer=null);N._isimmutable=
null;N._validate=null;N._invalidate=null;N.next=P.zpp_pool;P.zpp_pool=N}}for(var F=null,M=!1,G=a.polygon.gverts.next,I=0,gb=b.polygon.gverts.next,Q=0,W=0,ea=b.polygon.edgeCnt;W<ea;){var V=W++;if(e[V])gb=gb.next;else{Q=V;break}}if(null==gb){for(var gb=b.polygon.gverts.next,M=!0,Z=0,fa=a.polygon.edgeCnt;Z<fa;){var S=Z++;if(d[S])G=G.next;else{I=S;break}}null==G?G=a.polygon.gverts.next:(C.flowpoly.add(G),F=C.flowpoly.head.elt)}else C.flowpoly.add(gb),F=C.flowpoly.head.elt;var T=1;if(null==C.flowpoly.head){for(var X=
!0,ca=a.polygon.gverts.next,H=ca,R=ca.next;null!=R;){for(var Y=R,we=2,ba=b.polygon.gverts.next,aa=ba,ha=ba.next;null!=ha;){var ia=ha,U=0;(function(a){var b=a=0;a=H.x-aa.x;var b=H.y-aa.y,c=0,d=0,c=Y.x-H.x,d=Y.y-H.y,e=0,h=0,e=ia.x-aa.x,h=ia.y-aa.y,f=d*e-c*h;f*f>u.epsilon*u.epsilon?(f=1/f,e=(h*a-e*b)*f,e>u.epsilon&&e<1-u.epsilon?(a=(d*a-c*b)*f,a>u.epsilon&&a<1-u.epsilon?(U=e,a=!0):a=!1):a=!1):a=!1;return a})(this)&&U<we&&(we=U,gb=ba);ba=ha;aa=ia;ha=ha.next}var qa=ha=b.polygon.gverts.next,da=0;(function(a){var b=
a=0;a=H.x-aa.x;var b=H.y-aa.y,c=0,d=0,c=Y.x-H.x,d=Y.y-H.y,e=0,h=0,e=qa.x-aa.x,h=qa.y-aa.y,f=d*e-c*h;f*f>u.epsilon*u.epsilon?(f=1/f,e=(h*a-e*b)*f,e>u.epsilon&&e<1-u.epsilon?(a=(d*a-c*b)*f,a>u.epsilon&&a<1-u.epsilon?(da=e,a=!0):a=!1):a=!1):a=!1;return a})(this)&&da<we&&(we=da,gb=ba);if(2!=we){var D=0,pa=0,ta=we,D=H.x+(Y.x-H.x)*ta,pa=H.y+(Y.y-H.y)*ta,F=P.get(D,pa,null);C.flowpoly.add(F);M=!0;G=ca;X=!1;break}ca=R;H=Y;R=R.next}if(X){for(var na=R=a.polygon.gverts.next,va=2,la=b.polygon.gverts.next,oa=la,
wa=la.next;null!=wa;){var Na=wa,sa=0;(function(a){var b=a=0;a=H.x-oa.x;var b=H.y-oa.y,c=0,d=0,c=na.x-H.x,d=na.y-H.y,e=0,h=0,e=Na.x-oa.x,h=Na.y-oa.y,f=d*e-c*h;f*f>u.epsilon*u.epsilon?(f=1/f,e=(h*a-e*b)*f,e>u.epsilon&&e<1-u.epsilon?(a=(d*a-c*b)*f,a>u.epsilon&&a<1-u.epsilon?(sa=e,a=!0):a=!1):a=!1):a=!1;return a})(this)&&sa<va&&(va=sa,gb=la);la=wa;oa=Na;wa=wa.next}var ja=wa=b.polygon.gverts.next,J=0;(function(a){var b=a=0;a=H.x-oa.x;var b=H.y-oa.y,c=0,d=0,c=na.x-H.x,d=na.y-H.y,e=0,h=0,e=ja.x-oa.x,h=ja.y-
oa.y,f=d*e-c*h;f*f>u.epsilon*u.epsilon?(f=1/f,e=(h*a-e*b)*f,e>u.epsilon&&e<1-u.epsilon?(a=(d*a-c*b)*f,a>u.epsilon&&a<1-u.epsilon?(J=e,a=!0):a=!1):a=!1):a=!1;return a})(this)&&J<va&&(va=J,gb=la);if(2!=va){var ab=0,Ba=0,ga=va,ab=H.x+(na.x-H.x)*ga,Ba=H.y+(na.y-H.y)*ga,F=P.get(ab,Ba,null);C.flowpoly.add(F);M=!0;G=ca}}T=2}for(;;)if(M)if(G=G.next,I++,null==G&&(G=a.polygon.gverts.next,I=0),d[I]){var re=C.flowpoly.head.elt,uf=G,ya=gb,wd=gb.next;null==wd&&(wd=b.polygon.gverts.next);var ra=-1,Aa=null,Ca=0,
xa=0,Qa=wd,tc=wd;do{var Ad=tc,Ka=0;if(function(a){var b=a=0;a=ya.x-re.x;var b=ya.y-re.y,c=0,d=0,c=Ad.x-ya.x,d=Ad.y-ya.y,e=0,h=0,e=uf.x-re.x,h=uf.y-re.y,f=d*e-c*h;f*f>u.epsilon*u.epsilon?(f=1/f,e=(h*a-e*b)*f,e>u.epsilon&&e<1-u.epsilon?(a=(d*a-c*b)*f,a>u.epsilon&&a<1-u.epsilon?(Ka=e,a=!0):a=!1):a=!1):a=!1;return a}(this)&&Ka>=ra)if(Aa=gb,Ca=Q,++xa==T){ra=Ka;tc=Qa;break}else ra=Ka;ya=Ad;gb=tc;Q++;Q>=b.polygon.edgeCnt&&(Q=0);tc=tc.next;null==tc&&(tc=b.polygon.gverts.next)}while(0);for(;tc!=Qa;){var ka=
tc,Ga=0;if(function(a){var b=a=0;a=ya.x-re.x;var b=ya.y-re.y,c=0,d=0,c=ka.x-ya.x,d=ka.y-ya.y,e=0,h=0,e=uf.x-re.x,h=uf.y-re.y,f=d*e-c*h;f*f>u.epsilon*u.epsilon?(f=1/f,e=(h*a-e*b)*f,e>u.epsilon&&e<1-u.epsilon?(a=(d*a-c*b)*f,a>u.epsilon&&a<1-u.epsilon?(Ga=e,a=!0):a=!1):a=!1):a=!1;return a}(this)&&Ga>=ra)if(Aa=gb,Ca=Q,++xa==T){ra=Ga;tc=Qa;break}else ra=Ga;ya=ka;gb=tc;Q++;Q>=b.polygon.edgeCnt&&(Q=0);tc=tc.next;null==tc&&(tc=b.polygon.gverts.next)}if(null==Aa)break;var Ha=Aa,L=Aa.next;null==L&&(L=b.polygon.gverts.next);
var za=L,xb=0,Tb=0,Nb=ra,xb=Ha.x+(za.x-Ha.x)*Nb,Tb=Ha.y+(za.y-Ha.y)*Nb;if(null!=F&&eb.vec_dsq(xb,Tb,F.x,F.y)<u.epsilon)break;C.flowpoly.add(P.get(xb,Tb,null));null==F&&(F=C.flowpoly.head.elt);gb=Aa;Q=Ca;M=!M;T=2}else{var Ra=G;if(null!=F&&eb.vec_dsq(Ra.x,Ra.y,F.x,F.y)<u.epsilon)break;C.flowpoly.add(Ra);null==F&&(F=C.flowpoly.head.elt);T=1}else if(gb=gb.next,Q++,null==gb&&(gb=b.polygon.gverts.next,Q=0),e[Q]){var se=C.flowpoly.head.elt,qb=gb,Zd=G,xe=G.next;null==xe&&(xe=a.polygon.gverts.next);var ue=
-1,ye=null,Ia=0,Ea=0,cb=xe,Eb=xe;do{var Za=Eb,Ja=0;if(function(a){var b=a=0;a=Zd.x-se.x;var b=Zd.y-se.y,c=0,d=0,c=Za.x-Zd.x,d=Za.y-Zd.y,e=0,h=0,e=qb.x-se.x,h=qb.y-se.y,f=d*e-c*h;f*f>u.epsilon*u.epsilon?(f=1/f,e=(h*a-e*b)*f,e>u.epsilon&&e<1-u.epsilon?(a=(d*a-c*b)*f,a>u.epsilon&&a<1-u.epsilon?(Ja=e,a=!0):a=!1):a=!1):a=!1;return a}(this)&&Ja>=ue)if(ye=G,Ia=I,++Ea==T){ue=Ja;Eb=cb;break}else ue=Ja;Zd=Za;G=Eb;I++;I>=a.polygon.edgeCnt&&(I=0);Eb=Eb.next;null==Eb&&(Eb=a.polygon.gverts.next)}while(0);for(;Eb!=
cb;){var Da=Eb,fb=0;if(function(a){var b=a=0;a=Zd.x-se.x;var b=Zd.y-se.y,c=0,d=0,c=Da.x-Zd.x,d=Da.y-Zd.y,e=0,h=0,e=qb.x-se.x,h=qb.y-se.y,f=d*e-c*h;f*f>u.epsilon*u.epsilon?(f=1/f,e=(h*a-e*b)*f,e>u.epsilon&&e<1-u.epsilon?(a=(d*a-c*b)*f,a>u.epsilon&&a<1-u.epsilon?(fb=e,a=!0):a=!1):a=!1):a=!1;return a}(this)&&fb>=ue)if(ye=G,Ia=I,++Ea==T){ue=fb;Eb=cb;break}else ue=fb;Zd=Da;G=Eb;I++;I>=a.polygon.edgeCnt&&(I=0);Eb=Eb.next;null==Eb&&(Eb=a.polygon.gverts.next)}if(null==ye)break;var vf=ye,Qf=ye.next;null==
Qf&&(Qf=a.polygon.gverts.next);var jb=Qf,Rf=0,Xe=0,ub=ue,Rf=vf.x+(jb.x-vf.x)*ub,Xe=vf.y+(jb.y-vf.y)*ub;if(null!=F&&eb.vec_dsq(Rf,Xe,F.x,F.y)<u.epsilon)break;C.flowpoly.add(P.get(Rf,Xe,null));null==F&&(F=C.flowpoly.head.elt);G=ye;I=Ia;M=!M;T=2}else{var hb=gb;if(null!=F&&eb.vec_dsq(hb.x,hb.y,F.x,F.y)<u.epsilon)break;C.flowpoly.add(hb);null==F&&(F=C.flowpoly.head.elt);T=1}if(null!=C.flowpoly.head&&null!=C.flowpoly.head.next&&null!=C.flowpoly.head.next.next){for(var Nd=0,uc=0,Zb=0,Nd=Zb=uc=0,jc=C.flowpoly.head,
pb=jc.elt,jc=jc.next,kc=jc.elt,jc=jc.next;null!=jc;)var zb=jc.elt,Nd=Nd+kc.x*(zb.y-pb.y),dc=zb.y*kc.x-zb.x*kc.y,uc=uc+(kc.x+zb.x)*dc,Zb=Zb+(kc.y+zb.y)*dc,pb=kc,kc=zb,jc=jc.next;var jc=C.flowpoly.head,K=jc.elt,Nd=Nd+kc.x*(K.y-pb.y),O=K.y*kc.x-K.x*kc.y,uc=uc+(kc.x+K.x)*O,Zb=Zb+(kc.y+K.y)*O,pb=kc,kc=K,jc=jc.next,Oa=jc.elt,Nd=Nd+kc.x*(Oa.y-pb.y),ec=Oa.y*kc.x-Oa.x*kc.y,uc=uc+(kc.x+Oa.x)*ec,Zb=Zb+(kc.y+Oa.y)*ec,Nd=.5*Nd,db=1/(6*Nd),uc=uc*db,Zb=Zb*db;c.overlap=-Nd;c.centroidx=uc;c.centroidy=Zb;null;return!0}}}return!1}for(var Lb=
[],gc=!0,Pa=null,Sa=null,$a=-1E100,Mb=!0,fc=b.polygon.gverts.next,Ic=0,wb=b.polygon.edges.head;null!=wb;){var Rb=wb.elt,Sb=Rb.gnormx*a.circle.worldCOMx+Rb.gnormy*a.circle.worldCOMy;if(Sb>Rb.gprojection+a.circle.radius){Mb=!1;break}else Sb+a.circle.radius>Rb.gprojection+u.epsilon&&(gc=!1,Lb[Ic]=!0);Sb-=Rb.gprojection+a.circle.radius;Sb>$a&&($a=Sb,Pa=Rb,Sa=fc);fc=fc.next;Ic++;wb=wb.next}if(Mb){if(gc)return c.overlap=a.circle.area,c.centroidx=a.circle.worldCOMx,c.centroidy=a.circle.worldCOMy,null,!0;
var Ta=Sa,Wb;Wb=null==Sa.next?b.polygon.gverts.next:Sa.next;var qc=a.circle.worldCOMy*Pa.gnormx-a.circle.worldCOMx*Pa.gnormy;if(qc<=Ta.y*Pa.gnormx-Ta.x*Pa.gnormy?function(b){b=a.circle.radius;var c=0,d=0,c=Ta.x-a.circle.worldCOMx,d=Ta.y-a.circle.worldCOMy;return c*c+d*d<=b*b}(this):qc>=Wb.y*Pa.gnormx-Wb.x*Pa.gnormy?function(b){b=a.circle.radius;var c=0,d=0,c=Wb.x-a.circle.worldCOMx,d=Wb.y-a.circle.worldCOMy;return c*c+d*d<=b*b}(this):1){for(var sb=[],Wa=0,Ac=!0,$b=null,bb=0,Ua=b.polygon.gverts.next;null!=
Ua;){var Ab=Ua,Yb=eb.vec_dsq(Ab.x,Ab.y,a.circle.worldCOMx,a.circle.worldCOMy);(sb[Wa]=Yb<=a.circle.radius*a.circle.radius)?(bb=Wa,$b=Ua):Ac=!1;Wa++;Ua=Ua.next}if(Ac)return b.polygon.validate_worldCOM(),c.overlap=b.polygon.area,c.centroidx=b.polygon.worldCOMx,c.centroidy=b.polygon.worldCOMy,null,!0;for(;null!=C.flowpoly.head;){var Db=C.flowpoly.pop_unsafe();if(!Db._inuse){var ac=Db;null!=ac.outer&&(ac.outer.zpp_inner=null,ac.outer=null);ac._isimmutable=null;ac._validate=null;ac._invalidate=null;ac.next=
P.zpp_pool;P.zpp_pool=ac}}C.flowsegs.clear();var Fb=null,Dc=1;null==$b?($b=b.polygon.gverts.next,Dc=2):C.flowpoly.add(Fb=$b);for(;0!=Dc;)if(1==Dc)if($b=$b.next,null==$b&&($b=b.polygon.gverts.next),bb++,bb>=b.polygon.edgeCnt&&(bb=0),sb[bb]){if(eb.vec_dsq(Fb.x,Fb.y,$b.x,$b.y)<u.epsilon)break;C.flowpoly.add($b)}else{var te=C.flowpoly.head.elt,nb=$b,Ec=0,mc=0,Ec=nb.x-te.x,mc=nb.y-te.y,nc=0,mb=0,nc=te.x-a.circle.worldCOMx,mb=te.y-a.circle.worldCOMy,rb=Ec*Ec+mc*mc,rc=2*(nc*Ec+mb*mc),cc=Math.sqrt(rc*rc-
4*rb*(nc*nc+mb*mb-a.circle.radius*a.circle.radius)),rb=1/(2*rb),hc=(-rc-cc)*rb,Bb=0,Cb=0,ic=hc<u.epsilon?(-rc+cc)*rb:hc,Bb=te.x+(nb.x-te.x)*ic,Cb=te.y+(nb.y-te.y)*ic;if(eb.vec_dsq(Fb.x,Fb.y,Bb,Cb)<u.epsilon)break;C.flowpoly.add(P.get(Bb,Cb,null));Dc=2}else if(2==Dc){var sc=$b.next;null==sc&&(sc=b.polygon.gverts.next);var La=$b,Dc=0,ve=sc,ib=sc;do{var Kc=ib,Fa=bb+1;Fa==b.polygon.edgeCnt&&(Fa=0);if(Lb[bb])if(sb[Fa]){var Va=0,vc=0,Va=Kc.x-La.x,vc=Kc.y-La.y,Ma=0,ma=0,Ma=La.x-a.circle.worldCOMx,ma=La.y-
a.circle.worldCOMy,Hb=Va*Va+vc*vc,Xa=2*(Ma*Va+ma*vc),kb=Math.sqrt(Xa*Xa-4*Hb*(Ma*Ma+ma*ma-a.circle.radius*a.circle.radius)),Hb=1/(2*Hb),Ob=(-Xa-kb)*Hb,Ub=0,Fc=0,bc=Ob<u.epsilon?(-Xa+kb)*Hb:Ob,Ub=La.x+(Kc.x-La.x)*bc,Fc=La.y+(Kc.y-La.y)*bc;if(eb.vec_dsq(Fb.x,Fb.y,Ub,Fc)<u.epsilon){Dc=0;ib=ve;break}var Lc=P.get(Ub,Fc,null);C.flowsegs.add(C.flowpoly.head.elt);C.flowsegs.add(Lc);C.flowpoly.add(Lc);Dc=1;ib=ve;break}else{var Pb=0,wc=0,Gc,wf=0,xc=0,wf=Kc.x-La.x,xc=Kc.y-La.y,lb=0,tb=0,lb=La.x-a.circle.worldCOMx,
tb=La.y-a.circle.worldCOMy,Ya=wf*wf+xc*xc,ob=2*(lb*wf+tb*xc),Ib=ob*ob-4*Ya*(lb*lb+tb*tb-a.circle.radius*a.circle.radius);Ib*Ib<u.epsilon?(Pb=0>Ib?10:wc=-ob/(2*Ya),Gc=!1):(Ib=Math.sqrt(Ib),Ya=1/(2*Ya),Pb=(-ob-Ib)*Ya,wc=(-ob+Ib)*Ya,Gc=!0);if(Pb<1-u.epsilon&&wc>u.epsilon){var Jb=0,Kb=0,Mc=Pb,Jb=La.x+(Kc.x-La.x)*Mc,Kb=La.y+(Kc.y-La.y)*Mc;if(null!=Fb&&eb.vec_dsq(Fb.x,Fb.y,Jb,Kb)<u.epsilon){Dc=0;ib=ve;break}var yc=P.get(Jb,Kb,null);null!=C.flowpoly.head&&(C.flowsegs.add(C.flowpoly.head.elt),C.flowsegs.add(yc));
C.flowpoly.add(yc);null==Fb&&(Fb=C.flowpoly.head.elt);if(Gc){var Nc=0,zc=0,lc=wc,Nc=La.x+(Kc.x-La.x)*lc,zc=La.y+(Kc.y-La.y)*lc;C.flowpoly.add(P.get(Nc,zc,null))}}}La=Kc;$b=ib;bb=Fa;ib=ib.next;null==ib&&(ib=b.polygon.gverts.next)}while(0);for(;ib!=ve;){var vb=ib,Bc=bb+1;Bc==b.polygon.edgeCnt&&(Bc=0);if(Lb[bb])if(sb[Bc]){var yb=0,Cc=0,yb=vb.x-La.x,Cc=vb.y-La.y,Gb=0,Vb=0,Gb=La.x-a.circle.worldCOMx,Vb=La.y-a.circle.worldCOMy,Qb=yb*yb+Cc*Cc,Hc=2*(Gb*yb+Vb*Cc),Zc=Math.sqrt(Hc*Hc-4*Qb*(Gb*Gb+Vb*Vb-a.circle.radius*
a.circle.radius)),Qb=1/(2*Qb),ad=(-Hc-Zc)*Qb,Oc=0,Sc=0,dd=ad<u.epsilon?(-Hc+Zc)*Qb:ad,Oc=La.x+(vb.x-La.x)*dd,Sc=La.y+(vb.y-La.y)*dd;if(eb.vec_dsq(Fb.x,Fb.y,Oc,Sc)<u.epsilon){Dc=0;ib=ve;break}var fd=P.get(Oc,Sc,null);C.flowsegs.add(C.flowpoly.head.elt);C.flowsegs.add(fd);C.flowpoly.add(fd);Dc=1;ib=ve;break}else{var Rc=0,pc=0,cd,Uc=0,Wc=0,Uc=vb.x-La.x,Wc=vb.y-La.y,Xc=0,Yc=0,Xc=La.x-a.circle.worldCOMx,Yc=La.y-a.circle.worldCOMy,Jc=Uc*Uc+Wc*Wc,Tc=2*(Xc*Uc+Yc*Wc),ua=Tc*Tc-4*Jc*(Xc*Xc+Yc*Yc-a.circle.radius*
a.circle.radius);ua*ua<u.epsilon?(Rc=0>ua?10:pc=-Tc/(2*Jc),cd=!1):(ua=Math.sqrt(ua),Jc=1/(2*Jc),Rc=(-Tc-ua)*Jc,pc=(-Tc+ua)*Jc,cd=!0);if(Rc<1-u.epsilon&&pc>u.epsilon){var jd=0,ld=0,od=Rc,jd=La.x+(vb.x-La.x)*od,ld=La.y+(vb.y-La.y)*od;if(null!=Fb&&eb.vec_dsq(Fb.x,Fb.y,jd,ld)<u.epsilon){Dc=0;ib=ve;break}var qd=P.get(jd,ld,null);null!=C.flowpoly.head&&(C.flowsegs.add(C.flowpoly.head.elt),C.flowsegs.add(qd));C.flowpoly.add(qd);null==Fb&&(Fb=C.flowpoly.head.elt);if(cd){var rd=0,sd=0,td=pc,rd=La.x+(vb.x-
La.x)*td,sd=La.y+(vb.y-La.y)*td;C.flowpoly.add(P.get(rd,sd,null))}}}La=vb;$b=ib;bb=Bc;ib=ib.next;null==ib&&(ib=b.polygon.gverts.next)}}if(null==C.flowpoly.head)return!1;if(null==C.flowpoly.head.next){for(var ud=!0,hd=b.polygon.edges.head;null!=hd;){var md=hd.elt;if(md.gnormx*a.circle.worldCOMx+md.gnormy*a.circle.worldCOMy>md.gprojection){ud=!1;break}hd=hd.next}return ud?(c.overlap=a.circle.area,c.centroidx=a.circle.worldCOMx,c.centroidy=a.circle.worldCOMy,null,!0):!1}var Xb=0,oc=0,$c=0;if(null!=C.flowpoly.head.next.next){for(var Bd=
0,$d=0,ae=0,Bd=ae=$d=0,id=C.flowpoly.head,gd=id.elt,id=id.next,Pc=id.elt,id=id.next;null!=id;)var bd=id.elt,Bd=Bd+Pc.x*(bd.y-gd.y),yd=bd.y*Pc.x-bd.x*Pc.y,$d=$d+(Pc.x+bd.x)*yd,ae=ae+(Pc.y+bd.y)*yd,gd=Pc,Pc=bd,id=id.next;var id=C.flowpoly.head,ed=id.elt,Bd=Bd+Pc.x*(ed.y-gd.y),Dd=ed.y*Pc.x-ed.x*Pc.y,$d=$d+(Pc.x+ed.x)*Dd,ae=ae+(Pc.y+ed.y)*Dd,gd=Pc,Pc=ed,id=id.next,kd=id.elt,Bd=Bd+Pc.x*(kd.y-gd.y),Ed=kd.y*Pc.x-kd.x*Pc.y,$d=$d+(Pc.x+kd.x)*Ed,ae=ae+(Pc.y+kd.y)*Ed,Bd=.5*Bd,Fd=1/(6*Bd),$d=$d*Fd,ae=ae*Fd,Hd=
-Bd,Xb=Xb+$d*Hd,oc=oc+ae*Hd,$c=$c-Bd}else C.flowsegs.add(C.flowpoly.head.elt),C.flowsegs.add(C.flowpoly.head.next.elt);for(;null!=C.flowsegs.head;)var nd=C.flowsegs.pop_unsafe(),pd=C.flowsegs.pop_unsafe(),Kd=0,Md=0,Kd=pd.x-nd.x,Md=pd.y-nd.y,je=0,ke=0,je=Kd,ke=Md,Pd=1/Math.sqrt(je*je+ke*ke),je=je*Pd,ke=ke*Pd,de=je,je=-ke,ke=de,be=0,ce=0,be=nd.x+pd.x,ce=nd.y+pd.y,be=.5*be,ce=.5*ce,be=be-1*a.circle.worldCOMx,ce=ce-1*a.circle.worldCOMy,Gd=0,Sd=0,Td=je*be+ke*ce,xd=Td/a.circle.radius,vd=Math.sqrt(1-xd*
xd),Vd=Math.acos(xd),Gd=a.circle.radius*(a.circle.radius*Vd-Td*vd),Sd=.6666666666666666*a.circle.radius*vd*vd*vd/(Vd-xd*vd),be=a.circle.worldCOMx,ce=a.circle.worldCOMy,Wd=Sd,be=be+je*Wd,ce=ce+ke*Wd,Xd=Gd,Xb=Xb+be*Xd,oc=oc+ce*Xd,$c=$c+Gd;var Yd=1/$c,Xb=Xb*Yd,oc=oc*Yd;c.overlap=$c;c.centroidx=Xb;c.centroidy=oc;null;return!0}}return!1}var Qc=a.circle,Vc=b.circle,zd=0,Cd=0,zd=Vc.worldCOMx-Qc.worldCOMx,Cd=Vc.worldCOMy-Qc.worldCOMy,ee=Qc.radius+Vc.radius,Ud=zd*zd+Cd*Cd;if(Ud>ee*ee)return!1;if(Ud<u.epsilon*
u.epsilon)Qc.radius<Vc.radius?(c.overlap=Qc.area,c.centroidx=Qc.worldCOMx,c.centroidy=Qc.worldCOMy):(c.overlap=Vc.area,c.centroidx=Vc.worldCOMx,c.centroidy=Vc.worldCOMy);else{var Ld=Math.sqrt(Ud),ie=1/Ld,Od=.5*(Ld-(Vc.radius*Vc.radius-Qc.radius*Qc.radius)*ie);if(Od<=-Qc.radius)c.overlap=Qc.area,c.centroidx=Qc.worldCOMx,c.centroidy=Qc.worldCOMy;else{var fe=Ld-Od;if(fe<=-Vc.radius)c.overlap=Vc.area,c.centroidx=Vc.worldCOMx,c.centroidy=Vc.worldCOMy;else{var ge=0,le=0,he=0,me=0,Qd=Od/Qc.radius,Id=Math.sqrt(1-
Qd*Qd),ne=Math.acos(Qd),ge=Qc.radius*(Qc.radius*ne-Od*Id),le=.6666666666666666*Qc.radius*Id*Id*Id/(ne-Qd*Id),Rd=fe/Vc.radius,Jd=Math.sqrt(1-Rd*Rd),oe=Math.acos(Rd),he=Vc.radius*(Vc.radius*oe-fe*Jd),me=.6666666666666666*Vc.radius*Jd*Jd*Jd/(oe-Rd*Jd),pe=ge+he,qe=(le*ge+(Ld-me)*he)/pe*ie;c.overlap=pe;c.centroidx=Qc.worldCOMx+zd*qe;c.centroidy=Qc.worldCOMy+Cd*qe}}}null;return!0};var Ld=function(){};Ld.__name__=!0;Ld.isinner=function(a,b,c){var d=0,e=0,d=a.x-b.x,e=a.y-b.y,h=a=0;a=c.x-b.x;h=c.y-b.y;return 0<=
h*d-a*e};Ld.optimise=function(a){var b=a.vertices,c=a.vertices;if(null!=b){do b.sort(),b=b.next;while(b!=c)}a=c=a.vertices;if(null!=c){do{for(var b=c,d=b.prev,e=null,h=b.diagonals.head;null!=h;){var f=h.elt;if(Ld.isinner(null==h.next?b.next:h.next.elt,b,d)){for(var g=!0,k=f,l=k.prev,n=null,r=k.diagonals.head;null!=r;){var z=r.elt;if(z==b){g=Ld.isinner(null==r.next?k.next:r.next.elt,k,l);break}l=z;n=r;r=r.next}g?(h=b.diagonals.erase(e),k.diagonals.erase(n)):(d=f,e=h,h=h.next)}else e=h,d=f,h=h.next}c=
c.next}while(c!=a)}};var Ba=function(){this.toiDistance=0;this.next=null;this.inner=!1;this.normal=this.shape=this.convex=this.position=this.ray=null};Ba.__name__=!0;Ba.getRay=function(a,b,c,d){var e;null==Ba.rayPool?(Ba.internal=!0,e=new nf,e.zpp_inner=new Ba,e.zpp_inner.ray=e,Ba.internal=!1):(e=Ba.rayPool.ray,Ba.rayPool=Ba.rayPool.next,e.zpp_inner.next=null);var h=e.zpp_inner;h.normal=a;a.zpp_inner._immutable=!0;h.toiDistance=b;h.inner=c;h.shape=d;return e};Ba.getConvex=function(a,b,c,d){var e;
null==Ba.convexPool?(Ba.internal=!0,e=new jf,e.zpp_inner=new Ba,e.zpp_inner.convex=e,Ba.internal=!1):(e=Ba.convexPool.convex,Ba.convexPool=Ba.convexPool.next,e.zpp_inner.next=null);var h=e.zpp_inner;h.normal=a;h.position=b;a.zpp_inner._immutable=!0;b.zpp_inner._immutable=!0;h.toiDistance=c;h.shape=d;return e};Ba.prototype={disposed:function(){if(null!=this.next)throw new f("Error: This object has been disposed of and cannot be used");},free:function(){this.normal.zpp_inner._immutable=!1;this.normal.dispose();
null!=this.position&&(this.position.zpp_inner._immutable=!1,this.position.dispose());this.shape=null;this.toiDistance=0;null!=this.convex?(this.next=Ba.convexPool,Ba.convexPool=this):(this.next=Ba.rayPool,Ba.rayPool=this)},__class__:Ba};var Tb=function(){this.used=!1;this.rank=0;this.parent=null;this.positive=!1;this.value=0;this.vert=null;this.posx=this.posy=0;this.prev=this.next=null};Tb.__name__=!0;Tb.path=function(a){var b;null==Tb.zpp_pool?b=new Tb:(b=Tb.zpp_pool,Tb.zpp_pool=b.next,b.next=null);
null;b.vert=a;b.parent=b;b.rank=0;b.used=!1;return b};Tb.prototype={alloc:function(){},free:function(){this.parent=this.vert=null},__class__:Tb};var Ec=function(){this.path0=this.end=this.start=this.path1=null;this.virtualint=this.vertex=!1;this.time=0;this.next=null};Ec.__name__=!0;Ec.get=function(a,b,c,d,e,h,f){null==f&&(f=!1);null==h&&(h=!1);var g;null==Ec.zpp_pool?g=new Ec:(g=Ec.zpp_pool,Ec.zpp_pool=g.next,g.next=null);null;g.virtualint=h;g.end=b;g.start=c;g.path0=d;g.path1=e;g.time=a;g.vertex=
f;return g};Ec.prototype={alloc:function(){},free:function(){this.path0=this.path1=this.end=this.start=null},__class__:Ec};var ab=function(){};ab.__name__=!0;ab.run=function(a,b,c,d,e,h){var g=0,q=0;if(null!=b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");b.zpp_inner.validate();g=b.zpp_inner.x;if(null!=b&&b.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");b.zpp_inner.validate();var q=b.zpp_inner.y,k=0,l=0;if(null!=c&&c.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
c.zpp_inner.validate();k=c.zpp_inner.x-g;if(null!=c&&c.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");c.zpp_inner.validate();var l=c.zpp_inner.y-q,n;n=d?0:-Infinity;var r;r=e?1:Infinity;var z=-(q*k-g*l),x=null,p=!1,u=a;do{var w;null==Tb.zpp_pool?w=new Tb:(w=Tb.zpp_pool,Tb.zpp_pool=w.next,w.next=null);null;w.vert=u;w.posx=w.vert.x;w.posy=w.vert.y;w.value=w.posy*k-w.posx*l+z;w.positive=0<w.value;0==w.value&&(p=!0);var A=w;null==x?x=A.prev=A.next=A:(A.prev=x,A.next=x.next,
x.next.prev=A,x.next=A);x=A;u=u.next}while(u!=a);if(p){var v=null,C=x,B=x;if(null!=C){var m=C;do{var E=m;if(0!=E.value){v=E;break}m=m.next}while(m!=B)}var F=0,G=0,F=k,G=l,P=1/Math.sqrt(F*F+G*G),F=F*P,G=G*P,N=F,F=-G,G=N,gb=null,H=v;do{if(0==H.value||null!=gb&&H!=gb.next){var I=gb.value*H.value;if(0!=I){var M=gb.next,Q;if(0<I)Q=gb.positive;else{var T=M.next,W=0,V=0,W=M.posx+T.posx,V=M.posy+T.posy,W=.5*W,V=.5*V,ea=W+1E-8*F,ca=V+1E-8*G,Y=!1,Z=a,R=a;if(null!=Z){var aa=Z;do{var S=aa,X=S.prev;(S.y<ca&&X.y>=
ca||X.y<ca&&S.y>=ca)&&(S.x<=ea||X.x<=ea)&&S.x+(ca-S.y)/(X.y-S.y)*(X.x-S.x)<ea&&(Y=!Y);aa=aa.next}while(aa!=R)}Q=Y}var fa=M,ba=H;if(null!=fa){var ha=fa;do ha.positive=Q,ha=ha.next;while(ha!=ba)}gb=H}}else gb=H;H=H.next}while(H!=v);if(0==H.value||null!=gb&&H!=gb.next){var ia=gb.value*H.value;if(0!=ia){var U=gb.next,na;if(0<ia)na=gb.positive;else{var D=U.next,da=0,qa=0,da=U.posx+D.posx,qa=U.posy+D.posy,da=.5*da,qa=.5*qa,oa=da+1E-8*F,pa=qa+1E-8*G,va=!1;if(null!=a){var ya=a;do{var la=ya,ta=la.prev;(la.y<
pa&&ta.y>=pa||ta.y<pa&&la.y>=pa)&&(la.x<=oa||ta.x<=oa)&&la.x+(pa-la.y)/(ta.y-la.y)*(ta.x-la.x)<oa&&(va=!va);ya=ya.next}while(ya!=a)}na=va}var sa=H;if(null!=U){var wa=U;do wa.positive=na,wa=wa.next;while(wa!=sa)}gb=H}}else gb=H;H=H.next}null==ab.ints&&(ab.ints=new xf);null==ab.paths&&(ab.paths=new yf);var J=null,ra=y.get(x.posx,x.posy);null==J?J=ra.prev=ra.next=ra:(ra.next=J,ra.prev=J.prev,J.prev.next=ra,J.prev=ra);ra;var Na=J,Aa=Tb.path(J);ab.paths.add(Aa);var ja=x;do{var Ba=ja.next,ga=y.get(Ba.posx,
Ba.posy);if(ja.positive==Ba.positive){var wd=ga;null==J?J=wd.prev=wd.next=wd:(wd.next=J,wd.prev=J.prev,J.prev.next=wd,J.prev=wd);wd}else{var Ka=0,Ca=0,Ka=Ba.posx-ja.posx,Ca=Ba.posy-ja.posy,Qa=l*Ka-k*Ca,Qa=1/Qa,Ga=0,Ha=0,Ga=g-ja.posx,Ha=q-ja.posy,tc=(Ca*Ga-Ka*Ha)*Qa;if(tc<n||tc>r){ab.ints.add(Ec.get(tc,null,null,null,null,!0,null));var Ad=ga;null==J?J=Ad.prev=Ad.next=Ad:(Ad.next=J,Ad.prev=J.prev,J.prev.next=Ad,J.prev=Ad);Ad}else if(0==ja.value){var bb=J.prev,J=null,xa=y.get(bb.x,bb.y);null==J?J=xa.prev=
xa.next=xa:(xa.next=J,xa.prev=J.prev,J.prev.next=xa,J.prev=xa);xa;var ka=ga;null==J?J=ka.prev=ka.next=ka:(ka.next=J,ka.prev=J.prev,J.prev.next=ka,J.prev=ka);ka;var vb=ab.paths.head.elt;ab.paths.add(Tb.path(J));ab.ints.add(Ec.get(tc,bb,J,vb,ab.paths.head.elt,!0,null))}else if(0==Ba.value){var L=ga;null==J?J=L.prev=L.next=L:(L.next=J,L.prev=J.prev,J.prev.next=L,J.prev=L);L;var qb=J.prev,J=null,za=y.get(Ba.posx,Ba.posy);null==J?J=za.prev=za.next=za:(za.next=J,za.prev=J.prev,J.prev.next=za,J.prev=za);
za;var xb=ab.paths.head.elt;ab.paths.add(Tb.path(J));ab.ints.add(Ec.get(tc,qb,J,xb,ab.paths.head.elt,!0,null))}else{var zb=(l*Ga-k*Ha)*Qa,Pa=0,Ra=0,Pa=ja.posx,Ra=ja.posy,pb=zb,Pa=Pa+Ka*pb,Ra=Ra+Ca*pb,Ia=y.get(Pa,Ra);null==J?J=Ia.prev=Ia.next=Ia:(Ia.next=J,Ia.prev=J.prev,J.prev.next=Ia,J.prev=Ia);Ia;var xe=J.prev,J=null,eb=y.get(Pa,Ra);null==J?J=eb.prev=eb.next=eb:(eb.next=J,eb.prev=J.prev,J.prev.next=eb,J.prev=eb);eb;var Ja=ga;null==J?J=Ja.prev=Ja.next=Ja:(Ja.next=J,Ja.prev=J.prev,J.prev.next=Ja,
J.prev=Ja);Ja;var Nb=ab.paths.head.elt;ab.paths.add(Tb.path(J));ab.ints.add(Ec.get(tc,xe,J,Nb,ab.paths.head.elt,!1,null))}}ja=ja.next}while(ja!=x);var fb=J.prev;fb.next.prev=Na.prev;Na.prev.next=fb.next;fb.next=Na;Na.prev=fb;var cb=ab.paths.head.elt,Eb;if(Aa==Aa.parent)Eb=Aa;else{for(var Oa=Aa,Za=null;Oa!=Oa.parent;){var Rb=Oa.parent;Oa.parent=Za;Za=Oa;Oa=Rb}for(;null!=Za;){var Sb=Za.parent;Za.parent=Oa;Za=Sb}Eb=Oa}var Da;if(cb==cb.parent)Da=cb;else{for(var Ea=cb,hb=null;Ea!=Ea.parent;){var Wb=Ea.parent;
Ea.parent=hb;hb=Ea;Ea=Wb}for(;null!=hb;){var Xe=hb.parent;hb.parent=Ea;hb=Xe}Da=Ea}Eb!=Da&&(Eb.rank<Da.rank?Eb.parent=Da:Eb.rank>Da.rank?Da.parent=Eb:(Da.parent=Eb,Eb.rank++));var jb=ab.ints;if(null!=jb.head&&null!=jb.head.next){var Ib=jb.head,ub=null,uc=null,Zb=null,jc=null,Lb=1,kc,Sa,wb;do{kc=0;uc=Ib;for(ub=Ib=null;null!=uc;){kc++;Zb=uc;Sa=0;for(wb=Lb;null!=Zb&&Sa<Lb;)Sa++,Zb=Zb.next;for(;0<Sa||0<wb&&null!=Zb;)0==Sa?(jc=Zb,Zb=Zb.next,wb--):0==wb||null==Zb?(jc=uc,uc=uc.next,Sa--):uc.elt.time<Zb.elt.time?
(jc=uc,uc=uc.next,Sa--):(jc=Zb,Zb=Zb.next,wb--),null!=ub?ub.next=jc:Ib=jc,ub=jc;uc=Zb}ub.next=null;Lb<<=1}while(1<kc);jb.head=Ib;jb.modified=!0;jb.pushmod=!0}for(;null!=ab.ints.head;){var K=ab.ints.pop_unsafe(),O=ab.ints.pop_unsafe();if(!K.virtualint&&!O.virtualint){K.end.next.prev=O.start.prev;O.start.prev.next=K.end.next;K.end.next=O.start;O.start.prev=K.end;O.end.next.prev=K.start.prev;K.start.prev.next=O.end.next;O.end.next=K.start;K.start.prev=O.end;var Ta;if(K.path0==K.path0.parent)Ta=K.path0;
else{for(var Ua=K.path0,sb=null;Ua!=Ua.parent;){var dc=Ua.parent;Ua.parent=sb;sb=Ua;Ua=dc}for(;null!=sb;){var ec=sb.parent;sb.parent=Ua;sb=ec}Ta=Ua}var Ya;if(O.path1==O.path1.parent)Ya=O.path1;else{for(var db=O.path1,rb=null;db!=db.parent;){var fc=db.parent;db.parent=rb;rb=db;db=fc}for(;null!=rb;){var gc=rb.parent;rb.parent=db;rb=gc}Ya=db}Ta!=Ya&&(Ta.rank<Ya.rank?Ta.parent=Ya:Ta.rank>Ya.rank?Ya.parent=Ta:(Ya.parent=Ta,Ta.rank++));var nb;if(K.path1==K.path1.parent)nb=K.path1;else{for(var Wa=K.path1,
Hb=null;Wa!=Wa.parent;){var mc=Wa.parent;Wa.parent=Hb;Hb=Wa;Wa=mc}for(;null!=Hb;){var nc=Hb.parent;Hb.parent=Wa;Hb=nc}nb=Wa}var mb;if(O.path0==O.path0.parent)mb=O.path0;else{for(var $a=O.path0,Mb=null;$a!=$a.parent;){var qc=$a.parent;$a.parent=Mb;Mb=$a;$a=qc}for(;null!=Mb;){var rc=Mb.parent;Mb.parent=$a;Mb=rc}mb=$a}nb!=mb&&(nb.rank<mb.rank?nb.parent=mb:nb.rank>mb.rank?mb.parent=nb:(mb.parent=nb,nb.rank++))}else if(K.virtualint&&!O.virtualint){if(null!=O.end&&O.end.prev==O.end){O.end.next=O.end.prev=
null;var $b=O.end;null!=$b.wrap&&($b.wrap.zpp_inner._inuse=!1,$b.wrap.dispose(),$b.wrap=null);$b.prev=$b.next=null;$b.next=y.zpp_pool;y.zpp_pool=$b;O.end=null}else{var sc=O.end.prev;O.end.prev.next=O.end.next;O.end.next.prev=O.end.prev;O.end.next=O.end.prev=null;var Fa=O.end;null!=Fa.wrap&&(Fa.wrap.zpp_inner._inuse=!1,Fa.wrap.dispose(),Fa.wrap=null);Fa.prev=Fa.next=null;Fa.next=y.zpp_pool;y.zpp_pool=Fa;O.end=null;O.end=sc}if(!O.vertex)if(O.end!=O.path0.vert)if(O.start.x=O.end.x,O.start.y=O.end.y,
null!=O.end&&O.end.prev==O.end){O.end.next=O.end.prev=null;var Va=O.end;null!=Va.wrap&&(Va.wrap.zpp_inner._inuse=!1,Va.wrap.dispose(),Va.wrap=null);Va.prev=Va.next=null;Va.next=y.zpp_pool;y.zpp_pool=Va;O.end=null}else{var vc=O.end.prev;O.end.prev.next=O.end.next;O.end.next.prev=O.end.prev;O.end.next=O.end.prev=null;var Ma=O.end;null!=Ma.wrap&&(Ma.wrap.zpp_inner._inuse=!1,Ma.wrap.dispose(),Ma.wrap=null);Ma.prev=Ma.next=null;Ma.next=y.zpp_pool;y.zpp_pool=Ma;O.end=null;O.end=vc}else{var ac=O.start.next;
O.start.x=ac.x;O.start.y=ac.y;if(null!=ac&&ac.prev==ac){ac.next=ac.prev=null;var Fb=ac;null!=Fb.wrap&&(Fb.wrap.zpp_inner._inuse=!1,Fb.wrap.dispose(),Fb.wrap=null);Fb.prev=Fb.next=null;Fb.next=y.zpp_pool;y.zpp_pool=Fb;ac=null}else{ac.prev.next=ac.next;ac.next.prev=ac.prev;ac.next=ac.prev=null;var Dc=ac;null!=Dc.wrap&&(Dc.wrap.zpp_inner._inuse=!1,Dc.wrap.dispose(),Dc.wrap=null);Dc.prev=Dc.next=null;Dc.next=y.zpp_pool;y.zpp_pool=Dc}}O.end.next.prev=O.start.prev;O.start.prev.next=O.end.next;O.end.next=
O.start;O.start.prev=O.end;var ma;if(O.path0==O.path0.parent)ma=O.path0;else{for(var Xa=O.path0,Pb=null;Xa!=Xa.parent;){var wc=Xa.parent;Xa.parent=Pb;Pb=Xa;Xa=wc}for(;null!=Pb;){var xc=Pb.parent;Pb.parent=Xa;Pb=xc}ma=Xa}var lb;if(O.path1==O.path1.parent)lb=O.path1;else{for(var tb=O.path1,Qb=null;tb!=tb.parent;){var Ac=tb.parent;tb.parent=Qb;Qb=tb;tb=Ac}for(;null!=Qb;){var Bc=Qb.parent;Qb.parent=tb;Qb=Bc}lb=tb}ma!=lb&&(ma.rank<lb.rank?ma.parent=lb:ma.rank>lb.rank?lb.parent=ma:(lb.parent=ma,ma.rank++))}else if(O.virtualint&&
!K.virtualint){if(null!=K.end&&K.end.prev==K.end){K.end.next=K.end.prev=null;var yb=K.end;null!=yb.wrap&&(yb.wrap.zpp_inner._inuse=!1,yb.wrap.dispose(),yb.wrap=null);yb.prev=yb.next=null;yb.next=y.zpp_pool;y.zpp_pool=yb;K.end=null}else{var Cc=K.end.prev;K.end.prev.next=K.end.next;K.end.next.prev=K.end.prev;K.end.next=K.end.prev=null;var Ab=K.end;null!=Ab.wrap&&(Ab.wrap.zpp_inner._inuse=!1,Ab.wrap.dispose(),Ab.wrap=null);Ab.prev=Ab.next=null;Ab.next=y.zpp_pool;y.zpp_pool=Ab;K.end=null;K.end=Cc}if(!K.vertex)if(K.end!=
K.path0.vert)if(K.start.x=K.end.x,K.start.y=K.end.y,null!=K.end&&K.end.prev==K.end){K.end.next=K.end.prev=null;var Bb=K.end;null!=Bb.wrap&&(Bb.wrap.zpp_inner._inuse=!1,Bb.wrap.dispose(),Bb.wrap=null);Bb.prev=Bb.next=null;Bb.next=y.zpp_pool;y.zpp_pool=Bb;K.end=null}else{var La=K.end.prev;K.end.prev.next=K.end.next;K.end.next.prev=K.end.prev;K.end.next=K.end.prev=null;var Cb=K.end;null!=Cb.wrap&&(Cb.wrap.zpp_inner._inuse=!1,Cb.wrap.dispose(),Cb.wrap=null);Cb.prev=Cb.next=null;Cb.next=y.zpp_pool;y.zpp_pool=
Cb;K.end=null;K.end=La}else{var ib=K.start.next;K.start.x=ib.x;K.start.y=ib.y;if(null!=ib&&ib.prev==ib){ib.next=ib.prev=null;var Kc=ib;null!=Kc.wrap&&(Kc.wrap.zpp_inner._inuse=!1,Kc.wrap.dispose(),Kc.wrap=null);Kc.prev=Kc.next=null;Kc.next=y.zpp_pool;y.zpp_pool=Kc;ib=null}else{ib.prev.next=ib.next;ib.next.prev=ib.prev;ib.next=ib.prev=null;var Db=ib;null!=Db.wrap&&(Db.wrap.zpp_inner._inuse=!1,Db.wrap.dispose(),Db.wrap=null);Db.prev=Db.next=null;Db.next=y.zpp_pool;y.zpp_pool=Db}}K.end.next.prev=K.start.prev;
K.start.prev.next=K.end.next;K.end.next=K.start;K.start.prev=K.end;var ua;if(K.path0==K.path0.parent)ua=K.path0;else{for(var Gb=K.path0,Ub=null;Gb!=Gb.parent;){var Fc=Gb.parent;Gb.parent=Ub;Ub=Gb;Gb=Fc}for(;null!=Ub;){var Gc=Ub.parent;Ub.parent=Gb;Ub=Gc}ua=Gb}var Jb;if(K.path1==K.path1.parent)Jb=K.path1;else{for(var Kb=K.path1,Vb=null;Kb!=Kb.parent;){var Hc=Kb.parent;Kb.parent=Vb;Vb=Kb;Kb=Hc}for(;null!=Vb;){var Jc=Vb.parent;Vb.parent=Kb;Vb=Jc}Jb=Kb}ua!=Jb&&(ua.rank<Jb.rank?ua.parent=Jb:ua.rank>Jb.rank?
Jb.parent=ua:(Jb.parent=ua,ua.rank++))}var Xb=K;Xb.end=Xb.start=null;Xb.path0=Xb.path1=null;Xb.next=Ec.zpp_pool;Ec.zpp_pool=Xb;var Yb=O;Yb.end=Yb.start=null;Yb.path0=Yb.path1=null;Yb.next=Ec.zpp_pool;Ec.zpp_pool=Yb}var cc;cc=null==h?new Rc:h;for(var hc=ab.paths.head;null!=hc;){var ic=hc.elt,kb;if(ic==ic.parent)kb=ic;else{for(var Ob=ic,bc=null;Ob!=Ob.parent;){var Lc=Ob.parent;Ob.parent=bc;bc=Ob;Ob=Lc}for(;null!=bc;){var Mc=bc.parent;bc.parent=Ob;bc=Mc}kb=Ob}if(!kb.used){kb.used=!0;for(var ob=kb.vert,
yc=!0;null!=kb.vert&&(yc||ob!=kb.vert);)if(yc=!1,ob.x==ob.next.x&&ob.y==ob.next.y)if(ob==kb.vert&&(kb.vert=ob.next==ob?null:ob.next,yc=!0),null!=ob&&ob.prev==ob)ob=ob=ob.next=ob.prev=null;else{var Nc=ob.next;ob.prev.next=ob.next;ob.next.prev=ob.prev;ob=ob.next=ob.prev=null;ob=Nc}else ob=ob.next;if(null!=kb.vert){var zc=Ic.get();zc.zpp_inner.vertices=kb.vert;cc.zpp_inner.reverse_flag?cc.push(zc):cc.unshift(zc)}}hc=hc.next}for(;null!=ab.paths.head;){var lc=ab.paths.pop_unsafe();lc.vert=null;lc.parent=
null;lc.next=Tb.zpp_pool;Tb.zpp_pool=lc}for(;null!=x;)if(null!=x&&x.prev==x){x.next=x.prev=null;var oc=x;oc.vert=null;oc.parent=null;oc.next=Tb.zpp_pool;Tb.zpp_pool=oc;x=x=null}else{var Oc=x.next;x.prev.next=x.next;x.next.prev=x.prev;x.next=x.prev=null;var pc=x;pc.vert=null;pc.parent=null;pc.next=Tb.zpp_pool;Tb.zpp_pool=pc;x=null;x=Oc}return cc};var Pf=function(){};Pf.__name__=!0;Pf.validateShape=function(a){1==a.type&&a.polygon.validate_gaxi();a.zip_aabb&&null!=a.body&&(a.zip_aabb=!1,0==a.type?a.circle.__validate_aabb():
a.polygon.__validate_aabb());a.zip_worldCOM&&null!=a.body&&(a.zip_worldCOM=!1,a.zip_localCOM&&(a.zip_localCOM=!1,1==a.type&&a.polygon.__validate_localCOM(),null!=a.wrap_localCOM&&(a.wrap_localCOM.zpp_inner.x=a.localCOMx,a.wrap_localCOM.zpp_inner.y=a.localCOMy)),a.body.validate_axis(),a.worldCOMx=a.body.posx+(a.body.axisy*a.localCOMx-a.body.axisx*a.localCOMy),a.worldCOMy=a.body.posy+(a.localCOMx*a.body.axisx+a.localCOMy*a.body.axisy))};var y=function(){this.forced=!1;this.prev=this.next=this.wrap=
null;this.x=this.y=0};y.__name__=!0;y.get=function(a,b){var c;null==y.zpp_pool?c=new y:(c=y.zpp_pool,y.zpp_pool=c.next,c.next=null);c.forced=!1;c.x=a;c.y=b;return c};y.prototype={free:function(){null!=this.wrap&&(this.wrap.zpp_inner._inuse=!1,this.wrap.dispose(),this.wrap=null);this.prev=this.next=null},alloc:function(){this.forced=!1},wrapper:function(){null==this.wrap&&(this.wrap=E.get(this.x,this.y,null),this.wrap.zpp_inner._inuse=!0,this.wrap.zpp_inner._invalidate=w(this,this.modwrap),this.wrap.zpp_inner._validate=
w(this,this.getwrap));return this.wrap},modwrap:function(a){this.x=a.x;this.y=a.y},getwrap:function(){this.wrap.zpp_inner.x=this.x;this.wrap.zpp_inner.y=this.y},__class__:y};var kf=function(a){this.outer=this.vertices=null;this.outer=a};kf.__name__=!0;kf.prototype={__class__:kf};var wb=function(){this.outer=this.next=null;this.first=this.forward=!1;this.ptr=this.start=null;wb.internal=!0;this.outer=new lf;wb.internal=!1};wb.__name__=!0;wb.get=function(a,b){var c;null==wb.zpp_pool?c=new wb:(c=wb.zpp_pool,
wb.zpp_pool=c.next,c.next=null);null;c.outer.zpp_inner=c;c.ptr=a;c.forward=b;c.start=a;c.first=null!=a;return c.outer};wb.prototype={free:function(){this.ptr=this.start=this.outer.zpp_inner=null},alloc:function(){},__class__:wb};var Wa=function(){this.next=null;this.out=!1;this.rank=0;this.parent=null;this.parent=this};Wa.__name__=!0;Wa.prototype={free:function(){this.parent=this},alloc:function(){this.out=!1;this.rank=0},__class__:Wa};var jd=function(){this.pd=this.span1=this.span2=this.spanr=this.next=
null;this.keyr=this.okeyr=0;this.pr=null;this.key2=this.okey2=0;this.p2=null;this.key1=this.okey1=0;this.p1=null};jd.__name__=!0;jd.prototype={free:function(){this.span1=this.span2=this.spanr=this.p1=this.p2=this.pr=this.pd=null},alloc:function(){},__class__:jd};var da=function(){};da.__name__=!0;da.run=function(a,b,c,d,e,h,g,q,k){var l;if(null!=h&&h.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");h.zpp_inner.validate();l=(d-b)/h.zpp_inner.x;var n=l|0,r;if(null!=h&&h.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
h.zpp_inner.validate();r=(e-c)/h.zpp_inner.y;var z=r|0;l!=n&&n++;r!=z&&z++;q&&(null==da.map?da.map=new zf(n,z):da.map.resize(n,z,null));null==da.isos?da.isos=new Af(n+1,z+1):da.isos.resize(n+1,z+1,0);l=0;for(r=z+1;l<r;){var x=l++,p;if(0==x)p=c;else if(x<=z){if(null!=h&&h.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");h.zpp_inner.validate();p=c+h.zpp_inner.y*x}else p=e;for(var u=0,y=n+1;u<y;){var w=u++,v;if(0==w)v=b;else if(w<=n){if(null!=h&&h.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");
h.zpp_inner.validate();v=b+h.zpp_inner.x*w}else v=d;da.isos.set(w,x,a(v,p))}}null==da.ints?da.ints=new Bf(n+1,(z<<1)+1):da.ints.resize(n+1,(z<<1)+1,null);l=null;q&&(null==Wa.zpp_pool?l=new Wa:(l=Wa.zpp_pool,Wa.zpp_pool=l.next,l.next=null),l.out=!1,l.rank=0);u=c;for(r=0;r<z;){x=r++;p=u;if(x==z-1)u=e;else{if(null!=h&&h.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");h.zpp_inner.validate();u=c+h.zpp_inner.y*(x+1)}var u=y=u,A=b,w=null;for(v=0;v<n;){var B=v++,m=A,C;if(B==n-1)A=
d;else{if(null!=h&&h.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");h.zpp_inner.validate();A=b+h.zpp_inner.x*(B+1)}A=C=A;m=da.me.marchSquare(a,da.isos,da.ints,m,p,C,y,B,x,0==B||!q,0==x||!q,B==n-1||!q,x==z-1||!q,g);null==m?w=null:q?(C=null!=m.p2&&14!=m.okey2?m.p2:m.p1,m.pd=0==((C==m.p2?m.okey2:m.okey1)&128)?C.prev:C.prev.prev,da.map.set(B,x,m),null!=w&&da.me.combLeft(m.key1)?(da.me.combLR(w,m),m.span1=w.spanr):(null==Wa.zpp_pool?m.span1=new Wa:(m.span1=Wa.zpp_pool,Wa.zpp_pool=
m.span1.next,m.span1.next=null),m.span1.alloc(),m.span1.next=l,l=m.span1),null!=m.p2?(null==Wa.zpp_pool?m.span2=new Wa:(m.span2=Wa.zpp_pool,Wa.zpp_pool=m.span2.next,m.span2.next=null),m.span2.alloc(),m.span2.next=l,l=m.span2,m.spanr=m.span2):m.spanr=m.span1,w=da.me.combRight(m.keyr)?m:null):(da.me.output(k,m.p1),null!=m.p2&&da.me.output(k,m.p2),B=m,B.p1=B.p2=B.pr=B.pd=null,B.span1=B.span2=B.spanr=null,B.next=jd.zpp_pool,jd.zpp_pool=B)}}if(q){for(a=1;a<z;)for(b=a++,h=null,c=0;c<n;)if(e=c++,d=da.map.get(e,
b),null==d)h=null;else if(da.me.combUp(null!=d.p2&&14==d.okey2?d.okey2:d.okey1))if(e=da.map.get(e,b-1),null==e)h=null;else if(da.me.combDown(null!=e.p2&&56==e.okey2?e.okey2:e.okey1)){var E;E=null!=e.p2&&56==e.okey2?e.span2:e.span1;var F;F=null!=d.p2&&14==d.okey2?d.span2:d.span1;if((E==E.parent?E:function(a){a=E;for(var b=null;a!=a.parent;){var c=a.parent;a.parent=b;b=a;a=c}for(;null!=b;)c=b.parent,b.parent=a,b=c;return a}(this))==(F==F.parent?F:function(a){a=F;for(var b=null;a!=a.parent;){var c=a.parent;
a.parent=b;b=a;a=c}for(;null!=b;)c=b.parent,b.parent=a,b=c;return a}(this)))h!=F&&da.me.combUD_virtual(e,d);else{if(E==E.parent)h=E;else{h=E;for(g=null;h!=h.parent;)q=h.parent,h.parent=g,g=h,h=q;for(;null!=g;)q=g.parent,g.parent=h,g=q}if(F==F.parent)g=F;else{g=F;for(q=null;g!=g.parent;)r=g.parent,g.parent=q,q=g,g=r;for(;null!=q;)r=q.parent,q.parent=g,q=r}h!=g&&(h.rank<g.rank?h.parent=g:h.rank>g.rank?g.parent=h:(g.parent=h,h.rank++));da.me.combUD(e,d)}h=0!=((F==d.span2?d.okey2:d.okey1)&4)?F:null}else h=
null;else h=null;for(a=0;a<z;)for(b=a++,c=0;c<n;)if(d=c++,e=da.map.get(d,b),null!=e){if(e.span1==e.span1.parent)h=e.span1;else{h=e.span1;for(g=null;h!=h.parent;)q=h.parent,h.parent=g,g=h,h=q;for(;null!=g;)q=g.parent,g.parent=h,g=q}h.out||(h.out=!0,da.me.output(k,e.p1));if(null!=e.p2){if(e.span2==e.span2.parent)h=e.span2;else{h=e.span2;for(g=null;h!=h.parent;)q=h.parent,h.parent=g,g=h,h=q;for(;null!=g;)q=g.parent,g.parent=h,g=q}h.out||(h.out=!0,da.me.output(k,e.p2))}e.p1=e.p2=e.pr=e.pd=null;e.span1=
e.span2=e.spanr=null;e.next=jd.zpp_pool;jd.zpp_pool=e;da.map.set(d,b,null)}for(;null!=l;)k=l,l=k.next,k.parent=k,k.next=Wa.zpp_pool,Wa.zpp_pool=k}};da.ISO=function(a,b,c){return a(b,c)};da.prototype={output:function(a,b){var c;if(null==b||b.next==b||b.next==b.prev)c=!0;else{c=0;var d=b,e=b;if(null!=d){do{var h=d;c+=h.x*(h.next.y-h.prev.y);d=d.next}while(d!=e)}c*=.5;c=c*c<u.epsilon*u.epsilon}if(c)for(;null!=b;)null!=b&&b.prev==b?b=b=b.next=b.prev=null:(c=b.next,b.prev.next=b.next,b.next.prev=b.prev,
b.next=b.prev=null,b=c);else c=Ic.get(),c.zpp_inner.vertices=b,a.zpp_inner.reverse_flag?a.push(c):a.unshift(c)},linkright:function(a,b){var c=b&7;return 0==c?a:3==c?a.next.next:a.next},linkleft:function(a,b){return 0==(b&1)?a.prev:a},linkdown:function(a,b){return 0==(b&128)?a.prev:a.prev.prev},linkup:function(a,b){return a},combLR:function(a,b){var c=this.linkright(a.pr,a.okeyr),d=this.linkleft(b.p1,b.okey1),e=c.next,h=d.prev;0!=(a.keyr&4)?(b.pr==b.p1&&(b.pr=c.prev),b.p1=c.prev,c.prev.next=d.next,
d.next.prev=c.prev,null!=c.wrap&&(c.wrap.zpp_inner._inuse=!1,c.wrap.dispose(),c.wrap=null),c.prev=c.next=null,c.next=y.zpp_pool,y.zpp_pool=c):(c.next=d.next,d.next.prev=c);null!=d.wrap&&(d.wrap.zpp_inner._inuse=!1,d.wrap.dispose(),d.wrap=null);d.prev=d.next=null;d.next=y.zpp_pool;y.zpp_pool=d;0!=(a.keyr&16)?(b.pd=e.next,e.next.prev=h.prev,h.prev.next=e.next,null!=e.wrap&&(e.wrap.zpp_inner._inuse=!1,e.wrap.dispose(),e.wrap=null),e.prev=e.next=null,e.next=y.zpp_pool,y.zpp_pool=e):(e.prev=h.prev,h.prev.next=
e);null!=h.wrap&&(h.wrap.zpp_inner._inuse=!1,h.wrap.dispose(),h.wrap=null);h.prev=h.next=null;h.next=y.zpp_pool;y.zpp_pool=h},combUD:function(a,b){var c=a.pd,d=null!=b.p2&&14==b.key2?b.p2:b.p1,e=c.prev,h=d.next;d.next=c.next;c.next.prev=d;null!=c.wrap&&(c.wrap.zpp_inner._inuse=!1,c.wrap.dispose(),c.wrap=null);c.prev=c.next=null;c.next=y.zpp_pool;y.zpp_pool=c;h.prev=e.prev;e.prev.next=h;e==a.p1&&(a.p1=h);null!=e.wrap&&(e.wrap.zpp_inner._inuse=!1,e.wrap.dispose(),e.wrap=null);e.prev=e.next=null;e.next=
y.zpp_pool;y.zpp_pool=e},combUD_virtual:function(a,b){var c=a.pd,d=null!=b.p2&&14==b.key2?b.p2:b.p1;c.forced=d.forced=c.prev.forced=d.next.forced=!0},combLeft:function(a){return this.comb(a&1|(a&192)>>5)},combRight:function(a){return this.comb((a&28)>>2)},combUp:function(a){return this.comb(a&7)},combDown:function(a){return this.comb((a&112)>>4)},comb:function(a){var b=0;0!=(a&1)&&b++;0!=(a&2)&&b++;0!=(a&4)&&b++;return 2<=b},marchSquare:function(a,b,c,d,e,h,f,g,k,l,n,r,z,x){var p=0,u=b.list[k*b.width+
g];0>u&&(p|=8);var w=b.list[k*b.width+(g+1)];0>w&&(p|=4);var A=b.list[(k+1)*b.width+(g+1)];0>A&&(p|=2);b=b.list[(k+1)*b.width+g];0>b&&(p|=1);if(0==p)return null;var v;null==jd.zpp_pool?v=new jd:(v=jd.zpp_pool,jd.zpp_pool=v.next,v.next=null);null;if(10!=p&&5!=p){p=da.look_march[p];v.okey1=p;for(var C=0;8>C;){var B=C++;if(0!=(p&1<<B)){var m=null;if(0==B){if(m=y.get(d,e),l||n)m.forced=!0}else if(2==B){if(m=y.get(h,e),r||n)m.forced=!0}else if(4==B){if(m=y.get(h,f),r||z)m.forced=!0}else if(6==B){if(m=
y.get(d,f),l||z)m.forced=!0}else if(1==B){if(m=c.list[(k<<1)*c.width+g],null==m?(m=y.get(this.xlerp(d,h,e,u,w,a,x),e),c.list[(k<<1)*c.width+g]=m):m=y.get(m.x,m.y),n&&(m.forced=!0),m.x==d||m.x==h)if(m.x==d&&0!=(p&1)||m.x==h&&0!=(p&4))p^=2}else if(5==B){if(m=c.list[((k<<1)+2)*c.width+g],null==m?(m=y.get(this.xlerp(d,h,f,b,A,a,x),f),c.list[((k<<1)+2)*c.width+g]=m):m=y.get(m.x,m.y),z&&(m.forced=!0),m.x==d||m.x==h)if(m.x==d&&0!=(p&64)||m.x==h&&0!=(p&16))p^=32}else if(3==B){if(m=c.list[((k<<1)+1)*c.width+
(g+1)],null==m?(m=y.get(h,this.ylerp(e,f,h,w,A,a,x)),c.list[((k<<1)+1)*c.width+(g+1)]=m):m=y.get(m.x,m.y),r&&(m.forced=!0),m.y==e||m.y==f)if(m.y==e&&0!=(p&4)||m.y==f&&0!=(p&16))p^=8}else if(m=c.list[((k<<1)+1)*c.width+g],null==m?(m=y.get(d,this.ylerp(e,f,d,u,b,a,x)),c.list[((k<<1)+1)*c.width+g]=m):m=y.get(m.x,m.y),l&&(m.forced=!0),m.y==e||m.y==f)if(m.y==e&&0!=(p&1)||m.y==f&&0!=(p&64))p^=128;B=m;null==v.p1?v.p1=B.prev=B.next=B:(B.prev=v.p1,B.next=v.p1.next,v.p1.next.prev=B,v.p1.next=B);v.p1=B}}v.p1=
v.p1.next;v.key1=p;if(1==p||4==p||16==p||64==p||3==p||12==p||48==p||192==p||129==p||6==p||24==p||96==p||5==p||20==p||80==p||65==p||17==p||68==p)p=0,v.key1=0,v.p1=null;0==p?v=null:(v.pr=v.p1,v.okeyr=v.okey1,v.keyr=v.key1)}else if(C=0>a(.5*(d+h),.5*(e+f)),10==p)if(C){p=187;v.okey1=p;for(C=0;8>C;)if(B=C++,0!=(p&1<<B)){m=null;if(0==B){if(m=y.get(d,e),l||n)m.forced=!0}else if(2==B){if(m=y.get(h,e),r||n)m.forced=!0}else if(4==B){if(m=y.get(h,f),r||z)m.forced=!0}else if(6==B){if(m=y.get(d,f),l||z)m.forced=
!0}else if(1==B){if(m=c.list[(k<<1)*c.width+g],null==m?(m=y.get(this.xlerp(d,h,e,u,w,a,x),e),c.list[(k<<1)*c.width+g]=m):m=y.get(m.x,m.y),n&&(m.forced=!0),m.x==d||m.x==h)if(m.x==d&&0!=(p&1)||m.x==h&&0!=(p&4))p^=2}else if(5==B){if(m=c.list[((k<<1)+2)*c.width+g],null==m?(m=y.get(this.xlerp(d,h,f,b,A,a,x),f),c.list[((k<<1)+2)*c.width+g]=m):m=y.get(m.x,m.y),z&&(m.forced=!0),m.x==d||m.x==h)if(m.x==d&&0!=(p&64)||m.x==h&&0!=(p&16))p^=32}else if(3==B){if(m=c.list[((k<<1)+1)*c.width+(g+1)],null==m?(m=y.get(h,
this.ylerp(e,f,h,w,A,a,x)),c.list[((k<<1)+1)*c.width+(g+1)]=m):m=y.get(m.x,m.y),r&&(m.forced=!0),m.y==e||m.y==f)if(m.y==e&&0!=(p&4)||m.y==f&&0!=(p&16))p^=8}else if(m=c.list[((k<<1)+1)*c.width+g],null==m?(m=y.get(d,this.ylerp(e,f,d,u,b,a,x)),c.list[((k<<1)+1)*c.width+g]=m):m=y.get(m.x,m.y),l&&(m.forced=!0),m.y==e||m.y==f)if(m.y==e&&0!=(p&1)||m.y==f&&0!=(p&64))p^=128;B=m;null==v.p1?v.p1=B.prev=B.next=B:(B.prev=v.p1,B.next=v.p1.next,v.p1.next.prev=B,v.p1.next=B);v.p1=B}v.p1=v.p1.next;v.key1=p;if(1==
p||4==p||16==p||64==p||3==p||12==p||48==p||192==p||129==p||6==p||24==p||96==p||5==p||20==p||80==p||65==p||17==p||68==p)p=0,v.key1=0,v.p1=null;0==p?v=null:(v.pr=v.p1,v.okeyr=v.okey1,v.keyr=v.key1)}else{p=131;v.okey1=p;for(C=0;8>C;)if(B=C++,0!=(p&1<<B)){m=null;if(0==B){if(m=y.get(d,e),l||n)m.forced=!0}else if(2==B){if(m=y.get(h,e),r||n)m.forced=!0}else if(4==B){if(m=y.get(h,f),r||z)m.forced=!0}else if(6==B){if(m=y.get(d,f),l||z)m.forced=!0}else if(1==B){if(m=c.list[(k<<1)*c.width+g],null==m?(m=y.get(this.xlerp(d,
h,e,u,w,a,x),e),c.list[(k<<1)*c.width+g]=m):m=y.get(m.x,m.y),n&&(m.forced=!0),m.x==d||m.x==h)if(m.x==d&&0!=(p&1)||m.x==h&&0!=(p&4))p^=2}else if(5==B){if(m=c.list[((k<<1)+2)*c.width+g],null==m?(m=y.get(this.xlerp(d,h,f,b,A,a,x),f),c.list[((k<<1)+2)*c.width+g]=m):m=y.get(m.x,m.y),z&&(m.forced=!0),m.x==d||m.x==h)if(m.x==d&&0!=(p&64)||m.x==h&&0!=(p&16))p^=32}else if(3==B){if(m=c.list[((k<<1)+1)*c.width+(g+1)],null==m?(m=y.get(h,this.ylerp(e,f,h,w,A,a,x)),c.list[((k<<1)+1)*c.width+(g+1)]=m):m=y.get(m.x,
m.y),r&&(m.forced=!0),m.y==e||m.y==f)if(m.y==e&&0!=(p&4)||m.y==f&&0!=(p&16))p^=8}else if(m=c.list[((k<<1)+1)*c.width+g],null==m?(m=y.get(d,this.ylerp(e,f,d,u,b,a,x)),c.list[((k<<1)+1)*c.width+g]=m):m=y.get(m.x,m.y),l&&(m.forced=!0),m.y==e||m.y==f)if(m.y==e&&0!=(p&1)||m.y==f&&0!=(p&64))p^=128;B=m;null==v.p1?v.p1=B.prev=B.next=B:(B.prev=v.p1,B.next=v.p1.next,v.p1.next.prev=B,v.p1.next=B);v.p1=B}v.p1=v.p1.next;v.key1=p;if(1==p||4==p||16==p||64==p||3==p||12==p||48==p||192==p||129==p||6==p||24==p||96==
p||5==p||20==p||80==p||65==p||17==p||68==p)p=0,v.key1=0,v.p1=null;if(0!=p){p=56;v.okey2=p;for(C=0;8>C;)if(B=C++,0!=(p&1<<B)){m=null;if(0==B){if(m=y.get(d,e),l||n)m.forced=!0}else if(2==B){if(m=y.get(h,e),r||n)m.forced=!0}else if(4==B){if(m=y.get(h,f),r||z)m.forced=!0}else if(6==B){if(m=y.get(d,f),l||z)m.forced=!0}else if(1==B){if(m=c.list[(k<<1)*c.width+g],null==m?(m=y.get(this.xlerp(d,h,e,u,w,a,x),e),c.list[(k<<1)*c.width+g]=m):m=y.get(m.x,m.y),n&&(m.forced=!0),m.x==d||m.x==h)if(m.x==d&&0!=(p&1)||
m.x==h&&0!=(p&4))p^=2}else if(5==B){if(m=c.list[((k<<1)+2)*c.width+g],null==m?(m=y.get(this.xlerp(d,h,f,b,A,a,x),f),c.list[((k<<1)+2)*c.width+g]=m):m=y.get(m.x,m.y),z&&(m.forced=!0),m.x==d||m.x==h)if(m.x==d&&0!=(p&64)||m.x==h&&0!=(p&16))p^=32}else if(3==B){if(m=c.list[((k<<1)+1)*c.width+(g+1)],null==m?(m=y.get(h,this.ylerp(e,f,h,w,A,a,x)),c.list[((k<<1)+1)*c.width+(g+1)]=m):m=y.get(m.x,m.y),r&&(m.forced=!0),m.y==e||m.y==f)if(m.y==e&&0!=(p&4)||m.y==f&&0!=(p&16))p^=8}else if(m=c.list[((k<<1)+1)*c.width+
g],null==m?(m=y.get(d,this.ylerp(e,f,d,u,b,a,x)),c.list[((k<<1)+1)*c.width+g]=m):m=y.get(m.x,m.y),l&&(m.forced=!0),m.y==e||m.y==f)if(m.y==e&&0!=(p&1)||m.y==f&&0!=(p&64))p^=128;B=m;null==v.p2?v.p2=B.prev=B.next=B:(B.prev=v.p2,B.next=v.p2.next,v.p2.next.prev=B,v.p2.next=B);v.p2=B}v.p2=v.p2.next;v.key2=p;if(1==p||4==p||16==p||64==p||3==p||12==p||48==p||192==p||129==p||6==p||24==p||96==p||5==p||20==p||80==p||65==p||17==p||68==p)p=0,v.key2=0,v.p2=null;0==p?(v.pr=v.p1,v.okeyr=v.okey1,v.keyr=v.key1):(v.pr=
v.p2,v.okeyr=v.okey2,v.keyr=v.key2)}else{p=56;v.okey1=p;for(C=0;8>C;)if(B=C++,0!=(p&1<<B)){m=null;if(0==B){if(m=y.get(d,e),l||n)m.forced=!0}else if(2==B){if(m=y.get(h,e),r||n)m.forced=!0}else if(4==B){if(m=y.get(h,f),r||z)m.forced=!0}else if(6==B){if(m=y.get(d,f),l||z)m.forced=!0}else if(1==B){if(m=c.list[(k<<1)*c.width+g],null==m?(m=y.get(this.xlerp(d,h,e,u,w,a,x),e),c.list[(k<<1)*c.width+g]=m):m=y.get(m.x,m.y),n&&(m.forced=!0),m.x==d||m.x==h)if(m.x==d&&0!=(p&1)||m.x==h&&0!=(p&4))p^=2}else if(5==
B){if(m=c.list[((k<<1)+2)*c.width+g],null==m?(m=y.get(this.xlerp(d,h,f,b,A,a,x),f),c.list[((k<<1)+2)*c.width+g]=m):m=y.get(m.x,m.y),z&&(m.forced=!0),m.x==d||m.x==h)if(m.x==d&&0!=(p&64)||m.x==h&&0!=(p&16))p^=32}else if(3==B){if(m=c.list[((k<<1)+1)*c.width+(g+1)],null==m?(m=y.get(h,this.ylerp(e,f,h,w,A,a,x)),c.list[((k<<1)+1)*c.width+(g+1)]=m):m=y.get(m.x,m.y),r&&(m.forced=!0),m.y==e||m.y==f)if(m.y==e&&0!=(p&4)||m.y==f&&0!=(p&16))p^=8}else if(m=c.list[((k<<1)+1)*c.width+g],null==m?(m=y.get(d,this.ylerp(e,
f,d,u,b,a,x)),c.list[((k<<1)+1)*c.width+g]=m):m=y.get(m.x,m.y),l&&(m.forced=!0),m.y==e||m.y==f)if(m.y==e&&0!=(p&1)||m.y==f&&0!=(p&64))p^=128;B=m;null==v.p1?v.p1=B.prev=B.next=B:(B.prev=v.p1,B.next=v.p1.next,v.p1.next.prev=B,v.p1.next=B);v.p1=B}v.p1=v.p1.next;v.key1=p;if(1==p||4==p||16==p||64==p||3==p||12==p||48==p||192==p||129==p||6==p||24==p||96==p||5==p||20==p||80==p||65==p||17==p||68==p)p=0,v.key1=0,v.p1=null;0==p?v=null:(v.pr=v.p1,v.okeyr=v.okey1,v.keyr=v.key1)}}else if(C){p=238;v.okey1=p;for(C=
0;8>C;)if(B=C++,0!=(p&1<<B)){m=null;if(0==B){if(m=y.get(d,e),l||n)m.forced=!0}else if(2==B){if(m=y.get(h,e),r||n)m.forced=!0}else if(4==B){if(m=y.get(h,f),r||z)m.forced=!0}else if(6==B){if(m=y.get(d,f),l||z)m.forced=!0}else if(1==B){if(m=c.list[(k<<1)*c.width+g],null==m?(m=y.get(this.xlerp(d,h,e,u,w,a,x),e),c.list[(k<<1)*c.width+g]=m):m=y.get(m.x,m.y),n&&(m.forced=!0),m.x==d||m.x==h)if(m.x==d&&0!=(p&1)||m.x==h&&0!=(p&4))p^=2}else if(5==B){if(m=c.list[((k<<1)+2)*c.width+g],null==m?(m=y.get(this.xlerp(d,
h,f,b,A,a,x),f),c.list[((k<<1)+2)*c.width+g]=m):m=y.get(m.x,m.y),z&&(m.forced=!0),m.x==d||m.x==h)if(m.x==d&&0!=(p&64)||m.x==h&&0!=(p&16))p^=32}else if(3==B){if(m=c.list[((k<<1)+1)*c.width+(g+1)],null==m?(m=y.get(h,this.ylerp(e,f,h,w,A,a,x)),c.list[((k<<1)+1)*c.width+(g+1)]=m):m=y.get(m.x,m.y),r&&(m.forced=!0),m.y==e||m.y==f)if(m.y==e&&0!=(p&4)||m.y==f&&0!=(p&16))p^=8}else if(m=c.list[((k<<1)+1)*c.width+g],null==m?(m=y.get(d,this.ylerp(e,f,d,u,b,a,x)),c.list[((k<<1)+1)*c.width+g]=m):m=y.get(m.x,m.y),
l&&(m.forced=!0),m.y==e||m.y==f)if(m.y==e&&0!=(p&1)||m.y==f&&0!=(p&64))p^=128;B=m;null==v.p1?v.p1=B.prev=B.next=B:(B.prev=v.p1,B.next=v.p1.next,v.p1.next.prev=B,v.p1.next=B);v.p1=B}v.p1=v.p1.next;v.key1=p;if(1==p||4==p||16==p||64==p||3==p||12==p||48==p||192==p||129==p||6==p||24==p||96==p||5==p||20==p||80==p||65==p||17==p||68==p)p=0,v.key1=0,v.p1=null;0==p?v=null:(v.pr=v.p1,v.okeyr=v.okey1,v.keyr=v.key1)}else{p=224;v.okey1=p;for(C=0;8>C;)if(B=C++,0!=(p&1<<B)){m=null;if(0==B){if(m=y.get(d,e),l||n)m.forced=
!0}else if(2==B){if(m=y.get(h,e),r||n)m.forced=!0}else if(4==B){if(m=y.get(h,f),r||z)m.forced=!0}else if(6==B){if(m=y.get(d,f),l||z)m.forced=!0}else if(1==B){if(m=c.list[(k<<1)*c.width+g],null==m?(m=y.get(this.xlerp(d,h,e,u,w,a,x),e),c.list[(k<<1)*c.width+g]=m):m=y.get(m.x,m.y),n&&(m.forced=!0),m.x==d||m.x==h)if(m.x==d&&0!=(p&1)||m.x==h&&0!=(p&4))p^=2}else if(5==B){if(m=c.list[((k<<1)+2)*c.width+g],null==m?(m=y.get(this.xlerp(d,h,f,b,A,a,x),f),c.list[((k<<1)+2)*c.width+g]=m):m=y.get(m.x,m.y),z&&(m.forced=
!0),m.x==d||m.x==h)if(m.x==d&&0!=(p&64)||m.x==h&&0!=(p&16))p^=32}else if(3==B){if(m=c.list[((k<<1)+1)*c.width+(g+1)],null==m?(m=y.get(h,this.ylerp(e,f,h,w,A,a,x)),c.list[((k<<1)+1)*c.width+(g+1)]=m):m=y.get(m.x,m.y),r&&(m.forced=!0),m.y==e||m.y==f)if(m.y==e&&0!=(p&4)||m.y==f&&0!=(p&16))p^=8}else if(m=c.list[((k<<1)+1)*c.width+g],null==m?(m=y.get(d,this.ylerp(e,f,d,u,b,a,x)),c.list[((k<<1)+1)*c.width+g]=m):m=y.get(m.x,m.y),l&&(m.forced=!0),m.y==e||m.y==f)if(m.y==e&&0!=(p&1)||m.y==f&&0!=(p&64))p^=128;
B=m;null==v.p1?v.p1=B.prev=B.next=B:(B.prev=v.p1,B.next=v.p1.next,v.p1.next.prev=B,v.p1.next=B);v.p1=B}v.p1=v.p1.next;v.key1=p;if(1==p||4==p||16==p||64==p||3==p||12==p||48==p||192==p||129==p||6==p||24==p||96==p||5==p||20==p||80==p||65==p||17==p||68==p)p=0,v.key1=0,v.p1=null;if(0!=p){p=14;v.okey2=p;for(C=0;8>C;)if(B=C++,0!=(p&1<<B)){m=null;if(0==B){if(m=y.get(d,e),l||n)m.forced=!0}else if(2==B){if(m=y.get(h,e),r||n)m.forced=!0}else if(4==B){if(m=y.get(h,f),r||z)m.forced=!0}else if(6==B){if(m=y.get(d,
f),l||z)m.forced=!0}else if(1==B){if(m=c.list[(k<<1)*c.width+g],null==m?(m=y.get(this.xlerp(d,h,e,u,w,a,x),e),c.list[(k<<1)*c.width+g]=m):m=y.get(m.x,m.y),n&&(m.forced=!0),m.x==d||m.x==h)if(m.x==d&&0!=(p&1)||m.x==h&&0!=(p&4))p^=2}else if(5==B){if(m=c.list[((k<<1)+2)*c.width+g],null==m?(m=y.get(this.xlerp(d,h,f,b,A,a,x),f),c.list[((k<<1)+2)*c.width+g]=m):m=y.get(m.x,m.y),z&&(m.forced=!0),m.x==d||m.x==h)if(m.x==d&&0!=(p&64)||m.x==h&&0!=(p&16))p^=32}else if(3==B){if(m=c.list[((k<<1)+1)*c.width+(g+1)],
null==m?(m=y.get(h,this.ylerp(e,f,h,w,A,a,x)),c.list[((k<<1)+1)*c.width+(g+1)]=m):m=y.get(m.x,m.y),r&&(m.forced=!0),m.y==e||m.y==f)if(m.y==e&&0!=(p&4)||m.y==f&&0!=(p&16))p^=8}else if(m=c.list[((k<<1)+1)*c.width+g],null==m?(m=y.get(d,this.ylerp(e,f,d,u,b,a,x)),c.list[((k<<1)+1)*c.width+g]=m):m=y.get(m.x,m.y),l&&(m.forced=!0),m.y==e||m.y==f)if(m.y==e&&0!=(p&1)||m.y==f&&0!=(p&64))p^=128;B=m;null==v.p2?v.p2=B.prev=B.next=B:(B.prev=v.p2,B.next=v.p2.next,v.p2.next.prev=B,v.p2.next=B);v.p2=B}v.p2=v.p2.next;
v.key2=p;if(1==p||4==p||16==p||64==p||3==p||12==p||48==p||192==p||129==p||6==p||24==p||96==p||5==p||20==p||80==p||65==p||17==p||68==p)p=0,v.key2=0,v.p2=null;0==p?(v.pr=v.p1,v.okeyr=v.okey1,v.keyr=v.key1):(v.pr=v.p2,v.okeyr=v.okey2,v.keyr=v.key2)}else{p=14;v.okey1=p;for(C=0;8>C;)if(B=C++,0!=(p&1<<B)){m=null;if(0==B){if(m=y.get(d,e),l||n)m.forced=!0}else if(2==B){if(m=y.get(h,e),r||n)m.forced=!0}else if(4==B){if(m=y.get(h,f),r||z)m.forced=!0}else if(6==B){if(m=y.get(d,f),l||z)m.forced=!0}else if(1==
B){if(m=c.list[(k<<1)*c.width+g],null==m?(m=y.get(this.xlerp(d,h,e,u,w,a,x),e),c.list[(k<<1)*c.width+g]=m):m=y.get(m.x,m.y),n&&(m.forced=!0),m.x==d||m.x==h)if(m.x==d&&0!=(p&1)||m.x==h&&0!=(p&4))p^=2}else if(5==B){if(m=c.list[((k<<1)+2)*c.width+g],null==m?(m=y.get(this.xlerp(d,h,f,b,A,a,x),f),c.list[((k<<1)+2)*c.width+g]=m):m=y.get(m.x,m.y),z&&(m.forced=!0),m.x==d||m.x==h)if(m.x==d&&0!=(p&64)||m.x==h&&0!=(p&16))p^=32}else if(3==B){if(m=c.list[((k<<1)+1)*c.width+(g+1)],null==m?(m=y.get(h,this.ylerp(e,
f,h,w,A,a,x)),c.list[((k<<1)+1)*c.width+(g+1)]=m):m=y.get(m.x,m.y),r&&(m.forced=!0),m.y==e||m.y==f)if(m.y==e&&0!=(p&4)||m.y==f&&0!=(p&16))p^=8}else if(m=c.list[((k<<1)+1)*c.width+g],null==m?(m=y.get(d,this.ylerp(e,f,d,u,b,a,x)),c.list[((k<<1)+1)*c.width+g]=m):m=y.get(m.x,m.y),l&&(m.forced=!0),m.y==e||m.y==f)if(m.y==e&&0!=(p&1)||m.y==f&&0!=(p&64))p^=128;B=m;null==v.p1?v.p1=B.prev=B.next=B:(B.prev=v.p1,B.next=v.p1.next,v.p1.next.prev=B,v.p1.next=B);v.p1=B}v.p1=v.p1.next;v.key1=p;if(1==p||4==p||16==
p||64==p||3==p||12==p||48==p||192==p||129==p||6==p||24==p||96==p||5==p||20==p||80==p||65==p||17==p||68==p)p=0,v.key1=0,v.p1=null;0==p?v=null:(v.pr=v.p1,v.okeyr=v.okey1,v.keyr=v.key1)}}return v},lerp:function(a,b,c,d){if(0==c)return a;if(0==d)return b;d=c-d;c=d*d<u.epsilon*u.epsilon?.5:c/d;0>c?c=0:1<c&&(c=1);return a+c*(b-a)},xlerp:function(a,b,c,d,e,h,f){for(var g=this.lerp(a,b,d,e);0!=f--&&a<g&&g<b;){var k=h(g,c);if(0==k)break;0>d*k?(b=g,e=k):(a=g,d=k);g=this.lerp(a,b,d,e)}return g},ylerp:function(a,
b,c,d,e,h,f){for(var g=this.lerp(a,b,d,e);0!=f--&&a<g&&g<b;){var k=h(c,g);if(0==k)break;0>d*k?(b=g,e=k):(a=g,d=k);g=this.lerp(a,b,d,e)}return g},__class__:da};var ad=function(){this._invalidate=this.next=null;this.a=this.b=this.c=this.d=this.tx=this.ty=0;this.outer=null};ad.__name__=!0;ad.get=function(){var a;null==ad.zpp_pool?a=new ad:(a=ad.zpp_pool,ad.zpp_pool=a.next,a.next=null);null;return a};ad.identity=function(){var a=ad.get();a.setas(1,0,0,1,0,0);return a};ad.prototype={wrapper:function(){if(null==
this.outer){this.outer=new bb;var a=this.outer.zpp_inner;a.next=ad.zpp_pool;ad.zpp_pool=a;this.outer.zpp_inner=this}return this.outer},invalidate:function(){null!=this._invalidate&&this._invalidate()},set:function(a){this.setas(a.a,a.b,a.c,a.d,a.tx,a.ty)},setas:function(a,b,c,d,e,h){this.tx=e;this.ty=h;this.a=a;this.b=b;this.c=c;this.d=d},free:function(){},alloc:function(){},__class__:ad};var mf=function(a,b){this.x=null;this.m=this.n=0;this.outer=null;this.m=a;this.n=b;this.x=[];for(var c=0,d=a*
b;c<d;)c++,this.x.push(0)};mf.__name__=!0;mf.prototype={__class__:mf};var G=function(){};G.__name__=!0;G.bisector=function(a){var b=a.prev,c=a.next,d=0,e=0,d=a.x-b.x,e=a.y-b.y,h=b=0,b=c.x-a.x,h=c.y-a.y;a=P.get(-e-h,d+b,null);c=1/Math.sqrt(a.x*a.x+a.y*a.y);a.x*=c;a.y*=c;0>h*d-b*e&&(a.x=-a.x,a.y=-a.y);return a};G.below=function(a,b){if(a.y<b.y)return!0;if(a.y>b.y)return!1;if(a.x<b.x)return!0;if(a.x>b.x)return!1;var c=G.bisector(a),d=G.bisector(b);c.x+=1*a.x;c.y+=1*a.y;d.x+=1*b.x;d.y+=1*b.y;var e=c.x<
d.x||c.x==d.x&&c.y<d.y;null!=c.outer&&(c.outer.zpp_inner=null,c.outer=null);c._isimmutable=null;c._validate=null;c._invalidate=null;c.next=P.zpp_pool;P.zpp_pool=c;null!=d.outer&&(d.outer.zpp_inner=null,d.outer=null);d._isimmutable=null;d._validate=null;d._invalidate=null;d.next=P.zpp_pool;P.zpp_pool=d;return e};G.above=function(a,b){return G.below(b,a)};G.left_vertex=function(a){var b=a.prev;return b.y>a.y||b.y==a.y&&a.next.y<a.y};G.isMonotone=function(a){var b=a,c=a,d=a.next;if(null!=d){do{var e=
d;e.y<b.y&&(b=e);e.y>c.y&&(c=e);d=d.next}while(d!=a)}a=!0;d=b;if(c!=b.next){var h=b.next,e=c;if(null!=h){do{var f=h;if(f.y<d.y){a=!1;break}d=f;h=h.next}while(h!=e)}}if(!a)return!1;d=b;if(c!=b.prev&&(b=b.prev,null!=b)){do{e=b;if(e.y<d.y){a=!1;break}d=e;b=b.prev}while(b!=c)}return a};G.getShared=function(){null==G.sharedPPoly&&(G.sharedPPoly=new Y);return G.sharedPPoly};G.decompose=function(a,b){null==b?b=new Y(a):b.init(a);if(null==b.vertices)return b;null==G.queue&&(G.queue=new Cd);var c=b.vertices,
d=b.vertices;if(null!=c){do{var e=c;G.queue.add(e);var h=0,g=0,h=e.next.x-e.x,g=e.next.y-e.y,q=0,k=0,q=e.prev.x-e.x,k=e.prev.y-e.y,h=0<k*h-q*g;G.below(e.prev,e)?G.below(e.next,e)?e.type=h?0:3:e.type=4:G.below(e,e.next)?e.type=h?1:2:e.type=4;c=c.next}while(c!=d)}d=G.queue;if(null!=d.head&&null!=d.head.next){var c=d.head,q=g=h=e=null,k=1,l,n,r;do{l=0;h=c;for(e=c=null;null!=h;){l++;g=h;n=0;for(r=k;null!=g&&n<k;)n++,g=g.next;for(;0<n||0<r&&null!=g;)0==n?(q=g,g=g.next,r--):0==r||null==g?(q=h,h=h.next,
n--):G.above(h.elt,g.elt)?(q=h,h=h.next,n--):(q=g,g=g.next,r--),null!=e?e.next=q:c=q,e=q;h=g}e.next=null;k<<=1}while(1<l);d.head=c;d.modified=!0;d.pushmod=!0}null==G.edges&&(null==aa.zpp_pool?G.edges=new aa:(G.edges=aa.zpp_pool,aa.zpp_pool=G.edges.next,G.edges.next=null),null,G.edges.lt=ea.edge_lt,G.edges.swapped=ea.edge_swap);for(;null!=G.queue.head;)switch(d=G.queue.pop_unsafe(),d.type){case 0:d.helper=d;d.node=G.edges.insert(d);break;case 1:c=d.prev;if(null==c.helper)throw new f("Fatal error (1): Polygon is not weakly-simple and clockwise");
2==c.helper.type&&b.add_diagonal(d,c.helper);G.edges.remove_node(c.node);c.helper=null;break;case 3:c=null;if(!G.edges.empty()){for(e=G.edges.parent;null!=e.prev;)e=e.prev;for(;null!=e;){h=e.data;if(!ea.vert_lt(h,d)){c=h;break}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}if(null!=c){if(null==c.helper)throw new f("Fatal error (2): Polygon is not weakly-simple and clockwise");b.add_diagonal(d,c.helper);c.helper=d}d.node=G.edges.insert(d);
d.helper=d;break;case 2:c=d.prev;if(null==c.helper)throw new f("Fatal error (3): Polygon is not weakly-simple and clockwise");2==c.helper.type&&b.add_diagonal(d,c.helper);G.edges.remove_node(c.node);c=c.helper=null;if(!G.edges.empty()){for(e=G.edges.parent;null!=e.prev;)e=e.prev;for(;null!=e;){h=e.data;if(!ea.vert_lt(h,d)){c=h;break}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}if(null!=c){if(null==c.helper)throw new f("Fatal error (4): Polygon is not weakly-simple and clockwise");
2==c.helper.type&&b.add_diagonal(d,c.helper);c.helper=d}break;case 4:if(c=d.prev,G.left_vertex(d)){if(null==c.helper)throw new f("Fatal error (5): Polygon is not weakly-simple and clockwise");2==c.helper.type&&b.add_diagonal(d,c.helper);G.edges.remove_node(c.node);c.helper=null;d.node=G.edges.insert(d);d.helper=d}else{c=null;if(!G.edges.empty()){for(e=G.edges.parent;null!=e.prev;)e=e.prev;for(;null!=e;){h=e.data;if(!ea.vert_lt(h,d)){c=h;break}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=
e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}if(null==c||null==c.helper)throw new f("Fatal error (6): Polygon is not weakly-simple and clockwise");2==c.helper.type&&b.add_diagonal(d,c.helper);c.helper=d}}return b};var ea=function(){this.next=this.prev=this.node=null;this.rightchain=!1;this.helper=null;this.type=0;this.diagonals=null;this.forced=!1;this.id=this.mag=this.x=this.y=0;this.id=ea.nextId++;this.diagonals=new Cd};ea.__name__=!0;ea.get=function(a){var b;null==ea.zpp_pool?b=new ea:(b=
ea.zpp_pool,ea.zpp_pool=b.next,b.next=null);null;b.x=a.x;b.y=a.y;return b};ea.rightdistance=function(a,b){var c=a.next.y>a.y,d=0,e=0,d=a.next.x-a.x,e=a.next.y-a.y,h=0,f=0,h=b.x-a.x,f=b.y-a.y;return(c?-1:1)*(f*d-h*e)};ea.vert_lt=function(a,b){if(b==a||b==a.next)return!0;if(a.y==a.next.y){var c=a.x,d=a.next.x;return(c<d?c:d)<=b.x}return 0>=ea.rightdistance(a,b)};ea.edge_swap=function(a,b){var c=a.node;a.node=b.node;b.node=c};ea.edge_lt=function(a,b){if(a==b&&a.next==b.next)return!1;if(a==b.next)return!ea.vert_lt(a,
b);if(b==a.next)return ea.vert_lt(b,a);if(a.y==a.next.y)return b.y==b.next.y?function(b){b=a.x;var c=a.next.x;return b>c?b:c}(this)>function(a){a=b.x;var c=b.next.x;return a>c?a:c}(this):0<ea.rightdistance(b,a)||0<ea.rightdistance(b,a.next);var c=ea.rightdistance(a,b),d=ea.rightdistance(a,b.next);if(0==c&&0==d)return function(b){b=a.x;var c=a.next.x;return b>c?b:c}(this)>function(a){a=b.x;var c=b.next.x;return a>c?a:c}(this);if(0<=c*d)return 0>c||0>d;c=ea.rightdistance(b,a);d=ea.rightdistance(b,a.next);
return 0<=c*d?0<c||0<d:!1};ea.prototype={alloc:function(){},free:function(){this.helper=null},copy:function(){var a;null==ea.zpp_pool?a=new ea:(a=ea.zpp_pool,ea.zpp_pool=a.next,a.next=null);null;a.x=this.x;a.y=this.y;a.forced=this.forced;return a},sort:function(){var a=0,b=0,c=0,d=0,e,a=this.prev.x-this.x,b=this.prev.y-this.y,c=this.next.x-this.x,d=this.next.y-this.y;e=d*a-c*b;e=0<e?-1:0==e?0:1;var h=this.diagonals;if(null!=h.head&&null!=h.head.next){var f=h.head,g=null,k=null,l=null,n=null,r=1,z,
u,p;do{z=0;k=f;for(g=f=null;null!=k;){z++;l=k;u=0;for(p=r;null!=l&&u<r;)u++,l=l.next;for(;0<u||0<p&&null!=l;)0==u?(n=l,l=l.next,p--):0==p||null==l?(n=k,k=k.next,u--):(1==e?1==function(e){a=k.elt.x-e.x;b=k.elt.y-e.y;c=l.elt.x-e.x;d=l.elt.y-e.y;e=d*a-c*b;return 0<e?-1:0==e?0:1}(this):function(e){var h;a=e.prev.x-e.x;b=e.prev.y-e.y;c=k.elt.x-e.x;d=k.elt.y-e.y;h=d*a-c*b;h=0<h?-1:0==h?0:1;var f;a=e.prev.x-e.x;b=e.prev.y-e.y;c=l.elt.x-e.x;d=l.elt.y-e.y;f=d*a-c*b;f=0<f?-1:0==f?0:1;return 1==h*f||0==h*f&&
(1==h||1==f)?1==function(e){a=k.elt.x-e.x;b=k.elt.y-e.y;c=l.elt.x-e.x;d=l.elt.y-e.y;e=d*a-c*b;return 0<e?-1:0==e?0:1}(e):-1==h||-1==f?-1==f:0==h&&0==f?function(e){a=e.x-e.prev.x;b=e.y-e.prev.y;c=k.elt.x-e.x;d=k.elt.y-e.y;var h=a*c+b*d;c=l.elt.x-e.x;d=l.elt.y-e.y;e=a*c+b*d;return 0>h&&0<e?!0:0>e&&0<h?!1:!0}(e):!0}(this))?(n=k,k=k.next,u--):(n=l,l=l.next,p--),null!=g?g.next=n:f=n,g=n;k=l}g.next=null;r<<=1}while(1<z);h.head=f;h.modified=!0;h.pushmod=!0}},__class__:ea};var Y=function(a){this.vertices=
this.next=null;this.init(a)};Y.__name__=!0;Y.getSharedPP=function(){null==Y.sharedPPList&&(Y.sharedPPList=new vd);return Y.sharedPPList};Y.getShared=function(){null==Y.sharedGVList&&(Y.sharedGVList=new ud);return Y.sharedGVList};Y.prototype={eq:function(a,b){return eb.vec_dsq(a.x,a.y,b.x,b.y)<u.epsilon*u.epsilon},alloc:function(){},free:function(){},init:function(a){if(null!=a){var b;b=0;if(null!=a){var c=a;do{var d=c;b+=d.x*(d.next.y-d.prev.y);c=c.next}while(c!=a)}b=0<.5*b;c=a;do b?(d=ea.get(c),
null==this.vertices?this.vertices=d.prev=d.next=d:(d.prev=this.vertices,d.next=this.vertices.next,this.vertices.next.prev=d,this.vertices.next=d)):(d=ea.get(c),null==this.vertices?this.vertices=d.prev=d.next=d:(d.next=this.vertices,d.prev=this.vertices.prev,this.vertices.prev.next=d,this.vertices.prev=d)),this.vertices=d,this.vertices.forced=c.forced,c=c.next;while(c!=a);this.remove_collinear_vertices()}},remove_collinear_vertices:function(){for(var a=this.vertices,b=!0;b||a!=this.vertices;)if(b=
!1,this.eq(a,a.next)){a==this.vertices&&(this.vertices=a.next,b=!0);a.forced&&(a.next.forced=!0);if(null!=a&&a.prev==a)a.next=a.prev=null,a.helper=null,null,a.next=ea.zpp_pool,ea.zpp_pool=a,a=a=null;else{var c=a.next;a.prev.next=a.next;a.next.prev=a.prev;a.next=a.prev=null;a.helper=null;null;a.next=ea.zpp_pool;ea.zpp_pool=a;a=c}if(null==a){this.vertices=null;break}}else a=a.next;if(null==this.vertices)return!0;do for(c=!1,a=this.vertices,b=!0;b||a!=this.vertices;){var b=!1,d=a.prev,e=0,h=0,e=a.x-
d.x,h=a.y-d.y,f=d=0,d=a.next.x-a.x,f=a.next.y-a.y,e=f*e-d*h;if(e*e>=u.epsilon*u.epsilon)a=a.next;else if(a==this.vertices&&(this.vertices=a.next,b=!0),null!=a&&a.prev==a?(a.next=a.prev=null,a.helper=null,null,a.next=ea.zpp_pool,ea.zpp_pool=a,a=a=null):(c=a.next,a.prev.next=a.next,a.next.prev=a.prev,a.next=a.prev=null,a.helper=null,null,a.next=ea.zpp_pool,ea.zpp_pool=a,a=c),c=!0,null==a){c=!1;this.vertices=null;break}}while(c);return null==this.vertices},add_diagonal:function(a,b){a.diagonals.add(b);
b.diagonals.add(a);a.forced=b.forced=!0},extract_partitions:function(a){null==a&&(a=new vd);if(null!=this.vertices){var b=this.vertices,c=this.vertices;if(null!=b){do b.sort(),b=b.next;while(b!=c)}for(this.pull_partitions(this.vertices,a);null!=this.vertices;)null!=this.vertices&&this.vertices.prev==this.vertices?(this.vertices.next=this.vertices.prev=null,c=this.vertices,c.helper=null,null,c.next=ea.zpp_pool,ea.zpp_pool=c,this.vertices=this.vertices=null):(c=this.vertices.next,this.vertices.prev.next=
this.vertices.next,this.vertices.next.prev=this.vertices.prev,this.vertices.next=this.vertices.prev=null,b=this.vertices,b.helper=null,null,b.next=ea.zpp_pool,ea.zpp_pool=b,this.vertices=null,this.vertices=c);c=null;for(b=a.head;null!=b;)b.elt.remove_collinear_vertices()?a.erase(c):(c=b,b=b.next)}return a},pull_partitions:function(a,b){var c;null==Y.zpp_pool?c=new Y:(c=Y.zpp_pool,Y.zpp_pool=c.next,c.next=null);null;var d=a;do{var e=d.copy();null==c.vertices?c.vertices=e.prev=e.next=e:(e.prev=c.vertices,
e.next=c.vertices.next,c.vertices.next.prev=e,c.vertices.next=e);c.vertices=e;c.vertices.forced=d.forced;if(null!=d.diagonals.head)if(d.diagonals.inlined_pop_unsafe()==a)break;else d=this.pull_partitions(d,b);else d=d.next}while(d!=a);var e=0,h=c.vertices,f=c.vertices;if(null!=h){do var g=h,e=e+g.x*(g.next.y-g.prev.y),h=h.next;while(h!=f)}0!=.5*e&&b.add(c);return d},extract:function(a){null==a&&(a=new ud);if(null!=this.vertices){var b=this.vertices,c=this.vertices;if(null!=b){do b.sort(),b=b.next;
while(b!=c)}for(this.pull(this.vertices,a);null!=this.vertices;)null!=this.vertices&&this.vertices.prev==this.vertices?(this.vertices.next=this.vertices.prev=null,c=this.vertices,c.helper=null,null,c.next=ea.zpp_pool,ea.zpp_pool=c,this.vertices=this.vertices=null):(c=this.vertices.next,this.vertices.prev.next=this.vertices.next,this.vertices.next.prev=this.vertices.prev,this.vertices.next=this.vertices.prev=null,b=this.vertices,b.helper=null,null,b.next=ea.zpp_pool,ea.zpp_pool=b,this.vertices=null,
this.vertices=c)}return a},pull:function(a,b){var c=null,d=a;do{var e=y.get(d.x,d.y);null==c?e.prev=e.next=e:(e.prev=c,e.next=c.next,c.next.prev=e,c.next=e);c=e;c.forced=d.forced;if(null!=d.diagonals.head)if(d.diagonals.inlined_pop_unsafe()==a)break;else d=this.pull(d,b);else d=d.next}while(d!=a);var e=0,h=c,f=c;if(null!=h){do var g=h,e=e+g.x*(g.next.y-g.prev.y),h=h.next;while(h!=f)}e*=.5;if(e*e>=u.epsilon*u.epsilon){e=c;for(f=!0;f||e!=c;)if(f=!1,eb.vec_dsq(e.x,e.y,e.next.x,e.next.y)<u.epsilon*u.epsilon){if(e==
c&&(c=e.next,f=!0),e.forced&&(e.next.forced=!0),null!=e&&e.prev==e?e=e=e.next=e.prev=null:(h=e.next,e.prev.next=e.next,e.next.prev=e.prev,e.next=e.prev=null,e=h),null==e){c=null;break}}else e=e.next;if(null!=c){do for(h=!1,e=c,f=!0;f||e!=c;){var f=!1,k=e.prev,l=g=0,g=e.x-k.x,l=e.y-k.y,n=k=0,k=e.next.x-e.x,n=e.next.y-e.y,g=n*g-k*l;if(g*g>=u.epsilon*u.epsilon)e=e.next;else if(e==c&&(c=e.next,f=!0),null!=e&&e.prev==e?e=e=e.next=e.prev=null:(h=e.next,e.prev.next=e.next,e.next.prev=e.prev,e.next=e.prev=
null,e=h),h=!0,null==e){h=!1;c=null;break}}while(h)}null==c||b.add(c)}return d},__class__:Y};var M=function(){this.next=this.node=null;this.id=0;this.links=null;this.x=this.y=0;this.forced=!1;this.id=na.ZPP_SimpleVert();null==Z.zpp_pool?this.links=new Z:(this.links=Z.zpp_pool,Z.zpp_pool=this.links.next,this.links.next=null);null;this.links.lt=M.less_xy};M.__name__=!0;M.less_xy=function(a,b){return a.y<b.y||a.y==b.y&&a.x<b.x};M.swap_nodes=function(a,b){var c=a.node;a.node=b.node;b.node=c};M.get=function(a,
b){var c;null==M.zpp_pool?c=new M:(c=M.zpp_pool,M.zpp_pool=c.next,c.next=null);null;c.x=a;c.y=b;return c};M.prototype={free:function(){this.links.clear();this.node=null;this.forced=!1},alloc:function(){},__class__:M};var Nb=function(){this.next=this.prev=this.node=null;this.id=0;this.left=this.right=this.vertices=null;this.id=na.ZPP_SimpleSeg();null==Z.zpp_pool?this.vertices=new Z:(this.vertices=Z.zpp_pool,Z.zpp_pool=this.vertices.next,this.vertices.next=null);null;this.vertices.lt=w(this,this.less_xy)};
Nb.__name__=!0;Nb.get=function(a,b){var c;null==Nb.zpp_pool?c=new Nb:(c=Nb.zpp_pool,Nb.zpp_pool=c.next,c.next=null);null;c.left=a;c.right=b;c.vertices.insert(a);c.vertices.insert(b);return c};Nb.prototype={free:function(){this.node=this.prev=this.left=this.right=null;this.vertices.clear()},alloc:function(){},less_xy:function(a,b){return a.x<b.x||a.x==b.x&&a.y<b.y},__class__:Nb};var Q=function(){this.vertex=this.segment=this.segment2=this.node=this.next=null;this.type=0};Q.__name__=!0;Q.swap_nodes=
function(a,b){var c=a.node;a.node=b.node;b.node=c};Q.less_xy=function(a,b){return a.vertex.x<b.vertex.x?!0:a.vertex.x>b.vertex.x?!1:a.vertex.y<b.vertex.y?!0:a.vertex.y>b.vertex.y?!1:a.type<b.type};Q.get=function(a){var b;null==Q.zpp_pool?b=new Q:(b=Q.zpp_pool,Q.zpp_pool=b.next,b.next=null);null;b.vertex=a;return b};Q.prototype={free:function(){this.node=this.segment=this.segment2=this.vertex=null},alloc:function(){},__class__:Q};var Ye=function(){this.tree=null;this.sweepx=0;null==ha.zpp_pool?this.tree=
new ha:(this.tree=ha.zpp_pool,ha.zpp_pool=this.tree.next,this.tree.next=null);null;this.tree.lt=w(this,this.edge_lt);this.tree.swapped=w(this,this.swap_nodes)};Ye.__name__=!0;Ye.prototype={swap_nodes:function(a,b){var c=a.node;a.node=b.node;b.node=c},edge_lt:function(a,b){var c=0,d=0,e=0,h=0,f;if(a.left==b.left&&a.right==b.right)return!1;if(a.left==b.right)return a.left.x==a.right.x?c=a.left.y<a.right.y?a.left.y>b.left.y:a.right.y>b.left.y:(f=a.right.x<a.left.x,c=a.right.x-a.left.x,d=a.right.y-a.left.y,
e=b.left.x-a.left.x,h=b.left.y-a.left.y,c=0>(f?d*e-c*h:h*c-e*d)),c;if(a.right==b.left)return b.left.x==b.right.x?c=b.left.y<b.right.y?b.left.y>a.left.y:b.right.y>a.left.y:(f=b.right.x<b.left.x,c=b.right.x-b.left.x,d=b.right.y-b.left.y,e=a.left.x-b.left.x,h=a.left.y-b.left.y,c=0>(f?d*e-c*h:h*c-e*d)),!c;if(a.left==b.left)return a.left.x==a.right.x?c=a.left.y<a.right.y?a.left.y>b.right.y:a.right.y>b.right.y:(f=a.right.x<a.left.x,c=a.right.x-a.left.x,d=a.right.y-a.left.y,e=b.right.x-a.left.x,h=b.right.y-
a.left.y,c=0>(f?d*e-c*h:h*c-e*d)),c;if(a.right==b.right)return a.left.x==a.right.x?c=a.left.y<a.right.y?a.left.y>b.left.y:a.right.y>b.left.y:(f=a.right.x<a.left.x,c=a.right.x-a.left.x,d=a.right.y-a.left.y,e=b.left.x-a.left.x,h=b.left.y-a.left.y,c=0>(f?d*e-c*h:h*c-e*d)),c;if(a.left.x==a.right.x){if(b.left.x==b.right.x)return(a.left.y<a.right.y?a.right:a.left).y>(b.left.y<b.right.y?b.right:b.left).y;var g;f=b.right.x<b.left.x;c=b.right.x-b.left.x;d=b.right.y-b.left.y;e=a.left.x-b.left.x;h=a.left.y-
b.left.y;g=f?d*e-c*h:h*c-e*d;f=b.right.x<b.left.x;c=b.right.x-b.left.x;d=b.right.y-b.left.y;e=a.right.x-b.left.x;h=a.right.y-b.left.y;return 0<=g*(f?d*e-c*h:h*c-e*d)?0<=g:this.sweepx>=a.left.x}if(b.left.x==b.right.x)return f=a.right.x<a.left.x,c=a.right.x-a.left.x,d=a.right.y-a.left.y,e=b.left.x-a.left.x,h=b.left.y-a.left.y,g=f?d*e-c*h:h*c-e*d,f=a.right.x<a.left.x,c=a.right.x-a.left.x,d=a.right.y-a.left.y,e=b.right.x-a.left.x,h=b.right.y-a.left.y,0<=g*(f?d*e-c*h:h*c-e*d)?0>g:this.sweepx<b.left.x;
f=a.right.x<a.left.x;c=a.right.x-a.left.x;d=a.right.y-a.left.y;e=b.left.x-a.left.x;h=b.left.y-a.left.y;g=0>(f?d*e-c*h:h*c-e*d);f=a.right.x<a.left.x;c=a.right.x-a.left.x;d=a.right.y-a.left.y;e=b.right.x-a.left.x;h=b.right.y-a.left.y;if(g==0>(f?d*e-c*h:h*c-e*d))return g;f=b.right.x<b.left.x;c=b.right.x-b.left.x;d=b.right.y-b.left.y;e=a.left.x-b.left.x;h=a.left.y-b.left.y;g=0<=(f?d*e-c*h:h*c-e*d);f=b.right.x<b.left.x;c=b.right.x-b.left.x;d=b.right.y-b.left.y;e=a.right.x-b.left.x;h=a.right.y-b.left.y;
return g==0<=(f?d*e-c*h:h*c-e*d)?g:(this.sweepx-a.left.x)/(a.right.x-a.left.x)*(a.right.y-a.left.y)+a.left.y>(this.sweepx-b.left.x)/(b.right.x-b.left.x)*(b.right.y-b.left.y)+b.left.y},clear:function(){this.tree.clear()},add:function(a){a.node=this.tree.insert(a);var b=this.tree.successor_node(a.node),c=this.tree.predecessor_node(a.node);null!=b&&(a.next=b.data,b.data.prev=a);null!=c&&(a.prev=c.data,c.data.next=a);return a},remove:function(a){var b=this.tree.successor_node(a.node),c=this.tree.predecessor_node(a.node);
null!=b&&(b.data.prev=a.prev);null!=c&&(c.data.next=a.next);this.tree.remove_node(a.node);a.node=null},intersect:function(a,b){return null==a||null==b||a.left==b.left||a.left==b.right||a.right==b.left||a.right==b.right||0<((b.left.x-a.left.x)*(a.right.y-a.left.y)-(a.right.x-a.left.x)*(b.left.y-a.left.y))*((b.right.x-a.left.x)*(a.right.y-a.left.y)-(a.right.x-a.left.x)*(b.right.y-a.left.y))?!1:0<((a.left.x-b.left.x)*(b.right.y-b.left.y)-(b.right.x-b.left.x)*(a.left.y-b.left.y))*((a.right.x-b.left.x)*
(b.right.y-b.left.y)-(b.right.x-b.left.x)*(a.right.y-b.left.y))?!1:!0},intersection:function(a,b){if(null==a||null==b||a.left==b.left||a.left==b.right||a.right==b.left||a.right==b.right)return null;var c=0,d=0,c=a.right.x-a.left.x,d=a.right.y-a.left.y,e=0,h=0,e=b.right.x-b.left.x,h=b.right.y-b.left.y,g=h*c-e*d;if(0==g)return null;var g=1/g,q=0,k=0,q=b.left.x-a.left.x,k=b.left.y-a.left.y,l=(h*q-e*k)*g;if(0>l||1<l)return null;g*=d*q-c*k;if(0>g||1<g)return null;if(0==g||1==g||0==l||1==l){c=0==g;if(1==
g&&c)throw new f("corner case 1a");1==g&&(c=!0);if(0==l&&c)throw new f("corner case 1b");0==l&&(c=!0);if(1==l&&c)throw new f("corner case 1c");l=0==g?b.left:1==g?b.right:0==l?a.left:a.right}else l=M.get(.5*(a.left.x+c*l+b.left.x+e*g),.5*(a.left.y+d*l+b.left.y+h*g));l=Q.get(l);l.type=0;l.segment=a;l.segment2=b;return l},__class__:Ye};var A=function(){};A.__name__=!0;A.decompose=function(a,b){null==A.sweep&&(A.sweep=new Ye,A.inthash=new Ze);null==A.vertices&&(null==Z.zpp_pool?A.vertices=new Z:(A.vertices=
Z.zpp_pool,Z.zpp_pool=A.vertices.next,A.vertices.next=null),null,A.vertices.lt=M.less_xy,A.vertices.swapped=M.swap_nodes);null==A.queue&&(null==R.zpp_pool?A.queue=new R:(A.queue=R.zpp_pool,R.zpp_pool=A.queue.next,A.queue.next=null),null,A.queue.lt=Q.less_xy,A.queue.swapped=Q.swap_nodes);var c=null,d=null;if(null!=a){var e=a;do{var h=e,h=M.get(h.x,h.y),g;for(g=A.vertices.parent;null!=g;)if(A.vertices.lt(h,g.data))g=g.prev;else if(A.vertices.lt(g.data,h))g=g.next;else break;null!=g?(h.links.clear(),
h.node=null,h.forced=!1,h.next=M.zpp_pool,M.zpp_pool=h,h=g.data):h.node=A.vertices.insert(h);if(null!=d){g=Q.get(d);var q=Q.get(h),k;Q.less_xy(g,q)?(g.type=1,q.type=2,k=Nb.get(d,h)):(g.type=2,q.type=1,k=Nb.get(h,d));g.segment=q.segment=k;A.queue.insert(g);A.queue.insert(q);d.links.insert(h);h.links.insert(d)}d=h;null==c&&(c=h);e=e.next}while(e!=a)}e=Q.get(d);h=Q.get(c);Q.less_xy(e,h)?(e.type=1,h.type=2,g=Nb.get(d,c)):(e.type=2,h.type=1,g=Nb.get(c,d));e.segment=h.segment=g;A.queue.insert(e);A.queue.insert(h);
d.links.insert(c);c.links.insert(d);null==A.ints&&(null==R.zpp_pool?A.ints=new R:(A.ints=R.zpp_pool,R.zpp_pool=A.ints.next,A.ints.next=null),null,A.ints.lt=Q.less_xy);for(;!A.queue.empty();){c=A.queue.pop_front();A.sweep.sweepx=c.vertex.x;if(1==c.type){d=c.segment;A.sweep.add(d);if(null!=d.next&&null!=d&&(d.next.id<d.id?!A.inthash.has(d.next.id,d.id):!A.inthash.has(d.id,d.next.id))&&(e=A.sweep.intersection(d.next,d),null!=e))if(e.vertex.x>=A.sweep.sweepx){for(h=A.queue.parent;null!=h;)if(A.queue.lt(e,
h.data))h=h.prev;else if(A.queue.lt(h.data,e))h=h.next;else break;if(null==h){for(h=A.ints.parent;null!=h;)if(A.ints.lt(e,h.data))h=h.prev;else if(A.ints.lt(h.data,e))h=h.next;else break;null!=h?(g=e.vertex,g.links.clear(),g.node=null,g.forced=!1,g.next=M.zpp_pool,M.zpp_pool=g,e.vertex=h.data.vertex,h.data=e,A.queue.insert(e)):(A.queue.insert(e),A.ints.insert(e));d.next.id<d.id?A.inthash.add(ya.get(d.next.id,d.id,!0)):A.inthash.add(ya.get(d.id,d.next.id,!0))}else{h=h.data;if(h.segment!=e.segment||
e.segment2!=h.segment2)throw new f("corner case 2, shiiiit.");h=e.vertex;h.links.clear();h.node=null;h.forced=!1;h.next=M.zpp_pool;M.zpp_pool=h;e.vertex=null;e.segment=e.segment2=null;e.node=null;e.next=Q.zpp_pool;Q.zpp_pool=e}}else h=e.vertex,h.links.clear(),h.node=null,h.forced=!1,h.next=M.zpp_pool,M.zpp_pool=h,e.vertex=null,e.segment=e.segment2=null,e.node=null,e.next=Q.zpp_pool,Q.zpp_pool=e;if(null!=d&&null!=d.prev&&(d.id<d.prev.id?!A.inthash.has(d.id,d.prev.id):!A.inthash.has(d.prev.id,d.id))&&
(e=A.sweep.intersection(d,d.prev),null!=e))if(e.vertex.x>=A.sweep.sweepx){for(h=A.queue.parent;null!=h;)if(A.queue.lt(e,h.data))h=h.prev;else if(A.queue.lt(h.data,e))h=h.next;else break;if(null==h){for(h=A.ints.parent;null!=h;)if(A.ints.lt(e,h.data))h=h.prev;else if(A.ints.lt(h.data,e))h=h.next;else break;null!=h?(g=e.vertex,g.links.clear(),g.node=null,g.forced=!1,g.next=M.zpp_pool,M.zpp_pool=g,e.vertex=h.data.vertex,h.data=e,A.queue.insert(e)):(A.queue.insert(e),A.ints.insert(e));d.id<d.prev.id?
A.inthash.add(ya.get(d.id,d.prev.id,!0)):A.inthash.add(ya.get(d.prev.id,d.id,!0))}else{d=h.data;if(d.segment!=e.segment||e.segment2!=d.segment2)throw new f("corner case 2, shiiiit.");d=e.vertex;d.links.clear();d.node=null;d.forced=!1;d.next=M.zpp_pool;M.zpp_pool=d;d=e;d.vertex=null;d.segment=d.segment2=null;d.node=null;d.next=Q.zpp_pool;Q.zpp_pool=d}}else d=e.vertex,d.links.clear(),d.node=null,d.forced=!1,d.next=M.zpp_pool,M.zpp_pool=d,d=e,d.vertex=null,d.segment=d.segment2=null,d.node=null,d.next=
Q.zpp_pool,Q.zpp_pool=d}else if(2==c.type){if(d=c.segment,null!=d.node&&(e=d.next,h=d.prev,A.sweep.remove(d),d.left=d.right=null,d.prev=null,d.node=null,d.vertices.clear(),d.next=Nb.zpp_pool,Nb.zpp_pool=d,null!=e&&null!=h&&(e.id<h.id?!A.inthash.has(e.id,h.id):!A.inthash.has(h.id,e.id))&&(d=A.sweep.intersection(e,h),null!=d)))if(d.vertex.x>=A.sweep.sweepx){for(g=A.queue.parent;null!=g;)if(A.queue.lt(d,g.data))g=g.prev;else if(A.queue.lt(g.data,d))g=g.next;else break;if(null==g){for(g=A.ints.parent;null!=
g;)if(A.ints.lt(d,g.data))g=g.prev;else if(A.ints.lt(g.data,d))g=g.next;else break;null!=g?(q=d.vertex,q.links.clear(),q.node=null,q.forced=!1,q.next=M.zpp_pool,M.zpp_pool=q,d.vertex=g.data.vertex,g.data=d,A.queue.insert(d)):(A.queue.insert(d),A.ints.insert(d));e.id<h.id?A.inthash.add(ya.get(e.id,h.id,!0)):A.inthash.add(ya.get(h.id,e.id,!0))}else{e=g.data;if(e.segment!=d.segment||d.segment2!=e.segment2)throw new f("corner case 2, shiiiit.");e=d.vertex;e.links.clear();e.node=null;e.forced=!1;e.next=
M.zpp_pool;M.zpp_pool=e;d.vertex=null;d.segment=d.segment2=null;d.node=null;d.next=Q.zpp_pool;Q.zpp_pool=d}}else e=d.vertex,e.links.clear(),e.node=null,e.forced=!1,e.next=M.zpp_pool,M.zpp_pool=e,d.vertex=null,d.segment=d.segment2=null,d.node=null,d.next=Q.zpp_pool,Q.zpp_pool=d}else{var l=c.vertex,d=null==l.node,n=c.segment,r=c.segment2;r.next!=n&&(e=n,n=r,r=e);h=null==function(a){for(a=n.vertices.parent;null!=a;)if(n.vertices.lt(l,a.data))a=a.prev;else if(n.vertices.lt(a.data,l))a=a.next;else break;
return a}(this);e=null==function(a){for(a=r.vertices.parent;null!=a;)if(r.vertices.lt(l,a.data))a=a.prev;else if(r.vertices.lt(a.data,l))a=a.next;else break;return a}(this);h&&(g=n.vertices.insert(l),h=l==n.left?l:n.vertices.predecessor_node(g).data,g=l==n.right?l:n.vertices.successor_node(g).data,h.links.remove(g),l!=h&&h.links.insert(l),g.links.remove(h),l!=g&&g.links.insert(l),l!=h&&l.links.insert(h),l!=g&&l.links.insert(g));e&&(h=r.vertices.insert(l),e=l==r.left?l:r.vertices.predecessor_node(h).data,
h=l==r.right?l:r.vertices.successor_node(h).data,e.links.remove(h),l!=e&&e.links.insert(l),h.links.remove(e),l!=h&&h.links.insert(l),l!=e&&l.links.insert(e),l!=h&&l.links.insert(h));d&&(l.node=A.vertices.insert(l));l.forced=!0;d&&(d=n.node,e=r.node,d.data=r,e.data=n,n.node=e,r.node=d,r.next=n.next,n.next=r,n.prev=r.prev,r.prev=n,null!=n.prev&&(n.prev.next=n),null!=r.next&&(r.next.prev=r));if(null!=r.next&&null!=r&&(r.next.id<r.id?!A.inthash.has(r.next.id,r.id):!A.inthash.has(r.id,r.next.id))&&(d=
A.sweep.intersection(r.next,r),null!=d))if(d.vertex.x>=A.sweep.sweepx){for(e=A.queue.parent;null!=e;)if(A.queue.lt(d,e.data))e=e.prev;else if(A.queue.lt(e.data,d))e=e.next;else break;if(null==e){for(e=A.ints.parent;null!=e;)if(A.ints.lt(d,e.data))e=e.prev;else if(A.ints.lt(e.data,d))e=e.next;else break;null!=e?(h=d.vertex,h.links.clear(),h.node=null,h.forced=!1,h.next=M.zpp_pool,M.zpp_pool=h,d.vertex=e.data.vertex,e.data=d,A.queue.insert(d)):(A.queue.insert(d),A.ints.insert(d));r.next.id<r.id?A.inthash.add(ya.get(r.next.id,
r.id,!0)):A.inthash.add(ya.get(r.id,r.next.id,!0))}else{e=e.data;if(e.segment!=d.segment||d.segment2!=e.segment2)throw new f("corner case 2, shiiiit.");e=d.vertex;e.links.clear();e.node=null;e.forced=!1;e.next=M.zpp_pool;M.zpp_pool=e;d.vertex=null;d.segment=d.segment2=null;d.node=null;d.next=Q.zpp_pool;Q.zpp_pool=d}}else e=d.vertex,e.links.clear(),e.node=null,e.forced=!1,e.next=M.zpp_pool,M.zpp_pool=e,d.vertex=null,d.segment=d.segment2=null,d.node=null,d.next=Q.zpp_pool,Q.zpp_pool=d;if(null!=n&&null!=
n.prev&&(n.id<n.prev.id?!A.inthash.has(n.id,n.prev.id):!A.inthash.has(n.prev.id,n.id))&&(d=A.sweep.intersection(n,n.prev),null!=d))if(d.vertex.x>=A.sweep.sweepx){for(e=A.queue.parent;null!=e;)if(A.queue.lt(d,e.data))e=e.prev;else if(A.queue.lt(e.data,d))e=e.next;else break;if(null==e){for(e=A.ints.parent;null!=e;)if(A.ints.lt(d,e.data))e=e.prev;else if(A.ints.lt(e.data,d))e=e.next;else break;null!=e?(h=d.vertex,h.links.clear(),h.node=null,h.forced=!1,h.next=M.zpp_pool,M.zpp_pool=h,d.vertex=e.data.vertex,
e.data=d,A.queue.insert(d)):(A.queue.insert(d),A.ints.insert(d));n.id<n.prev.id?A.inthash.add(ya.get(n.id,n.prev.id,!0)):A.inthash.add(ya.get(n.prev.id,n.id,!0))}else{e=e.data;if(e.segment!=d.segment||d.segment2!=e.segment2)throw new f("corner case 2, shiiiit.");e=d.vertex;e.links.clear();e.node=null;e.forced=!1;e.next=M.zpp_pool;M.zpp_pool=e;d.vertex=null;d.segment=d.segment2=null;d.node=null;d.next=Q.zpp_pool;Q.zpp_pool=d}}else e=d.vertex,e.links.clear(),e.node=null,e.forced=!1,e.next=M.zpp_pool,
M.zpp_pool=e,d.vertex=null,d.segment=d.segment2=null,d.node=null,d.next=Q.zpp_pool,Q.zpp_pool=d;A.ints.remove(c)}c.vertex=null;c.segment=c.segment2=null;c.node=null;c.next=Q.zpp_pool;Q.zpp_pool=c}c=0;for(d=A.inthash.table.length;c<d;)if(e=c++,g=A.inthash.table[e],null!=g){for(;null!=g;)h=g.hnext,g.hnext=null,g.next=ya.zpp_pool,ya.zpp_pool=g,g=h;A.inthash.table[e]=null}for(null==b&&(b=new ud);!A.vertices.empty();)A.clip_polygon(A.vertices,b);return b};A.clip_polygon=function(a,b){var c=null,d=a.first(),
e=d,h=d.links.parent,f=h.data,h=(null==h.prev?h.next:h.prev).data,g=0,k=0,g=d.x-f.x,k=d.y-f.y,l=0,n=0,l=h.x-d.x,n=h.y-d.y;0>n*g-l*k&&(h=f);f=y.get(d.x,d.y);null==c?f.prev=f.next=f:(f.prev=c,f.next=c.next,c.next.prev=f,c.next=f);c=f;for(c.forced=d.forced;;){d.links.remove(h);h.links.remove(d);if(h==e){d.links.empty()&&(a.remove(d),h=d,h.links.clear(),h.node=null,h.forced=!1,h.next=M.zpp_pool,M.zpp_pool=h);break}f=y.get(h.x,h.y);null==c?f.prev=f.next=f:(f.prev=c,f.next=c.next,c.next.prev=f,c.next=f);
c=f;c.forced=h.forced;if(h.links.singular())d.links.empty()&&(a.remove(d),d.links.clear(),d.node=null,d.forced=!1,d.next=M.zpp_pool,M.zpp_pool=d),d=h,h=h.links.parent.data;else{f=null;l=0;if(!h.links.empty()){for(g=h.links.parent;null!=g.prev;)g=g.prev;for(;null!=g;){k=g.data;if(null==f)var f=k,n=l=0,l=h.x-d.x,n=h.y-d.y,r=0,z=0,r=k.x-h.x,z=k.y-h.y,l=z*l-r*n;else{var r=n=0,n=h.x-d.x,r=h.y-d.y,u=z=0,z=k.x-h.x,u=k.y-h.y,n=u*n-z*r;if(0<n&&0>=l)f=k,l=n;else if(0<=l*n){var z=r=0,r=h.x-k.x,z=h.y-k.y,p=u=
0,u=f.x-h.x,p=f.y-h.y;0<p*r-u*z&&(f=k,l=n)}}if(null!=g.next)for(g=g.next;null!=g.prev;)g=g.prev;else{for(;null!=g.parent&&g==g.parent.next;)g=g.parent;g=g.parent}}}d.links.empty()&&(a.remove(d),d.links.clear(),d.node=null,d.forced=!1,d.next=M.zpp_pool,M.zpp_pool=d);d=h;h=f}}a.remove(e);e.links.clear();e.node=null;e.forced=!1;e.next=M.zpp_pool;M.zpp_pool=e;b.add(c)};A.isSimple=function(a){null==A.sweep&&(A.sweep=new Ye,A.inthash=new Ze);var b=A.list_vertices;null==b&&(b=A.list_vertices=new Cf);if(null!=
a){var c=a;do{var d=c;b.add(M.get(d.x,d.y));c=c.next}while(c!=a)}a=A.list_queue;null==a&&(a=A.list_queue=new Df);d=b.head;c=d.elt;for(d=d.next;null!=d;){var e=d.elt,h=a.add(Q.get(c)),f=a.add(Q.get(e)),g=h;Q.less_xy(h,f)?(h.type=1,f.type=2,c=f.segment=Nb.get(c,e)):(h.type=2,f.type=1,c=f.segment=Nb.get(e,c));g.segment=c;c=e;d=d.next}e=b.head.elt;d=a.add(Q.get(c));g=a.add(Q.get(e));Q.less_xy(d,g)?(d.type=1,g.type=2,c=g.segment=Nb.get(c,e)):(d.type=2,g.type=1,c=g.segment=Nb.get(e,c));d.segment=c;c=a;
if(null!=c.head&&null!=c.head.next){var d=c.head,f=h=g=e=null,k=1,l,n,r;do{l=0;g=d;for(e=d=null;null!=g;){l++;h=g;n=0;for(r=k;null!=h&&n<k;)n++,h=h.next;for(;0<n||0<r&&null!=h;)0==n?(f=h,h=h.next,r--):0==r||null==h?(f=g,g=g.next,n--):Q.less_xy(g.elt,h.elt)?(f=g,g=g.next,n--):(f=h,h=h.next,r--),null!=e?e.next=f:d=f,e=f;g=h}e.next=null;k<<=1}while(1<l);c.head=d;c.modified=!0;c.pushmod=!0}for(c=!0;null!=a.head;){d=a.pop_unsafe();e=d.segment;if(1==d.type){if(A.sweep.add(e),A.sweep.intersect(e,e.next)||
A.sweep.intersect(e,e.prev)){c=!1;break}}else if(2==d.type){if(A.sweep.intersect(e.prev,e.next)){c=!1;break}A.sweep.remove(e);e.left=e.right=null;e.prev=null;e.node=null;e.vertices.clear();e.next=Nb.zpp_pool;Nb.zpp_pool=e}d.vertex=null;d.segment=d.segment2=null;d.node=null;d.next=Q.zpp_pool;Q.zpp_pool=d}for(;null!=a.head;)d=a.pop_unsafe(),2==d.type&&(e=d.segment,e.left=e.right=null,e.prev=null,e.node=null,e.vertices.clear(),e.next=Nb.zpp_pool,Nb.zpp_pool=e),d.vertex=null,d.segment=d.segment2=null,
d.node=null,d.next=Q.zpp_pool,Q.zpp_pool=d;for(A.sweep.clear();null!=b.head;)a=b.pop_unsafe(),a.links.clear(),a.node=null,a.forced=!1,a.next=M.zpp_pool,M.zpp_pool=a;return c};var fd=function(){this.flag=this.forced=!1;this.next=this.prev=null;this.x=this.y=0};fd.__name__=!0;fd.get=function(a){var b;null==fd.zpp_pool?b=new fd:(b=fd.zpp_pool,fd.zpp_pool=b.next,b.next=null);null;b.x=a.x;b.y=a.y;b.flag=!1;return b};fd.prototype={free:function(){},alloc:function(){},__class__:fd};var fb=function(){this.next=
this.min=this.max=null};fb.__name__=!0;fb.get=function(a,b){var c;null==fb.zpp_pool?c=new fb:(c=fb.zpp_pool,fb.zpp_pool=c.next,c.next=null);null;c.min=a;c.max=b;return c};fb.prototype={free:function(){this.min=this.max=null},alloc:function(){},__class__:fb};var xb=function(){};xb.__name__=!0;xb.lessval=function(a,b){return a.x-b.x+(a.y-b.y)};xb.less=function(a,b){return 0>a.x-b.x+(a.y-b.y)};xb.distance=function(a,b,c){var d=0,e=0,d=c.x-b.x,e=c.y-b.y,h=0,f=0,h=a.x-b.x,f=a.y-b.y;if(0==d*d+e*e)return h*
h+f*f;b=(h*d+f*e)/(d*d+e*e);if(0>=b)return h*h+f*f;if(1<=b)return eb.vec_dsq(a.x,a.y,c.x,c.y);h-=d*b;f-=e*b;return h*h+f*f};xb.simplify=function(a,b){var c=null,d=null,e=null;b*=b;null==xb.stack&&(xb.stack=new Ef);var h=null,f=null,g=a;do{var k=fd.get(g);k.forced=g.forced;k.forced&&(k.flag=!0,null!=h?xb.stack.add(fb.get(h,k)):f=k,h=k);null==c?k.prev=k.next=k:(k.prev=c,k.next=c.next,c.next.prev=k,c.next=k);c=k;null==d?e=d=c:(0>c.x-d.x+(c.y-d.y)&&(d=c),0>e.x-c.x+(e.y-c.y)&&(e=c));g=g.next}while(g!=
a);null==xb.stack.head?null==f?(d.flag=e.flag=!0,xb.stack.add(fb.get(d,e)),xb.stack.add(fb.get(e,d))):(h=d.x-f.x+(d.y-f.y),0>h&&(h=-h),g=e.x-f.x+(e.y-f.y),0>g&&(g=-g),h>g?(d.flag=f.flag=!0,xb.stack.add(fb.get(d,f)),xb.stack.add(fb.get(f,d))):(e.flag=f.flag=!0,xb.stack.add(fb.get(e,f)),xb.stack.add(fb.get(f,e)))):xb.stack.add(fb.get(h,f));for(;null!=xb.stack.head;){f=xb.stack.pop_unsafe();d=f.min;e=f.max;f.min=f.max=null;f.next=fb.zpp_pool;fb.zpp_pool=f;f=b;h=null;for(g=d.next;g!=e;)k=xb.distance(g,
d,e),k>f&&(f=k,h=g),g=g.next;null!=h&&(h.flag=!0,xb.stack.add(fb.get(d,h)),xb.stack.add(fb.get(h,e)))}for(d=null;null!=c;)c.flag&&(e=y.get(c.x,c.y),null==d?e.prev=e.next=e:(e.prev=d,e.next=d.next,d.next.prev=e,d.next=e),d=e,d.forced=c.forced),null!=c&&c.prev==c?(c.next=c.prev=null,c.next=fd.zpp_pool,fd.zpp_pool=c,c=c=null):(e=c.next,c.prev.next=c.next,c.next.prev=c.prev,c.next=c.prev=null,c.next=fd.zpp_pool,fd.zpp_pool=c,c=e);return d};var wa=function(){this.slipped=this.failed=this.kinematic=!1;
this.c1=this.c2=this.axis=null;this.frozen1=this.frozen2=!1;this.s1=this.s2=this.arbiter=null;this.toi=0;this.next=null;this.c1=new P;this.c2=new P;this.axis=new P};wa.__name__=!0;wa.prototype={alloc:function(){this.failed=!1;this.arbiter=this.s1=this.s2=null},free:function(){},__class__:wa};var Pa=function(){};Pa.__name__=!0;Pa.dynamicSweep=function(a,b,c,d,e){null==e&&(e=!1);var h=a.s1,f=a.s2,g=h.body,k=f.body,l=0,n=0,l=k.velx-g.velx,n=k.vely-g.vely,r=g.angvel;0>r&&(r=-r);var z=k.angvel;0>z&&(z=
-z);var x=h.sweepCoef*r+f.sweepCoef*z;if(!e&&!a.kinematic&&l*l+n*n<u.dynamicSweepLinearThreshold*u.dynamicSweepLinearThreshold&&x<u.dynamicSweepAngularThreshold)a.toi=-1,a.failed=!0;else{for(var p=a.c1,r=a.c2,z=a.axis,w=0;;){g.sweepIntegrate(c*b);g.sweepValidate(h);k.sweepIntegrate(c*b);k.sweepValidate(f);var y=Pa.distance(h,f,p,r,z,null)+d,A=l*z.x+n*z.y;if(y<u.distanceThresholdCCD){if(e)break;var v=0,C=0,v=p.x-g.posx,C=p.y-g.posy,B=0,m=0,B=r.x-k.posx,m=r.y-k.posy,v=A-g.sweep_angvel*(z.y*v-z.x*C)+
k.sweep_angvel*(z.y*B-z.x*m);0<v&&(a.slipped=!0);if(0>=v||y<.5*u.distanceThresholdCCD)break}A=(x-A)*b;if(0>=A){c=-1;break}A=y/A;1E-6>A&&(A=1E-6);c+=A;if(1<=c){c=1;g.sweepIntegrate(c*b);g.sweepValidate(h);k.sweepIntegrate(c*b);k.sweepValidate(f);b=Pa.distance(h,f,p,r,z,null)+d;l=l*z.x+n*z.y;if(b<u.distanceThresholdCCD){if(e)break;n=e=0;e=p.x-g.posx;n=p.y-g.posy;d=p=0;p=r.x-k.posx;d=r.y-k.posy;g=l-g.sweep_angvel*(z.y*e-z.x*n)+k.sweep_angvel*(z.y*p-z.x*d);0<g&&(a.slipped=!0);if(0>=g||b<.5*u.distanceThresholdCCD)break}c=
-1;break}if(40<=++w){y>d&&(a.failed=!0);break}}a.toi=c}};Pa.staticSweep=function(a,b,c,d){var e=a.s1,h=a.s2,f=e.body,g=0,k=0,g=-f.velx,k=-f.vely,l=f.sweep_angvel;0>l&&(l=-l);for(var n=e.sweepCoef*l,l=a.c1,r=a.c2,z=a.axis,x=0;;){f.sweepIntegrate(c*b);f.sweepValidate(e);var p=Pa.distance(e,h,l,r,z,null)+d,w=g*z.x+k*z.y;if(p<u.distanceThresholdCCD){var y=0,A=0,y=l.x-f.posx,A=l.y-f.posy,y=w-f.sweep_angvel*(z.y*y-z.x*A);0<y&&(a.slipped=!0);if(0>=y||p<.5*u.distanceThresholdCCD)break}w=(n-w)*b;if(0>=w){c=
-1;break}w=p/w;1E-6>w&&(w=1E-6);c+=w;if(1<=c){c=1;f.sweepIntegrate(c*b);f.sweepValidate(e);b=Pa.distance(e,h,l,r,z,null)+d;g=g*z.x+k*z.y;if(b<u.distanceThresholdCCD&&(d=k=0,k=l.x-f.posx,d=l.y-f.posy,f=g-f.sweep_angvel*(z.y*k-z.x*d),0<f&&(a.slipped=!0),0>=f||b<.5*u.distanceThresholdCCD))break;c=-1;break}if(40<=++x){p>d&&(a.failed=!0);break}}a.toi=c};Pa.distanceBody=function(a,b,c,d){var e;null==P.zpp_pool?e=new P:(e=P.zpp_pool,P.zpp_pool=e.next,e.next=null);e.weak=!1;var h;null==P.zpp_pool?h=new P:
(h=P.zpp_pool,P.zpp_pool=h.next,h.next=null);h.weak=!1;var f;null==P.zpp_pool?f=new P:(f=P.zpp_pool,P.zpp_pool=f.next,f.next=null);f.weak=!1;var g=1E100;for(a=a.shapes.head;null!=a;){for(var k=a.elt,l=b.shapes.head;null!=l;){var n=Pa.distance(k,l.elt,e,h,f,g);n<g&&(g=n,c.x=e.x,c.y=e.y,d.x=h.x,d.y=h.y);l=l.next}a=a.next}b=e;null!=b.outer&&(b.outer.zpp_inner=null,b.outer=null);b._isimmutable=null;b._validate=null;b._invalidate=null;b.next=P.zpp_pool;P.zpp_pool=b;null!=h.outer&&(h.outer.zpp_inner=null,
h.outer=null);h._isimmutable=null;h._validate=null;h._invalidate=null;h.next=P.zpp_pool;P.zpp_pool=h;null!=f.outer&&(f.outer.zpp_inner=null,f.outer=null);f._isimmutable=null;f._validate=null;f._invalidate=null;f.next=P.zpp_pool;P.zpp_pool=f;return g};Pa.distance=function(a,b,c,d,e,h){null==h&&(h=1E100);if(0==a.type&&0==b.type){var f=a.circle,g=b.circle,k,l=0,n=0,l=g.worldCOMx-f.worldCOMx,n=g.worldCOMy-f.worldCOMy,r=Math.sqrt(l*l+n*n);k=r-(f.radius+g.radius);if(k<h){if(0==r)l=1,n=0;else var z=1/r,
l=l*z,n=n*z;var x=f.radius;c.x=f.worldCOMx+l*x;c.y=f.worldCOMy+n*x;var p=-g.radius;d.x=g.worldCOMx+l*p;d.y=g.worldCOMy+n*p;e.x=l;e.y=n}return k}var w=!1;if(0==a.type&&1==b.type){var y=a;a=b;b=y;var A=c;c=d;d=A;w=!0}if(1==a.type&&0==b.type){for(var v=b.circle,C=-1E100,B=null,m=a.polygon.edges.head;null!=m;){var E=m.elt,F=E.gnormx*v.worldCOMx+E.gnormy*v.worldCOMy-E.gprojection-v.radius;if(F>h){C=F;break}0<F?F>C&&(C=F,B=E):0>C&&F>C&&(C=F,B=E);m=m.next}if(C<h){var G=B.gp0,H=B.gp1,P=v.worldCOMy*B.gnormx-
v.worldCOMx*B.gnormy;if(P<=G.y*B.gnormx-G.x*B.gnormy){var N=0,M=0,N=v.worldCOMx-G.x,M=v.worldCOMy-G.y,I=Math.sqrt(N*N+M*M),C=I-v.radius;if(C<h){if(0==I)N=1,M=0;else var Q=1/I,N=N*Q,M=M*Q;c.x=G.x+0*N;c.y=G.y+0*M;var W=-v.radius;d.x=v.worldCOMx+N*W;d.y=v.worldCOMy+M*W;e.x=N;e.y=M}}else if(P>=H.y*B.gnormx-H.x*B.gnormy){var T=0,S=0,T=v.worldCOMx-H.x,S=v.worldCOMy-H.y,V=Math.sqrt(T*T+S*S),C=V-v.radius;if(C<h){if(0==V)T=1,S=0;else var ca=1/V,T=T*ca,S=S*ca;c.x=H.x+0*T;c.y=H.y+0*S;var ea=-v.radius;d.x=v.worldCOMx+
T*ea;d.y=v.worldCOMy+S*ea;e.x=T;e.y=S}}else{var X=-v.radius;d.x=v.worldCOMx+B.gnormx*X;d.y=v.worldCOMy+B.gnormy*X;var Y=-C;c.x=d.x+B.gnormx*Y;c.y=d.y+B.gnormy*Y;e.x=B.gnormx;e.y=B.gnormy}}w&&(e.x=-e.x,e.y=-e.y);return C}for(var aa=a.polygon,Z=b.polygon,R=-1E100,ha=null,fa=null,ba=0,U=aa.edges.head;null!=U;){for(var la=U.elt,da=1E100,pa=Z.gverts.next;null!=pa;){var D=pa,qa=la.gnormx*D.x+la.gnormy*D.y;qa<da&&(da=qa);pa=pa.next}da-=la.gprojection;if(da>h){R=da;break}0<da?da>R&&(R=da,ha=la,ba=1):0>R&&
da>R&&(R=da,ha=la,ba=1);U=U.next}if(R<h){for(var na=Z.edges.head;null!=na;){for(var ia=na.elt,ja=1E100,oa=aa.gverts.next;null!=oa;){var va=oa,ta=ia.gnormx*va.x+ia.gnormy*va.y;ta<ja&&(ja=ta);oa=oa.next}ja-=ia.gprojection;if(ja>h){R=ja;break}0<ja?ja>R&&(R=ja,fa=ia,ba=2):0>R&&ja>R&&(R=ja,fa=ia,ba=2);na=na.next}if(R<h){var ra,sa;if(1==ba)ra=Z,sa=ha;else{ra=aa;sa=fa;var ya=c;c=d;d=ya;w=!w}for(var J=null,wa=1E100,Ba=ra.edges.head;null!=Ba;){var Aa=Ba.elt,Na=sa.gnormx*Aa.gnormx+sa.gnormy*Aa.gnormy;Na<wa&&
(wa=Na,J=Aa);Ba=Ba.next}w?(e.x=-sa.gnormx,e.y=-sa.gnormy):(e.x=sa.gnormx,e.y=sa.gnormy);if(0<=R){var ga=sa.gp0,xa=sa.gp1,ka=J.gp0,za=J.gp1,Ia=0,Ja=0,Ka=0,Ca=0,Ia=xa.x-ga.x,Ja=xa.y-ga.y,Ka=za.x-ka.x,Ca=za.y-ka.y,Oa=1/(Ia*Ia+Ja*Ja),Qa=1/(Ka*Ka+Ca*Ca),Da=-(Ia*(ga.x-ka.x)+Ja*(ga.y-ka.y))*Oa,Ea=-(Ia*(ga.x-za.x)+Ja*(ga.y-za.y))*Oa,Ga=-(Ka*(ka.x-ga.x)+Ca*(ka.y-ga.y))*Qa,Ha=-(Ka*(ka.x-xa.x)+Ca*(ka.y-xa.y))*Qa;0>Da?Da=0:1<Da&&(Da=1);0>Ea?Ea=0:1<Ea&&(Ea=1);0>Ga?Ga=0:1<Ga&&(Ga=1);0>Ha?Ha=0:1<Ha&&(Ha=1);var L=
0,ab=0,bb=Da,L=ga.x+Ia*bb,ab=ga.y+Ja*bb,Ta=0,Pa=0,Za=Ea,Ta=ga.x+Ia*Za,Pa=ga.y+Ja*Za,Ra=0,Ua=0,nb=Ga,Ra=ka.x+Ka*nb,Ua=ka.y+Ca*nb,Ya=0,hb=0,db=Ha,Ya=ka.x+Ka*db,hb=ka.y+Ca*db,Sa=eb.vec_dsq(L,ab,ka.x,ka.y),Wa=eb.vec_dsq(Ta,Pa,za.x,za.y),fb=eb.vec_dsq(Ra,Ua,ga.x,ga.y),Eb=eb.vec_dsq(Ya,hb,xa.x,xa.y),cb=0,jb=0,ma=null;Sa<Wa?(cb=L,jb=ab,ma=ka):(cb=Ta,jb=Pa,ma=za,Sa=Wa);var kb=0,mb=0,$a=null;fb<Eb?(kb=Ra,mb=Ua,$a=ga):(kb=Ya,mb=hb,$a=xa,fb=Eb);Sa<fb?(c.x=cb,c.y=jb,d.x=ma.x,d.y=ma.y,R=Math.sqrt(Sa)):(d.x=kb,
d.y=mb,c.x=$a.x,c.y=$a.y,R=Math.sqrt(fb));if(0!=R){e.x=d.x-c.x;e.y=d.y-c.y;var sb=1/R;e.x*=sb;e.y*=sb;w&&(e.x=-e.x,e.y=-e.y)}return R}var Fa=0,ua=0,Fa=J.gp0.x,ua=J.gp0.y,Va=0,Ma=0,Va=J.gp1.x,Ma=J.gp1.y,Xa=0,lb=0,Xa=Va-Fa,lb=Ma-ua,tb=sa.gnormy*Fa-sa.gnormx*ua,ub=sa.gnormy*Va-sa.gnormx*Ma,vb=1/(ub-tb),pb=(-sa.tp1-tb)*vb;pb>u.epsilon&&(Fa+=Xa*pb,ua+=lb*pb);var qb=(-sa.tp0-ub)*vb;qb<-u.epsilon&&(Va+=Xa*qb,Ma+=lb*qb);var rb=Fa*sa.gnormx+ua*sa.gnormy-sa.gprojection,K=Va*sa.gnormx+Ma*sa.gnormy-sa.gprojection;
if(rb<K){d.x=Fa;d.y=ua;var O=-rb;c.x=d.x+sa.gnormx*O;c.y=d.y+sa.gnormy*O;return rb}d.x=Va;d.y=Ma;var wb=-K;c.x=d.x+sa.gnormx*wb;c.y=d.y+sa.gnormy*wb;return K}}return h};var cb=function(){this.node=null;this.id=this.di=0;this.a=this.b=null;this.length=0;this._inuse=this.modified=this.pushmod=!1;this.next=null};cb.__name__=!0;cb.get=function(a,b){var c;null==cb.zpp_pool?c=new cb:(c=cb.zpp_pool,cb.zpp_pool=c.next,c.next=null);null;c.a=a;c.b=b;a.id<b.id?(c.id=a.id,c.di=b.id):(c.id=b.id,c.di=a.id);return c};
cb.edge_swap=function(a,b){var c=a.node;a.node=b.node;b.node=c};cb.edge_lt=function(a,b){return a.id<b.id||a.id==b.id&&a.di<b.di};cb.prototype={elem:function(){return this},begin:function(){return this.next},setbegin:function(a){this.next=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){a._inuse=!0;a.next=this.next;this.next=a;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.next;null!=a;)this.add(a),a=a.next},insert:function(a,
b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){b._inuse=!0;null==a?(b.next=this.next,this.next=b):(b.next=a.next,a.next=b);this.pushmod=this.modified=!0;this.length++;return b},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.next;this.next=a.next;a._inuse=!1;null==this.next&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.next;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},
try_remove:function(a){for(var b=null,c=this.next,d=!1;null!=c;){if(c==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.next,d=!1;null!=c;){if(c==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.next,this.next=c=b.next,null==this.next&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,
null==c&&(this.pushmod=!0));b._inuse=!1;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){},inlined_clear:function(){},reverse:function(){for(var a=this.next,b=null;null!=a;){var c=a.next;a.next=b;b=this.next=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.next},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;
for(var c=this.next;null!=c;){if(c==a){b=!0;break}c=c.next}return b},front:function(){return this.next},back:function(){for(var a=this.next,b=a;null!=b;)a=b,b=b.next;return a},iterator_at:function(a){for(var b=this.next;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a:null},free:function(){this.node=this.a=this.b=null},alloc:function(){},__class__:cb};var V=function(){};V.__name__=!0;V.lt=function(a,b){return a.y<b.y||a.y==b.y&&a.x<b.x};V.right_turn=function(a,
b,c){var d=0,e=0,d=c.x-b.x,e=c.y-b.y,h=c=0;c=b.x-a.x;h=b.y-a.y;return h*d-c*e};V.delaunay=function(a,b,c,d){var e=0,h=0,f=0,g=0,e=c.x-b.x,h=c.y-b.y,f=b.x-a.x,g=b.y-a.y;(e=0<=g*e-f*h)||(e=d.x-c.x,h=d.y-c.y,f=c.x-b.x,g=c.y-b.y,e=0<=g*e-f*h);e||(e=a.x-d.x,h=a.y-d.y,f=d.x-c.x,g=d.y-c.y,e=0<=g*e-f*h);e||(e=b.x-a.x,h=b.y-a.y,f=a.x-d.x,g=a.y-d.y,e=0<=g*e-f*h);return e?!0:0<b.x*(c.y*d.mag-c.mag*d.y)-c.x*(b.y*d.mag-b.mag*d.y)+d.x*(b.y*c.mag-b.mag*c.y)-(a.x*(c.y*d.mag-c.mag*d.y)-c.x*(a.y*d.mag-a.mag*d.y)+d.x*
(a.y*c.mag-a.mag*c.y))+(a.x*(b.y*d.mag-b.mag*d.y)-b.x*(a.y*d.mag-a.mag*d.y)+d.x*(a.y*b.mag-a.mag*b.y))-(a.x*(b.y*c.mag-b.mag*c.y)-b.x*(a.y*c.mag-a.mag*c.y)+c.x*(a.y*b.mag-a.mag*b.y))};V.optimise=function(a){var b=a.vertices,c=a.vertices;if(null!=b){do{var d=b;d.sort();d.mag=d.x*d.x+d.y*d.y;b=b.next}while(b!=c)}null==V.edgeSet&&(null==ia.zpp_pool?V.edgeSet=new ia:(V.edgeSet=ia.zpp_pool,ia.zpp_pool=V.edgeSet.next,V.edgeSet.next=null),null,V.edgeSet.lt=cb.edge_lt,V.edgeSet.swapped=cb.edge_swap);null==
cb.zpp_pool?c=new cb:(c=cb.zpp_pool,cb.zpp_pool=c.next,c.next=null);null;a=b=a.vertices;if(null!=b){do{var d=b,e=d.next;d.diagonals.reverse();for(var h=d.diagonals.head;null!=h;){var f=h.elt;f.id<d.id||V.delaunay(d,e,f,null==h.next?d.prev:h.next.elt)||(e=cb.get(d,f),c.add(e),e.node=V.edgeSet.insert(e));e=f;h=h.next}b=b.next}while(b!=a)}for(;null!=c.next;){a=c.pop_unsafe();b=a.a;f=a.b;d=b.next;h=null;for(e=b.diagonals.head;null!=e;){var g=e.elt;if(g==f){e=e.next;h=null==e?b.prev:e.elt;break}d=g;e=
e.next}b.diagonals.remove(f);f.diagonals.remove(b);if(f==d.next)d.diagonals.add(h);else for(e=d.diagonals.head;null!=e;){if(e.elt==f){d.diagonals.insert(e,h);break}e=e.next}if(b==h.next)h.diagonals.add(d);else for(f=h.diagonals.head;null!=f;){if(f.elt==b){h.diagonals.insert(f,d);break}f=f.next}V.edgeSet.remove_node(a.node);a.a=a.b=null;a.node=null;a.next=cb.zpp_pool;cb.zpp_pool=a}c.a=c.b=null;c.node=null;c.next=cb.zpp_pool;cb.zpp_pool=c};V.triangulate=function(a){var b=a.vertices,c=a.vertices,d=a.vertices.next,
e=a.vertices;if(null!=d){do{var h=d;if(h.y<b.y||h.y==b.y&&h.x<b.x)b=h;if(c.y<h.y||c.y==h.y&&c.x<h.x)c=h;d=d.next}while(d!=e)}null==V.queue&&(V.queue=new Cd);e=c.prev;d=c.next;for(V.queue.add(c);e!=b||d!=b;)e==b||d!=b&&(e.y<d.y||e.y==d.y&&e.x<d.x)?(V.queue.add(d),d.rightchain=!1,d=d.next):(V.queue.add(e),e.rightchain=!0,e=e.prev);V.queue.add(b);null==V.stack&&(V.stack=new Cd);V.stack.add(V.queue.pop_unsafe());e=V.queue.pop_unsafe();for(V.stack.add(e);;){b=V.queue.pop_unsafe();if(null==V.queue.head)break;
if(b.rightchain!=V.stack.head.elt.rightchain)for(;;){d=V.stack.pop_unsafe();if(null==V.stack.head)break;a.add_diagonal(d,b)}else for(e=V.stack.pop_unsafe();null!=V.stack.head;){d=V.stack.head.elt;h=V.right_turn(d,e,b);if(b.rightchain&&0<=h||!b.rightchain&&0>=h)break;a.add_diagonal(d,b);e=d;V.stack.pop()}V.stack.add(e);V.stack.add(b);e=b}if(null!=V.stack.head)for(V.stack.pop();null!=V.stack.head;){b=V.stack.pop_unsafe();if(null==V.stack.head)break;a.add_diagonal(c,b)}return a};var P=function(){this.length=
this.x=this.y=0;this._inuse=this.modified=this.pushmod=!1;this.next=null;this.weak=!1;this._isimmutable=this.outer=null;this._immutable=!1;this._invalidate=this._validate=null};P.__name__=!0;P.get=function(a,b,c){null==c&&(c=!1);var d;null==P.zpp_pool?d=new P:(d=P.zpp_pool,P.zpp_pool=d.next,d.next=null);d.weak=!1;d._immutable=c;d.x=a;d.y=b;return d};P.prototype={validate:function(){null!=this._validate&&this._validate()},invalidate:function(){null!=this._invalidate&&this._invalidate(this)},immutable:function(){if(this._immutable)throw new f("Error: Vec2 is immutable");
null!=this._isimmutable&&this._isimmutable()},wrapper:function(){if(null==this.outer){this.outer=new E;var a=this.outer.zpp_inner;null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null);a._isimmutable=null;a._validate=null;a._invalidate=null;a.next=P.zpp_pool;P.zpp_pool=a;this.outer.zpp_inner=this}return this.outer},free:function(){null!=this.outer&&(this.outer=this.outer.zpp_inner=null);this._invalidate=this._validate=this._isimmutable=null},alloc:function(){this.weak=!1},elem:function(){return this},
begin:function(){return this.next},setbegin:function(a){this.next=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){a._inuse=!0;a.next=this.next;this.next=a;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.next;null!=a;)this.add(a),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){b._inuse=!0;null==a?(b.next=this.next,this.next=b):(b.next=a.next,a.next=b);this.pushmod=this.modified=!0;
this.length++;return b},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.next;this.next=a.next;a._inuse=!1;null==this.next&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.next;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.next,d=!1;null!=c;){if(c==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},
inlined_try_remove:function(a){for(var b=null,c=this.next,d=!1;null!=c;){if(c==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.next,this.next=c=b.next,null==this.next&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));b._inuse=!1;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){},
inlined_clear:function(){},reverse:function(){for(var a=this.next,b=null;null!=a;){var c=a.next;a.next=b;b=this.next=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.next},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.next;null!=c;){if(c==a){b=!0;break}c=c.next}return b},front:function(){return this.next},back:function(){for(var a=this.next,b=a;null!=b;)a=b,b=b.next;return a},iterator_at:function(a){for(var b=
this.next;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a:null},copy:function(){return P.get(this.x,this.y,null)},toString:function(){return"{ x: "+this.x+" y: "+this.y+" }"},__class__:P};var of=function(){this._validate=null;this.immutable=!1;this.x=this.y=this.z=0;this.outer=null;this.immutable=!1;this._validate=null};of.__name__=!0;of.prototype={validate:function(){null!=this._validate&&this._validate()},__class__:of};var eb=function(){};eb.__name__=!0;
eb.vec_dsq=function(a,b,c,d){var e=0,h=0,e=a-c,h=b-d;return e*e+h*h};eb.vec_distance=function(a,b,c,d){var e=0,h=0,e=a-c,h=b-d;return Math.sqrt(e*e+h*h)};var Na=function(){this.userData=this.ishape=this.ibody=this.icompound=this.cbsets=this.group=this.cbTypes=this.cbSet=this.wrap_cbTypes=null;this.id=0;this.outer_i=null;this.id=na.Interactor();this.cbsets=new Ff;this.cbTypes=new Uc};Na.__name__=!0;Na.get=function(a,b){var c;c=a.id<b.id?a.id:b.id;var d;d=a.id<b.id?b.id:a.id;for(var e=null,h=(a.cbsets.length<
b.cbsets.length?a.cbsets:b.cbsets).head;null!=h;){var f=h.elt;if(f.id==c&&f.di==d){e=f;break}h=h.next}return e};Na.int_callback=function(a,b,c){var d=a.int1;a=a.int2;b.options1.compatible(d.cbTypes)&&b.options2.compatible(a.cbTypes)?(c.int1=d,c.int2=a):(c.int1=a,c.int2=d)};Na.prototype={isShape:function(){return null!=this.ishape},isBody:function(){return null!=this.ibody},isCompound:function(){return null!=this.icompound},__iaddedToSpace:function(){null!=this.group&&this.group.interactors.add(this);
for(var a=this.cbTypes.head;null!=a;)a.elt.interactors.add(this),a=a.next;this.alloc_cbSet()},__iremovedFromSpace:function(){null!=this.group&&this.group.interactors.remove(this);for(var a=this.cbTypes.head;null!=a;)a.elt.interactors.remove(this),a=a.next;this.dealloc_cbSet()},wake:function(){if(null!=this.ishape){var a=this.ishape.body;null!=a&&null!=a.space&&a.space.non_inlined_wake(a);!0}else null!=this.ibody?null!=this.ibody.space?this.ibody.space.non_inlined_wake(this.ibody):!1:(null!=this.icompound.space&&
this.icompound.space.wakeCompound(this.icompound),!0)},getSpace:function(){return null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:null!=this.ibody?this.ibody.space:this.icompound.space},setupcbTypes:function(){this.wrap_cbTypes=Vb.get(this.cbTypes);this.wrap_cbTypes.zpp_inner.adder=w(this,this.wrap_cbTypes_adder);this.wrap_cbTypes.zpp_inner.subber=w(this,this.wrap_cbTypes_subber);this.wrap_cbTypes.zpp_inner.dontremove=!0;this.wrap_cbTypes.zpp_inner._modifiable=w(this,this.immutable_cbTypes)},
immutable_cbTypes:function(){this.immutable_midstep("Interactor::cbTypes")},wrap_cbTypes_subber:function(a){a=a.zpp_inner;if(this.cbTypes.has(a)){var b;b=null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:null!=this.ibody?this.ibody.space:this.icompound.space;null!=b&&(this.dealloc_cbSet(),a.interactors.remove(this));this.cbTypes.remove(a);null!=b&&(this.alloc_cbSet(),this.wake())}},wrap_cbTypes_adder:function(a){this.insert_cbtype(a.zpp_inner);return!1},insert_cbtype:function(a){if(!this.cbTypes.has(a)){var b;
b=null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:null!=this.ibody?this.ibody.space:this.icompound.space;null!=b&&(this.dealloc_cbSet(),a.interactors.add(this));for(var c=null,d=this.cbTypes.head;null!=d&&!(a.id<d.elt.id);)c=d,d=d.next;this.cbTypes.inlined_insert(c,a);null!=b&&(this.alloc_cbSet(),this.wake())}},alloc_cbSet:function(){var a;a=null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:null!=this.ibody?this.ibody.space:this.icompound.space;null!=(this.cbSet=
a.cbsets.get(this.cbTypes))&&(this.cbSet.count++,this.cbSet.interactors.add(this),this.cbSet.validate(),a.freshInteractorType(this))},dealloc_cbSet:function(){var a;a=null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:null!=this.ibody?this.ibody.space:this.icompound.space;null!=this.cbSet&&(this.cbSet.interactors.remove(this),a.nullInteractorType(this),0==--this.cbSet.count&&(a.cbsets.remove(this.cbSet),a=this.cbSet,a.free(),a.next=oa.zpp_pool,oa.zpp_pool=a),this.cbSet=null)},setGroup:function(a){if(this.group!=
a){var b;(b=null!=(null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:null!=this.ibody?this.ibody.space:this.icompound.space))&&null!=this.group&&this.group.interactors.remove(this);this.group=a;b&&null!=a&&a.interactors.add(this);b&&(null!=this.ishape?this.ishape.body.wake():null!=this.ibody?this.ibody.wake():this.icompound.wake())}},immutable_midstep:function(a){null!=this.ibody?this.ibody.__immutable_midstep(a):null!=this.ishape?this.ishape.__immutable_midstep(a):this.icompound.__imutable_midstep(a)},
lookup_group:function(){for(var a=this;null!=a&&null==a.group;)a=null!=a.ishape?a.ishape.body:null!=a.icompound?a.icompound.compound:a.ibody.compound;return null==a?null:a.group},copyto:function(a){a.zpp_inner_i.group=this.group;for(var b=this.outer_i.get_cbTypes().iterator();b.hasNext();){var c;b.zpp_critical=!1;c=b.zpp_inner.at(b.zpp_i++);var d=void 0;null==a.zpp_inner_i.wrap_cbTypes&&a.zpp_inner_i.setupcbTypes();d=a.zpp_inner_i.wrap_cbTypes;d.add(c)}null!=this.userData&&(a.zpp_inner_i.userData=
ub.copy(this.userData))},__class__:Na};var H=function(){this.wrap_localCOM=this.wrap_worldCOM=null;this.zip_worldCOM=!1;this.worldCOMx=this.worldCOMy=0;this.zip_localCOM=!1;this.localCOMx=this.localCOMy=0;this.zip_aabb=!1;this.aabb=null;this.norotate=!1;this.cinertia=this.iinertia=this.sinertia=0;this.zip_inertia=!1;this.inertiaMode=this.inertia=0;this.zip_gravMassScale=!1;this.gravMassMode=this.gravMassScale=0;this.zip_gravMass=!1;this.gravMass=0;this.nomove=!1;this.massMode=this.imass=this.smass=
this.cmass=0;this.zip_mass=!1;this.mass=0;this.zip_axis=!1;this.angvel=this.torque=this.kinangvel=this.pre_rot=this.rot=this.axisx=this.axisy=0;this.wrap_svel=this.wrapcvel=null;this.svelx=this.svely=0;this.wrap_kinvel=null;this.kinvelx=this.kinvely=0;this.wrap_force=null;this.forcex=this.forcey=0;this.wrap_vel=null;this.velx=this.vely=0;this.wrap_pos=null;this.pre_posx=this.pre_posy=this.posx=this.posy=0;this.bullet=this.bulletEnabled=this.disableCCD=!1;this.sweepRadius=0;this.sweepFrozen=!1;this.graph_depth=
this.sweepTime=this.sweep_angvel=0;this.compound=this.shapes=this.wrap_shapes=this.space=this.arbiters=this.wrap_arbiters=this.constraints=this.wrap_constraints=this.component=null;this.type=0;this.world=!1;this.outer=null;Na.call(this);this.ibody=this;this.bulletEnabled=this.world=!1;this.sweep_angvel=this.sweepTime=0;this.disableCCD=this.norotate=this.nomove=!1;this.axisx=this.rot=this.posy=this.posx=0;this.axisy=1;this.torque=this.angvel=this.kinangvel=this.forcey=this.forcex=this.kinvely=this.kinvelx=
this.vely=this.velx=this.svely=this.svelx=0;this.pre_rot=this.pre_posy=this.pre_posx=Infinity;this.worldCOMy=this.worldCOMx=this.localCOMy=this.localCOMx=0;this.zip_aabb=!0;this.aabb=X.get(0,0,0,0);this.aabb._immutable=!0;this.aabb._validate=w(this,this.aabb_validate);this.gravMassMode=this.massMode=0;this.gravMassScale=1;this.inertiaMode=0;this.arbiters=new Od;this.constraints=new md;this.shapes=new ua;this.wrap_shapes=Zc.get(this.shapes);this.wrap_shapes.zpp_inner.adder=w(this,this.shapes_adder);
this.wrap_shapes.zpp_inner.subber=w(this,this.shapes_subber);this.wrap_shapes.zpp_inner._invalidate=w(this,this.shapes_invalidate);this.wrap_shapes.zpp_inner._modifiable=w(this,this.shapes_modifiable);this.kinematicDelaySleep=!1};H.__name__=!0;H.bodysetlt=function(a,b){return a.id<b.id};H.__static=function(){var a=ld;null==g.BodyType_STATIC&&(g.internal=!0,g.BodyType_STATIC=new Ga,g.internal=!1);var a=new a(g.BodyType_STATIC),b=a.zpp_inner;b.world=!0;b.wrap_shapes.zpp_inner.immutable=!0;b.smass=b.imass=
b.cmass=b.mass=b.gravMass=0;b.sinertia=b.iinertia=b.cinertia=b.inertia=0;b.cbTypes.clear();return a};H.__super__=Na;H.prototype=I(Na.prototype,{isStatic:function(){return 1==this.type},isDynamic:function(){return 2==this.type},isKinematic:function(){return 3==this.type},invalidate_type:function(){this.invalidate_mass();this.invalidate_inertia()},invalidate_shapes:function(){this.zip_worldCOM=this.zip_localCOM=this.zip_aabb=!0;this.invalidate_mass();this.invalidate_inertia()},init_bodysetlist:function(){null==
H.bodyset&&(H.bodyset=new pa,H.bodyset.lt=H.bodysetlt,H.bodystack=new Wc)},connectedBodies_cont:function(a){H.bodyset.try_insert_bool(a.zpp_inner)&&(H.bodystack.add(a.zpp_inner),a.zpp_inner.graph_depth=H.cur_graph_depth+1)},connectedBodies:function(a,b){var c=this;null==H.bodyset&&(H.bodyset=new pa,H.bodyset.lt=H.bodysetlt,H.bodystack=new Wc);null;var d;d=null==b?new Ka:b;H.bodystack.add(this);H.bodyset.insert(this);for(this.graph_depth=0;null!=H.bodystack.head;){var e=H.bodystack.pop_unsafe();if(e.graph_depth!=
a)for(H.cur_graph_depth=e.graph_depth,e=e.constraints.head;null!=e;)e.elt.outer.visitBodies(w(this,this.connectedBodies_cont)),e=e.next}H.bodyset.clear_with(function(a){a!=c&&d.add(a.outer)});return d},interactingBodies:function(a,b,c){var d=this;null==H.bodyset&&(H.bodyset=new pa,H.bodyset.lt=H.bodysetlt,H.bodystack=new Wc);null;var e;e=null==c?new Ka:c;H.bodyset.insert(this);H.bodystack.add(this);for(this.graph_depth=0;null!=H.bodystack.head;)if(c=H.bodystack.pop_unsafe(),c.graph_depth!=b)for(var h=
c.arbiters.head;null!=h;){var f=h.elt;0!=(f.type&a)&&(f=f.b1==c?f.b2:f.b1,H.bodyset.try_insert_bool(f)&&(H.bodystack.add(f),f.graph_depth=c.graph_depth+1));h=h.next}H.bodyset.clear_with(function(a){a!=d&&e.add(a.outer)});return e},atRest:function(a){if(2!=this.type)return this.component.sleeping;var b=u.linearSleepThreshold,b=b*b;if(this.velx*this.velx+this.vely*this.vely>b)a=!1;else if(eb.vec_dsq(this.posx,this.posy,this.pre_posx,this.pre_posy)>.25*b*a*a)a=!1;else{var c=b=0,b=this.aabb.maxx-this.aabb.minx,
c=this.aabb.maxy-this.aabb.miny,b=b*b+c*c,c=u.angularSleepThreshold,c=c*c;if(4*this.angvel*this.angvel*b>c)a=!1;else{var d=this.rot-this.pre_rot;a=d*d*b>c*a*a?!1:!0}}a||(this.component.waket=this.space.stamp);return this.component.waket+u.sleepDelay<this.space.stamp},refreshArbiters:function(){for(var a=this.arbiters.head;null!=a;)a.elt.invalidated=!0,a=a.next},sweepIntegrate:function(a){var b=a-this.sweepTime;0!=b&&(this.sweepTime=a,this.posx+=this.velx*b,this.posy+=this.vely*b,0!=this.angvel&&this.delta_rot(this.sweep_angvel*
b))},sweepValidate:function(a){if(0==a.type)a.worldCOMx=this.posx+(this.axisy*a.localCOMx-this.axisx*a.localCOMy),a.worldCOMy=this.posy+(a.localCOMx*this.axisx+a.localCOMy*this.axisy);else{a=a.polygon;for(var b=a.lverts.next,c=a.gverts.next;null!=c;){var d=c,e=b,b=b.next;d.x=this.posx+(this.axisy*e.x-this.axisx*e.y);d.y=this.posy+(e.x*this.axisx+e.y*this.axisy);c=c.next}c=a.edges.head;b=d=a.gverts.next;for(d=d.next;null!=d;){var e=d,h=c.elt,c=c.next;h.gnormx=this.axisy*h.lnormx-this.axisx*h.lnormy;
h.gnormy=h.lnormx*this.axisx+h.lnormy*this.axisy;h.gprojection=this.posx*h.gnormx+this.posy*h.gnormy+h.lprojection;h.tp0=b.y*h.gnormx-b.x*h.gnormy;h.tp1=e.y*h.gnormx-e.x*h.gnormy;b=e;d=d.next}a=a.gverts.next;c=c.elt;c.gnormx=this.axisy*c.lnormx-this.axisx*c.lnormy;c.gnormy=c.lnormx*this.axisx+c.lnormy*this.axisy;c.gprojection=this.posx*c.gnormx+this.posy*c.gnormy+c.lprojection;c.tp0=b.y*c.gnormx-b.x*c.gnormy;c.tp1=a.y*c.gnormx-a.x*c.gnormy}},invalidate_pos:function(){for(var a=this.shapes.head;null!=
a;){var b=a.elt;1==b.type&&(b.polygon.invalidate_gverts(),b.polygon.invalidate_gaxi());b.invalidate_worldCOM();a=a.next}this.zip_worldCOM=!0},pos_invalidate:function(a){this.immutable_midstep("Body::position");if(1==this.type&&null!=this.space)throw new f("Error: Cannot move a static object once inside a Space");if(this.posx!=a.x||this.posy!=a.y)this.posx=a.x,this.posy=a.y,this.invalidate_pos(),this.wake()},pos_validate:function(){this.wrap_pos.zpp_inner.x=this.posx;this.wrap_pos.zpp_inner.y=this.posy},
vel_invalidate:function(a){if(1==this.type)throw new f("Error: Static body cannot have its velocity set.");this.velx=a.x;this.vely=a.y;this.wake()},vel_validate:function(){this.wrap_vel.zpp_inner.x=this.velx;this.wrap_vel.zpp_inner.y=this.vely},kinvel_invalidate:function(a){this.kinvelx=a.x;this.kinvely=a.y;this.wake()},kinvel_validate:function(){this.wrap_kinvel.zpp_inner.x=this.kinvelx;this.wrap_kinvel.zpp_inner.y=this.kinvely},svel_invalidate:function(a){this.svelx=a.x;this.svely=a.y;this.wake()},
svel_validate:function(){this.wrap_svel.zpp_inner.x=this.svelx;this.wrap_svel.zpp_inner.y=this.svely},force_invalidate:function(a){if(2!=this.type)throw new f("Error: Non-dynamic body cannot have force applied.");this.forcex=a.x;this.forcey=a.y;this.wake()},force_validate:function(){this.wrap_force.zpp_inner.x=this.forcex;this.wrap_force.zpp_inner.y=this.forcey},setupPosition:function(){this.wrap_pos=E.get(this.posx,this.posy,null);this.wrap_pos.zpp_inner._inuse=!0;this.world?this.wrap_pos.zpp_inner._immutable=
!0:(this.wrap_pos.zpp_inner._invalidate=w(this,this.pos_invalidate),this.wrap_pos.zpp_inner._validate=w(this,this.pos_validate))},setupVelocity:function(){this.wrap_vel=E.get(this.velx,this.vely,null);this.wrap_vel.zpp_inner._inuse=!0;this.world?this.wrap_vel.zpp_inner._immutable=!0:(this.wrap_vel.zpp_inner._invalidate=w(this,this.vel_invalidate),this.wrap_vel.zpp_inner._validate=w(this,this.vel_validate))},setupkinvel:function(){this.wrap_kinvel=E.get(this.kinvelx,this.kinvely,null);this.wrap_kinvel.zpp_inner._inuse=
!0;this.world?this.wrap_kinvel.zpp_inner._immutable=!0:(this.wrap_kinvel.zpp_inner._invalidate=w(this,this.kinvel_invalidate),this.wrap_kinvel.zpp_inner._validate=w(this,this.kinvel_validate))},setupsvel:function(){this.wrap_svel=E.get(this.svelx,this.svely,null);this.wrap_svel.zpp_inner._inuse=!0;this.world?this.wrap_svel.zpp_inner._immutable=!0:(this.wrap_svel.zpp_inner._invalidate=w(this,this.svel_invalidate),this.wrap_svel.zpp_inner._validate=w(this,this.svel_validate))},setupForce:function(){this.wrap_force=
E.get(this.forcex,this.forcey,null);this.wrap_force.zpp_inner._inuse=!0;this.world?this.wrap_force.zpp_inner._immutable=!0:(this.wrap_force.zpp_inner._invalidate=w(this,this.force_invalidate),this.wrap_force.zpp_inner._validate=w(this,this.force_validate))},cvel_validate:function(){this.wrapcvel.zpp_inner.x=this.velx+this.kinvelx;this.wrapcvel.zpp_inner.y=this.vely+this.kinvely;this.wrapcvel.zpp_inner.z=this.angvel+this.kinangvel},setup_cvel:function(){this.wrapcvel=N.get();this.wrapcvel.zpp_inner.immutable=
!0;this.wrapcvel.zpp_inner._validate=w(this,this.cvel_validate)},invalidate_rot:function(){this.zip_axis=!0;for(var a=this.shapes.head;null!=a;){var b=a.elt;1==b.type&&(b.polygon.invalidate_gverts(),b.polygon.invalidate_gaxi());b.invalidate_worldCOM();a=a.next}this.zip_worldCOM=!0},validate_axis:function(){this.zip_axis&&(this.zip_axis=!1,this.axisx=Math.sin(this.rot),this.axisy=Math.cos(this.rot),null)},quick_validate_axis:function(){this.axisx=Math.sin(this.rot);this.axisy=Math.cos(this.rot)},delta_rot:function(a){this.rot+=
a;if(1E-4<a*a)this.axisx=Math.sin(this.rot),this.axisy=Math.cos(this.rot),null;else{var b=a*a,c=1-.5*b,b=1-b*b/8,d=(c*this.axisx+a*this.axisy)*b;this.axisy=(c*this.axisy-a*this.axisx)*b;this.axisx=d}},invalidate_mass:function(){this.zip_mass=!0;this.invalidate_gravMass()},validate_mass:function(){if(this.zip_mass){this.zip_mass=!1;if(0==this.massMode){this.cmass=0;for(var a=this.shapes.head;null!=a;){var b=a.elt;b.refmaterial.density=b.material.density;b.validate_area_inertia();this.cmass+=b.area*
b.material.density;a=a.next}}2!=this.type||this.nomove?(this.mass=Infinity,this.imass=this.smass=0):(this.mass=this.cmass,this.imass=this.smass=1/this.mass)}},invalidate_gravMass:function(){1!=this.gravMassMode&&(this.zip_gravMass=!0);2!=this.gravMassMode&&(this.zip_gravMassScale=!0);this.wake()},validate_gravMass:function(){this.zip_gravMass&&(this.zip_gravMass=!1,this.validate_mass(),0==this.gravMassMode?(this.validate_mass(),this.gravMass=this.cmass):2==this.gravMassMode&&(this.validate_mass(),
this.gravMass=this.cmass*this.gravMassScale))},invalidate_gravMassScale:function(){2!=this.gravMassMode?this.zip_gravMassScale=!0:this.invalidate_gravMass()},validate_gravMassScale:function(){this.zip_gravMassScale&&(this.zip_gravMassScale=!1,0==this.gravMassMode?this.gravMassScale=1:1==this.gravMassMode&&(this.validate_mass(),this.gravMassScale=this.gravMass/this.cmass))},invalidate_inertia:function(){this.zip_inertia=!0;this.wake()},validate_inertia:function(){if(this.zip_inertia){this.zip_inertia=
!1;if(0==this.inertiaMode){this.cinertia=0;for(var a=this.shapes.head;null!=a;){var b=a.elt;b.refmaterial.density=b.material.density;b.validate_area_inertia();this.cinertia+=b.inertia*b.area*b.material.density;a=a.next}}2!=this.type||this.norotate?(this.inertia=Infinity,this.sinertia=this.iinertia=0):(this.inertia=this.cinertia,this.sinertia=this.iinertia=1/this.inertia)}},invalidate_wake:function(){this.wake()},validate_aabb:function(){if(null==this.shapes.head)throw new f("Error: Body bounds only makes sense if it contains shapes");
if(this.zip_aabb){this.zip_aabb=!1;this.aabb.minx=Infinity;this.aabb.miny=Infinity;this.aabb.maxx=-Infinity;this.aabb.maxy=-Infinity;for(var a=this.shapes.head;null!=a;){var b=a.elt;b.zip_aabb&&null!=b.body&&(b.zip_aabb=!1,0==b.type?b.circle.__validate_aabb():b.polygon.__validate_aabb());this.aabb.combine(b.aabb);a=a.next}}},invalidate_aabb:function(){this.zip_aabb=!0},invalidate_localCOM:function(){this.zip_worldCOM=this.zip_localCOM=!0},invalidate_worldCOM:function(){this.zip_worldCOM=!0},validate_localCOM:function(){if(this.zip_localCOM){this.zip_localCOM=
!1;for(var a=0,b=0,c=0,d=this.shapes.head;null!=d;){var e=d.elt;e.zip_localCOM&&(e.zip_localCOM=!1,1==e.type&&e.polygon.__validate_localCOM(),null!=e.wrap_localCOM&&(e.wrap_localCOM.zpp_inner.x=e.localCOMx,e.wrap_localCOM.zpp_inner.y=e.localCOMy));e.validate_area_inertia();var h=e.area*e.material.density,a=a+e.localCOMx*h,b=b+e.localCOMy*h,c=c+e.area*e.material.density,d=d.next}0!=c&&(d=1/c,this.localCOMx=a*d,this.localCOMy=b*d);null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,
this.wrap_localCOM.zpp_inner.y=this.localCOMy);this.zip_mass&&0==this.massMode&&(this.zip_mass=!1,this.cmass=c,2==this.type?(this.mass=this.cmass,this.imass=this.smass=1/this.mass):(this.mass=Infinity,this.imass=this.smass=0))}},validate_worldCOM:function(){this.zip_worldCOM&&(this.zip_worldCOM=!1,this.validate_localCOM(),this.zip_axis&&(this.zip_axis=!1,this.axisx=Math.sin(this.rot),this.axisy=Math.cos(this.rot),null),this.worldCOMx=this.posx+(this.axisy*this.localCOMx-this.axisx*this.localCOMy),
this.worldCOMy=this.posy+(this.localCOMx*this.axisx+this.localCOMy*this.axisy),null!=this.wrap_worldCOM&&(this.wrap_worldCOM.zpp_inner.x=this.worldCOMx,this.wrap_worldCOM.zpp_inner.y=this.worldCOMy))},getlocalCOM:function(){if(null==this.shapes.head)throw new f("Error: localCOM only makes sense when Body has Shapes");this.validate_localCOM()},getworldCOM:function(){if(null==this.shapes.head)throw new f("Error: worldCOM only makes sense when Body has Shapes");this.validate_worldCOM()},__immutable_midstep:function(a){if(null!=
this.space&&this.space.midstep)throw new f("Error: "+a+" cannot be set during a space step()");},clear:function(){if(null!=this.space)throw new f("Error: Cannot clear a Body if it is currently being used by a Space!");if(null!=this.constraints.head)throw new f("Error: Cannot clear a Body if it is currently being used by a constraint!");for(;null!=this.shapes.head;){var a=this.shapes.pop_unsafe();a.removedFromBody();a.body=null}this.invalidate_shapes();this.angvel=this.torque=this.kinangvel=this.pre_rot=
this.rot=this.svely=this.svelx=this.kinvely=this.kinvelx=this.forcey=this.forcex=this.vely=this.velx=this.posy=this.posx=this.pre_posy=this.pre_posx=0;this.invalidate_pos();this.invalidate_rot();this.axisx=0;this.axisy=1;this.zip_axis=!1;this.gravMassMode=this.massMode=0;this.gravMassScale=1;this.inertiaMode=0;this.nomove=this.norotate=!1},aabb_validate:function(){if(null==this.shapes.head)throw new f("Error: bounds only makes sense when Body has shapes");this.validate_aabb()},shapes_adder:function(a){return a.zpp_inner.body!=
this?(null!=a.zpp_inner.body&&a.zpp_inner.body.wrap_shapes.remove(a),a.zpp_inner.body=this,a.zpp_inner.addedToBody(),null!=this.space&&this.space.added_shape(a.zpp_inner,null),1==a.zpp_inner.type&&(a.zpp_inner.polygon.invalidate_gaxi(),a.zpp_inner.polygon.invalidate_gverts()),!0):!1},shapes_subber:function(a){null!=this.space&&this.space.removed_shape(a.zpp_inner);a.zpp_inner.body=null;a.zpp_inner.removedFromBody()},shapes_invalidate:function(a){this.invalidate_shapes()},shapes_modifiable:function(){this.immutable_midstep("Body::shapes");
if(1==this.type&&null!=this.space)throw new f("Error: Cannot modifiy shapes of static object once added to Space");},addedToSpace:function(){null==Fa.zpp_pool?this.component=new Fa:(this.component=Fa.zpp_pool,Fa.zpp_pool=this.component.next,this.component.next=null);null;this.component.isBody=!0;this.component.body=this;this.__iaddedToSpace()},removedFromSpace:function(){for(;null!=this.arbiters.head;){var a=this.arbiters.pop_unsafe();a.cleared=!0;a.b2==this&&a.b1.arbiters.inlined_try_remove(a);a.b1==
this&&a.b2.arbiters.inlined_try_remove(a);null!=a.pair&&(a.pair.arb=null,a.pair=null);a.active=!1;this.space.f_arbiters.modified=!0}a=this.component;a.body=null;a.constraint=null;null;a.next=Fa.zpp_pool;Fa.zpp_pool=a;this.component=null;this.__iremovedFromSpace()},copy:function(){var a=(new ld).zpp_inner;a.type=this.type;a.bulletEnabled=this.bulletEnabled;a.disableCCD=this.disableCCD;for(var b=this.shapes.head;null!=b;)a.outer.zpp_inner.wrap_shapes.add(b.elt.outer.copy()),b=b.next;a.posx=this.posx;
a.posy=this.posy;a.velx=this.velx;a.vely=this.vely;a.forcex=this.forcex;a.forcey=this.forcey;a.rot=this.rot;a.angvel=this.angvel;a.torque=this.torque;a.kinvelx=this.kinvelx;a.kinvely=this.kinvely;a.kinangvel=this.kinangvel;a.svelx=this.svelx;a.svely=this.svely;this.zip_axis?a.invalidate_rot():(a.axisx=this.axisx,a.axisy=this.axisy);a.rot=this.rot;a.massMode=this.massMode;a.gravMassMode=this.gravMassMode;a.inertiaMode=this.inertiaMode;a.norotate=this.norotate;a.nomove=this.nomove;a.cmass=this.cmass;
a.cinertia=this.cinertia;this.zip_mass?a.invalidate_mass():a.mass=this.mass;this.zip_gravMass?a.invalidate_gravMass():a.gravMass=this.gravMass;this.zip_gravMassScale?a.invalidate_gravMassScale():a.gravMassScale=this.gravMassScale;this.zip_inertia?a.invalidate_inertia():a.inertia=this.inertia;this.zip_aabb?a.zip_aabb=!0:(a.aabb.minx=this.aabb.minx,a.aabb.miny=this.aabb.miny,a.aabb.maxx=this.aabb.maxx,a.aabb.maxy=this.aabb.maxy);this.zip_localCOM?(a.zip_localCOM=!0,a.zip_worldCOM=!0):(a.localCOMx=this.localCOMx,
a.localCOMy=this.localCOMy);this.zip_worldCOM?a.zip_worldCOM=!0:(a.worldCOMx=this.worldCOMx,a.worldCOMy=this.worldCOMy);this.copyto(a.outer);return a.outer},__class__:H});var Pe=function(){this.compound=this.space=null;this.depth=0;this.outer=this.bodies=this.constraints=this.compounds=this.wrap_bodies=this.wrap_constraints=this.wrap_compounds=null;Na.call(this);this.icompound=this;this.depth=1;this.bodies=new Wc;this.wrap_bodies=pc.get(this.bodies);this.wrap_bodies.zpp_inner.adder=w(this,this.bodies_adder);
this.wrap_bodies.zpp_inner.subber=w(this,this.bodies_subber);this.wrap_bodies.zpp_inner._modifiable=w(this,this.bodies_modifiable);this.constraints=new md;this.wrap_constraints=mb.get(this.constraints);this.wrap_constraints.zpp_inner.adder=w(this,this.constraints_adder);this.wrap_constraints.zpp_inner.subber=w(this,this.constraints_subber);this.wrap_constraints.zpp_inner._modifiable=w(this,this.constraints_modifiable);this.compounds=new Pd;this.wrap_compounds=Jc.get(this.compounds);this.wrap_compounds.zpp_inner.adder=
w(this,this.compounds_adder);this.wrap_compounds.zpp_inner.subber=w(this,this.compounds_subber);this.wrap_compounds.zpp_inner._modifiable=w(this,this.compounds_modifiable)};Pe.__name__=!0;Pe.__super__=Na;Pe.prototype=I(Na.prototype,{__imutable_midstep:function(a){if(null!=this.space&&this.space.midstep)throw new f("Error: "+a+" cannot be set during space step()");},addedToSpace:function(){this.__iaddedToSpace()},removedFromSpace:function(){this.__iremovedFromSpace()},breakApart:function(){null!=this.space&&
(this.__iremovedFromSpace(),this.space.nullInteractorType(this));for(null!=this.compound?this.compound.compounds.remove(this):null!=this.space&&this.space.compounds.remove(this);null!=this.bodies.head;){var a=this.bodies.pop_unsafe();null!=(a.compound=this.compound)?this.compound.bodies.add(a):null!=this.space&&this.space.bodies.add(a);null!=this.space&&this.space.freshInteractorType(a)}for(;null!=this.constraints.head;)a=this.constraints.pop_unsafe(),null!=(a.compound=this.compound)?this.compound.constraints.add(a):
null!=this.space&&this.space.constraints.add(a);for(;null!=this.compounds.head;)a=this.compounds.pop_unsafe(),null!=(a.compound=this.compound)?this.compound.compounds.add(a):null!=this.space&&this.space.compounds.add(a),null!=this.space&&this.space.freshInteractorType(a);this.space=this.compound=null},bodies_adder:function(a){return a.zpp_inner.compound!=this?(null!=a.zpp_inner.compound?a.zpp_inner.compound.wrap_bodies.remove(a):null!=a.zpp_inner.space&&a.zpp_inner.space.wrap_bodies.remove(a),a.zpp_inner.compound=
this,null!=this.space&&this.space.addBody(a.zpp_inner),!0):!1},bodies_subber:function(a){a.zpp_inner.compound=null;null!=this.space&&this.space.remBody(a.zpp_inner)},bodies_modifiable:function(){this.immutable_midstep("Compound::bodies")},constraints_adder:function(a){return a.zpp_inner.compound!=this?(null!=a.zpp_inner.compound?a.zpp_inner.compound.wrap_constraints.remove(a):null!=a.zpp_inner.space&&a.zpp_inner.space.wrap_constraints.remove(a),a.zpp_inner.compound=this,null!=this.space&&this.space.addConstraint(a.zpp_inner),
!0):!1},constraints_subber:function(a){a.zpp_inner.compound=null;null!=this.space&&this.space.remConstraint(a.zpp_inner)},constraints_modifiable:function(){this.immutable_midstep("Compound::constraints")},compounds_adder:function(a){for(var b=this;null!=b&&b!=a.zpp_inner;)b=b.compound;if(b==a.zpp_inner)throw new f("Error: Assignment would cause a cycle in the Compound tree: assigning "+a.toString()+".compound = "+this.outer.toString());return a.zpp_inner.compound!=this?(null!=a.zpp_inner.compound?
a.zpp_inner.compound.wrap_compounds.remove(a):null!=a.zpp_inner.space&&a.zpp_inner.space.wrap_compounds.remove(a),a.zpp_inner.compound=this,a.zpp_inner.depth=this.depth+1,null!=this.space&&this.space.addCompound(a.zpp_inner),!0):!1},compounds_subber:function(a){a.zpp_inner.compound=null;a.zpp_inner.depth=1;null!=this.space&&this.space.remCompound(a.zpp_inner)},compounds_modifiable:function(){this.immutable_midstep("Compound::compounds")},copy:function(a,b){var c=null==a;null==a&&(a=[]);null==b&&(b=
[]);for(var d=new Qe,e=this.compounds.head;null!=e;){var h=e.elt.copy(a,b);h.zpp_inner.immutable_midstep("Compound::compound");(null==h.zpp_inner.compound?null:h.zpp_inner.compound.outer)!=d&&(null!=(null==h.zpp_inner.compound?null:h.zpp_inner.compound.outer)&&(null==h.zpp_inner.compound?null:h.zpp_inner.compound.outer).zpp_inner.wrap_compounds.remove(h),null!=d&&d.zpp_inner.wrap_compounds.add(h));null==h.zpp_inner.compound?null:h.zpp_inner.compound.outer;e=e.next}for(e=this.bodies.head;null!=e;){var h=
e.elt,f=h.outer.copy();a.push(ka.dict(h.id,f));(null==f.zpp_inner.compound?null:f.zpp_inner.compound.outer)!=d&&(null!=(null==f.zpp_inner.compound?null:f.zpp_inner.compound.outer)&&(null==f.zpp_inner.compound?null:f.zpp_inner.compound.outer).zpp_inner.wrap_bodies.remove(f),null!=d&&d.zpp_inner.wrap_bodies.add(f));null==f.zpp_inner.compound?null:f.zpp_inner.compound.outer;e=e.next}for(e=this.constraints.head;null!=e;)h=e.elt.copy(a,b),(null==h.zpp_inner.compound?null:h.zpp_inner.compound.outer)!=d&&
(null!=(null==h.zpp_inner.compound?null:h.zpp_inner.compound.outer)&&(null==h.zpp_inner.compound?null:h.zpp_inner.compound.outer).zpp_inner.wrap_constraints.remove(h),null!=d&&d.zpp_inner.wrap_constraints.add(h)),null==h.zpp_inner.compound?null:h.zpp_inner.compound.outer,e=e.next;if(c)for(;0<b.length;)for(c=b.pop(),e=0;e<a.length;)if(h=a[e],++e,h.id==c.id){c.cb(h.bc);break}this.copyto(d);return d},__class__:Pe});var Sc=function(){this.wrap_gravity=null;this.viscosity=this.density=this.gravityx=this.gravityy=
0;this.next=this.userData=this.outer=this.shapes=this.wrap_shapes=null;this.shapes=new ua;this.density=this.viscosity=1;this.wrap_gravity=null;this.gravityy=this.gravityx=0};Sc.__name__=!0;Sc.prototype={wrapper:function(){if(null==this.outer){this.outer=new Md;var a=this.outer.zpp_inner;a.outer=null;a.next=Sc.zpp_pool;Sc.zpp_pool=a;this.outer.zpp_inner=this}return this.outer},free:function(){this.outer=null},alloc:function(){},feature_cons:function(){this.shapes=new ua},addShape:function(a){this.shapes.add(a)},
remShape:function(a){this.shapes.remove(a)},copy:function(){var a;null==Sc.zpp_pool?a=new Sc:(a=Sc.zpp_pool,Sc.zpp_pool=a.next,a.next=null);null;a.viscosity=this.viscosity;a.density=this.density;return a},gravity_invalidate:function(a){this.gravityx=a.x;this.gravityy=a.y;this.invalidate()},gravity_validate:function(){this.wrap_gravity.zpp_inner.x=this.gravityx;this.wrap_gravity.zpp_inner.y=this.gravityy},getgravity:function(){this.wrap_gravity=E.get(this.gravityx,this.gravityy,null);this.wrap_gravity.zpp_inner._inuse=
!0;this.wrap_gravity.zpp_inner._invalidate=w(this,this.gravity_invalidate);this.wrap_gravity.zpp_inner._validate=w(this,this.gravity_validate)},invalidate:function(){for(var a=this.shapes.head;null!=a;)a.elt.invalidate_fluidprops(),a=a.next},__class__:Sc};var W=function(){this.dynamicFriction=this.staticFriction=this.density=this.elasticity=this.rollingFriction=0;this.next=this.userData=this.outer=this.shapes=this.wrap_shapes=null;this.shapes=new ua;this.elasticity=0;this.dynamicFriction=1;this.staticFriction=
2;this.density=.001;this.rollingFriction=.01};W.__name__=!0;W.prototype={wrapper:function(){if(null==this.outer){this.outer=new hb;var a=this.outer.zpp_inner;a.outer=null;a.next=W.zpp_pool;W.zpp_pool=a;this.outer.zpp_inner=this}return this.outer},free:function(){this.outer=null},alloc:function(){},feature_cons:function(){this.shapes=new ua},addShape:function(a){this.shapes.add(a)},remShape:function(a){this.shapes.remove(a)},copy:function(){var a=new W;a.dynamicFriction=this.dynamicFriction;a.staticFriction=
this.staticFriction;a.density=this.density;a.elasticity=this.elasticity;a.rollingFriction=this.rollingFriction;return a},set:function(a){this.dynamicFriction=a.dynamicFriction;this.staticFriction=a.staticFriction;this.density=a.density;this.elasticity=a.elasticity;this.rollingFriction=a.rollingFriction},invalidate:function(a){for(var b=this.shapes.head;null!=b;)b.elt.invalidate_material(a),b=b.next},__class__:W};var cd=function(a){this.zip_aabb=!1;this.sweep=this.node=this.pairs=this.aabb=null;this.fluidEnabled=
this.sensorEnabled=!1;this.circle=this.polygon=this.refmaterial=this.material=this.filter=this.fluidProperties=null;this.sweepCoef=0;this.zip_sweepRadius=!1;this.sweepRadius=0;this.wrap_localCOM=this.wrap_worldCOM=null;this.zip_worldCOM=!1;this.worldCOMx=this.worldCOMy=0;this.zip_localCOM=!1;this.localCOMx=this.localCOMy=0;this.zip_angDrag=!1;this.inertia=this.angDrag=0;this.zip_area_inertia=!1;this.type=this.area=0;this.outer=this.body=null;Na.call(this);this.pairs=new Gf;this.ishape=this;this.type=
a;this.aabb=X.get(0,0,0,0);this.aabb._immutable=!0;this.aabb._validate=w(this,this.aabb_validate);this.zip_area_inertia=this.zip_angDrag=this.zip_localCOM=this.zip_sweepRadius=!0;this.worldCOMy=this.worldCOMx=this.localCOMy=this.localCOMx=0;this.sensorEnabled=this.fluidEnabled=!1;this.body=this.fluidProperties=null;this.refmaterial=new W;this.sweepRadius=this.sweepCoef=0};cd.__name__=!0;cd.__super__=Na;cd.prototype=I(Na.prototype,{isCircle:function(){return 0==this.type},isPolygon:function(){return 1==
this.type},invalidate_sweepRadius:function(){this.zip_sweepRadius=!0},validate_sweepRadius:function(){this.zip_sweepRadius&&(this.zip_sweepRadius=!1,0==this.type?this.circle.__validate_sweepRadius():this.polygon.__validate_sweepRadius())},clear:function(){0==this.type?this.circle.__clear():this.polygon.__clear()},validate_aabb:function(){this.zip_aabb&&null!=this.body&&(this.zip_aabb=!1,0==this.type?this.circle.__validate_aabb():this.polygon.__validate_aabb())},force_validate_aabb:function(){0==this.type?
this.circle._force_validate_aabb():this.polygon._force_validate_aabb()},invalidate_aabb:function(){this.zip_aabb=!0;null!=this.body&&(this.body.zip_aabb=!0)},validate_area_inertia:function(){this.zip_area_inertia&&(this.zip_area_inertia=!1,0==this.type?this.circle.__validate_area_inertia():this.polygon.__validate_area_inertia())},validate_angDrag:function(){if(this.zip_angDrag||this.refmaterial.dynamicFriction!=this.material.dynamicFriction)this.zip_angDrag=!1,this.refmaterial.dynamicFriction=this.material.dynamicFriction,
0==this.type?this.circle.__validate_angDrag():this.polygon.__validate_angDrag()},validate_localCOM:function(){this.zip_localCOM&&(this.zip_localCOM=!1,1==this.type&&this.polygon.__validate_localCOM(),null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy))},validate_worldCOM:function(){this.zip_worldCOM&&null!=this.body&&(this.zip_worldCOM=!1,this.zip_localCOM&&(this.zip_localCOM=!1,1==this.type&&this.polygon.__validate_localCOM(),null!=
this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy)),this.body.validate_axis(),this.worldCOMx=this.body.posx+(this.body.axisy*this.localCOMx-this.body.axisx*this.localCOMy),this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+this.localCOMy*this.body.axisy))},getworldCOM:function(){if(null==this.body)throw new f("Error: worldCOM only makes sense when Shape belongs to a Body");this.zip_worldCOM&&null!=this.body&&(this.zip_worldCOM=
!1,this.zip_localCOM&&(this.zip_localCOM=!1,1==this.type&&this.polygon.__validate_localCOM(),null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy)),this.body.validate_axis(),this.worldCOMx=this.body.posx+(this.body.axisy*this.localCOMx-this.body.axisx*this.localCOMy),this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+this.localCOMy*this.body.axisy));this.wrap_worldCOM.zpp_inner.x=this.worldCOMx;this.wrap_worldCOM.zpp_inner.y=
this.worldCOMy},invalidate_area_inertia:function(){this.zip_area_inertia=!0;null!=this.body&&(this.body.invalidate_localCOM(),this.body.invalidate_mass(),this.body.invalidate_inertia())},invalidate_angDrag:function(){this.zip_angDrag=!0},invalidate_localCOM:function(){this.zip_localCOM=!0;this.invalidate_area_inertia();0==this.type&&(this.zip_sweepRadius=!0);this.invalidate_angDrag();this.invalidate_worldCOM();null!=this.body&&this.body.invalidate_localCOM()},invalidate_worldCOM:function(){this.zip_aabb=
this.zip_worldCOM=!0;null!=this.body&&(this.body.zip_aabb=!0)},invalidate_material:function(a){0!=(a&W.WAKE)&&this.wake();0!=(a&W.ARBITERS)&&null!=this.body&&this.body.refreshArbiters();0!=(a&W.PROPS)&&null!=this.body&&(this.body.invalidate_localCOM(),this.body.invalidate_mass(),this.body.invalidate_inertia());0!=(a&W.ANGDRAG)&&this.invalidate_angDrag();this.refmaterial.set(this.material)},invalidate_filter:function(){this.wake()},invalidate_fluidprops:function(){this.fluidEnabled&&this.wake()},aabb_validate:function(){if(null==
this.body)throw new f("Error: bounds only makes sense when Shape belongs to a Body");this.zip_aabb&&null!=this.body&&(this.zip_aabb=!1,0==this.type?this.circle.__validate_aabb():this.polygon.__validate_aabb())},setMaterial:function(a){this.material!=a&&(null!=this.body&&null!=this.body.space&&null!=this.material&&this.material.shapes.remove(this),this.material=a,null!=this.body&&null!=this.body.space&&a.shapes.add(this),this.wake(),null!=this.body&&this.body.refreshArbiters())},setFilter:function(a){this.filter!=
a&&(null!=this.body&&null!=this.body.space&&null!=this.filter&&this.filter.shapes.remove(this),this.filter=a,null!=this.body&&null!=this.body.space&&a.shapes.add(this),this.wake())},setFluid:function(a){this.fluidProperties!=a&&(null!=this.body&&null!=this.body.space&&null!=this.fluidProperties&&this.fluidProperties.shapes.remove(this),this.fluidProperties=a,null!=this.body&&null!=this.body.space&&a.shapes.add(this),this.fluidEnabled&&this.wake())},__immutable_midstep:function(a){if(null!=this.body&&
null!=this.body.space&&this.body.space.midstep)throw new f("Error: "+a+" cannot be set during a space step()");},addedToBody:function(){this.invalidate_worldCOM();this.zip_aabb=!0;null!=this.body&&(this.body.zip_aabb=!0)},removedFromBody:function(){},addedToSpace:function(){this.__iaddedToSpace();this.material.shapes.add(this);this.filter.shapes.add(this);null!=this.fluidProperties&&this.fluidProperties.shapes.add(this)},removedFromSpace:function(){this.__iremovedFromSpace();this.material.shapes.remove(this);
this.filter.shapes.remove(this);null!=this.fluidProperties&&this.fluidProperties.shapes.remove(this)},copy:function(){var a=null,a=0==this.type?this.circle.__copy():this.polygon.__copy();this.zip_area_inertia?a.invalidate_area_inertia():(a.area=this.area,a.inertia=this.inertia);this.zip_sweepRadius?a.zip_sweepRadius=!0:(a.sweepRadius=this.sweepRadius,a.sweepCoef=this.sweepCoef);this.zip_angDrag?a.invalidate_angDrag():a.angDrag=this.angDrag;this.zip_aabb?(a.zip_aabb=!0,null!=a.body&&(a.body.zip_aabb=
!0)):(a.aabb.minx=this.aabb.minx,a.aabb.miny=this.aabb.miny,a.aabb.maxx=this.aabb.maxx,a.aabb.maxy=this.aabb.maxy);var b=a.material;b.outer=null;b.next=W.zpp_pool;W.zpp_pool=b;b=a.filter;b.outer=null;b.next=za.zpp_pool;za.zpp_pool=b;a.material=this.material;a.filter=this.filter;null!=this.fluidProperties&&(a.fluidProperties=this.fluidProperties);a.fluidEnabled=this.fluidEnabled;a.sensorEnabled=this.sensorEnabled;null!=this.userData&&(a.userData=ub.copy(this.userData));this.copyto(a.outer);return a.outer},
__class__:cd});var Re=function(){this.radius=0;this.outer_zn=null;cd.call(this,0);this.circle=this;this.zip_localCOM=!1};Re.__name__=!0;Re.__super__=cd;Re.prototype=I(cd.prototype,{__clear:function(){},invalidate_radius:function(){this.invalidate_area_inertia();this.invalidate_angDrag();this.zip_aabb=!0;null!=this.body&&(this.body.zip_aabb=!0);null!=this.body&&this.body.wake()},localCOM_validate:function(){this.wrap_localCOM.zpp_inner.x=this.localCOMx;this.wrap_localCOM.zpp_inner.y=this.localCOMy},
localCOM_invalidate:function(a){this.localCOMx=a.x;this.localCOMy=a.y;this.invalidate_localCOM();null!=this.body&&this.body.wake()},localCOM_immutable:function(){if(null!=this.body&&1==this.body.type&&null!=this.body.space)throw new f("Error: Cannot modify localCOM of Circle added to a static Body whilst within a Space");},setupLocalCOM:function(){this.wrap_localCOM=E.get(this.localCOMx,this.localCOMy,null);this.wrap_localCOM.zpp_inner._inuse=!0;this.wrap_localCOM.zpp_inner._validate=w(this,this.localCOM_validate);
this.wrap_localCOM.zpp_inner._invalidate=w(this,this.localCOM_invalidate);this.wrap_localCOM.zpp_inner._isimmutable=w(this,this.localCOM_immutable)},__validate_aabb:function(){this.zip_worldCOM&&null!=this.body&&(this.zip_worldCOM=!1,this.zip_localCOM&&(this.zip_localCOM=!1,1==this.type&&this.polygon.__validate_localCOM(),null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy)),this.body.validate_axis(),this.worldCOMx=this.body.posx+
(this.body.axisy*this.localCOMx-this.body.axisx*this.localCOMy),this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+this.localCOMy*this.body.axisy));var a=this.radius,b=this.radius;this.aabb.minx=this.worldCOMx-a;this.aabb.miny=this.worldCOMy-b;this.aabb.maxx=this.worldCOMx+a;this.aabb.maxy=this.worldCOMy+b},_force_validate_aabb:function(){this.worldCOMx=this.body.posx+(this.body.axisy*this.localCOMx-this.body.axisx*this.localCOMy);this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+
this.localCOMy*this.body.axisy);this.aabb.minx=this.worldCOMx-this.radius;this.aabb.miny=this.worldCOMy-this.radius;this.aabb.maxx=this.worldCOMx+this.radius;this.aabb.maxy=this.worldCOMy+this.radius},__validate_sweepRadius:function(){this.sweepCoef=Math.sqrt(this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy);this.sweepRadius=this.sweepCoef+this.radius},__validate_area_inertia:function(){var a=this.radius*this.radius;this.area=a*Math.PI;this.inertia=.5*a+(this.localCOMx*this.localCOMx+this.localCOMy*
this.localCOMy)},__validate_angDrag:function(){var a=this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy,b=this.radius*this.radius;this.angDrag=(a+2*b)*this.material.dynamicFriction*u.fluidAngularDragFriction+.5*u.fluidAngularDrag*(1+u.fluidVacuumDrag)*a;this.angDrag/=2*(a+.5*b)},__scale:function(a,b){var c;c=((0>a?-a:a)+(0>b?-b:b))/2;this.radius=0>c?this.radius*-c:this.radius*c;this.invalidate_radius();0<this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy&&(this.localCOMx*=a,this.localCOMy*=
b,this.invalidate_localCOM())},__translate:function(a,b){this.localCOMx+=1*a;this.localCOMy+=1*b;this.invalidate_localCOM()},__rotate:function(a,b){if(0<this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy){var c=0,d=0,c=b*this.localCOMx-a*this.localCOMy,d=this.localCOMx*a+this.localCOMy*b;this.localCOMx=c;this.localCOMy=d;this.invalidate_localCOM()}},__transform:function(a){var b=a.zpp_inner.a*a.zpp_inner.d-a.zpp_inner.b*a.zpp_inner.c;0>b&&(b=-b);this.radius*=Math.sqrt(b);b=a.zpp_inner.a*
this.localCOMx+a.zpp_inner.b*this.localCOMy+a.zpp_inner.tx;this.localCOMy=a.zpp_inner.c*this.localCOMx+a.zpp_inner.d*this.localCOMy+a.zpp_inner.ty;this.localCOMx=b;this.invalidate_radius();this.invalidate_localCOM()},__copy:function(){var a=(new Gd(this.radius)).zpp_inner_zn;a.localCOMx=this.localCOMx;a.localCOMy=this.localCOMy;a.zip_localCOM=!1;return a},__class__:Re});var Ca=function(){this.tp0=this.tp1=0;this.lp0=this.gp0=this.lp1=this.gp1=null;this.length=this.lprojection=this.gprojection=0;this.wrap_gnorm=
null;this.gnormx=this.gnormy=0;this.wrap_lnorm=null;this.lnormx=this.lnormy=0;this.next=this.polygon=this.outer=null;this.gprojection=this.lprojection=this.length=this.gnormy=this.gnormx=this.lnormy=this.lnormx=0};Ca.__name__=!0;Ca.prototype={free:function(){this.polygon=null},alloc:function(){},wrapper:function(){null==this.outer&&(Ca.internal=!0,this.outer=new pf,Ca.internal=!1,this.outer.zpp_inner=this);return this.outer},lnorm_validate:function(){if(null==this.polygon)throw new f("Error: Edge not currently in use");
this.polygon.validate_laxi();this.wrap_lnorm.zpp_inner.x=this.lnormx;this.wrap_lnorm.zpp_inner.y=this.lnormy},gnorm_validate:function(){if(null==this.polygon)throw new f("Error: Edge not currently in use");if(null==this.polygon.body)throw new f("Error: Edge worldNormal only makes sense if the parent Polygon is contained within a rigid body");this.polygon.validate_gaxi();this.wrap_gnorm.zpp_inner.x=this.gnormx;this.wrap_gnorm.zpp_inner.y=this.gnormy},getlnorm:function(){this.wrap_lnorm=E.get(this.lnormx,
this.lnormy,null);this.wrap_lnorm.zpp_inner._immutable=!0;this.wrap_lnorm.zpp_inner._validate=w(this,this.lnorm_validate)},getgnorm:function(){this.wrap_gnorm=E.get(this.gnormx,this.gnormy,null);this.wrap_gnorm.zpp_inner._immutable=!0;this.wrap_gnorm.zpp_inner._validate=w(this,this.gnorm_validate)},__class__:Ca};var Se=function(){this.reverse_flag=this.zip_lverts=this.zip_laxi=this.zip_gverts=this.zip_gaxi=this.zip_valid=this.zip_sanitation=!1;this.edgeCnt=0;this.outer_zn=this.lverts=this.wrap_lverts=
this.gverts=this.wrap_gverts=this.edges=this.wrap_edges=null;cd.call(this,1);this.polygon=this;this.lverts=new P;this.gverts=new P;this.edges=new $e;this.edgeCnt=0};Se.__name__=!0;Se.__super__=cd;Se.prototype=I(cd.prototype,{__clear:function(){},lverts_pa_invalidate:function(a){this.invalidate_lverts()},lverts_pa_immutable:function(){if(null!=this.body&&1==this.body.type&&null!=this.body.space)throw new f("Error: Cannot modify local vertex of Polygon added to a static body whilst within a Space");
},gverts_pa_validate:function(){if(null==this.body)throw new f("Error: World vertex only makes sense when Polygon is contained in a rigid body");this.validate_gverts()},lverts_post_adder:function(a){a.zpp_inner._invalidate=w(this,this.lverts_pa_invalidate);a.zpp_inner._isimmutable=w(this,this.lverts_pa_immutable);for(var b=null,c=null,d=this.lverts.next;null!=d&&d!=a.zpp_inner;)b=null==b?this.gverts.next:b.next,c=null==c?this.edges.head:c.next,d=d.next;a=P.get(0,0,!0);this.gverts.insert(b,a);null!=
this.lverts.next.next&&(null==this.lverts.next.next.next?(null==Ca.zpp_pool?c=new Ca:(c=Ca.zpp_pool,Ca.zpp_pool=c.next,c.next=null),null,c.polygon=this,this.edges.add(c),null==Ca.zpp_pool?c=new Ca:(c=Ca.zpp_pool,Ca.zpp_pool=c.next,c.next=null),null,c.polygon=this,this.edges.add(c),this.edgeCnt+=2):(null==Ca.zpp_pool?b=new Ca:(b=Ca.zpp_pool,Ca.zpp_pool=b.next,b.next=null),null,b.polygon=this,this.edges.insert(c,b),this.edgeCnt++));a._validate=w(this,this.gverts_pa_validate)},lverts_subber:function(a){this.cleanup_lvert(a.zpp_inner)},
lverts_invalidate:function(a){this.invalidate_lverts()},lverts_validate:function(){this.validate_lverts()},lverts_modifiable:function(){this.immutable_midstep("Polygon::localVerts");if(null!=this.body&&1==this.body.type&&null!=this.body.space)throw new f("Error: Cannot modifiy shapes of static object once added to Space");},gverts_validate:function(){this.validate_gverts()},edges_validate:function(){this.validate_lverts()},getlverts:function(){this.wrap_lverts=de.get(this.lverts);this.wrap_lverts.zpp_inner.post_adder=
w(this,this.lverts_post_adder);this.wrap_lverts.zpp_inner.subber=w(this,this.lverts_subber);this.wrap_lverts.zpp_inner._invalidate=w(this,this.lverts_invalidate);this.wrap_lverts.zpp_inner._validate=w(this,this.lverts_validate);this.wrap_lverts.zpp_inner._modifiable=w(this,this.lverts_modifiable);this.wrap_lverts.zpp_inner.reverse_flag=this.reverse_flag},getgverts:function(){this.wrap_gverts=de.get(this.gverts,!0);this.wrap_gverts.zpp_inner.reverse_flag=this.reverse_flag;this.wrap_gverts.zpp_inner._validate=
w(this,this.gverts_validate)},getedges:function(){this.wrap_edges=hd.get(this.edges,!0);this.wrap_edges.zpp_inner.reverse_flag=this.reverse_flag;this.wrap_edges.zpp_inner._validate=w(this,this.edges_validate)},invalidate_lverts:function(){this.invalidate_laxi();this.invalidate_area_inertia();this.invalidate_angDrag();this.invalidate_localCOM();this.invalidate_gverts();this.zip_sanitation=this.zip_valid=this.zip_lverts=!0;null!=this.body&&this.body.wake()},invalidate_laxi:function(){this.invalidate_gaxi();
this.zip_laxi=this.zip_sweepRadius=!0},invalidate_gverts:function(){this.zip_aabb=!0;null!=this.body&&(this.body.zip_aabb=!0);this.zip_gverts=!0},invalidate_gaxi:function(){this.zip_gaxi=!0},valid:function(){if(this.zip_valid){this.zip_valid=!1;this.zip_sanitation&&(this.zip_sanitation=!1,this.splice_collinear_real());if(3>this.lverts.length)return null==g.ValidationResult_DEGENERATE&&(g.internal=!0,g.ValidationResult_DEGENERATE=new xa,g.internal=!1),this.validation=g.ValidationResult_DEGENERATE;
this.validate_lverts();this.validate_area_inertia();if(this.area<u.epsilon)return null==g.ValidationResult_DEGENERATE&&(g.internal=!0,g.ValidationResult_DEGENERATE=new xa,g.internal=!1),this.validation=g.ValidationResult_DEGENERATE;for(var a=!1,b=!1,c=!0,d=this.lverts.next,e=d,h=d=d.next,d=d.next;null!=d;){var f=d,q=0,k=0,q=f.x-h.x,k=f.y-h.y,l=0,n=0,l=h.x-e.x,n=h.y-e.y,q=n*q-l*k;q>u.epsilon?b=!0:q<-u.epsilon&&(a=!0);if(b&&a){c=!1;break}e=h;h=f;d=d.next}c&&(f=d=this.lverts.next,k=q=0,q=f.x-h.x,k=f.y-
h.y,n=l=0,l=h.x-e.x,n=h.y-e.y,e=n*q-l*k,e>u.epsilon?b=!0:e<-u.epsilon&&(a=!0),b&&a&&(c=!1),c&&(e=h,h=f,f=d=d.next,d=c=0,c=f.x-h.x,d=f.y-h.y,q=f=0,f=h.x-e.x,q=h.y-e.y,h=q*c-f*d,h>u.epsilon?b=!0:h<-u.epsilon&&(a=!0)));if(b&&a)return null==g.ValidationResult_CONCAVE&&(g.internal=!0,g.ValidationResult_CONCAVE=new xa,g.internal=!1),this.validation=g.ValidationResult_CONCAVE;h=a=!0;b=e=this.lverts.next;for(e=e.next;null!=e;){c=e;if(!a){h=!1;break}f=!0;d=q=this.lverts.next;for(q=q.next;null!=q;){k=q;if(b!=
d&&b!=k&&c!=d&&c!=k){var n=l=0,l=b.x-d.x,n=b.y-d.y,r=0,z=0,r=c.x-b.x,z=c.y-b.y,x=0,p=0,x=k.x-d.x,p=k.y-d.y,w=z*x-r*p;if(w*w>u.epsilon&&(w=1/w,x=(p*l-x*n)*w,x>u.epsilon&&x<1-u.epsilon&&(l=(z*l-r*n)*w,l>u.epsilon&&l<1-u.epsilon))){f=a=!1;break}}d=k;q=q.next}f&&(n=this.lverts.next,b!=d&&b!=n&&c!=d&&c!=n&&(q=f=0,f=b.x-d.x,q=b.y-d.y,l=k=0,k=c.x-b.x,l=c.y-b.y,r=b=0,b=n.x-d.x,r=n.y-d.y,d=l*b-k*r,d*d>u.epsilon&&(d=1/d,b=(r*f-b*q)*d,b>u.epsilon&&b<1-u.epsilon&&(b=(l*f-k*q)*d,b>u.epsilon&&b<1-u.epsilon&&(a=
!1)))));b=c;e=e.next}if(h){do if(e=this.lverts.next,a){c=!0;h=d=this.lverts.next;for(d=d.next;null!=d;){f=d;if(b!=h&&b!=f&&e!=h&&e!=f&&(k=q=0,q=b.x-h.x,k=b.y-h.y,n=l=0,l=e.x-b.x,n=e.y-b.y,w=z=0,z=f.x-h.x,w=f.y-h.y,r=n*z-l*w,r*r>u.epsilon&&(r=1/r,z=(w*q-z*k)*r,z>u.epsilon&&z<1-u.epsilon&&(q=(n*q-l*k)*r,q>u.epsilon&&q<1-u.epsilon)))){c=a=!1;break}h=f;d=d.next}c&&(k=this.lverts.next,b!=h&&b!=k&&e!=h&&e!=k&&(d=c=0,c=b.x-h.x,d=b.y-h.y,q=f=0,f=e.x-b.x,q=e.y-b.y,l=e=0,e=k.x-h.x,l=k.y-h.y,h=q*e-f*l,h*h>u.epsilon&&
(h=1/h,e=(l*c-e*d)*h,e>u.epsilon&&e<1-u.epsilon&&(h*=q*c-f*d,h>u.epsilon&&h<1-u.epsilon&&(a=!1)))))}while(0)}a?(null==g.ValidationResult_VALID&&(g.internal=!0,g.ValidationResult_VALID=new xa,g.internal=!1),a=this.validation=g.ValidationResult_VALID):(null==g.ValidationResult_SELF_INTERSECTING&&(g.internal=!0,g.ValidationResult_SELF_INTERSECTING=new xa,g.internal=!1),a=this.validation=g.ValidationResult_SELF_INTERSECTING);return a}return this.validation},validate_lverts:function(){this.zip_lverts&&
(this.zip_lverts=!1,2<this.lverts.length&&(this.validate_area_inertia(),0>this.area&&(this.reverse_vertices(),this.area=-this.area)))},cleanup_lvert:function(a){for(var b=null,c=null,d=this.lverts.next;null!=d&&d!=a;)b=null==b?this.gverts.next:b.next,c=null==c?this.edges.head:c.next,d=d.next;a=null==b?this.gverts.next:b.next;this.gverts.erase(b);null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null);a._isimmutable=null;a._validate=null;a._invalidate=null;a.next=P.zpp_pool;P.zpp_pool=a;2==this.edgeCnt?
(c=this.edges.pop_unsafe(),c.polygon=null,c.next=Ca.zpp_pool,Ca.zpp_pool=c,c=this.edges.pop_unsafe(),c.polygon=null,c.next=Ca.zpp_pool,Ca.zpp_pool=c,this.edgeCnt=0):0!=this.edgeCnt&&(b=null==c?this.edges.head.elt:c.next.elt,this.edges.erase(c),b.polygon=null,b.next=Ca.zpp_pool,Ca.zpp_pool=b,this.edgeCnt--)},splice_collinear:function(){this.zip_sanitation&&(this.zip_sanitation=!1,this.splice_collinear_real())},splice_collinear_real:function(){if(null!=this.lverts.next&&null!=this.lverts.next.next&&
null!=this.lverts.next.next.next){for(var a=null,b=this.lverts.next;null!=b;){var c=b,d=null==b.next?this.lverts.next:b.next;eb.vec_dsq(c.x,c.y,d.x,d.y)<u.epsilon*u.epsilon?(this.cleanup_lvert(b),b=this.lverts.erase(a)):(a=b,b=b.next)}if(null!=this.lverts.next){do for(a=!1,b=this.lverts.next;null!=b;){var c=null==b.next?this.lverts.next:b.next,e=b,d=c,h=null==c.next?this.lverts.next:c.next,f=0,g=0,f=d.x-e.x,g=d.y-e.y,k=e=0,e=h.x-d.x,k=h.y-d.y,d=k*f-e*g;d*d>=u.epsilon*u.epsilon||(this.cleanup_lvert(c),
this.lverts.erase(null==b.next?null:b),a=!0);b=b.next}while(a)}}},reverse_vertices:function(){this.lverts.reverse();this.gverts.reverse();this.edges.reverse();var a=this.edges.iterator_at(this.edgeCnt-1),b=this.edges.pop_unsafe();this.edges.insert(a,b);this.reverse_flag=!this.reverse_flag;null!=this.wrap_lverts&&(this.wrap_lverts.zpp_inner.reverse_flag=this.reverse_flag);null!=this.wrap_gverts&&(this.wrap_gverts.zpp_inner.reverse_flag=this.reverse_flag);null!=this.wrap_edges&&(this.wrap_edges.zpp_inner.reverse_flag=
this.reverse_flag)},validate_laxi:function(){if(this.zip_laxi){this.zip_laxi=!1;this.validate_lverts();for(var a=this.edges.head,b=this.lverts.next,c=b,b=b.next;null!=b;){var d=b,e=a.elt,a=a.next;e.lp0=c;e.lp1=d;var h=0,f=0,h=c.x-d.x,f=c.y-d.y,g=Math.sqrt(h*h+f*f);e.length=g;g=1/g;h*=g;f*=g;g=h;h=-f;f=g;e.lprojection=h*c.x+f*c.y;e.lnormx=h;e.lnormy=f;null!=e.wrap_lnorm&&(e.wrap_lnorm.zpp_inner.x=h,e.wrap_lnorm.zpp_inner.y=f);c=d;b=b.next}e=this.lverts.next;a=a.elt;a.lp0=c;a.lp1=e;d=b=0;b=c.x-e.x;
d=c.y-e.y;e=Math.sqrt(b*b+d*d);a.length=e;e=1/e;h=b*e;b=-(d*e);d=h;a.lprojection=b*c.x+d*c.y;a.lnormx=b;a.lnormy=d;null!=a.wrap_lnorm&&(a.wrap_lnorm.zpp_inner.x=b,a.wrap_lnorm.zpp_inner.y=d)}},validate_gverts:function(){if(this.zip_gverts&&null!=this.body){this.zip_gverts=!1;this.validate_lverts();this.body.validate_axis();for(var a=this.lverts.next,b=this.gverts.next;null!=b;){var c=b,d=a,a=a.next;c.x=this.body.posx+(this.body.axisy*d.x-this.body.axisx*d.y);c.y=this.body.posy+(d.x*this.body.axisx+
d.y*this.body.axisy);b=b.next}}},validate_gaxi:function(){if(this.zip_gaxi&&null!=this.body){this.zip_gaxi=!1;this.validate_laxi();this.body.validate_axis();this.validate_gverts();for(var a=this.edges.head,b=this.gverts.next,c=b,b=b.next;null!=b;){var d=b,e=a.elt,a=a.next;e.gp0=c;e.gp1=d;e.gnormx=this.body.axisy*e.lnormx-this.body.axisx*e.lnormy;e.gnormy=e.lnormx*this.body.axisx+e.lnormy*this.body.axisy;e.gprojection=this.body.posx*e.gnormx+this.body.posy*e.gnormy+e.lprojection;null!=e.wrap_gnorm&&
(e.wrap_gnorm.zpp_inner.x=e.gnormx,e.wrap_gnorm.zpp_inner.y=e.gnormy);e.tp0=e.gp0.y*e.gnormx-e.gp0.x*e.gnormy;e.tp1=e.gp1.y*e.gnormx-e.gp1.x*e.gnormy;c=d;b=b.next}b=this.gverts.next;a=a.elt;a.gp0=c;a.gp1=b;a.gnormx=this.body.axisy*a.lnormx-this.body.axisx*a.lnormy;a.gnormy=a.lnormx*this.body.axisx+a.lnormy*this.body.axisy;a.gprojection=this.body.posx*a.gnormx+this.body.posy*a.gnormy+a.lprojection;null!=a.wrap_gnorm&&(a.wrap_gnorm.zpp_inner.x=a.gnormx,a.wrap_gnorm.zpp_inner.y=a.gnormy);a.tp0=a.gp0.y*
a.gnormx-a.gp0.x*a.gnormy;a.tp1=a.gp1.y*a.gnormx-a.gp1.x*a.gnormy}},__validate_aabb:function(){this.validate_gverts();if(null==this.lverts.next)throw new f("Error: An empty polygon has no meaningful bounds");var a=this.gverts.next;this.aabb.minx=a.x;this.aabb.miny=a.y;this.aabb.maxx=a.x;this.aabb.maxy=a.y;for(a=this.gverts.next.next;null!=a;){var b=a;b.x<this.aabb.minx&&(this.aabb.minx=b.x);b.x>this.aabb.maxx&&(this.aabb.maxx=b.x);b.y<this.aabb.miny&&(this.aabb.miny=b.y);b.y>this.aabb.maxy&&(this.aabb.maxy=
b.y);a=a.next}},_force_validate_aabb:function(){var a=this.lverts.next,b=this.gverts.next,c=a,a=a.next;b.x=this.body.posx+(this.body.axisy*c.x-this.body.axisx*c.y);b.y=this.body.posy+(c.x*this.body.axisx+c.y*this.body.axisy);this.aabb.minx=b.x;this.aabb.miny=b.y;this.aabb.maxx=b.x;this.aabb.maxy=b.y;for(b=this.gverts.next.next;null!=b;){var c=b,d=a,a=a.next;c.x=this.body.posx+(this.body.axisy*d.x-this.body.axisx*d.y);c.y=this.body.posy+(d.x*this.body.axisx+d.y*this.body.axisy);c.x<this.aabb.minx&&
(this.aabb.minx=c.x);c.x>this.aabb.maxx&&(this.aabb.maxx=c.x);c.y<this.aabb.miny&&(this.aabb.miny=c.y);c.y>this.aabb.maxy&&(this.aabb.maxy=c.y);b=b.next}},__validate_sweepRadius:function(){var a=0,b=0;this.validate_laxi();for(var c=this.lverts.next;null!=c;){var d=c,d=d.x*d.x+d.y*d.y;d>a&&(a=d);c=c.next}for(c=this.edges.head;null!=c;){d=c.elt;if(d.lprojection<b&&(b=d.lprojection,0>b))break;c=c.next}0>b&&(b=0);this.sweepRadius=Math.sqrt(a);this.sweepCoef=this.sweepRadius-b},__validate_area_inertia:function(){if(null==
this.lverts.next||null==this.lverts.next.next||null==this.lverts.next.next.next)this.inertia=this.area=0;else{for(var a=this.area=0,b=0,c=this.lverts.next,d=c,e=c=c.next,c=c.next;null!=c;){var h=c,f=e.y*d.x-e.x*d.y,a=a+f*(e.x*e.x+e.y*e.y+(e.x*d.x+e.y*d.y)+(d.x*d.x+d.y*d.y)),b=b+f;this.area+=e.x*(h.y-d.y);d=e;e=h;c=c.next}f=c=this.lverts.next;h=e.y*d.x-e.x*d.y;a+=h*(e.x*e.x+e.y*e.y+(e.x*d.x+e.y*d.y)+(d.x*d.x+d.y*d.y));this.area+=e.x*(f.y-d.y);d=e;e=f;c=c.next;f=e.y*d.x-e.x*d.y;a+=f*(e.x*e.x+e.y*e.y+
(e.x*d.x+e.y*d.y)+(d.x*d.x+d.y*d.y));b=b+h+f;this.area+=e.x*(c.y-d.y);this.inertia=a/(6*b);this.area*=.5;0>this.area&&(this.area=-this.area,this.reverse_vertices())}},__validate_angDrag:function(){if(3>this.lverts.length)throw new f("Error: Polygon's with less than 3 vertices have no meaningful angDrag");this.validate_area_inertia();this.validate_laxi();for(var a=0,b=this.edges.head,c=0,d=this.lverts.next,e=d,d=d.next;null!=d;){var h=d,g=b.elt,b=b.next,c=c+g.length,q=0,k=0,q=h.x-e.x,k=h.y-e.y,a=a+
g.length*u.fluidAngularDragFriction*this.material.dynamicFriction*g.lprojection*g.lprojection,l=-(e.y*g.lnormx-e.x*g.lnormy)/(k*g.lnormx-q*g.lnormy);if(0<l){var n;n=1<l?1:l;var r=0,z=0,r=e.x,z=e.y,x=n,r=r+q*x,z=z+k*x,x=g.lnormy*e.x-g.lnormx*e.y,r=g.lnormy*r-g.lnormx*z,a=a+(r*r*r-x*x*x)/(3*(r-x))*n*g.length*u.fluidAngularDrag}1>l&&(l=0>l?0:l,r=n=0,n=e.x,r=e.y,e=l,n+=q*e,r+=k*e,e=g.lnormy*n-g.lnormx*r,q=g.lnormy*h.x-g.lnormx*h.y,a+=(q*q*q-e*e*e)/(3*(q-e))*u.fluidVacuumDrag*(1-l)*g.length*u.fluidAngularDrag);
e=h;d=d.next}d=this.lverts.next;b=b.elt;c+=b.length;g=h=0;h=d.x-e.x;g=d.y-e.y;a+=b.length*u.fluidAngularDragFriction*this.material.dynamicFriction*b.lprojection*b.lprojection;q=-(e.y*b.lnormx-e.x*b.lnormy)/(g*b.lnormx-h*b.lnormy);0<q&&(k=1<q?1:q,r=n=0,n=e.x,r=e.y,l=b.lnormy*e.x-b.lnormx*e.y,n=b.lnormy*(n+h*k)-b.lnormx*(r+g*k),a+=(n*n*n-l*l*l)/(3*(n-l))*k*b.length*u.fluidAngularDrag);1>q&&(q=0>q?0:q,l=k=0,k=e.x,l=e.y,e=b.lnormy*(k+h*q)-b.lnormx*(l+g*q),d=b.lnormy*d.x-b.lnormx*d.y,a+=(d*d*d-e*e*e)/
(3*(d-e))*u.fluidVacuumDrag*(1-q)*b.length*u.fluidAngularDrag);this.angDrag=a/(this.inertia*c)},__validate_localCOM:function(){if(null==this.lverts.next)throw new f("Error: An empty polygon has no meaningful localCOM");if(null==this.lverts.next.next)this.localCOMx=this.lverts.next.x,this.localCOMy=this.lverts.next.y;else if(null==this.lverts.next.next.next)this.localCOMx=this.lverts.next.x,this.localCOMy=this.lverts.next.y,this.localCOMx+=1*this.lverts.next.next.x,this.localCOMy+=1*this.lverts.next.next.y,
this.localCOMx*=.5,this.localCOMy*=.5;else{for(var a=this.localCOMy=this.localCOMx=0,b=this.lverts.next,c=b,d=b=b.next,b=b.next;null!=b;){var e=b,a=a+d.x*(e.y-c.y),c=e.y*d.x-e.x*d.y;this.localCOMx+=(d.x+e.x)*c;this.localCOMy+=(d.y+e.y)*c;c=d;d=e;b=b.next}e=b=this.lverts.next;a+=d.x*(e.y-c.y);c=e.y*d.x-e.x*d.y;this.localCOMx+=(d.x+e.x)*c;this.localCOMy+=(d.y+e.y)*c;c=d;d=e;b=b.next;a+=d.x*(b.y-c.y);c=b.y*d.x-b.x*d.y;this.localCOMx+=(d.x+b.x)*c;this.localCOMy+=(d.y+b.y)*c;a=1/(3*a);this.localCOMx*=
a;this.localCOMy*=a}},localCOM_validate:function(){if(null==this.lverts.next)throw new f("Error: An empty polygon does not have any meaningful localCOM");this.zip_localCOM&&(this.zip_localCOM=!1,1==this.type&&this.polygon.__validate_localCOM(),null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy))},localCOM_invalidate:function(a){this.zip_localCOM&&(this.zip_localCOM=!1,1==this.type&&this.polygon.__validate_localCOM(),null!=this.wrap_localCOM&&
(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy));var b=0,c=0,b=a.x-this.localCOMx,c=a.y-this.localCOMy;for(a=this.lverts.next;null!=a;){var d=a;d.x+=1*b;d.y+=1*c;a=a.next}this.invalidate_lverts()},setupLocalCOM:function(){this.wrap_localCOM=E.get(this.localCOMx,this.localCOMy,null);this.wrap_localCOM.zpp_inner._inuse=!0;this.wrap_localCOM.zpp_inner._validate=w(this,this.localCOM_validate);this.wrap_localCOM.zpp_inner._invalidate=w(this,this.localCOM_invalidate)},
__translate:function(a,b){for(var c=this.lverts.next;null!=c;){var d=c;d.x+=1*a;d.y+=1*b;c=c.next}this.invalidate_lverts()},__scale:function(a,b){for(var c=this.lverts.next;null!=c;){var d=c;d.x*=a;d.y*=b;c=c.next}this.invalidate_lverts()},__rotate:function(a,b){for(var c=this.lverts.next;null!=c;){var d=c,e=0,h=0,e=b*d.x-a*d.y,h=d.x*a+d.y*b;d.x=e;d.y=h;c=c.next}this.invalidate_lverts()},__transform:function(a){for(var b=this.lverts.next;null!=b;){var c=b,d=a.zpp_inner.a*c.x+a.zpp_inner.b*c.y+a.zpp_inner.tx;
c.y=a.zpp_inner.c*c.x+a.zpp_inner.d*c.y+a.zpp_inner.ty;c.x=d;b=b.next}this.invalidate_lverts()},__copy:function(){return(new Ea(this.outer_zn.get_localVerts())).zpp_inner_zn},__class__:Se});var Dd=function(){this.sweep=this.dynab=this.aabbShape=this.matrix=this.circShape=null;this.is_sweep=!1;this.space=null};Dd.__name__=!0;Dd.prototype={insert:function(a){this.is_sweep?this.sweep.__insert(a):this.dynab.__insert(a)},remove:function(a){this.is_sweep?this.sweep.__remove(a):this.dynab.__remove(a)},sync:function(a){this.is_sweep?
!this.sweep.space.continuous&&a.zip_aabb&&null!=a.body&&(a.zip_aabb=!1,0==a.type?a.circle.__validate_aabb():a.polygon.__validate_aabb()):this.dynab.__sync(a)},broadphase:function(a,b){},clear:function(){},shapesUnderPoint:function(a,b,c,d){return null},bodiesUnderPoint:function(a,b,c,d){return null},updateAABBShape:function(a){if(null==this.aabbShape){var b=ld;null==g.BodyType_STATIC&&(g.internal=!0,g.BodyType_STATIC=new Ga,g.internal=!1);(new b(g.BodyType_STATIC)).zpp_inner.wrap_shapes.add(this.aabbShape=
new Ea(Ea.rect(a.minx,a.miny,a.maxx-a.minx,a.maxy-a.miny)))}else{var b=this.aabbShape.zpp_inner.aabb,c=(a.maxx-a.minx)/(b.maxx-b.minx),d=(a.maxy-a.miny)/(b.maxy-b.miny);null==this.matrix&&(this.matrix=new bb);this.matrix.set_a(c);this.matrix.set_b(this.matrix.set_c(0));this.matrix.set_d(d);this.matrix.set_tx(a.minx-c*b.minx);this.matrix.set_ty(a.miny-d*b.miny);this.aabbShape.transform(this.matrix)}this.aabbShape.zpp_inner.validate_aabb();this.aabbShape.zpp_inner.polygon.validate_gaxi()},shapesInAABB:function(a,
b,c,d,e){return null},bodiesInAABB:function(a,b,c,d,e){return null},updateCircShape:function(a,b,c){if(null==this.circShape){var d=ld;null==g.BodyType_STATIC&&(g.internal=!0,g.BodyType_STATIC=new Ga,g.internal=!1);(new d(g.BodyType_STATIC)).zpp_inner.wrap_shapes.add(this.circShape=new Gd(c,E.get(a,b,null)))}else d=this.circShape.zpp_inner.circle,c/=d.radius,null==this.matrix&&(this.matrix=new bb),this.matrix.set_a(this.matrix.set_d(c)),this.matrix.set_b(this.matrix.set_c(0)),this.matrix.set_tx(a-
c*d.localCOMx),this.matrix.set_ty(b-c*d.localCOMy),this.circShape.transform(this.matrix);this.circShape.zpp_inner.validate_aabb()},shapesInCircle:function(a,b,c,d,e,h){return null},bodiesInCircle:function(a,b,c,d,e,h){return null},validateShape:function(a){1==a.type&&a.polygon.validate_gaxi();a.zip_aabb&&null!=a.body&&(a.zip_aabb=!1,0==a.type?a.circle.__validate_aabb():a.polygon.__validate_aabb());a.zip_worldCOM&&null!=a.body&&(a.zip_worldCOM=!1,a.zip_localCOM&&(a.zip_localCOM=!1,1==a.type&&a.polygon.__validate_localCOM(),
null!=a.wrap_localCOM&&(a.wrap_localCOM.zpp_inner.x=a.localCOMx,a.wrap_localCOM.zpp_inner.y=a.localCOMy)),a.body.validate_axis(),a.worldCOMx=a.body.posx+(a.body.axisy*a.localCOMx-a.body.axisx*a.localCOMy),a.worldCOMy=a.body.posy+(a.localCOMx*a.body.axisx+a.localCOMy*a.body.axisy))},shapesInShape:function(a,b,c,d){return null},bodiesInShape:function(a,b,c,d){return null},rayCast:function(a,b,c){return null},rayMultiCast:function(a,b,c,d){return null},__class__:Dd};var Oa=function(){this.synced=this.first_sync=
!1;this.snext=null;this.moved=!1;this.next=this.mnext=null;this.height=this.rayt=0;this.parent=this.child1=this.child2=null;this.dyn=!1;this.aabb=this.shape=null;this.height=-1};Oa.__name__=!0;Oa.prototype={alloc:function(){null==X.zpp_pool?this.aabb=new X:(this.aabb=X.zpp_pool,X.zpp_pool=this.aabb.next,this.aabb.next=null);null;this.first_sync=this.synced=this.moved=!1},free:function(){this.height=-1;var a=this.aabb;null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null);a.wrap_min=a.wrap_max=null;
a._invalidate=null;a._validate=null;a.next=X.zpp_pool;X.zpp_pool=a;this.mnext=this.snext=this.next=this.child1=this.child2=this.parent=null},isLeaf:function(){return null==this.child1},__class__:Oa};var Aa=function(){this.arb=this.next=null;this.id=this.di=0;this.first=this.sleeping=!1;this.n1=this.n2=null};Aa.__name__=!0;Aa.prototype={alloc:function(){},free:function(){this.n1=this.n2=null;this.sleeping=!1},__class__:Aa};var Gb=function(){this.root=null};Gb.__name__=!0;Gb.prototype={clear:function(){if(null!=
this.root){var a;this.root.next=null;for(a=this.root;null!=a;){var b;b=a;a=b.next;b.next=null;null==b.child1?(b.shape.node=null,b.shape.removedFromSpace(),b.shape=null):(null!=b.child1&&(b.child1.next=a,a=b.child1),null!=b.child2&&(b.child2.next=a,a=b.child2));b.free();b.next=Oa.zpp_pool;Oa.zpp_pool=b}this.root=null}},insertLeaf:function(a){this.inlined_insertLeaf(a)},inlined_insertLeaf:function(a){if(null==this.root)this.root=a,this.root.parent=null;else{for(var b=a.aabb,c=this.root;null!=c.child1;){var d=
c.child1,e=c.child2,h=c.aabb.perimeter();Gb.tmpaabb.setCombine(c.aabb,b);var f=Gb.tmpaabb.perimeter(),g=2*f,h=2*(f-h);Gb.tmpaabb.setCombine(b,d.aabb);null==d.child1?f=Gb.tmpaabb.perimeter()+h:(f=d.aabb.perimeter(),f=Gb.tmpaabb.perimeter()-f+h);Gb.tmpaabb.setCombine(b,e.aabb);if(null==e.child1)h=Gb.tmpaabb.perimeter()+h;else var k=e.aabb.perimeter(),h=Gb.tmpaabb.perimeter()-k+h;if(g<f&&g<h)break;else c=f<h?d:e}d=c.parent;null==Oa.zpp_pool?e=new Oa:(e=Oa.zpp_pool,Oa.zpp_pool=e.next,e.next=null);null==
X.zpp_pool?e.aabb=new X:(e.aabb=X.zpp_pool,X.zpp_pool=e.aabb.next,e.aabb.next=null);null;e.moved=!1;e.synced=!1;e.first_sync=!1;e.parent=d;e.aabb.setCombine(b,c.aabb);e.height=c.height+1;null!=d?(d.child1==c?d.child1=e:d.child2=e,e.child1=c,e.child2=a,c.parent=e,a.parent=e):(e.child1=c,e.child2=a,c.parent=e,this.root=a.parent=e);for(c=a.parent;null!=c;)c=this.balance(c),a=c.child1,b=c.child2,d=c,e=void 0,e=a.height,g=b.height,e=e>g?e:g,d.height=1+e,c.aabb.setCombine(a.aabb,b.aabb),c=c.parent}},removeLeaf:function(a){this.inlined_removeLeaf(a)},
inlined_removeLeaf:function(a){if(a==this.root)this.root=null;else{var b=a.parent,c=b.parent;a=b.child1==a?b.child2:b.child1;if(null!=c)for(c.child1==b?c.child1=a:c.child2=a,a.parent=c,b.free(),b.next=Oa.zpp_pool,Oa.zpp_pool=b,b=c;null!=b;){var b=this.balance(b),d=b.child1;a=b.child2;b.aabb.setCombine(d.aabb,a.aabb);var c=b,e=void 0,d=d.height;a=a.height;e=d>a?d:a;c.height=1+e;b=b.parent}else this.root=a,a.parent=null,b.free(),b.next=Oa.zpp_pool,Oa.zpp_pool=b}},balance:function(a){if(null==a.child1||
2>a.height)return a;var b=a.child1,c=a.child2,d=c.height-b.height;if(1<d){var e=c.child1,h=c.child2;c.child1=a;c.parent=a.parent;a.parent=c;null!=c.parent?c.parent.child1==a?c.parent.child1=c:c.parent.child2=c:this.root=c;e.height>h.height?(c.child2=e,a.child2=h,h.parent=a,a.aabb.setCombine(b.aabb,h.aabb),c.aabb.setCombine(a.aabb,e.aabb),a.height=1+function(a){a=b.height;var c=h.height;return a>c?a:c}(this),c.height=1+function(b){b=a.height;var c=e.height;return b>c?b:c}(this)):(c.child2=h,a.child2=
e,e.parent=a,a.aabb.setCombine(b.aabb,e.aabb),c.aabb.setCombine(a.aabb,h.aabb),a.height=1+function(a){a=b.height;var c=e.height;return a>c?a:c}(this),c.height=1+function(b){b=a.height;var c=h.height;return b>c?b:c}(this));return c}if(-1>d){var f=b.child1,g=b.child2;b.child1=a;b.parent=a.parent;a.parent=b;null!=b.parent?b.parent.child1==a?b.parent.child1=b:b.parent.child2=b:this.root=b;f.height>g.height?(b.child2=f,a.child1=g,g.parent=a,a.aabb.setCombine(c.aabb,g.aabb),b.aabb.setCombine(a.aabb,f.aabb),
a.height=1+function(a){a=c.height;var b=g.height;return a>b?a:b}(this),b.height=1+function(b){b=a.height;var c=f.height;return b>c?b:c}(this)):(b.child2=g,a.child1=f,f.parent=a,a.aabb.setCombine(c.aabb,f.aabb),b.aabb.setCombine(a.aabb,g.aabb),a.height=1+function(a){a=c.height;var b=f.height;return a>b?a:b}(this),b.height=1+function(b){b=a.height;var c=g.height;return b>c?b:c}(this));return b}return a},__class__:Gb};var ee=function(a){this.stree=this.dtree=this.pairs=this.syncs=this.moves=this.treeStack=
this.treeStack2=this.failed=this.openlist=null;Dd.call(this);this.space=a;this.is_sweep=!1;this.dynab=this;this.stree=new Gb;this.dtree=new Gb};ee.__name__=!0;ee.__super__=Dd;ee.prototype=I(Dd.prototype,{dyn:function(a){return 1==a.body.type?!1:!a.body.component.sleeping},__insert:function(a){var b;null==Oa.zpp_pool?b=new Oa:(b=Oa.zpp_pool,Oa.zpp_pool=b.next,b.next=null);null==X.zpp_pool?b.aabb=new X:(b.aabb=X.zpp_pool,X.zpp_pool=b.aabb.next,b.aabb.next=null);null;b.moved=!1;b.synced=!1;b.first_sync=
!1;b.shape=a;a.node=b;b.synced=!0;b.first_sync=!0;b.snext=this.syncs;this.syncs=b},__remove:function(a){var b=a.node;b.first_sync||(b.dyn?this.dtree.removeLeaf(b):this.stree.removeLeaf(b));a.node=null;if(b.synced){for(var c=null,d=this.syncs;null!=d&&d!=b;)c=d,d=d.snext;null==c?this.syncs=d.snext:c.snext=d.snext;d.snext=null;b.synced=!1}if(b.moved){c=null;for(d=this.moves;null!=d&&d!=b;)c=d,d=d.mnext;null==c?this.moves=d.mnext:c.mnext=d.mnext;d.mnext=null;b.moved=!1}for(var c=null,e=this.pairs;null!=
e;)d=e.next,e.n1==b||e.n2==b?(null==c?this.pairs=d:c.next=d,null!=e.arb&&(e.arb.pair=null),e.arb=null,e.n1.shape.pairs.remove(e),e.n2.shape.pairs.remove(e),e.n1=e.n2=null,e.sleeping=!1,e.next=Aa.zpp_pool,Aa.zpp_pool=e):c=e,e=d;for(;null!=a.pairs.head;)c=a.pairs.pop_unsafe(),c.n1==b?c.n2.shape.pairs.remove(c):c.n1.shape.pairs.remove(c),null!=c.arb&&(c.arb.pair=null),c.arb=null,c.n1=c.n2=null,c.sleeping=!1,c.next=Aa.zpp_pool,Aa.zpp_pool=c;b.free();b.next=Oa.zpp_pool;Oa.zpp_pool=b},__sync:function(a){var b=
a.node;b.synced||(!this.space.continuous&&a.zip_aabb&&null!=a.body&&(a.zip_aabb=!1,0==a.type?a.circle.__validate_aabb():a.polygon.__validate_aabb()),b.dyn==(1==a.body.type?!1:!a.body.component.sleeping)&&b.aabb.contains(a.aabb)||(b.synced=!0,b.snext=this.syncs,this.syncs=b))},sync_broadphase:function(){this.space.validation();if(null!=this.syncs)if(null==this.moves){for(var a=this.syncs;null!=a;){var b=a.shape;a.first_sync?a.first_sync=!1:(a.dyn?this.dtree:this.stree).inlined_removeLeaf(a);var c=
a.aabb;!this.space.continuous&&b.zip_aabb&&null!=b.body&&(b.zip_aabb=!1,0==b.type?b.circle.__validate_aabb():b.polygon.__validate_aabb());c.setExpand(b.aabb,3);((1==b.body.type?a.dyn=!1:a.dyn=!b.body.component.sleeping)?this.dtree:this.stree).inlined_insertLeaf(a);a.synced=!1;a.moved=!0;a.mnext=a.snext;a.snext=null;a=a.mnext}a=this.syncs;this.syncs=this.moves;this.moves=a}else for(;null!=this.syncs;)a=this.syncs,this.syncs=a.snext,a.snext=null,b=a.shape,a.first_sync?a.first_sync=!1:(a.dyn?this.dtree:
this.stree).inlined_removeLeaf(a),c=a.aabb,!this.space.continuous&&b.zip_aabb&&null!=b.body&&(b.zip_aabb=!1,0==b.type?b.circle.__validate_aabb():b.polygon.__validate_aabb()),c.setExpand(b.aabb,3),((1==b.body.type?a.dyn=!1:a.dyn=!b.body.component.sleeping)?this.dtree:this.stree).inlined_insertLeaf(a),a.synced=!1,a.moved||(a.moved=!0,a.mnext=this.moves,this.moves=a)},broadphase:function(a,b){for(var c=this.syncs;null!=c;){var d=c.shape;c.first_sync?c.first_sync=!1:(c.dyn?this.dtree:this.stree).inlined_removeLeaf(c);
var e=c.aabb;!a.continuous&&d.zip_aabb&&null!=d.body&&(d.zip_aabb=!1,0==d.type?d.circle.__validate_aabb():d.polygon.__validate_aabb());e.setExpand(d.aabb,3);((1==d.body.type?c.dyn=!1:c.dyn=!d.body.component.sleeping)?this.dtree:this.stree).inlined_insertLeaf(c);c.synced=!1;c=c.snext}for(;null!=this.syncs;)if(c=this.syncs,this.syncs=c.snext,c.snext=null,!c.moved&&(c.moved=!1,d=c.shape,!d.body.component.sleeping)){var e=c.aabb,h=null;null!=this.dtree.root&&(this.dtree.root.next=h,h=this.dtree.root);
for(;null!=h;){var f;f=h;h=f.next;f.next=null;if(f!=c)if(null==f.child1){var g=f.shape;if(g.body!=d.body&&(1!=g.body.type||1!=d.body.type)&&e.intersect(f.aabb)){var k,l;d.id<g.id?(k=d.id,l=g.id):(k=g.id,l=d.id);for(var n=null,r=(d.pairs.length<g.pairs.length?d:g).pairs.head;null!=r;){var u=r.elt;if(u.id==k&&u.di==l){n=u;break}r=r.next}null!=n?n.sleeping&&(n.sleeping=!1,n.next=this.pairs,this.pairs=n,n.first=!0):(null==Aa.zpp_pool?n=new Aa:(n=Aa.zpp_pool,Aa.zpp_pool=n.next,n.next=null),null,n.n1=c,
n.n2=f,n.id=k,n.di=l,n.next=this.pairs,this.pairs=n,n.first=!0,d.pairs.inlined_add(n),g.pairs.inlined_add(n))}}else e.intersect(f.aabb)&&(null!=f.child1&&(f.child1.next=h,h=f.child1),null!=f.child2&&(f.child2.next=h,h=f.child2))}null!=this.stree.root&&(this.stree.root.next=h,h=this.stree.root);for(;null!=h;)if(f=h,h=f.next,f.next=null,f!=c)if(null==f.child1){if(g=f.shape,g.body!=d.body&&(1!=g.body.type||1!=d.body.type)&&e.intersect(f.aabb)){d.id<g.id?(k=d.id,l=g.id):(k=g.id,l=d.id);n=null;for(r=(d.pairs.length<
g.pairs.length?d:g).pairs.head;null!=r;){u=r.elt;if(u.id==k&&u.di==l){n=u;break}r=r.next}null!=n?n.sleeping&&(n.sleeping=!1,n.next=this.pairs,this.pairs=n,n.first=!0):(null==Aa.zpp_pool?n=new Aa:(n=Aa.zpp_pool,Aa.zpp_pool=n.next,n.next=null),null,n.n1=c,n.n2=f,n.id=k,n.di=l,n.next=this.pairs,this.pairs=n,n.first=!0,d.pairs.inlined_add(n),g.pairs.inlined_add(n))}}else e.intersect(f.aabb)&&(null!=f.child1&&(f.child1.next=h,h=f.child1),null!=f.child2&&(f.child2.next=h,h=f.child2))}for(;null!=this.moves;)if(c=
this.moves,this.moves=c.mnext,c.mnext=null,c.moved=!1,d=c.shape,!d.body.component.sleeping){e=c.aabb;h=null;null!=this.dtree.root&&(this.dtree.root.next=h,h=this.dtree.root);for(;null!=h;)if(f=h,h=f.next,f.next=null,f!=c)if(null==f.child1){if(g=f.shape,g.body!=d.body&&(1!=g.body.type||1!=d.body.type)&&e.intersect(f.aabb)){d.id<g.id?(k=d.id,l=g.id):(k=g.id,l=d.id);n=null;for(r=(d.pairs.length<g.pairs.length?d:g).pairs.head;null!=r;){u=r.elt;if(u.id==k&&u.di==l){n=u;break}r=r.next}null!=n?n.sleeping&&
(n.sleeping=!1,n.next=this.pairs,this.pairs=n,n.first=!0):(null==Aa.zpp_pool?n=new Aa:(n=Aa.zpp_pool,Aa.zpp_pool=n.next,n.next=null),null,n.n1=c,n.n2=f,n.id=k,n.di=l,n.next=this.pairs,this.pairs=n,n.first=!0,d.pairs.inlined_add(n),g.pairs.inlined_add(n))}}else e.intersect(f.aabb)&&(null!=f.child1&&(f.child1.next=h,h=f.child1),null!=f.child2&&(f.child2.next=h,h=f.child2));null!=this.stree.root&&(this.stree.root.next=h,h=this.stree.root);for(;null!=h;)if(f=h,h=f.next,f.next=null,f!=c)if(null==f.child1){if(g=
f.shape,g.body!=d.body&&(1!=g.body.type||1!=d.body.type)&&e.intersect(f.aabb)){d.id<g.id?(k=d.id,l=g.id):(k=g.id,l=d.id);n=null;for(r=(d.pairs.length<g.pairs.length?d:g).pairs.head;null!=r;){u=r.elt;if(u.id==k&&u.di==l){n=u;break}r=r.next}null!=n?n.sleeping&&(n.sleeping=!1,n.next=this.pairs,this.pairs=n,n.first=!0):(null==Aa.zpp_pool?n=new Aa:(n=Aa.zpp_pool,Aa.zpp_pool=n.next,n.next=null),null,n.n1=c,n.n2=f,n.id=k,n.di=l,n.next=this.pairs,this.pairs=n,n.first=!0,d.pairs.inlined_add(n),g.pairs.inlined_add(n))}}else e.intersect(f.aabb)&&
(null!=f.child1&&(f.child1.next=h,h=f.child1),null!=f.child2&&(f.child2.next=h,h=f.child2))}c=null;for(d=this.pairs;null!=d;)d.first||d.n1.aabb.intersect(d.n2.aabb)?(e=d.n1.shape,h=e.body,f=d.n2.shape,g=f.body,d.first||!h.component.sleeping&&1!=h.type||!g.component.sleeping&&1!=g.type?(d.first=!1,e.aabb.intersect(f.aabb)&&(c=d.arb,d.arb=b?a.narrowPhase(e,f,2!=h.type||2!=g.type,d.arb,!1):a.continuousEvent(e,f,2!=h.type||2!=g.type,d.arb,!1),null==d.arb?null!=c&&(c.pair=null):d.arb.pair=d),c=d):(d.sleeping=
!0,null==c?this.pairs=d.next:c.next=d.next),d=d.next):(null==c?this.pairs=d.next:c.next=d.next,d.n1.shape.pairs.inlined_try_remove(d),d.n2.shape.pairs.inlined_try_remove(d),e=d.next,null!=d.arb&&(d.arb.pair=null),d.arb=null,d.n1=d.n2=null,d.sleeping=!1,d.next=Aa.zpp_pool,Aa.zpp_pool=d,d=e)},clear:function(){for(;null!=this.syncs;){var a=this.syncs.snext;this.syncs.snext=null;this.syncs.first_sync&&(this.syncs.shape.node=null,this.syncs.shape.removedFromSpace(),this.syncs.shape=null);this.syncs=a}for(;null!=
this.moves;)a=this.moves.mnext,this.moves.mnext=null,this.moves.first_sync&&(this.moves.shape.node=null,this.moves.shape.removedFromSpace(),this.moves.shape=null),this.moves=a;for(;null!=this.pairs;){a=this.pairs.next;null!=this.pairs.arb&&(this.pairs.arb.pair=null);this.pairs.arb=null;this.pairs.n1.shape.pairs.inlined_try_remove(this.pairs);this.pairs.n2.shape.pairs.inlined_try_remove(this.pairs);var b=this.pairs;b.n1=b.n2=null;b.sleeping=!1;b.next=Aa.zpp_pool;Aa.zpp_pool=b;this.pairs=a}this.dtree.clear();
this.stree.clear()},shapesUnderPoint:function(a,b,c,d){this.sync_broadphase();a=P.get(a,b,null);d=null==d?new Ab:d;if(null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new Qa),this.treeStack.add(this.stree.root);null!=this.treeStack.head;)if(b=this.treeStack.pop_unsafe(),b.aabb.containsPoint(a))if(null==b.child1){if(null==c||b.shape.filter.shouldCollide(c))0==b.shape.type?C.circleContains(b.shape.circle,a)&&d.push(b.shape.outer):C.polyContains(b.shape.polygon,a)&&d.push(b.shape.outer)}else null!=
b.child1&&this.treeStack.add(b.child1),null!=b.child2&&this.treeStack.add(b.child2);if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new Qa),this.treeStack.add(this.dtree.root);null!=this.treeStack.head;)if(b=this.treeStack.pop_unsafe(),b.aabb.containsPoint(a))if(null==b.child1){if(null==c||b.shape.filter.shouldCollide(c))0==b.shape.type?C.circleContains(b.shape.circle,a)&&d.push(b.shape.outer):C.polyContains(b.shape.polygon,a)&&d.push(b.shape.outer)}else null!=b.child1&&this.treeStack.add(b.child1),
null!=b.child2&&this.treeStack.add(b.child2);null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null);a._isimmutable=null;a._validate=null;a._invalidate=null;a.next=P.zpp_pool;P.zpp_pool=a;return d},bodiesUnderPoint:function(a,b,c,d){this.sync_broadphase();a=P.get(a,b,null);d=null==d?new Ka:d;if(null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new Qa),this.treeStack.add(this.stree.root);null!=this.treeStack.head;)if(b=this.treeStack.pop_unsafe(),b.aabb.containsPoint(a))if(null==b.child1){var e=
b.shape.body.outer;d.has(e)||null!=c&&!b.shape.filter.shouldCollide(c)||(0==b.shape.type?C.circleContains(b.shape.circle,a)&&d.push(e):C.polyContains(b.shape.polygon,a)&&d.push(e))}else null!=b.child1&&this.treeStack.add(b.child1),null!=b.child2&&this.treeStack.add(b.child2);if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new Qa),this.treeStack.add(this.dtree.root);null!=this.treeStack.head;)b=this.treeStack.pop_unsafe(),b.aabb.containsPoint(a)&&(null==b.child1?(e=b.shape.body.outer,
d.has(e)||null!=c&&!b.shape.filter.shouldCollide(c)||(0==b.shape.type?C.circleContains(b.shape.circle,a)&&d.push(e):C.polyContains(b.shape.polygon,a)&&d.push(e))):(null!=b.child1&&this.treeStack.add(b.child1),null!=b.child2&&this.treeStack.add(b.child2)));null!=a.outer&&(a.outer.zpp_inner=null,a.outer=null);a._isimmutable=null;a._validate=null;a._invalidate=null;a.next=P.zpp_pool;P.zpp_pool=a;return d},shapesInAABB:function(a,b,c,d,e){this.sync_broadphase();this.updateAABBShape(a);a=this.aabbShape.zpp_inner.aabb;
e=null==e?new Ab:e;if(null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new Qa),this.treeStack.add(this.stree.root);null!=this.treeStack.head;){var h=this.treeStack.pop_unsafe();if(a.contains(h.aabb))if(null==h.child1)(null==d||h.shape.filter.shouldCollide(d))&&e.push(h.shape.outer);else for(null==this.treeStack2&&(this.treeStack2=new Qa),this.treeStack2.add(h);null!=this.treeStack2.head;)h=this.treeStack2.pop_unsafe(),null==h.child1?(null==d||h.shape.filter.shouldCollide(d))&&e.push(h.shape.outer):
(null!=h.child1&&this.treeStack2.add(h.child1),null!=h.child2&&this.treeStack2.add(h.child2));else if(h.aabb.intersect(a))if(null==h.child1){if(null==d||h.shape.filter.shouldCollide(d))b?c?C.containTest(this.aabbShape.zpp_inner,h.shape)&&e.push(h.shape.outer):a.contains(h.shape.aabb)?e.push(h.shape.outer):C.testCollide_safe(h.shape,this.aabbShape.zpp_inner)&&e.push(h.shape.outer):c&&!a.contains(h.shape.aabb)||e.push(h.shape.outer)}else null!=h.child1&&this.treeStack.add(h.child1),null!=h.child2&&
this.treeStack.add(h.child2)}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new Qa),this.treeStack.add(this.dtree.root);null!=this.treeStack.head;)if(h=this.treeStack.pop_unsafe(),a.contains(h.aabb))if(null==h.child1)(null==d||h.shape.filter.shouldCollide(d))&&e.push(h.shape.outer);else for(null==this.treeStack2&&(this.treeStack2=new Qa),this.treeStack2.add(h);null!=this.treeStack2.head;)h=this.treeStack2.pop_unsafe(),null==h.child1?(null==d||h.shape.filter.shouldCollide(d))&&
e.push(h.shape.outer):(null!=h.child1&&this.treeStack2.add(h.child1),null!=h.child2&&this.treeStack2.add(h.child2));else if(h.aabb.intersect(a))if(null==h.child1){if(null==d||h.shape.filter.shouldCollide(d))b?c?C.containTest(this.aabbShape.zpp_inner,h.shape)&&e.push(h.shape.outer):a.contains(h.shape.aabb)?e.push(h.shape.outer):C.testCollide_safe(h.shape,this.aabbShape.zpp_inner)&&e.push(h.shape.outer):c&&!a.contains(h.shape.aabb)||e.push(h.shape.outer)}else null!=h.child1&&this.treeStack.add(h.child1),
null!=h.child2&&this.treeStack.add(h.child2);return e},bodiesInAABB:function(a,b,c,d,e){this.sync_broadphase();this.updateAABBShape(a);a=this.aabbShape.zpp_inner.aabb;e=null==e?new Ka:e;null==this.failed&&(this.failed=new Ka);if(null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new Qa),this.treeStack.add(this.stree.root);null!=this.treeStack.head;){var h=this.treeStack.pop_unsafe();if(a.contains(h.aabb))if(null==h.child1){if(null==d||h.shape.filter.shouldCollide(d)){var f=h.shape.body.outer;
e.has(f)||e.push(f)}}else for(null==this.treeStack2&&(this.treeStack2=new Qa),this.treeStack2.add(h);null!=this.treeStack2.head;)if(f=this.treeStack2.pop_unsafe(),null==f.child1){if(null==d||f.shape.filter.shouldCollide(d))f=f.shape.body.outer,e.has(f)||e.push(f)}else null!=f.child1&&this.treeStack2.add(f.child1),null!=f.child2&&this.treeStack2.add(f.child2);else if(h.aabb.intersect(a))if(null==h.child1){if(f=h.shape.body.outer,null==d||h.shape.filter.shouldCollide(d))b?c?this.failed.has(f)||(h=C.containTest(this.aabbShape.zpp_inner,
h.shape),!e.has(f)&&h?e.push(f):h||(e.remove(f),this.failed.push(f))):!e.has(f)&&C.testCollide_safe(h.shape,this.aabbShape.zpp_inner)&&e.push(f):c?this.failed.has(f)||(h=a.contains(h.shape.aabb),!e.has(f)&&h?e.push(f):h||(e.remove(f),this.failed.push(f))):!e.has(f)&&a.contains(h.shape.aabb)&&e.push(f)}else null!=h.child1&&this.treeStack.add(h.child1),null!=h.child2&&this.treeStack.add(h.child2)}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new Qa),this.treeStack.add(this.dtree.root);null!=
this.treeStack.head;)if(h=this.treeStack.pop_unsafe(),a.contains(h.aabb))if(null==h.child1){if(null==d||h.shape.filter.shouldCollide(d))f=h.shape.body.outer,e.has(f)||e.push(f)}else for(null==this.treeStack2&&(this.treeStack2=new Qa),this.treeStack2.add(h);null!=this.treeStack2.head;)if(f=this.treeStack2.pop_unsafe(),null==f.child1){if(null==d||f.shape.filter.shouldCollide(d))f=f.shape.body.outer,e.has(f)||e.push(f)}else null!=f.child1&&this.treeStack2.add(f.child1),null!=f.child2&&this.treeStack2.add(f.child2);
else if(h.aabb.intersect(a))if(null==h.child1){if(f=h.shape.body.outer,null==d||h.shape.filter.shouldCollide(d))b?c?this.failed.has(f)||(h=C.containTest(this.aabbShape.zpp_inner,h.shape),!e.has(f)&&h?e.push(f):h||(e.remove(f),this.failed.push(f))):!e.has(f)&&C.testCollide_safe(h.shape,this.aabbShape.zpp_inner)&&e.push(f):c?this.failed.has(f)||(h=a.contains(h.shape.aabb),!e.has(f)&&h?e.push(f):h||(e.remove(f),this.failed.push(f))):!e.has(f)&&a.contains(h.shape.aabb)&&e.push(f)}else null!=h.child1&&
this.treeStack.add(h.child1),null!=h.child2&&this.treeStack.add(h.child2);this.failed.clear();return e},shapesInCircle:function(a,b,c,d,e,h){this.sync_broadphase();this.updateCircShape(a,b,c);a=this.circShape.zpp_inner.aabb;h=null==h?new Ab:h;if(null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new Qa),this.treeStack.add(this.stree.root);null!=this.treeStack.head;)if(b=this.treeStack.pop_unsafe(),b.aabb.intersect(a))if(null==b.child1){if(null==e||b.shape.filter.shouldCollide(e))d?C.containTest(this.circShape.zpp_inner,
b.shape)&&h.push(b.shape.outer):C.testCollide_safe(b.shape,this.circShape.zpp_inner)&&h.push(b.shape.outer)}else null!=b.child1&&this.treeStack.add(b.child1),null!=b.child2&&this.treeStack.add(b.child2);if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new Qa),this.treeStack.add(this.dtree.root);null!=this.treeStack.head;)if(b=this.treeStack.pop_unsafe(),b.aabb.intersect(a))if(null==b.child1){if(null==e||b.shape.filter.shouldCollide(e))d?C.containTest(this.circShape.zpp_inner,b.shape)&&
h.push(b.shape.outer):C.testCollide_safe(b.shape,this.circShape.zpp_inner)&&h.push(b.shape.outer)}else null!=b.child1&&this.treeStack.add(b.child1),null!=b.child2&&this.treeStack.add(b.child2);return h},bodiesInCircle:function(a,b,c,d,e,h){this.sync_broadphase();this.updateCircShape(a,b,c);a=this.circShape.zpp_inner.aabb;h=null==h?new Ka:h;null==this.failed&&(this.failed=new Ka);if(null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new Qa),this.treeStack.add(this.stree.root);null!=this.treeStack.head;)if(c=
this.treeStack.pop_unsafe(),c.aabb.intersect(a))if(null==c.child1){if(b=c.shape.body.outer,null==e||c.shape.filter.shouldCollide(e))d?this.failed.has(b)||(c=C.containTest(this.circShape.zpp_inner,c.shape),!h.has(b)&&c?h.push(b):c||(h.remove(b),this.failed.push(b))):!h.has(b)&&C.testCollide_safe(c.shape,this.circShape.zpp_inner)&&h.push(b)}else null!=c.child1&&this.treeStack.add(c.child1),null!=c.child2&&this.treeStack.add(c.child2);if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=
new Qa),this.treeStack.add(this.dtree.root);null!=this.treeStack.head;)if(c=this.treeStack.pop_unsafe(),c.aabb.intersect(a))if(null==c.child1){if(b=c.shape.body.outer,null==e||c.shape.filter.shouldCollide(e))d?this.failed.has(b)||(c=C.containTest(this.circShape.zpp_inner,c.shape),!h.has(b)&&c?h.push(b):c||(h.remove(b),this.failed.push(b))):!h.has(b)&&C.testCollide_safe(c.shape,this.circShape.zpp_inner)&&h.push(b)}else null!=c.child1&&this.treeStack.add(c.child1),null!=c.child2&&this.treeStack.add(c.child2);
this.failed.clear();return h},shapesInShape:function(a,b,c,d){this.sync_broadphase();this.validateShape(a);var e=a.aabb;d=null==d?new Ab:d;if(null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new Qa),this.treeStack.add(this.stree.root);null!=this.treeStack.head;){var h=this.treeStack.pop_unsafe();if(h.aabb.intersect(e))if(null==h.child1){if(null==c||h.shape.filter.shouldCollide(c))b?C.containTest(a,h.shape)&&d.push(h.shape.outer):C.testCollide_safe(h.shape,a)&&d.push(h.shape.outer)}else null!=
h.child1&&this.treeStack.add(h.child1),null!=h.child2&&this.treeStack.add(h.child2)}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new Qa),this.treeStack.add(this.dtree.root);null!=this.treeStack.head;)if(h=this.treeStack.pop_unsafe(),h.aabb.intersect(e))if(null==h.child1){if(null==c||h.shape.filter.shouldCollide(c))b?C.containTest(a,h.shape)&&d.push(h.shape.outer):C.testCollide_safe(h.shape,a)&&d.push(h.shape.outer)}else null!=h.child1&&this.treeStack.add(h.child1),null!=h.child2&&
this.treeStack.add(h.child2);return d},bodiesInShape:function(a,b,c,d){this.sync_broadphase();this.validateShape(a);var e=a.aabb;d=null==d?new Ka:d;null==this.failed&&(this.failed=new Ka);if(null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new Qa),this.treeStack.add(this.stree.root);null!=this.treeStack.head;){var h=this.treeStack.pop_unsafe();if(h.aabb.intersect(e))if(null==h.child1){var f=h.shape.body.outer;if(null==c||h.shape.filter.shouldCollide(c))b?this.failed.has(f)||(h=C.containTest(a,
h.shape),!d.has(f)&&h?d.push(f):h||(d.remove(f),this.failed.push(f))):!d.has(f)&&C.testCollide_safe(h.shape,a)&&d.push(f)}else null!=h.child1&&this.treeStack.add(h.child1),null!=h.child2&&this.treeStack.add(h.child2)}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new Qa),this.treeStack.add(this.dtree.root);null!=this.treeStack.head;)if(h=this.treeStack.pop_unsafe(),h.aabb.intersect(e))if(null==h.child1){if(f=h.shape.body.outer,null==c||h.shape.filter.shouldCollide(c))b?this.failed.has(f)||
(h=C.containTest(a,h.shape),!d.has(f)&&h?d.push(f):h||(d.remove(f),this.failed.push(f))):!d.has(f)&&C.testCollide_safe(h.shape,a)&&d.push(f)}else null!=h.child1&&this.treeStack.add(h.child1),null!=h.child2&&this.treeStack.add(h.child2);this.failed.clear();return d},rayCast:function(a,b,c){null==this.openlist&&(this.openlist=new Qa);this.sync_broadphase();a.validate_dir();var d=a.maxdist;if(null!=this.dtree.root&&a.aabbtest(this.dtree.root.aabb)){var e=a.aabbsect(this.dtree.root.aabb);if(0<=e&&e<d){this.dtree.root.rayt=
e;for(var e=null,h=this.openlist.head;null!=h&&!(this.dtree.root.rayt<h.elt.rayt);)e=h,h=h.next;this.openlist.inlined_insert(e,this.dtree.root)}}if(null!=this.stree.root&&a.aabbtest(this.stree.root.aabb)&&(e=a.aabbsect(this.stree.root.aabb),0<=e&&e<d)){this.stree.root.rayt=e;e=null;for(h=this.openlist.head;null!=h&&!(this.stree.root.rayt<h.elt.rayt);)e=h,h=h.next;this.openlist.inlined_insert(e,this.stree.root)}for(e=null;null!=this.openlist.head;){h=this.openlist.pop_unsafe();if(h.rayt>=d)break;if(null==
h.child1){if(h=h.shape,null==c||h.filter.shouldCollide(c))if(h=0==h.type?a.circlesect(h.circle,b,d):a.aabbtest(h.aabb)?a.polysect(h.polygon,b,d):null,null!=h){if(null!=h.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");d=h.zpp_inner.toiDistance;if(null!=e){if(null!=e.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");e.zpp_inner.free()}e=h}}else{if(null!=h.child1&&a.aabbtest(h.child1.aabb)){var g=a.aabbsect(h.child1.aabb);
if(0<=g&&g<d){h.child1.rayt=g;for(var g=null,q=this.openlist.head;null!=q&&!(h.child1.rayt<q.elt.rayt);)g=q,q=q.next;this.openlist.inlined_insert(g,h.child1)}}if(null!=h.child2&&a.aabbtest(h.child2.aabb)&&(g=a.aabbsect(h.child2.aabb),0<=g&&g<d)){h.child2.rayt=g;g=null;for(q=this.openlist.head;null!=q&&!(h.child2.rayt<q.elt.rayt);)g=q,q=q.next;this.openlist.inlined_insert(g,h.child2)}}}this.openlist.clear();return e},rayMultiCast:function(a,b,c,d){null==this.openlist&&(this.openlist=new Qa);this.sync_broadphase();
a.validate_dir();var e=Infinity<=a.maxdist;d=null==d?new bd:d;if(null!=this.dtree.root&&a.aabbtest(this.dtree.root.aabb))if(e)this.openlist.add(this.dtree.root);else{var f=a.aabbsect(this.dtree.root.aabb);0<=f&&f<a.maxdist&&this.openlist.add(this.dtree.root)}null!=this.stree.root&&a.aabbtest(this.stree.root.aabb)&&(e?this.openlist.add(this.stree.root):(f=a.aabbsect(this.stree.root.aabb),0<=f&&f<a.maxdist&&this.openlist.add(this.stree.root)));for(;null!=this.openlist.head;)if(f=this.openlist.pop_unsafe(),
null==f.child1){if(f=f.shape,null==c||f.filter.shouldCollide(c))0==f.type?a.circlesect2(f.circle,b,d):a.aabbtest(f.aabb)&&a.polysect2(f.polygon,b,d)}else{if(null!=f.child1&&a.aabbtest(f.child1.aabb))if(e)this.openlist.add(f.child1);else{var g=a.aabbsect(f.child1.aabb);0<=g&&g<a.maxdist&&this.openlist.add(f.child1)}null!=f.child2&&a.aabbtest(f.child2.aabb)&&(e?this.openlist.add(f.child2):(g=a.aabbsect(f.child2.aabb),0<=g&&g<a.maxdist&&this.openlist.add(f.child2)))}this.openlist.clear();return d},__class__:ee});
var jb=function(){this.waket=0;this.sleep=!1;this.comps=null;this.length=0;this._inuse=this.modified=this.pushmod=!1;this.next=null;this.comps=new Hf};jb.__name__=!0;jb.prototype={elem:function(){return this},begin:function(){return this.next},setbegin:function(a){this.next=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){a._inuse=!0;a.next=this.next;this.next=a;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.next;null!=a;)this.add(a),
a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){b._inuse=!0;null==a?(b.next=this.next,this.next=b):(b.next=a.next,a.next=b);this.pushmod=this.modified=!0;this.length++;return b},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.next;this.next=a.next;a._inuse=!1;null==this.next&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.next;this.pop();
return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.next,d=!1;null!=c;){if(c==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.next,d=!1;null!=c;){if(c==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.next,this.next=c=b.next,null==this.next&&
(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));b._inuse=!1;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){},inlined_clear:function(){},reverse:function(){for(var a=this.next,b=null;null!=a;){var c=a.next;a.next=b;b=this.next=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.next},size:function(){return this.length},has:function(a){return this.inlined_has(a)},
inlined_has:function(a){var b;b=!1;for(var c=this.next;null!=c;){if(c==a){b=!0;break}c=c.next}return b},front:function(){return this.next},back:function(){for(var a=this.next,b=a;null!=b;)a=b,b=b.next;return a},iterator_at:function(a){for(var b=this.next;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a:null},free:function(){},alloc:function(){this.waket=0},__class__:jb};var Fa=function(){this.woken=!1;this.waket=0;this.sleeping=!1;this.body=this.constraint=
this.island=null;this.isBody=!1;this.rank=0;this.next=this.parent=null;this.sleeping=!1;this.island=null;this.parent=this;this.rank=0;this.woken=!1};Fa.__name__=!0;Fa.prototype={free:function(){this.constraint=this.body=null},alloc:function(){},reset:function(){this.sleeping=!1;this.island=null;this.parent=this;this.rank=0},__class__:Fa};var ec=function(){this.freed=this.lazydel=!1;this.length=0;this._inuse=this.modified=this.pushmod=!1;this.int1=this.int2=this.next=null;this.id=this.di=0;this.arbiters=
new Od};ec.__name__=!0;ec.get=function(a,b){var c;null==ec.zpp_pool?c=new ec:(c=ec.zpp_pool,ec.zpp_pool=c.next,c.next=null);c.freed=!1;c.lazydel=!1;c.COLLISIONstate=1;c.COLLISIONstamp=0;c.SENSORstate=1;c.SENSORstamp=0;c.FLUIDstate=1;c.FLUIDstamp=0;a.id<b.id?(c.int1=a,c.int2=b):(c.int1=b,c.int2=a);c.id=c.int1.id;c.di=c.int2.id;return c};ec.prototype={elem:function(){return this},begin:function(){return this.next},setbegin:function(a){this.next=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},
inlined_add:function(a){a._inuse=!0;a.next=this.next;this.next=a;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.next;null!=a;)this.add(a),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){b._inuse=!0;null==a?(b.next=this.next,this.next=b):(b.next=a.next,a.next=b);this.pushmod=this.modified=!0;this.length++;return b},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.next;this.next=a.next;a._inuse=!1;null==this.next&&
(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.next;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.next,d=!1;null!=c;){if(c==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.next,d=!1;null!=c;){if(c==a){this.inlined_erase(b);
d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.next,this.next=c=b.next,null==this.next&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));b._inuse=!1;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){},inlined_clear:function(){},reverse:function(){for(var a=this.next,b=null;null!=a;){var c=
a.next;a.next=b;b=this.next=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.next},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.next;null!=c;){if(c==a){b=!0;break}c=c.next}return b},front:function(){return this.next},back:function(){for(var a=this.next,b=a;null!=b;)a=b,b=b.next;return a},iterator_at:function(a){for(var b=this.next;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);
return null!=a?a:null},free:function(){this.int1=this.int2=null;this.id=this.di=-1;this.freed=!0},alloc:function(){this.lazydel=this.freed=!1;this.COLLISIONstate=1;this.COLLISIONstamp=0;this.SENSORstate=1;this.SENSORstamp=0;this.FLUIDstate=1;this.FLUIDstamp=0},add_arb:function(a){if(this.arbiters.inlined_has(a))return!1;this.arbiters.inlined_add(a);return!0},try_remove_arb:function(a){return this.arbiters.inlined_try_remove(a)},remove_arb:function(a){this.arbiters.inlined_try_remove(a)},empty_arb:function(a){var b;
b=!0;for(var c=this.arbiters.head;null!=c;)if(0==(c.elt.type&a))c=c.next;else{b=!1;break}return b},really_empty:function(){return null==this.arbiters.head},sleeping:function(){var a;a=!0;for(var b=this.arbiters.head;null!=b;)if(b.elt.sleeping)b=b.next;else{a=!1;break}return a},__class__:ec};var If=function(a){this.cbsets=this.space=null;null==U.zpp_pool?this.cbsets=new U:(this.cbsets=U.zpp_pool,U.zpp_pool=this.cbsets.next,this.cbsets.next=null);null;this.cbsets.lt=oa.setlt;this.space=a};If.__name__=
!0;If.prototype={get:function(a){if(null==a.head)return null;var b;null==oa.zpp_pool?b=new oa:(b=oa.zpp_pool,oa.zpp_pool=b.next,b.next=null);null;var c=b.cbTypes;b.cbTypes=a;var d=this.cbsets.find_weak(b);null!=d?a=d.data:(a=oa.get(a),this.cbsets.insert(a),a.manager=this);b.cbTypes=c;b.free();b.next=oa.zpp_pool;oa.zpp_pool=b;return a},remove:function(a){for(this.cbsets.remove(a);null!=a.cbpairs.head;){var b=a.cbpairs.pop_unsafe();b.a!=b.b&&(a==b.a?b.b.cbpairs.remove(b):b.a.cbpairs.remove(b));b.a=
b.b=null;b.listeners.clear();b.next=Yb.zpp_pool;Yb.zpp_pool=b}a.manager=null},clear:function(){},validate:function(){if(!this.cbsets.empty()){for(var a=this.cbsets.parent;null!=a.prev;)a=a.prev;for(;null!=a;)if(a.data.validate(),null!=a.next)for(a=a.next;null!=a.prev;)a=a.prev;else{for(;null!=a.parent&&a==a.parent.next;)a=a.parent;a=a.parent}}},pair:function(a,b){for(var c=null,d=(a.cbpairs.length<b.cbpairs.length?a.cbpairs:b.cbpairs).head;null!=d;){var e=d.elt;if(e.a==a&&e.b==b||e.a==b&&e.b==a){c=
e;break}d=d.next}null==c&&(c=Yb.get(a,b),a.cbpairs.add(c),b!=a&&b.cbpairs.add(c));c.zip_listeners&&(c.zip_listeners=!1,c.__validate());return c},valid_listener:function(a){return a.space==this.space},__class__:If};var qf=function(a,b){this.precb=this.prelisteners=null;this.continuous=!1;this.toiEvents=null;this.pre_dt=0;this.c_arbiters_true=this.c_arbiters_false=this.f_arbiters=this.s_arbiters=this.wrap_arbiters=this.live=this.wrap_live=this.live_constraints=this.wrap_livecon=this.staticsleep=this.islands=
this.listeners=this.wrap_listeners=this.callbacks=this.callbackset_list=this.cbsets=this.convexShapeList=null;this.sortcontacts=!1;this.time=0;this.midstep=!1;this.global_lin_drag=this.global_ang_drag=this.stamp=0;this.wrap_gravity=this.bodies=this.wrap_bodies=this.compounds=this.wrap_compounds=this.constraints=this.wrap_constraints=this.kinematics=this.bphase=this.__static=null;this.gravityx=this.gravityy=0;this.outer=this.userData=null;this.toiEvents=new Jf;this.global_ang_drag=this.global_lin_drag=
.015;Ra.internal=!0;this.precb=new Jd;this.precb.zpp_inner=new Ra;Ra.internal=!1;this.sortcontacts=!0;this.pre_dt=0;var c;(c=null==b)||(null==g.Broadphase_DYNAMIC_AABB_TREE&&(g.internal=!0,g.Broadphase_DYNAMIC_AABB_TREE=new dd,g.internal=!1),c=b==g.Broadphase_DYNAMIC_AABB_TREE);c?this.bphase=new ee(this):(null==g.Broadphase_SWEEP_AND_PRUNE&&(g.internal=!0,g.Broadphase_SWEEP_AND_PRUNE=new dd,g.internal=!1),b==g.Broadphase_SWEEP_AND_PRUNE&&(this.bphase=new af(this)));this.time=0;null!=a?(this.gravityx=
a.x,this.gravityy=a.y):this.gravityy=this.gravityx=0;this.bodies=new Wc;this.wrap_bodies=pc.get(this.bodies);this.wrap_bodies.zpp_inner.adder=w(this,this.bodies_adder);this.wrap_bodies.zpp_inner.subber=w(this,this.bodies_subber);this.wrap_bodies.zpp_inner._modifiable=w(this,this.bodies_modifiable);this.compounds=new Pd;this.wrap_compounds=Jc.get(this.compounds);this.wrap_compounds.zpp_inner.adder=w(this,this.compounds_adder);this.wrap_compounds.zpp_inner.subber=w(this,this.compounds_subber);this.wrap_compounds.zpp_inner._modifiable=
w(this,this.compounds_modifiable);this.kinematics=new Wc;this.c_arbiters_true=new bf;this.c_arbiters_false=new bf;this.f_arbiters=new Kf;this.s_arbiters=new Lf;this.islands=new jb;this.live=new Wc;this.wrap_live=pc.get(this.live,!0);this.staticsleep=new Wc;this.constraints=new md;this.wrap_constraints=mb.get(this.constraints);this.wrap_constraints.zpp_inner.adder=w(this,this.constraints_adder);this.wrap_constraints.zpp_inner.subber=w(this,this.constraints_subber);this.wrap_constraints.zpp_inner._modifiable=
w(this,this.constraints_modifiable);this.live_constraints=new md;this.wrap_livecon=mb.get(this.live_constraints,!0);this.__static=H.__static();this.__static.zpp_inner.space=this;this.callbacks=new Ra;this.midstep=!1;this.listeners=new cf;this.wrap_listeners=qd.get(this.listeners);this.wrap_listeners.zpp_inner.adder=w(this,this.listeners_adder);this.wrap_listeners.zpp_inner.subber=w(this,this.listeners_subber);this.wrap_listeners.zpp_inner._modifiable=w(this,this.listeners_modifiable);this.callbackset_list=
new ec;this.mrca1=new Xb;this.mrca2=new Xb;this.prelisteners=new Yd;this.cbsets=new If(this)};qf.__name__=!0;qf.prototype={getgravity:function(){this.wrap_gravity=E.get(this.gravityx,this.gravityy,null);this.wrap_gravity.zpp_inner._inuse=!0;this.wrap_gravity.zpp_inner._invalidate=w(this,this.gravity_invalidate);this.wrap_gravity.zpp_inner._validate=w(this,this.gravity_validate)},gravity_invalidate:function(a){if(this.midstep)throw new f("Error: Space::gravity cannot be set during space step");this.gravityx=
a.x;this.gravityy=a.y;a=new Pd;for(var b=this.bodies.head;null!=b;){var c=b.elt;c.world||(c.component.waket=this.stamp+(this.midstep?0:1),3==c.type&&(c.kinematicDelaySleep=!0),c.component.sleeping&&this.really_wake(c,!1));b=b.next}for(b=this.compounds.head;null!=b;)a.add(b.elt),b=b.next;for(;null!=a.head;){b=a.pop_unsafe();for(c=b.bodies.head;null!=c;){var d=c.elt;d.world||(d.component.waket=this.stamp+(this.midstep?0:1),3==d.type&&(d.kinematicDelaySleep=!0),d.component.sleeping&&this.really_wake(d,
!1));c=c.next}for(b=b.compounds.head;null!=b;)a.add(b.elt),b=b.next}},gravity_validate:function(){this.wrap_gravity.zpp_inner.x=this.gravityx;this.wrap_gravity.zpp_inner.y=this.gravityy},clear:function(){for(;null!=this.listeners.head;){var a=this.listeners.pop_unsafe();this.remListener(a)}for(;null!=this.callbackset_list.next;)a=this.callbackset_list.pop_unsafe(),a.arbiters.clear(),a.int1=a.int2=null,a.id=a.di=-1,a.freed=!0,null,a.next=ec.zpp_pool,ec.zpp_pool=a;for(;null!=this.c_arbiters_true.head;)this.c_arbiters_true.pop_unsafe().retire();
for(;null!=this.c_arbiters_false.head;)this.c_arbiters_false.pop_unsafe().retire();for(;null!=this.s_arbiters.head;)this.s_arbiters.pop_unsafe().retire();for(;null!=this.f_arbiters.head;)this.f_arbiters.pop_unsafe().retire();for(this.bphase.clear();null!=this.bodies.head;){a=this.bodies.pop_unsafe();if(null!=a.component){var b=a.component.island;if(null!=b){for(;null!=b.comps.head;){var c=b.comps.pop_unsafe();c.sleeping=!1;c.island=null;c.parent=c;c.rank=0}b.next=jb.zpp_pool;jb.zpp_pool=b}}a.removedFromSpace();
a.space=null}for(;null!=this.constraints.head;){a=this.constraints.pop_unsafe();if(null!=a.component&&(b=a.component.island,null!=b)){for(;null!=b.comps.head;)c=b.comps.pop_unsafe(),c.sleeping=!1,c.island=null,c.parent=c,c.rank=0;b.next=jb.zpp_pool;jb.zpp_pool=b}a.removedFromSpace();a.space=null}this.kinematics.clear();for(a=new Pd;null!=this.compounds.head;)b=this.compounds.pop_unsafe(),a.add(b);for(;null!=a.head;){b=a.pop_unsafe();b.removedFromSpace();b.space=null;for(c=b.bodies.head;null!=c;){var d=
c.elt;if(null!=d.component){var e=d.component.island;if(null!=e){for(;null!=e.comps.head;){var f=e.comps.pop_unsafe();f.sleeping=!1;f.island=null;f.parent=f;f.rank=0}e.next=jb.zpp_pool;jb.zpp_pool=e}}d.removedFromSpace();d.space=null;c=c.next}for(c=b.constraints.head;null!=c;){d=c.elt;if(null!=d.component&&(e=d.component.island,null!=e)){for(;null!=e.comps.head;)f=e.comps.pop_unsafe(),f.sleeping=!1,f.island=null,f.parent=f,f.rank=0;e.next=jb.zpp_pool;jb.zpp_pool=e}d.removedFromSpace();d.space=null;
c=c.next}for(b=b.compounds.head;null!=b;)a.add(b.elt),b=b.next}this.staticsleep.clear();this.live.clear();this.live_constraints.clear();this.time=this.stamp=0;this.mrca1.clear();this.mrca2.clear();this.prelisteners.clear();this.cbsets.clear()},bodies_adder:function(a){if(null!=a.zpp_inner.compound)throw new f("Error: Cannot set the space of a Body belonging to a Compound, only the root Compound space can be set");return a.zpp_inner.space!=this?(null!=a.zpp_inner.space&&a.zpp_inner.space.outer.zpp_inner.wrap_bodies.remove(a),
this.addBody(a.zpp_inner),!0):!1},bodies_subber:function(a){this.remBody(a.zpp_inner)},bodies_modifiable:function(){if(this.midstep)throw new f("Error: Space::bodies cannot be set during space step()");},compounds_adder:function(a){if(null!=a.zpp_inner.compound)throw new f("Error: Cannot set the space of an inner Compound, only the root Compound space can be set");return a.zpp_inner.space!=this?(null!=a.zpp_inner.space&&a.zpp_inner.space.wrap_compounds.remove(a),this.addCompound(a.zpp_inner),!0):
!1},compounds_subber:function(a){this.remCompound(a.zpp_inner)},compounds_modifiable:function(){if(this.midstep)throw new f("Error: Space::compounds cannot be set during space step()");},constraints_adder:function(a){if(null!=a.zpp_inner.compound)throw new f("Error: Cannot set the space of a Constraint belonging to a Compound, only the root Compound space can be set");return a.zpp_inner.space!=this?(null!=a.zpp_inner.space&&a.zpp_inner.space.outer.zpp_inner.wrap_constraints.remove(a),this.addConstraint(a.zpp_inner),
!0):!1},constraints_subber:function(a){this.remConstraint(a.zpp_inner)},constraints_modifiable:function(){if(this.midstep)throw new f("Error: Space::constraints cannot be set during space step()");},listeners_adder:function(a){return a.zpp_inner.space!=this?(null!=a.zpp_inner.space&&a.zpp_inner.space.outer.zpp_inner.wrap_listeners.remove(a),this.addListener(a.zpp_inner),!0):!1},listeners_subber:function(a){this.remListener(a.zpp_inner)},listeners_modifiable:function(){if(this.midstep)throw new f("Error: Space::listeners cannot be set during space step()");
},revoke_listener:function(a){},unrevoke_listener:function(a){},addListener:function(a){a.space=this;a.addedToSpace();null!=a.interaction&&null},remListener:function(a){null!=a.interaction&&null;a.removedFromSpace();a.space=null},add_callbackset:function(a){a.int1.cbsets.inlined_add(a);a.int2.cbsets.inlined_add(a);this.callbackset_list.inlined_add(a)},remove_callbackset:function(a){a.lazydel=!0;a.int1.cbsets.inlined_try_remove(a);a.int2.cbsets.inlined_try_remove(a)},transmitType:function(a,b){a.world||
(a.component.waket=this.stamp+(this.midstep?0:1),3==a.type&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,!1));2==a.type?this.live.remove(a):3==a.type?(this.kinematics.remove(a),this.staticsleep.remove(a)):1==a.type&&this.staticsleep.remove(a);a.type=b;3==a.type&&this.kinematics.add(a);1==a.type&&this.static_validation(a);a.component.sleeping=!0;a.world||(a.component.waket=this.stamp+(this.midstep?0:1),3==a.type&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,
!0))},added_shape:function(a,b){null==b&&(b=!1);if(!b){var c=a.body;c.world||(c.component.waket=this.stamp+(this.midstep?0:1),3==c.type&&(c.kinematicDelaySleep=!0),c.component.sleeping&&this.really_wake(c,!1))}this.bphase.insert(a);a.addedToSpace()},removed_shape:function(a,b){null==b&&(b=!1);var c=this,d=a.body;b||d.wake();for(var e=null,f=d.arbiters.head;null!=f;){var g=[f.elt];if(g[0].ws1==a||g[0].ws2==a){if(0!=g[0].present)for(this.MRCA_chains(g[0].ws1,g[0].ws2),f=this.mrca1.head;null!=f;){for(var q=
f.elt,k=this.mrca2.head;null!=k;){var l=k.elt,n=q.cbSet,r=l.cbSet;n.validate();r.validate();n.manager.pair(n,r).empty_intersection()||(l=[Na.get(q,l)],l[0].remove_arb(g[0]),g[0].present--,n.manager.pair(n,r).forall(1,function(a,b){return function(d){if(0!=(d.itype&b[0].type)&&a[0].empty_arb(d.itype)){var e=c.push_callback(d);e.event=1;Na.int_callback(a[0],d,e);e.set=a[0]}}}(l,g)),null==l[0].arbiters.head&&this.remove_callbackset(l[0]));k=k.next}f=f.next}g[0].b1!=d&&2==g[0].b1.type&&(f=g[0].b1,f.world||
(f.component.waket=this.stamp+(this.midstep?0:1),3==f.type&&(f.kinematicDelaySleep=!0),f.component.sleeping&&this.really_wake(f,!1)));g[0].b2!=d&&2==g[0].b2.type&&(f=g[0].b2,f.world||(f.component.waket=this.stamp+(this.midstep?0:1),3==f.type&&(f.kinematicDelaySleep=!0),f.component.sleeping&&this.really_wake(f,!1)));g[0].cleared=!0;null!=d&&g[0].b2!=d||g[0].b1.arbiters.inlined_try_remove(g[0]);null!=d&&g[0].b1!=d||g[0].b2.arbiters.inlined_try_remove(g[0]);null!=g[0].pair&&(g[0].pair.arb=null,g[0].pair=
null);g[0].active=!1;this.f_arbiters.modified=!0;f=d.arbiters.erase(e)}else e=f,f=f.next}this.bphase.remove(a);a.removedFromSpace()},addConstraint:function(a){a.space=this;a.addedToSpace();a.active&&(a.component.sleeping=!0,this.wake_constraint(a,!0))},remConstraint:function(a){a.active&&(this.wake_constraint(a,!0),this.live_constraints.remove(a));a.removedFromSpace();a.space=null},addCompound:function(a){a.space=this;a.addedToSpace();for(var b=a.bodies.head;null!=b;)this.addBody(b.elt),b=b.next;
for(b=a.constraints.head;null!=b;)this.addConstraint(b.elt),b=b.next;for(a=a.compounds.head;null!=a;)this.addCompound(a.elt),a=a.next},remCompound:function(a){for(var b=a.bodies.head;null!=b;)this.remBody(b.elt),b=b.next;for(b=a.constraints.head;null!=b;)this.remConstraint(b.elt),b=b.next;for(b=a.compounds.head;null!=b;)this.remCompound(b.elt),b=b.next;a.removedFromSpace();a.space=null},addBody:function(a,b){null==b&&(b=-1);a.space=this;a.addedToSpace();a.component.sleeping=!0;a.world||(a.component.waket=
this.stamp+(this.midstep?0:1),3==a.type&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,!0));for(var c=a.shapes.head;null!=c;)this.added_shape(c.elt,!0),c=c.next;1==a.type?this.static_validation(a):2!=a.type&&3!=b&&this.kinematics.add(a)},remBody:function(a,b){null==b&&(b=-1);1==a.type?(a.world||(a.component.waket=this.stamp+(this.midstep?0:1),3==a.type&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,!0)),this.staticsleep.remove(a)):2==a.type?(a.world||(a.component.waket=
this.stamp+(this.midstep?0:1),3==a.type&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,!0)),this.live.remove(a)):(3!=b&&this.kinematics.remove(a),a.world||(a.component.waket=this.stamp+(this.midstep?0:1),3==a.type&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,!0)),this.staticsleep.remove(a));for(var c=a.shapes.head;null!=c;)this.removed_shape(c.elt,!0),c=c.next;a.removedFromSpace();a.space=null},shapesUnderPoint:function(a,b,c,d){return this.bphase.shapesUnderPoint(a,
b,c,d)},bodiesUnderPoint:function(a,b,c,d){return this.bphase.bodiesUnderPoint(a,b,c,d)},shapesInAABB:function(a,b,c,d,e){return this.bphase.shapesInAABB(a.zpp_inner,b,c,d,e)},bodiesInAABB:function(a,b,c,d,e){return this.bphase.bodiesInAABB(a.zpp_inner,b,c,d,e)},shapesInCircle:function(a,b,c,d,e){return this.bphase.shapesInCircle(function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this),function(b){if(null!=
a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this),b,c,d,e)},bodiesInCircle:function(a,b,c,d,e){return this.bphase.bodiesInCircle(function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.x}(this),function(b){if(null!=a&&a.zpp_disp)throw new f("Error: Vec2 has been disposed and cannot be used!");a.zpp_inner.validate();return a.zpp_inner.y}(this),
b,c,d,e)},shapesInShape:function(a,b,c,d){return this.bphase.shapesInShape(a,b,c,d)},bodiesInShape:function(a,b,c,d){return this.bphase.bodiesInShape(a,b,c,d)},rayCast:function(a,b,c){return this.bphase.rayCast(a.zpp_inner,b,null==c?null:c.zpp_inner)},rayMultiCast:function(a,b,c,d){return this.bphase.rayMultiCast(a.zpp_inner,b,null==c?null:c.zpp_inner,d)},convexCast:function(a,b,c,d){var e;null==wa.zpp_pool?e=new wa:(e=wa.zpp_pool,wa.zpp_pool=e.next,e.next=null);e.failed=!1;e.s1=e.s2=null;e.arbiter=
null;0==a.type?a.circle.validate_worldCOM():a.polygon.validate_gaxi();var f=a.body,g=f.posx,q=f.posy;f.sweepTime=0;f.sweep_angvel=f.angvel;f.sweepIntegrate(b);var k=f.posx,l=f.posy;a.validate_sweepRadius();var n=a.sweepRadius,r;null==X.zpp_pool?r=new X:(r=X.zpp_pool,X.zpp_pool=r.next,r.next=null);null;r.minx=(g<k?g:k)-n;r.maxx=(g>k?g:k)+n;r.miny=(q<l?q:l)-n;r.maxy=(q>l?q:l)+n;c=this.convexShapeList=this.bphase.shapesInAABB(r,!1,!1,null==c?null:c.zpp_inner,this.convexShapeList);null!=r.outer&&(r.outer.zpp_inner=
null,r.outer=null);r.wrap_min=r.wrap_max=null;r._invalidate=null;r._validate=null;r.next=X.zpp_pool;X.zpp_pool=r;var k=q=k=q=g=r=g=r=0,l=null,n=b+1,u;c.zpp_inner.valmod();for(u=zb.get(c);u.hasNext();){var x;u.zpp_critical=!1;x=u.zpp_inner.at(u.zpp_i++);x!=a.outer&&(null!=x.zpp_inner.body?x.zpp_inner.body.outer:null)!=f.outer&&(e.s1=a,e.s2=x.zpp_inner,d?(x.zpp_inner.validate_sweepRadius(),(null!=x.zpp_inner.body?x.zpp_inner.body.outer:null).zpp_inner.sweep_angvel=(null!=x.zpp_inner.body?x.zpp_inner.body.outer:
null).zpp_inner.angvel,(null!=x.zpp_inner.body?x.zpp_inner.body.outer:null).zpp_inner.sweepTime=0,Pa.dynamicSweep(e,b,0,0,!0),(null!=x.zpp_inner.body?x.zpp_inner.body.outer:null).zpp_inner.sweepIntegrate(0),(null!=x.zpp_inner.body?x.zpp_inner.body.outer:null).zpp_inner.sweepValidate(x.zpp_inner)):Pa.staticSweep(e,b,0,0),e.toi*=b,0<e.toi&&e.toi<n&&(n=e.toi,r=e.axis.x,g=e.axis.y,q=e.c2.x,k=e.c2.y,l=x))}c.clear();d=e;d.next=wa.zpp_pool;wa.zpp_pool=d;f.sweepIntegrate(0);f.sweepValidate(a);return n<=b?
Ba.getConvex(E.get(-r,-g,null),E.get(q,k,null),n,l):null},prepareCast:function(a){0==a.type?a.circle.validate_worldCOM():a.polygon.validate_gaxi()},convexMultiCast:function(a,b,c,d,e){var h;null==wa.zpp_pool?h=new wa:(h=wa.zpp_pool,wa.zpp_pool=h.next,h.next=null);h.failed=!1;h.s1=h.s2=null;h.arbiter=null;0==a.type?a.circle.validate_worldCOM():a.polygon.validate_gaxi();var g=a.body,q=g.posx,k=g.posy;g.sweepTime=0;g.sweep_angvel=g.angvel;g.sweepIntegrate(b);var l=g.posx,n=g.posy;a.validate_sweepRadius();
var r=a.sweepRadius,u;null==X.zpp_pool?u=new X:(u=X.zpp_pool,X.zpp_pool=u.next,u.next=null);null;u.minx=(q<l?q:l)-r;u.maxx=(q>l?q:l)+r;u.miny=(k<n?k:n)-r;u.maxy=(k>n?k:n)+r;c=this.convexShapeList=this.bphase.shapesInAABB(u,!1,!1,null==c?null:c.zpp_inner,this.convexShapeList);null!=u.outer&&(u.outer.zpp_inner=null,u.outer=null);u.wrap_min=u.wrap_max=null;u._invalidate=null;u._validate=null;u.next=X.zpp_pool;X.zpp_pool=u;e=null==e?new Kd:e;c.zpp_inner.valmod();for(u=zb.get(c);u.hasNext();)if(u.zpp_critical=
!1,q=u.zpp_inner.at(u.zpp_i++),q!=a.outer&&(null!=q.zpp_inner.body?q.zpp_inner.body.outer:null)!=g.outer&&(h.s1=a,h.s2=q.zpp_inner,d?(q.zpp_inner.validate_sweepRadius(),(null!=q.zpp_inner.body?q.zpp_inner.body.outer:null).zpp_inner.sweep_angvel=(null!=q.zpp_inner.body?q.zpp_inner.body.outer:null).zpp_inner.angvel,(null!=q.zpp_inner.body?q.zpp_inner.body.outer:null).zpp_inner.sweepTime=0,Pa.dynamicSweep(h,b,0,0,!0),(null!=q.zpp_inner.body?q.zpp_inner.body.outer:null).zpp_inner.sweepIntegrate(0),(null!=
q.zpp_inner.body?q.zpp_inner.body.outer:null).zpp_inner.sweepValidate(q.zpp_inner)):Pa.staticSweep(h,b,0,0),h.toi*=b,0<h.toi)){q=Ba.getConvex(E.get(-h.axis.x,-h.axis.y,null),E.get(h.c2.x,h.c2.y,null),h.toi,q);k=null;for(l=e.zpp_inner.inner.head;null!=l;){n=l.elt;if(null!=q.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");r=q.zpp_inner.toiDistance;if(null!=n.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");if(r<n.zpp_inner.toiDistance)break;
k=l;l=l.next}e.zpp_inner.inner.inlined_insert(k,q)}c.clear();b=h;b.next=wa.zpp_pool;wa.zpp_pool=b;g.sweepIntegrate(0);g.sweepValidate(a);return e},push_callback:function(a){var b;null==Ra.zpp_pool?b=new Ra:(b=Ra.zpp_pool,Ra.zpp_pool=b.next,b.next=null);null;this.callbacks.push(b);b.listener=a;return b},step:function(a,b,c){var d=this;if(this.midstep)throw new f("Error: ... REALLY?? you're going to call space.step() inside of space.step()? COME ON!!");this.time+=a;this.pre_dt=a;this.midstep=!0;this.stamp++;
this.validation();this.bphase.broadphase(this,!0);this.prestep(a);if(this.sortcontacts){var e=this.c_arbiters_false;if(null!=e.head&&null!=e.head.next){var h=e.head,g=null,q=null,k=null,l=null,n=1,r,u,x;do{r=0;q=h;for(g=h=null;null!=q;){r++;k=q;u=0;for(x=n;null!=k&&u<n;)u++,k=k.next;for(;0<u||0<x&&null!=k;)0==u?(l=k,k=k.next,x--):0==x||null==k?(l=q,q=q.next,u--):(q.elt.active&&k.elt.active?q.elt.oc1.dist<k.elt.oc1.dist:1)?(l=q,q=q.next,u--):(l=k,k=k.next,x--),null!=g?g.next=l:h=l,g=l;q=k}g.next=null;
n<<=1}while(1<r);e.head=h;e.modified=!0;e.pushmod=!0}}this.updateVel(a);this.warmStart();this.iterateVel(b);for(b=this.kinematics.head;null!=b;)e=b.elt,e.pre_posx=e.posx,e.pre_posy=e.posy,e.pre_rot=e.rot,b=b.next;for(b=this.live.head;null!=b;)e=b.elt,e.pre_posx=e.posx,e.pre_posy=e.posy,e.pre_rot=e.rot,b=b.next;this.updatePos(a);this.continuous=!0;this.continuousCollisions(a);this.continuous=!1;this.iteratePos(c);for(c=this.kinematics.head;null!=c;)b=c.elt,e=b.pre_rot!=b.rot,b.posx==b.pre_posx&&b.posy==
b.pre_posy||b.invalidate_pos(),e&&b.invalidate_rot(),c=c.next;for(c=this.live.head;null!=c;)b=c.elt,e=b.pre_rot!=b.rot,b.posx==b.pre_posx&&b.posy==b.pre_posy||b.invalidate_pos(),e&&b.invalidate_rot(),c=c.next;c=null;for(b=this.staticsleep.head;null!=b;)e=b.elt,3!=e.type||0==e.velx&&0==e.vely&&0==e.angvel?e.kinematicDelaySleep?(e.kinematicDelaySleep=!1,b=b.next):(e.component.sleeping=!0,b=this.staticsleep.inlined_erase(c)):(c=b,b=b.next);this.doForests(a);this.sleepArbiters();this.midstep=!1;c=null;
for(a=this.callbackset_list.next;null!=a;)b=[a],null==b[0].arbiters.head?(a=this.callbackset_list.inlined_erase(c),b=b[0],b.int1=b.int2=null,b.id=b.di=-1,b.freed=!0,null,b.next=ec.zpp_pool,ec.zpp_pool=b):(c=[b[0].sleeping()],oa.find_all(b[0].int1.cbSet,b[0].int2.cbSet,6,function(a,b){return function(c){if((!a[0]||c.allowSleepingCallbacks)&&!b[0].empty_arb(c.itype)){var e=d.push_callback(c);e.event=6;Na.int_callback(b[0],c,e);e.set=b[0]}}}(c,b)),c=a,a=a.next);for(;!this.callbacks.empty();)a=this.callbacks.pop(),
0==a.listener.type?a.listener.body.handler(a.wrapper_body()):1==a.listener.type?a.listener.constraint.handler(a.wrapper_con()):2==a.listener.type&&a.listener.interaction.handleri(a.wrapper_int()),a.int1=a.int2=null,a.body=null,a.constraint=null,a.listener=null,null!=a.wrap_arbiters&&(a.wrap_arbiters.zpp_inner.inner=null),a.set=null,a.next=Ra.zpp_pool,Ra.zpp_pool=a},continuousCollisions:function(a){var b=2*Math.PI/a;this.bphase.broadphase(this,!1);for(var c=0;1>c&&null!=this.toiEvents.head;){for(var d=
null,c=2,e=!1,f=null,g=null,q=this.toiEvents.head;null!=q;){var k=q.elt,l=k.s1.body,n=k.s2.body;if(l.sweepFrozen&&n.sweepFrozen)if(0!=k.toi&&C.testCollide_safe(k.s1,k.s2))k.toi=0;else{q=this.toiEvents.erase(g);k.next=wa.zpp_pool;wa.zpp_pool=k;continue}if(k.frozen1!=l.sweepFrozen||k.frozen2!=n.sweepFrozen)if(k.kinematic){q=this.toiEvents.erase(g);k.next=wa.zpp_pool;wa.zpp_pool=k;continue}else if(k.frozen1=l.sweepFrozen,k.frozen2=n.sweepFrozen,k.frozen1&&(l=k.s1,k.s1=k.s2,k.s2=l,k.frozen1=!1,k.frozen2=
!0),Pa.staticSweep(k,a,0,u.collisionSlopCCD),0>k.toi){q=this.toiEvents.erase(g);k.next=wa.zpp_pool;wa.zpp_pool=k;continue}0<=k.toi&&(k.toi<c||!e&&k.kinematic)&&(d=k,c=k.toi,e=k.kinematic,f=g);g=q;q=q.next}if(null==d)break;this.toiEvents.erase(f);c=d.toi;e=d.s1.body;f=d.s2.body;e.sweepFrozen||(e.sweepIntegrate(c*a),e.sweepValidate(d.s1));f.sweepFrozen||(f.sweepIntegrate(c*a),f.sweepValidate(d.s2));g=this.narrowPhase(d.s1,d.s2,!0,d.arbiter,!0);null==g?null!=d.arbiter&&null!=d.arbiter.pair&&(d.arbiter.pair.arb=
null,d.arbiter.pair=null):!this.presteparb(g,a,!0)&&g.type==F.COL&&g.active&&0!=(g.immState&1)&&(g.colarb.warmStart(),g.colarb.applyImpulseVel(),g.colarb.applyImpulseVel(),g.colarb.applyImpulseVel(),g.colarb.applyImpulseVel(),e.sweep_angvel=e.angvel%b,f.sweep_angvel=f.angvel%b);null!=g&&g.active&&0!=(g.immState&1)&&g.type==F.COL&&(e.sweepFrozen||3==e.type||(e.sweepFrozen=!0,e.angvel=d.failed?e.sweep_angvel=0:d.slipped?e.sweep_angvel*=u.angularCCDSlipScale:e.sweep_angvel),f.sweepFrozen||3==f.type||
(f.sweepFrozen=!0,f.angvel=d.failed?f.sweep_angvel=0:d.slipped?f.sweep_angvel*=u.angularCCDSlipScale:f.sweep_angvel));d.next=wa.zpp_pool;wa.zpp_pool=d}for(;null!=this.toiEvents.head;)b=this.toiEvents.pop_unsafe(),b.next=wa.zpp_pool,wa.zpp_pool=b;for(b=this.kinematics.head;null!=b;)d=b.elt,d.sweepIntegrate(a),d.sweepTime=0,b=b.next;for(b=this.live.head;null!=b;)d=b.elt,d.sweepFrozen||d.sweepIntegrate(a),d.sweepTime=0,b=b.next},continuousEvent:function(a,b,c,d,e){if(a.body.sweepFrozen&&b.body.sweepFrozen||
a.body.disableCCD||b.body.disableCCD||null!=d&&null==d.colarb||0>=this.interactionType(a,b,a.body,b.body))return d;var f=a.body,g=b.body;if(c||f.bullet||g.bullet)null==wa.zpp_pool?e=new wa:(e=wa.zpp_pool,wa.zpp_pool=e.next,e.next=null),e.failed=!1,e.s1=e.s2=null,e.arbiter=null,f=3==f.type||3==g.type,c&&!f?(2!=a.body.type?(e.s2=a,e.s1=b):(e.s1=a,e.s2=b),e.kinematic=!1,Pa.staticSweep(e,this.pre_dt,0,u.collisionSlopCCD)):(e.s1=a,e.s2=b,e.kinematic=f,e.s1.body.sweepFrozen||e.s2.body.sweepFrozen?(e.s1.body.sweepFrozen&&
(a=e.s1,e.s1=e.s2,e.s2=a,e.frozen1=!1,e.frozen2=!0),Pa.staticSweep(e,this.pre_dt,0,u.collisionSlopCCD)):Pa.dynamicSweep(e,this.pre_dt,0,u.collisionSlopCCD)),c&&0>e.toi||e.failed?(c=e,c.next=wa.zpp_pool,wa.zpp_pool=c):(this.toiEvents.add(e),e.frozen1=e.s1.body.sweepFrozen,e.frozen2=e.s2.body.sweepFrozen,e.arbiter=null!=d?d.colarb:null);return d},bodyCbWake:function(a){if(2==a.type&&null!=a.cbSet)if(this.midstep)for(var b=a.cbSet.bodylisteners.head;null!=b;){var c=b.elt;2==c.event&&(c=this.push_callback(c),
c.event=2,c.body=a);b=b.next}else a.component.woken=!0},bodyCbSleep:function(a){if(2==a.type&&null!=a.cbSet)for(var b=a.cbSet.bodylisteners.head;null!=b;){var c=b.elt;3==c.event&&(c=this.push_callback(c),c.event=3,c.body=a);b=b.next}},constraintCbWake:function(a){if(null!=a.cbSet)if(this.midstep)for(var b=a.cbSet.conlisteners.head;null!=b;){var c=b.elt;2==c.event&&(c=this.push_callback(c),c.event=2,c.constraint=a);b=b.next}else a.component.woken=!0},constraintCbSleep:function(a){if(null!=a.cbSet)for(var b=
a.cbSet.conlisteners.head;null!=b;){var c=b.elt;3==c.event&&(c=this.push_callback(c),c.event=3,c.constraint=a);b=b.next}},constraintCbBreak:function(a){if(null!=a.cbSet)for(var b=a.cbSet.conlisteners.head;null!=b;){var c=b.elt;4==c.event&&(c=this.push_callback(c),c.event=4,c.constraint=a);b=b.next}},nullListenerType:function(a,b){for(var c=new Xb,d=a.interactors.head;null!=d;)c.add(d.elt),d=d.next;if(a!=b)for(d=b.interactors.head;null!=d;)c.add(d.elt),d=d.next;for(;null!=c.head;)if(d=c.pop_unsafe(),
null!=d.icompound){for(var d=d.icompound,e=d.bodies.head;null!=e;)c.add(e.elt),e=e.next;for(d=d.compounds.head;null!=d;)c.add(d.elt),d=d.next}else for(e=null!=d.ibody?d.ibody:d.ishape.body,d=null!=d.ishape?d.ishape:null,e=e.arbiters.head;null!=e;){var f=e.elt;if(0!=f.present&&(null==d||f.ws1==d||f.ws2==d))for(this.MRCA_chains(f.ws1,f.ws2),f=this.mrca1.head;null!=f;){var g=f.elt;if(g.cbSet==a||g.cbSet==b)for(var q=this.mrca2.head;null!=q;){var k=q.elt;if(!(g.cbSet==a&&k.cbSet!=b||g.cbSet==b&&k.cbSet!=
a)&&(k=Na.get(g,k),null!=k)){for(;null!=k.arbiters.head;)k.arbiters.pop_unsafe().present--;this.remove_callbackset(k)}q=q.next}f=f.next}e=e.next}},nullInteractorType:function(a,b){null==b&&(b=a);if(null!=a.icompound){for(var c=a.icompound,d=c.bodies.head;null!=d;)this.nullInteractorType(d.elt,b),d=d.next;for(c=c.compounds.head;null!=c;)this.nullInteractorType(c.elt,b),c=c.next}else for(d=null!=a.ibody?a.ibody:a.ishape.body,c=null!=a.ishape?a.ishape:null,d=d.arbiters.head;null!=d;){var e=d.elt;if(0!=
e.present&&(null==c||e.ws1==c||e.ws2==c)){this.MRCA_chains(e.ws1,e.ws2);for(var f=this.mrca1.head;null!=f;){for(var g=f.elt,q=this.mrca2.head;null!=q;){var k=q.elt;if(g==b||k==b)k=Na.get(g,k),null!=k&&(e.present--,k.remove_arb(e),null==k.arbiters.head&&this.remove_callbackset(k));q=q.next}f=f.next}}d=d.next}},freshListenerType:function(a,b){for(var c=new Xb,d=a.interactors.head;null!=d;)c.add(d.elt),d=d.next;if(a!=b)for(d=b.interactors.head;null!=d;)c.add(d.elt),d=d.next;for(;null!=c.head;)if(d=c.pop_unsafe(),
null!=d.icompound){for(var d=d.icompound,e=d.bodies.head;null!=e;)c.add(e.elt),e=e.next;for(d=d.compounds.head;null!=d;)c.add(d.elt),d=d.next}else for(e=null!=d.ibody?d.ibody:d.ishape.body,d=null!=d.ishape?d.ishape:null,e=e.arbiters.head;null!=e;){var f=e.elt;if(f.presentable&&(null==d||f.ws1==d||f.ws2==d)){this.MRCA_chains(f.ws1,f.ws2);for(var g=this.mrca1.head;null!=g;){var q=g.elt;if(q.cbSet==a||q.cbSet==b)for(var k=this.mrca2.head;null!=k;){var l=k.elt;if(!(q.cbSet==a&&l.cbSet!=b||q.cbSet==b&&
l.cbSet!=a)){var n=Na.get(q,l);null==n&&(n=ec.get(q,l),this.add_callbackset(n));n.arbiters.inlined_has(f)?n=!1:(l=void 0,n.arbiters.inlined_add(f),n=l=!0);n&&f.present++}k=k.next}g=g.next}}e=e.next}},freshInteractorType:function(a,b){null==b&&(b=a);if(null!=a.icompound){for(var c=a.icompound,d=c.bodies.head;null!=d;)this.freshInteractorType(d.elt,b),d=d.next;for(c=c.compounds.head;null!=c;)this.freshInteractorType(c.elt,b),c=c.next}else for(d=null!=a.ibody?a.ibody:a.ishape.body,c=null!=a.ishape?a.ishape:
null,d=d.arbiters.head;null!=d;){var e=d.elt;if(e.presentable&&(null==c||e.ws1==c||e.ws2==c)){this.MRCA_chains(e.ws1,e.ws2);for(var f=this.mrca1.head;null!=f;){for(var g=f.elt,q=this.mrca2.head;null!=q;){var k=q.elt;if(g==b||k==b){var l=g.cbSet,n=k.cbSet;l.validate();n.validate();l.manager.pair(l,n).empty_intersection()||(l=Na.get(g,k),null==l&&(l=ec.get(g,k),this.add_callbackset(l)),l.arbiters.inlined_has(e)?k=!1:(k=void 0,l.arbiters.inlined_add(e),k=!0),k&&e.present++)}q=q.next}f=f.next}}d=d.next}},
wakeCompound:function(a){for(var b=a.bodies.head;null!=b;){var c=b.elt;c.world||(c.component.waket=this.stamp+(this.midstep?0:1),3==c.type&&(c.kinematicDelaySleep=!0),c.component.sleeping&&this.really_wake(c,!1));b=b.next}for(b=a.constraints.head;null!=b;)this.wake_constraint(b.elt),b=b.next;for(a=a.compounds.head;null!=a;)this.wakeCompound(a.elt),a=a.next},wakeIsland:function(a){for(;null!=a.comps.head;){var b=a.comps.pop_unsafe();b.waket=this.stamp+(this.midstep?0:1);if(b.isBody){var c=b.body;this.live.add(c);
for(var d=c.arbiters.head;null!=d;){var e=d.elt;e.sleeping&&(e.sleeping=!1,e.up_stamp+=this.stamp-e.sleep_stamp,e.type==F.COL?(e=e.colarb,e.stat?this.c_arbiters_true.inlined_add(e):this.c_arbiters_false.inlined_add(e)):e.type==F.FLUID?this.f_arbiters.inlined_add(e.fluidarb):this.s_arbiters.inlined_add(e.sensorarb));d=d.next}this.bodyCbWake(c);b.sleeping=!1;b.island=null;b.parent=b;b.rank=0;if(1!=c.type)for(b=c.shapes.head;null!=b;)c=b.elt,null!=c.node&&this.bphase.sync(c),b=b.next}else c=b.constraint,
this.live_constraints.inlined_add(c),this.constraintCbWake(c),b.sleeping=!1,b.island=null,b.parent=b,b.rank=0}a.next=jb.zpp_pool;jb.zpp_pool=a},non_inlined_wake:function(a,b){null==b&&(b=!1);a.world||(a.component.waket=this.stamp+(this.midstep?0:1),3==a.type&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,b))},really_wake:function(a,b){null==b&&(b=!1);if(null==a.component.island){a.component.sleeping=!1;3==a.type||1==a.type?this.staticsleep.inlined_add(a):this.live.inlined_add(a);
for(var c=a.constraints.head;null!=c;){var d=c.elt;d.space==this&&this.wake_constraint(d);c=c.next}for(c=a.arbiters.head;null!=c;){d=c.elt;if(d.sleeping)if(d.sleeping=!1,d.up_stamp+=this.stamp+(this.midstep?0:1)-d.sleep_stamp,d.type==F.COL){var e=d.colarb;e.stat?this.c_arbiters_true.inlined_add(e):this.c_arbiters_false.inlined_add(e)}else d.type==F.FLUID?this.f_arbiters.inlined_add(d.fluidarb):this.s_arbiters.inlined_add(d.sensorarb);d.type!=F.SENSOR&&!d.cleared&&d.up_stamp>=this.stamp&&0!=(d.immState&
1)&&(2==d.b1.type&&d.b1.component.sleeping&&(e=d.b1,e.world||(e.component.waket=this.stamp+(this.midstep?0:1),3==e.type&&(e.kinematicDelaySleep=!0),e.component.sleeping&&this.really_wake(e,!1))),2==d.b2.type&&d.b2.component.sleeping&&(d=d.b2,d.world||(d.component.waket=this.stamp+(this.midstep?0:1),3==d.type&&(d.kinematicDelaySleep=!0),d.component.sleeping&&this.really_wake(d,!1))));c=c.next}b||2!=a.type||this.bodyCbWake(a);if(!b&&!this.bphase.is_sweep&&1!=a.type)for(c=a.shapes.head;null!=c;)d=c.elt,
null!=d.node&&this.bphase.sync(d),c=c.next}else this.wakeIsland(a.component.island)},wake_constraint:function(a,b){null==b&&(b=!1);return a.active&&(a.component.waket=this.stamp+(this.midstep?0:1),a.component.sleeping)?(null==a.component.island?(a.component.sleeping=!1,this.live_constraints.inlined_add(a),a.wake_connected(),b||this.constraintCbWake(a)):this.wakeIsland(a.component.island),!0):!1},doForests:function(a){for(var b=this.c_arbiters_false.head;null!=b;){var c=b.elt;if(!c.cleared&&c.up_stamp==
this.stamp&&0!=(c.immState&1)&&2==c.b1.type&&2==c.b2.type){var d;if(c.b1.component==c.b1.component.parent)d=c.b1.component;else{d=c.b1.component;for(var e=null;d!=d.parent;){var f=d.parent;d.parent=e;e=d;d=f}for(;null!=e;)f=e.parent,e.parent=d,e=f}if(c.b2.component==c.b2.component.parent)c=c.b2.component;else{c=c.b2.component;for(e=null;c!=c.parent;)f=c.parent,c.parent=e,e=c,c=f;for(;null!=e;)f=e.parent,e.parent=c,e=f}d!=c&&(d.rank<c.rank?d.parent=c:d.rank>c.rank?c.parent=d:(c.parent=d,d.rank++))}b=
b.next}for(b=this.f_arbiters.head;null!=b;){c=b.elt;if(!c.cleared&&c.up_stamp==this.stamp&&0!=(c.immState&1)&&2==c.b1.type&&2==c.b2.type){if(c.b1.component==c.b1.component.parent)d=c.b1.component;else{d=c.b1.component;for(e=null;d!=d.parent;)f=d.parent,d.parent=e,e=d,d=f;for(;null!=e;)f=e.parent,e.parent=d,e=f}if(c.b2.component==c.b2.component.parent)c=c.b2.component;else{c=c.b2.component;for(e=null;c!=c.parent;)f=c.parent,c.parent=e,e=c,c=f;for(;null!=e;)f=e.parent,e.parent=c,e=f}d!=c&&(d.rank<c.rank?
d.parent=c:d.rank>c.rank?c.parent=d:(c.parent=d,d.rank++))}b=b.next}for(b=this.live_constraints.head;null!=b;)b.elt.forest(),b=b.next;for(;null!=this.live.head;){d=this.live.inlined_pop_unsafe();b=d.component;if(b==b.parent)c=b;else{c=b;for(e=null;c!=c.parent;)f=c.parent,c.parent=e,e=c,c=f;for(;null!=e;)f=e.parent,e.parent=c,e=f}null==c.island&&(null==jb.zpp_pool?c.island=new jb:(c.island=jb.zpp_pool,jb.zpp_pool=c.island.next,c.island.next=null),c.island.waket=0,this.islands.inlined_add(c.island),
c.island.sleep=!0);b.island=c.island;b.island.comps.inlined_add(b);d=d.atRest(a);b.island.sleep=b.island.sleep&&d;b.waket>b.island.waket&&(b.island.waket=b.waket)}for(;null!=this.live_constraints.head;){a=this.live_constraints.inlined_pop_unsafe().component;if(a==a.parent)b=a;else{b=a;for(d=null;b!=b.parent;)c=b.parent,b.parent=d,d=b,b=c;for(;null!=d;)c=d.parent,d.parent=b,d=c}a.island=b.island;a.island.comps.inlined_add(a);a.waket>a.island.waket&&(a.island.waket=a.waket)}for(;null!=this.islands.next;)if(a=
this.islands.inlined_pop_unsafe(),a.sleep)for(a=a.comps.head;null!=a;){d=a.elt;if(d.isBody){b=d.body;b.velx=0;b.vely=0;b.angvel=0;d.sleeping=!0;for(d=b.shapes.head;null!=d;)this.bphase.sync(d.elt),d=d.next;this.bodyCbSleep(b)}else this.constraintCbSleep(d.constraint),d.sleeping=!0;a=a.next}else{for(;null!=a.comps.head;)b=a.comps.inlined_pop_unsafe(),b.waket=a.waket,b.isBody?this.live.inlined_add(b.body):this.live_constraints.inlined_add(b.constraint),b.sleeping=!1,b.island=null,b.parent=b,b.rank=
0;a.next=jb.zpp_pool;jb.zpp_pool=a}},sleepArbiters:function(){var a=null,b=this.c_arbiters_true,c=b.head,d=null!=this.c_arbiters_false;d&&null==c&&(d=!1,c=this.c_arbiters_false.head,b=this.c_arbiters_false,a=null);for(;null!=c;){var e=c.elt;e.b1.component.sleeping&&e.b2.component.sleeping?(e.sleep_stamp=this.stamp,e.sleeping=!0,c=b.inlined_erase(a)):(a=c,c=c.next);d&&null==c&&(d=!1,c=this.c_arbiters_false.head,b=this.c_arbiters_false,a=null)}a=null;b=this.f_arbiters;c=b.head;d=!1;for(;null!=c;)e=
c.elt,e.b1.component.sleeping&&e.b2.component.sleeping?(e.sleep_stamp=this.stamp,e.sleeping=!0,c=b.inlined_erase(a)):(a=c,c=c.next),d&&null==c&&(d=!1,a=b=null);a=null;b=this.s_arbiters;c=b.head;d=!1;for(;null!=c;)e=c.elt,e.b1.component.sleeping&&e.b2.component.sleeping?(e.sleep_stamp=this.stamp,e.sleeping=!0,c=b.inlined_erase(a)):(a=c,c=c.next),d&&null==c&&(d=!1,a=b=null)},static_validation:function(a){null!=a.shapes.head&&a.validate_aabb();a.validate_mass();a.validate_inertia();if(0!=a.velx||0!=
a.vely||0!=a.angvel)throw new f("Error: Static body cannot have any real velocity, only kinematic or surface velocities");for(var b=a.shapes.head;null!=b;){var c=b.elt;if(1==c.type){c.polygon.splice_collinear();var d=c.polygon.valid(),e=d,h=void 0;null==g.ValidationResult_VALID&&(g.internal=!0,g.ValidationResult_VALID=new xa,g.internal=!1);h=g.ValidationResult_VALID;if(e!=h)throw new f("Error: Cannot simulate with an invalid Polygon : "+c.polygon.outer.toString()+" is invalid : "+d.toString());c.polygon.validate_gaxi()}b=
b.next}a.sweepFrozen=!0},validation:function(){this.cbsets.validate();for(var a=this.live.head;null!=a;){var b=a.elt;b.sweepRadius=0;for(var c=b.shapes.head;null!=c;){var d=c.elt;if(1==d.type){d.polygon.splice_collinear();var e=d.polygon.valid(),h=e;null==g.ValidationResult_VALID&&(g.internal=!0,g.ValidationResult_VALID=new xa,g.internal=!1);if(h!=g.ValidationResult_VALID)throw new f("Error: Cannot simulate with an invalid Polygon : "+d.polygon.outer.toString()+" is invalid : "+e.toString());d.polygon.validate_gaxi()}d.validate_sweepRadius();
d.sweepRadius>b.sweepRadius&&(b.sweepRadius=d.sweepRadius);c=c.next}b.validate_mass();b.validate_inertia();null!=b.shapes.head&&(b.validate_aabb(),b.validate_worldCOM());b.validate_gravMass();b.zip_axis&&(b.zip_axis=!1,b.axisx=Math.sin(b.rot),b.axisy=Math.cos(b.rot),null);if(!b.nomove&&2==b.type&&0==b.mass)throw new f("Error: Dynamic Body cannot be simulated with 0 mass unless allowMovement is false");if(!b.norotate&&2==b.type&&0==b.inertia)throw new f("Error: Dynamic Body cannot be simulated with 0 inertia unless allowRotation is false");
if(b.component.woken&&null!=b.cbSet)for(c=b.cbSet.bodylisteners.head;null!=c;)d=c.elt,2==d.event&&(d=this.push_callback(d),d.event=2,d.body=b),c=c.next;b.component.woken=!1;for(b=b.shapes.head;null!=b;)this.bphase.sync(b.elt),b=b.next;a=a.next}for(a=this.kinematics.head;null!=a;){b=a.elt;b.sweepRadius=0;for(c=b.shapes.head;null!=c;){d=c.elt;if(1==d.type){d.polygon.splice_collinear();h=e=d.polygon.valid();null==g.ValidationResult_VALID&&(g.internal=!0,g.ValidationResult_VALID=new xa,g.internal=!1);
if(h!=g.ValidationResult_VALID)throw new f("Error: Cannot simulate with an invalid Polygon : "+d.polygon.outer.toString()+" is invalid : "+e.toString());d.polygon.validate_gaxi()}d.validate_sweepRadius();d.sweepRadius>b.sweepRadius&&(b.sweepRadius=d.sweepRadius);c=c.next}b.validate_mass();b.validate_inertia();null!=b.shapes.head&&(b.validate_aabb(),b.validate_worldCOM());b.validate_gravMass();b.zip_axis&&(b.zip_axis=!1,b.axisx=Math.sin(b.rot),b.axisy=Math.cos(b.rot),null);if(!b.nomove&&2==b.type&&
0==b.mass)throw new f("Error: Dynamic Body cannot be simulated with 0 mass unless allowMovement is false");if(!b.norotate&&2==b.type&&0==b.inertia)throw new f("Error: Dynamic Body cannot be simulated with 0 inertia unless allowRotation is false");for(b=b.shapes.head;null!=b;)this.bphase.sync(b.elt),b=b.next;a=a.next}for(a=this.live_constraints.head;null!=a;){b=a.elt;if(b.active){b.validate();if(b.component.woken&&null!=b.cbSet)for(c=b.cbSet.conlisteners.head;null!=c;)d=c.elt,2==d.event&&(d=this.push_callback(d),
d.event=2,d.constraint=b),c=c.next;b.component.woken=!1}a=a.next}},updateVel:function(a){for(var b=1-a*this.global_lin_drag,c=1-a*this.global_ang_drag,d=this.live.head;null!=d;){var e=d.elt;if(0!=e.smass){var f=a*e.imass;e.velx=b*e.velx+(e.forcex+this.gravityx*e.gravMass)*f;e.vely=b*e.vely+(e.forcey+this.gravityy*e.gravMass)*f}if(0!=e.sinertia){var g=f=0,f=e.worldCOMx-e.posx,g=e.worldCOMy-e.posy;e.angvel=c*e.angvel+(e.torque+(this.gravityy*f-this.gravityx*g)*e.gravMass)*a*e.iinertia}d=d.next}},updatePos:function(a){for(var b=
2*Math.PI/a,c=this.live.head;null!=c;){var d=c.elt;d.pre_posx=d.posx;d.pre_posy=d.posy;d.pre_rot=d.rot;d.sweepTime=0;d.sweep_angvel=d.angvel%b;d.sweepIntegrate(a);if(d.disableCCD)d.sweepFrozen=!0,d.bullet=!1;else{var e=u.staticCCDLinearThreshold*d.sweepRadius,f=u.staticCCDAngularThreshold;if((d.velx*d.velx+d.vely*d.vely)*a*a>e*e||d.angvel*d.angvel*a*a>f*f||3==d.type){e=d.sweep_angvel;0>e&&(e=-e);for(var f=1/e,g=d.shapes.head;null!=g;){var q=g.elt,k=q.aabb,l=k.minx,n=k.miny,r=k.maxx,w=k.maxy,x=e*a*
q.sweepCoef*.008333333333333333|0;8<x&&(x=8);var p=e*a/x;d.sweepIntegrate(a);0==q.type?q.circle._force_validate_aabb():q.polygon._force_validate_aabb();l<k.minx?k.minx=l:l=k.minx;n<k.miny?k.miny=n:n=k.miny;r>k.maxx?k.maxx=r:r=k.maxx;w>k.maxy?k.maxy=w:w=k.maxy;for(var y=1;y<x;){var A=y++;d.sweepIntegrate(p*A*f);0==q.type?q.circle._force_validate_aabb():q.polygon._force_validate_aabb();l<k.minx?k.minx=l:l=k.minx;n<k.miny?k.miny=n:n=k.miny;r>k.maxx?k.maxx=r:r=k.maxx;w>k.maxy?k.maxy=w:w=k.maxy}this.bphase.sync(q);
g=g.next}d.sweepFrozen=!1;2==d.type&&d.bulletEnabled&&(e=u.bulletCCDLinearThreshold*d.sweepRadius,f=u.bulletCCDAngularThreshold,(d.velx*d.velx+d.vely*d.vely)*a*a>e*e||d.angvel*d.angvel*a*a>f*f)&&(d.bullet=!0)}else d.sweepFrozen=!0,d.bullet=!1}c=c.next}for(c=this.kinematics.head;null!=c;){d=c.elt;d.pre_posx=d.posx;d.pre_posy=d.posy;d.pre_rot=d.rot;d.sweepTime=0;d.sweep_angvel=d.angvel%b;d.sweepIntegrate(a);if(d.disableCCD)d.sweepFrozen=!0,d.bullet=!1;else if(e=u.staticCCDLinearThreshold*d.sweepRadius,
f=u.staticCCDAngularThreshold,(d.velx*d.velx+d.vely*d.vely)*a*a>e*e||d.angvel*d.angvel*a*a>f*f||3==d.type){e=d.sweep_angvel;0>e&&(e=-e);f=1/e;for(g=d.shapes.head;null!=g;){q=g.elt;k=q.aabb;l=k.minx;n=k.miny;r=k.maxx;w=k.maxy;x=e*a*q.sweepCoef*.008333333333333333|0;8<x&&(x=8);p=e*a/x;d.sweepIntegrate(a);0==q.type?q.circle._force_validate_aabb():q.polygon._force_validate_aabb();l<k.minx?k.minx=l:l=k.minx;n<k.miny?k.miny=n:n=k.miny;r>k.maxx?k.maxx=r:r=k.maxx;w>k.maxy?k.maxy=w:w=k.maxy;for(y=1;y<x;)A=
y++,d.sweepIntegrate(p*A*f),0==q.type?q.circle._force_validate_aabb():q.polygon._force_validate_aabb(),l<k.minx?k.minx=l:l=k.minx,n<k.miny?k.miny=n:n=k.miny,r>k.maxx?k.maxx=r:r=k.maxx,w>k.maxy?k.maxy=w:w=k.maxy;this.bphase.sync(q);g=g.next}d.sweepFrozen=!1;2==d.type&&d.bulletEnabled&&(e=u.bulletCCDLinearThreshold*d.sweepRadius,f=u.bulletCCDAngularThreshold,(d.velx*d.velx+d.vely*d.vely)*a*a>e*e||d.angvel*d.angvel*a*a>f*f)&&(d.bullet=!0)}else d.sweepFrozen=!0,d.bullet=!1;c=c.next}},presteparb:function(a,
b,c){null==c&&(c=!1);var d=this;if(!a.cleared&&a.b1.component.sleeping&&a.b2.component.sleeping)return a.sleep_stamp=this.stamp,a.sleeping=!0;if(!a.cleared||0!=a.present||a.intchange){var e=!c&&a.up_stamp==this.stamp-1&&!a.cleared&&!a.intchange;c=a.fresh&&!a.cleared&&!a.intchange;e&&(a.endGenerated=this.stamp);if(c||e||a.cleared||a.intchange)for(this.inlined_MRCA_chains(a.ws1,a.ws2),e=this.mrca1.head;null!=e;){for(var f=e.elt,g=this.mrca2.head;null!=g;){var q=g.elt,k=f.cbSet,l=q.cbSet;if(!k.manager.pair(k,
l).empty_intersection()){var n=[Na.get(f,q)];c||a.intchange?(null==n[0]&&(n[0]=ec.get(f,q),this.add_callbackset(n[0])),k.manager.pair(k,l).forall(0,function(b){return function(c){if(0!=(c.itype&a.type)&&b[0].empty_arb(c.itype)){var e=d.push_callback(c);e.event=0;Na.int_callback(b[0],c,e);e.set=b[0]}}}(n)),n[0].arbiters.inlined_has(a)?q=0:(n[0].arbiters.inlined_add(a),q=!0),q&&a.present++):(a.present--,n[0].remove_arb(a),k.manager.pair(k,l).forall(1,function(b){return function(c){if(0!=(c.itype&a.type)&&
b[0].empty_arb(c.itype)){var e=d.push_callback(c);e.event=1;Na.int_callback(b[0],c,e);e.set=b[0]}}}(n)),null==n[0].arbiters.head&&this.remove_callbackset(n[0]))}g=g.next}e=e.next}a.fresh=!1;a.intchange=!1}if(a.cleared||a.up_stamp+(a.type==F.COL?u.arbiterExpirationDelay:0)<this.stamp)return a.type==F.SENSOR?a.sensorarb.retire():a.type==F.FLUID?a.fluidarb.retire():a.colarb.retire(),!0;c=a.active;a.active=a.presentable=a.up_stamp==this.stamp;0!=(a.immState&1)?a.active&&a.type!=F.SENSOR&&(null!=a.colarb?
a.colarb.preStep(b)&&(a.active=!1):a.fluidarb.preStep(this,b)):null!=a.colarb&&a.colarb.cleanupContacts()&&(a.active=!1);c!=a.active&&(a.b1.arbiters.modified=!0,a.b2.arbiters.modified=!0,this.c_arbiters_true.modified=this.c_arbiters_false.modified=!0,this.s_arbiters.modified=this.f_arbiters.modified=!0);return!1},prestep:function(a){for(var b=null,c=this.live_constraints.head;null!=c;){var d=c.elt;d.preStep(a)?(c=this.live_constraints.erase(b),d.broken(),this.constraintCbBreak(d),d.removeOnBreak?
(d.component.sleeping=!0,this.midstep=!1,null!=d.compound?d.compound.wrap_constraints.remove(d.outer):this.wrap_constraints.remove(d.outer),this.midstep=!0):d.active=!1,d.clearcache()):(b=c,c=c.next)}var b=null,c=this.c_arbiters_true,d=c.head,e=null!=this.c_arbiters_false;e&&null==d&&(e=!1,d=this.c_arbiters_false.head,c=this.c_arbiters_false,b=null);for(;null!=d;)this.presteparb(d.elt,a)?d=c.inlined_erase(b):(b=d,d=d.next),e&&null==d&&(e=!1,d=this.c_arbiters_false.head,c=this.c_arbiters_false,b=null);
b=null;c=this.f_arbiters;d=c.head;e=!1;for(;null!=d;)this.presteparb(d.elt,a)?d=c.inlined_erase(b):(b=d,d=d.next),e&&null==d&&(e=!1,b=c=null);b=null;c=this.s_arbiters;d=c.head;e=!1;for(;null!=d;)this.presteparb(d.elt,a)?d=c.inlined_erase(b):(b=d,d=d.next),e&&null==d&&(e=!1,b=c=null)},warmStart:function(){for(var a=this.f_arbiters.head;null!=a;){var b=a.elt;b.active&&0!=(b.immState&1)&&b.warmStart();a=a.next}a=this.c_arbiters_false.head;b=!0;null==a&&(a=this.c_arbiters_true.head,b=!1);for(;null!=a;){var c=
a.elt;c.active&&0!=(c.immState&1)&&c.warmStart();a=a.next;b&&null==a&&(a=this.c_arbiters_true.head,b=!1)}for(a=this.live_constraints.head;null!=a;)a.elt.warmStart(),a=a.next},iterateVel:function(a){for(var b=0;b<a;){b++;for(var c=this.f_arbiters.head;null!=c;){var d=c.elt;d.active&&0!=(d.immState&1)&&d.applyImpulseVel();c=c.next}c=null;for(d=this.live_constraints.head;null!=d;){var e=d.elt;e.applyImpulseVel()?(d=this.live_constraints.erase(c),e.broken(),this.constraintCbBreak(e),e.removeOnBreak?(e.component.sleeping=
!0,this.midstep=!1,null!=e.compound?e.compound.wrap_constraints.remove(e.outer):this.wrap_constraints.remove(e.outer),this.midstep=!0):e.active=!1,e.clearcache()):(c=d,d=d.next)}c=this.c_arbiters_false.head;d=!0;null==c&&(c=this.c_arbiters_true.head,d=!1);for(;null!=c;)e=c.elt,e.active&&0!=(e.immState&1)&&e.applyImpulseVel(),c=c.next,d&&null==c&&(c=this.c_arbiters_true.head,d=!1)}},iteratePos:function(a){for(var b=0;b<a;){b++;for(var c=null,d=this.live_constraints.head;null!=d;){var e=d.elt;!e.__velocity&&
e.stiff&&e.applyImpulsePos()?(d=this.live_constraints.erase(c),e.broken(),this.constraintCbBreak(e),e.removeOnBreak?(e.component.sleeping=!0,this.midstep=!1,null!=e.compound?e.compound.wrap_constraints.remove(e.outer):this.wrap_constraints.remove(e.outer),this.midstep=!0):e.active=!1,e.clearcache()):(c=d,d=d.next)}c=this.c_arbiters_false.head;d=!0;null==c&&(c=this.c_arbiters_true.head,d=!1);for(;null!=c;)e=c.elt,e.active&&0!=(e.immState&1)&&e.applyImpulsePos(),c=c.next,d&&null==c&&(c=this.c_arbiters_true.head,
d=!1)}},group_ignore:function(a,b){var c=a.lookup_group();if(null==c)return!1;var d=b.lookup_group();if(null==d)return!1;for(var e=!1;null!=c&&null!=d;){if(c==d){e=c.ignore;break}c.depth<d.depth?d=d.group:c=c.group}return e},interactionType:function(a,b,c,d){var e;e=!1;for(var f=c.constraints.head;null!=f;){var g=f.elt;if(g.ignore&&g.pair_exists(c.id,d.id)){e=!0;break}f=f.next}return e||this.group_ignore(a,b)?-1:(a.sensorEnabled||b.sensorEnabled)&&a.filter.shouldSense(b.filter)?2:!a.fluidEnabled&&
!b.fluidEnabled||!a.filter.shouldFlow(b.filter)||0==c.imass&&0==d.imass&&0==c.iinertia&&0==d.iinertia?!a.filter.shouldCollide(b.filter)||0==c.imass&&0==d.imass&&0==c.iinertia&&0==d.iinertia?-1:1:0},narrowPhase:function(a,b,c,d,e){var f=this,t=null,q=a.body,k=b.body,l=this.interactionType(a,b,q,k);if(-1!=l){var n,r;a.type>b.type?(n=b,r=a):a.type==b.type?a.id<b.id?(n=a,r=b):(r=a,n=b):(n=a,r=b);var u=n==b;if(0==l){var w;if(null==d){for(var p=null,y=(q.arbiters.length<k.arbiters.length?q:k).arbiters.head;null!=
y;){var A=y.elt;if(A.id==n.id&&A.di==r.id){p=A;break}y=y.next}w=p}else w=d;var E=null==w,v,F=!1;E?(null==nb.zpp_pool?v=new nb:(v=nb.zpp_pool,nb.zpp_pool=v.next,v.next=null),null):null==w.fluidarb?(w.cleared=!0,w.b1.arbiters.inlined_try_remove(w),w.b2.arbiters.inlined_try_remove(w),null!=w.pair&&(w.pair.arb=null,w.pair=null),w.active=!1,this.f_arbiters.modified=!0,null==nb.zpp_pool?v=new nb:(v=nb.zpp_pool,nb.zpp_pool=v.next,v.next=null),null,F=E=v.intchange=!0):v=w.fluidarb;if(E||v.stamp!=this.stamp||
e)if(v.stamp=this.stamp,C.flowCollide(n,r,v)){E?(v.b1=a.body,v.ws1=a,v.b2=b.body,v.ws2=b,v.id=n.id,v.di=r.id,v.b1.arbiters.inlined_add(v),v.b2.arbiters.inlined_add(v),v.active=!0,v.present=0,v.cleared=!1,v.sleeping=!1,v.fresh=!1,v.presentable=!1,v.nx=0,v.ny=1,v.dampx=0,v.dampy=0,v.adamp=0,this.f_arbiters.inlined_add(v),v.fresh=!F):v.fresh=v.up_stamp<this.stamp-1||v.endGenerated==this.stamp&&e;v.up_stamp=v.stamp;if(v.fresh||0==(v.immState&4)){v.immState=1;var B=!1;this.inlined_MRCA_chains(v.ws1.id>
v.ws2.id?v.ws2:v.ws1,v.ws1.id>v.ws2.id?v.ws1:v.ws2);for(var m=this.mrca1.head;null!=m;){for(var G=m.elt,H=this.mrca2.head;null!=H;){var N=H.elt,M=G.cbSet,P=N.cbSet;if(!M.manager.pair(M,P).empty_intersection()){var I=null,Q=null;this.prelisteners.inlined_clear();M.manager.pair(M,P).forall(5,function(a){return function(b){0!=(b.itype&4)&&(a[0]=f.prelisteners.inlined_insert(a[0],b),B=B||!b.pure)}}([null]));if(null!=this.prelisteners.head)if(I=Na.get(G,N),null==I&&(Q=ec.get(G,N),this.add_callbackset(Q)),
null==I||(I.FLUIDstamp!=this.stamp||e)&&0==(I.FLUIDstate&4)){null!=Q&&(I=Q);if(null!=I)for(var R=this.prelisteners.head;null!=R;)7==R.elt.itype&&(I.COLLISIONstamp=this.stamp,I.SENSORstamp=this.stamp),I.FLUIDstamp=this.stamp,R=R.next;v.mutable=!0;null!=v.wrap_position&&(v.wrap_position.zpp_inner._immutable=!1);var T=v.active;v.active=!0;this.precb.zpp_inner.pre_arbiter=v;this.precb.zpp_inner.set=I;for(var S=this.prelisteners.head;null!=S;){var W=S.elt;this.precb.zpp_inner.listener=W;Na.int_callback(I,
W,this.precb.zpp_inner);this.precb.zpp_inner.pre_swapped=G!=this.precb.zpp_inner.int1;var V=W.handlerp(this.precb);if(null!=V){var ca=V;null==g.PreFlag_ACCEPT&&(g.internal=!0,g.PreFlag_ACCEPT=new ja,g.internal=!1);if(ca==g.PreFlag_ACCEPT)v.immState=5;else{var da=V;null==g.PreFlag_ACCEPT_ONCE&&(g.internal=!0,g.PreFlag_ACCEPT_ONCE=new ja,g.internal=!1);if(da==g.PreFlag_ACCEPT_ONCE)v.immState=1;else{var ea=V;null==g.PreFlag_IGNORE&&(g.internal=!0,g.PreFlag_IGNORE=new ja,g.internal=!1);ea==g.PreFlag_IGNORE?
v.immState=6:v.immState=2}}}S=S.next}v.mutable=!1;null!=v.wrap_position&&(v.wrap_position.zpp_inner._immutable=!0);v.active=T;if(null!=I)for(var aa=this.prelisteners.head;null!=aa;)7==aa.elt.itype&&(I.COLLISIONstate=v.immState,I.SENSORstate=v.immState),I.FLUIDstate=v.immState,aa=aa.next}else null==I?0==(v.immState&4)&&(v.immState=1):v.immState=I.FLUIDstate}H=H.next}m=m.next}if(B&&0==(v.immState&4)){if(2==v.b1.type){var X=v.b1;X.world||(X.component.waket=this.stamp+(this.midstep?0:1),3==X.type&&(X.kinematicDelaySleep=
!0),X.component.sleeping&&this.really_wake(X,!1))}if(2==v.b1.type){var Y=v.b2;Y.world||(Y.component.waket=this.stamp+(this.midstep?0:1),3==Y.type&&(Y.kinematicDelaySleep=!0),Y.component.sleeping&&this.really_wake(Y,!1))}}}if(0!=(v.immState&1)){if(2==v.b1.type&&v.b1.component.sleeping){var Z=v.b1;Z.world||(Z.component.waket=this.stamp+(this.midstep?0:1),3==Z.type&&(Z.kinematicDelaySleep=!0),Z.component.sleeping&&this.really_wake(Z,!1))}if(2==v.b2.type&&v.b2.component.sleeping){var ba=v.b2;ba.world||
(ba.component.waket=this.stamp+(this.midstep?0:1),3==ba.type&&(ba.kinematicDelaySleep=!0),ba.component.sleeping&&this.really_wake(ba,!1))}}v.sleeping&&(v.sleeping=!1,this.f_arbiters.inlined_add(v));t=v}else if(E){var ha=v;ha.next=nb.zpp_pool;nb.zpp_pool=ha;t=null}else t=v;else t=v}else if(1==l){var fa;fa=c?this.c_arbiters_true:this.c_arbiters_false;var U;if(null==d){for(var la=null,ga=(q.arbiters.length<k.arbiters.length?q:k).arbiters.head;null!=ga;){var ka=ga.elt;if(ka.id==n.id&&ka.di==r.id){la=
ka;break}ga=ga.next}U=la}else U=d;var ia=null==U,D,pa=!1;ia?(null==dc.zpp_pool?D=new dc:(D=dc.zpp_pool,dc.zpp_pool=D.next,D.next=null),null,D.stat=c):null==U.colarb?(U.cleared=!0,U.b1.arbiters.inlined_try_remove(U),U.b2.arbiters.inlined_try_remove(U),null!=U.pair&&(U.pair.arb=null,U.pair=null),U.active=!1,this.f_arbiters.modified=!0,null==dc.zpp_pool?D=new dc:(D=dc.zpp_pool,dc.zpp_pool=D.next,D.next=null),null,D.intchange=!0,D.stat=c,pa=ia=!0):(D=U.colarb,u=n!=D.s1,D.stat!=c&&(D.stat=c,D.sleeping||
((c?this.c_arbiters_false:this.c_arbiters_true).remove(D),fa.add(D))));if(ia||D.stamp!=this.stamp||e)if(D.stamp=this.stamp,C.contactCollide(n,r,D,u)){ia?(D.b1=a.body,D.ws1=a,D.b2=b.body,D.ws2=b,D.id=n.id,D.di=r.id,D.b1.arbiters.inlined_add(D),D.b2.arbiters.inlined_add(D),D.active=!0,D.present=0,D.cleared=!1,D.sleeping=!1,D.fresh=!1,D.presentable=!1,D.s1=a,D.s2=b,D.userdef_restitution||(D.restitution=-Infinity>=D.s1.material.elasticity||-Infinity>=D.s2.material.elasticity?0:Infinity<=D.s1.material.elasticity||
Infinity<=D.s2.material.elasticity?1:(D.s1.material.elasticity+D.s2.material.elasticity)/2,0>D.restitution&&(D.restitution=0),1<D.restitution&&(D.restitution=1)),D.userdef_dyn_fric||(D.dyn_fric=Math.sqrt(D.s1.material.dynamicFriction*D.s2.material.dynamicFriction)),D.userdef_stat_fric||(D.stat_fric=Math.sqrt(D.s1.material.staticFriction*D.s2.material.staticFriction)),D.userdef_rfric||(D.rfric=Math.sqrt(D.s1.material.rollingFriction*D.s2.material.rollingFriction)),fa.inlined_add(D),D.fresh=!pa):D.fresh=
D.up_stamp<this.stamp-1||D.endGenerated==this.stamp&&e;D.up_stamp=D.stamp;if(D.fresh||0==(D.immState&4)){D.immState=1;var na=!1;this.inlined_MRCA_chains(D.ws1.id>D.ws2.id?D.ws2:D.ws1,D.ws1.id>D.ws2.id?D.ws1:D.ws2);for(var oa=this.mrca1.head;null!=oa;){for(var qa=oa.elt,ra=this.mrca2.head;null!=ra;){var va=ra.elt,ta=qa.cbSet,ya=va.cbSet;if(!ta.manager.pair(ta,ya).empty_intersection()){var sa=null,wa=null;this.prelisteners.inlined_clear();ta.manager.pair(ta,ya).forall(5,function(a){return function(b){0!=
(b.itype&1)&&(a[0]=f.prelisteners.inlined_insert(a[0],b),na=na||!b.pure)}}([null]));if(null!=this.prelisteners.head)if(sa=Na.get(qa,va),null==sa&&(wa=ec.get(qa,va),this.add_callbackset(wa)),null==sa||(sa.COLLISIONstamp!=this.stamp||e)&&0==(sa.COLLISIONstate&4)){null!=wa&&(sa=wa);if(null!=sa)for(var J=this.prelisteners.head;null!=J;)7==J.elt.itype?(sa.COLLISIONstamp=this.stamp,sa.SENSORstamp=this.stamp,sa.FLUIDstamp=this.stamp):sa.COLLISIONstamp=this.stamp,J=J.next;D.mutable=!0;null!=D.wrap_normal&&
(D.wrap_normal.zpp_inner._immutable=!1);null!=D.wrap_contacts&&(D.wrap_contacts.zpp_inner.immutable=!1);var Ba=D.active;D.active=!0;D.cleanupContacts();this.precb.zpp_inner.pre_arbiter=D;this.precb.zpp_inner.set=sa;for(var xa=this.prelisteners.head;null!=xa;){var Aa=xa.elt;this.precb.zpp_inner.listener=Aa;Na.int_callback(sa,Aa,this.precb.zpp_inner);this.precb.zpp_inner.pre_swapped=qa!=this.precb.zpp_inner.int1;var za=Aa.handlerp(this.precb);if(null!=za){var Ia=za;null==g.PreFlag_ACCEPT&&(g.internal=
!0,g.PreFlag_ACCEPT=new ja,g.internal=!1);if(Ia==g.PreFlag_ACCEPT)D.immState=5;else{var Ja=za;null==g.PreFlag_ACCEPT_ONCE&&(g.internal=!0,g.PreFlag_ACCEPT_ONCE=new ja,g.internal=!1);if(Ja==g.PreFlag_ACCEPT_ONCE)D.immState=1;else{var Ka=za;null==g.PreFlag_IGNORE&&(g.internal=!0,g.PreFlag_IGNORE=new ja,g.internal=!1);Ka==g.PreFlag_IGNORE?D.immState=6:D.immState=2}}}xa=xa.next}D.mutable=!1;null!=D.wrap_normal&&(D.wrap_normal.zpp_inner._immutable=!0);null!=D.wrap_contacts&&(D.wrap_contacts.zpp_inner.immutable=
!0);D.active=Ba;if(null!=sa)for(var Ca=this.prelisteners.head;null!=Ca;)7==Ca.elt.itype?(sa.COLLISIONstate=D.immState,sa.SENSORstate=D.immState,sa.FLUIDstate=D.immState):sa.COLLISIONstate=D.immState,Ca=Ca.next}else null==sa?0==(D.immState&4)&&(D.immState=1):D.immState=sa.COLLISIONstate}ra=ra.next}oa=oa.next}if(na&&0==(D.immState&4)){if(2==D.b1.type){var Da=D.b1;Da.world||(Da.component.waket=this.stamp+(this.midstep?0:1),3==Da.type&&(Da.kinematicDelaySleep=!0),Da.component.sleeping&&this.really_wake(Da,
!1))}if(2==D.b1.type){var Ea=D.b2;Ea.world||(Ea.component.waket=this.stamp+(this.midstep?0:1),3==Ea.type&&(Ea.kinematicDelaySleep=!0),Ea.component.sleeping&&this.really_wake(Ea,!1))}}}if(0!=(D.immState&1)){if(2==D.b1.type&&D.b1.component.sleeping){var Ga=D.b1;Ga.world||(Ga.component.waket=this.stamp+(this.midstep?0:1),3==Ga.type&&(Ga.kinematicDelaySleep=!0),Ga.component.sleeping&&this.really_wake(Ga,!1))}if(2==D.b2.type&&D.b2.component.sleeping){var Ha=D.b2;Ha.world||(Ha.component.waket=this.stamp+
(this.midstep?0:1),3==Ha.type&&(Ha.kinematicDelaySleep=!0),Ha.component.sleeping&&this.really_wake(Ha,!1))}}D.sleeping&&(D.sleeping=!1,fa.inlined_add(D));t=D}else if(ia){var Fa=D;Fa.userdef_dyn_fric=!1;Fa.userdef_stat_fric=!1;Fa.userdef_restitution=!1;Fa.userdef_rfric=!1;Fa.__ref_edge1=Fa.__ref_edge2=null;Fa.next=dc.zpp_pool;dc.zpp_pool=Fa;t=null}else t=D;else t=D}else{var ua;if(null==d){for(var Va=null,Oa=(q.arbiters.length<k.arbiters.length?q:k).arbiters.head;null!=Oa;){var Qa=Oa.elt;if(Qa.id==
n.id&&Qa.di==r.id){Va=Qa;break}Oa=Oa.next}ua=Va}else ua=d;var Ma=null==ua,L,ab=!1;Ma?(null==Db.zpp_pool?L=new Db:(L=Db.zpp_pool,Db.zpp_pool=L.next,L.next=null),null):null==ua.sensorarb?(ua.cleared=!0,ua.b1.arbiters.inlined_try_remove(ua),ua.b2.arbiters.inlined_try_remove(ua),null!=ua.pair&&(ua.pair.arb=null,ua.pair=null),ua.active=!1,this.f_arbiters.modified=!0,null==Db.zpp_pool?L=new Db:(L=Db.zpp_pool,Db.zpp_pool=L.next,L.next=null),null,ab=Ma=L.intchange=!0):L=ua.sensorarb;if(Ma||L.stamp!=this.stamp||
e)if(L.stamp=this.stamp,C.testCollide(n,r)){Ma?(L.b1=a.body,L.ws1=a,L.b2=b.body,L.ws2=b,L.id=n.id,L.di=r.id,L.b1.arbiters.inlined_add(L),L.b2.arbiters.inlined_add(L),L.active=!0,L.present=0,L.cleared=!1,L.sleeping=!1,L.fresh=!1,L.presentable=!1,this.s_arbiters.inlined_add(L),L.fresh=!ab):L.fresh=L.up_stamp<this.stamp-1||L.endGenerated==this.stamp&&e;L.up_stamp=L.stamp;if(L.fresh||0==(L.immState&4)){L.immState=1;var Ta=!1;this.inlined_MRCA_chains(L.ws1.id>L.ws2.id?L.ws2:L.ws1,L.ws1.id>L.ws2.id?L.ws1:
L.ws2);for(var Pa=this.mrca1.head;null!=Pa;){for(var Ra=Pa.elt,Sa=this.mrca2.head;null!=Sa;){var bb=Sa.elt,Ua=Ra.cbSet,fb=bb.cbSet;if(!Ua.manager.pair(Ua,fb).empty_intersection()){var ma=null,Ya=null;this.prelisteners.inlined_clear();Ua.manager.pair(Ua,fb).forall(5,function(a){return function(b){0!=(b.itype&2)&&(a[0]=f.prelisteners.inlined_insert(a[0],b),Ta=Ta||!b.pure)}}([null]));if(null!=this.prelisteners.head)if(ma=Na.get(Ra,bb),null==ma&&(Ya=ec.get(Ra,bb),this.add_callbackset(Ya)),null==ma||(ma.SENSORstamp!=
this.stamp||e)&&0==(ma.SENSORstate&4)){null!=Ya&&(ma=Ya);if(null!=ma)for(var Za=this.prelisteners.head;null!=Za;)7==Za.elt.itype?(ma.COLLISIONstamp=this.stamp,ma.SENSORstamp=this.stamp,ma.FLUIDstamp=this.stamp):ma.SENSORstamp=this.stamp,Za=Za.next;var hb=L.active;L.active=!0;this.precb.zpp_inner.pre_arbiter=L;this.precb.zpp_inner.set=ma;for(var $a=this.prelisteners.head;null!=$a;){var eb=$a.elt;this.precb.zpp_inner.listener=eb;Na.int_callback(ma,eb,this.precb.zpp_inner);this.precb.zpp_inner.pre_swapped=
Ra!=this.precb.zpp_inner.int1;var cb=eb.handlerp(this.precb);if(null!=cb){var jb=cb;null==g.PreFlag_ACCEPT&&(g.internal=!0,g.PreFlag_ACCEPT=new ja,g.internal=!1);if(jb==g.PreFlag_ACCEPT)L.immState=5;else{var kb=cb;null==g.PreFlag_ACCEPT_ONCE&&(g.internal=!0,g.PreFlag_ACCEPT_ONCE=new ja,g.internal=!1);if(kb==g.PreFlag_ACCEPT_ONCE)L.immState=1;else{var mb=cb;null==g.PreFlag_IGNORE&&(g.internal=!0,g.PreFlag_IGNORE=new ja,g.internal=!1);mb==g.PreFlag_IGNORE?L.immState=6:L.immState=2}}}$a=$a.next}L.active=
hb;if(null!=ma)for(var db=this.prelisteners.head;null!=db;)7==db.elt.itype?(ma.COLLISIONstate=L.immState,ma.SENSORstate=L.immState,ma.FLUIDstate=L.immState):ma.SENSORstate=L.immState,db=db.next}else null==ma?0==(L.immState&4)&&(L.immState=1):L.immState=ma.SENSORstate}Sa=Sa.next}Pa=Pa.next}if(Ta&&0==(L.immState&4)){if(1!=L.b1.type){var Wa=L.b1;Wa.world||(Wa.component.waket=this.stamp+(this.midstep?0:1),3==Wa.type&&(Wa.kinematicDelaySleep=!0),Wa.component.sleeping&&this.really_wake(Wa,!1))}if(1!=L.b2.type){var Xa=
L.b2;Xa.world||(Xa.component.waket=this.stamp+(this.midstep?0:1),3==Xa.type&&(Xa.kinematicDelaySleep=!0),Xa.component.sleeping&&this.really_wake(Xa,!1))}}}L.sleeping&&(L.sleeping=!1,this.s_arbiters.inlined_add(L));t=L}else if(Ma){var lb=L;lb.next=Db.zpp_pool;Db.zpp_pool=lb;t=null}else t=L;else t=L}}return t},MRCA_chains:function(a,b){this.inlined_MRCA_chains(a,b)},inlined_MRCA_chains:function(a,b){this.mrca1.inlined_clear();this.mrca2.inlined_clear();null!=a.cbSet&&this.mrca1.inlined_add(a);null!=
a.body.cbSet&&this.mrca1.inlined_add(a.body);null!=b.cbSet&&this.mrca2.inlined_add(b);null!=b.body.cbSet&&this.mrca2.inlined_add(b.body);for(var c=a.body.compound,d=b.body.compound;c!=d;)(null==c?0:c.depth)<(null==d?0:d.depth)?(null!=d.cbSet&&this.mrca2.inlined_add(d),d=d.compound):(null!=c.cbSet&&this.mrca1.inlined_add(c),c=c.compound)},__class__:qf};var kd=function(){this.next=this.prev=this.shape=this.aabb=null};kd.__name__=!0;kd.prototype={free:function(){this.aabb=this.shape=this.prev=null},
alloc:function(){},gt:function(a){return this.aabb.minx>a.aabb.minx},__class__:kd};var af=function(a){this.list=this.failed=null;Dd.call(this);this.space=a;this.is_sweep=!0;this.sweep=this};af.__name__=!0;af.__super__=Dd;af.prototype=I(Dd.prototype,{__insert:function(a){var b;null==kd.zpp_pool?b=new kd:(b=kd.zpp_pool,kd.zpp_pool=b.next,b.next=null);null;a.sweep=b;b.shape=a;b.aabb=a.aabb;b.next=this.list;null!=this.list&&(this.list.prev=b);this.list=b},__remove:function(a){var b=a.sweep;null==b.prev?
this.list=b.next:b.prev.next=b.next;null!=b.next&&(b.next.prev=b.prev);a.sweep=null;b.prev=null;b.shape=null;b.aabb=null;b.next=kd.zpp_pool;kd.zpp_pool=b},__sync:function(a){!this.space.continuous&&a.zip_aabb&&null!=a.body&&(a.zip_aabb=!1,0==a.type?a.circle.__validate_aabb():a.polygon.__validate_aabb())},sync_broadphase:function(){this.space.validation();null!=this.list&&this.sync_broadphase_fast()},sync_broadphase_fast:function(){for(var a=this.list.next;null!=a;){var b=a.next,c=a.prev;if(!(a.aabb.minx>
c.aabb.minx)){for(;null!=c.prev&&c.prev.aabb.minx>a.aabb.minx;)c=c.prev;var d=a.prev;d.next=a.next;null!=a.next&&(a.next.prev=d);null==c.prev?(a.prev=null,this.list=a,a.next=c,c.prev=a):(a.prev=c.prev,c.prev=a,a.prev.next=a,a.next=c)}a=b}},broadphase:function(a,b){if(null!=this.list){this.sync_broadphase_fast();for(var c=this.list;null!=c;){for(var d=c.next,e=c.shape,f=e.body,g=c.aabb.maxx;null!=d&&!(d.aabb.minx>g);){var q=d.shape,k=q.body;k==f||1==f.type&&1==k.type||f.component.sleeping&&k.component.sleeping||
e.aabb.intersectY(q.aabb)&&(b?a.narrowPhase(e,q,2!=f.type||2!=k.type,null,!1):a.continuousEvent(e,q,2!=f.type||2!=k.type,null,!1));d=d.next}c=c.next}}},clear:function(){for(;null!=this.list;)this.list.shape.removedFromSpace(),this.__remove(this.list.shape)},shapesUnderPoint:function(a,b,c,d){this.sync_broadphase();var e=P.get(a,b,null);d=null==d?new Ab:d;for(var f=this.list;null!=f&&f.aabb.minx>a;)f=f.next;for(;null!=f&&f.aabb.minx<=a;){if(f.aabb.maxx>=a&&f.aabb.miny<=b&&f.aabb.maxy>=b){var g=f.shape;
if(null==c||g.filter.shouldCollide(c))0==g.type?C.circleContains(g.circle,e)&&d.push(g.outer):C.polyContains(g.polygon,e)&&d.push(g.outer)}f=f.next}null!=e.outer&&(e.outer.zpp_inner=null,e.outer=null);e._isimmutable=null;e._validate=null;e._invalidate=null;e.next=P.zpp_pool;P.zpp_pool=e;return d},bodiesUnderPoint:function(a,b,c,d){this.sync_broadphase();var e=P.get(a,b,null);d=null==d?new Ka:d;for(var f=this.list;null!=f&&f.aabb.minx>a;)f=f.next;for(;null!=f&&f.aabb.minx<=a;){if(f.aabb.maxx>=a&&f.aabb.miny<=
b&&f.aabb.maxy>=b){var g=f.shape,q=g.body.outer;d.has(q)||null!=c&&!g.filter.shouldCollide(c)||(0==g.type?C.circleContains(g.circle,e)&&d.push(q):C.polyContains(g.polygon,e)&&d.push(q))}f=f.next}null!=e.outer&&(e.outer.zpp_inner=null,e.outer=null);e._isimmutable=null;e._validate=null;e._invalidate=null;e.next=P.zpp_pool;P.zpp_pool=e;return d},shapesInAABB:function(a,b,c,d,e){this.sync_broadphase();this.updateAABBShape(a);a=this.aabbShape.zpp_inner.aabb;e=null==e?new Ab:e;for(var f=this.list;null!=
f&&f.aabb.maxx<a.minx;)f=f.next;for(;null!=f&&f.aabb.minx<=a.maxx;){var g=f.shape;if(null==d||g.filter.shouldCollide(d))b?c?C.containTest(this.aabbShape.zpp_inner,g)&&e.push(g.outer):a.contains(f.aabb)?e.push(g.outer):f.aabb.intersect(a)&&C.testCollide_safe(g,this.aabbShape.zpp_inner)&&e.push(g.outer):(c?a.contains(f.aabb):f.aabb.intersect(a))&&e.push(g.outer);f=f.next}return e},bodiesInAABB:function(a,b,c,d,e){this.sync_broadphase();this.updateAABBShape(a);a=this.aabbShape.zpp_inner.aabb;e=null==
e?new Ka:e;null==this.failed&&(this.failed=new Ka);for(var f=this.list;null!=f&&f.aabb.maxx<a.minx;)f=f.next;for(;null!=f&&f.aabb.minx<=a.maxx;){var g=f.shape,q=g.body.outer;f.aabb.intersect(a)&&(null==d||g.filter.shouldCollide(d))&&(b?c?this.failed.has(q)||(g=C.containTest(this.aabbShape.zpp_inner,g),!e.has(q)&&g?e.push(q):g||(e.remove(q),this.failed.push(q))):!e.has(q)&&C.testCollide_safe(g,this.aabbShape.zpp_inner)&&e.push(q):c?this.failed.has(q)||(g=a.contains(g.aabb),!e.has(q)&&g?e.push(q):g||
(e.remove(q),this.failed.push(q))):!e.has(q)&&a.contains(g.aabb)&&e.push(q));f=f.next}this.failed.clear();return e},shapesInCircle:function(a,b,c,d,e,f){this.sync_broadphase();this.updateCircShape(a,b,c);a=this.circShape.zpp_inner.aabb;f=null==f?new Ab:f;for(b=this.list;null!=b&&b.aabb.maxx<a.minx;)b=b.next;for(;null!=b&&b.aabb.minx<=a.maxx;)b.aabb.intersect(a)&&(c=b.shape,null==e||c.filter.shouldCollide(e))&&(d?C.containTest(this.circShape.zpp_inner,c)&&f.push(c.outer):C.testCollide_safe(c,this.circShape.zpp_inner)&&
f.push(c.outer)),b=b.next;return f},bodiesInCircle:function(a,b,c,d,e,f){this.sync_broadphase();this.updateCircShape(a,b,c);a=this.circShape.zpp_inner.aabb;f=null==f?new Ka:f;null==this.failed&&(this.failed=new Ka);for(b=this.list;null!=b&&b.aabb.maxx<a.minx;)b=b.next;for(;null!=b&&b.aabb.minx<=a.maxx;){if(b.aabb.intersect(a)){var g=b.shape;c=g.body.outer;if(null==e||g.filter.shouldCollide(e))d?this.failed.has(c)||(g=C.containTest(this.circShape.zpp_inner,g),!f.has(c)&&g?f.push(c):g||(f.remove(c),
this.failed.push(c))):!f.has(c)&&C.testCollide_safe(g,this.circShape.zpp_inner)&&f.push(c)}b=b.next}this.failed.clear();return f},shapesInShape:function(a,b,c,d){this.sync_broadphase();this.validateShape(a);var e=a.aabb;d=null==d?new Ab:d;for(var f=this.list;null!=f&&f.aabb.maxx<e.minx;)f=f.next;for(;null!=f&&f.aabb.minx<=e.maxx;){if(f.aabb.intersect(e)){var g=f.shape;if(null==c||g.filter.shouldCollide(c))b?C.containTest(a,g)&&d.push(g.outer):C.testCollide_safe(g,a)&&d.push(g.outer)}f=f.next}return d},
bodiesInShape:function(a,b,c,d){this.sync_broadphase();this.validateShape(a);var e=a.aabb;d=null==d?new Ka:d;null==this.failed&&(this.failed=new Ka);for(var f=this.list;null!=f&&f.aabb.maxx<e.minx;)f=f.next;for(;null!=f&&f.aabb.minx<=e.maxx;){if(f.aabb.intersect(e)){var g=f.shape,q=g.body.outer;if(null==c||g.filter.shouldCollide(c))b?this.failed.has(q)||(g=C.containTest(a,g),!d.has(q)&&g?d.push(q):g||(d.remove(q),this.failed.push(q))):!d.has(q)&&C.testCollide_safe(a,g)&&d.push(q)}f=f.next}this.failed.clear();
return d},rayCast:function(a,b,c){this.sync_broadphase();a.validate_dir();var d=a.rayAABB(),e=a.maxdist,h=null;if(0==a.dirx)for(var g=this.list;null!=g&&g.aabb.minx<=d.minx;){if(g.aabb.intersect(d)&&(null==c||g.shape.filter.shouldCollide(c))){var q=a.aabbsect(g.aabb);if(0<=q&&q<e&&(q=0==g.shape.type?a.circlesect(g.shape.circle,b,e):a.polysect(g.shape.polygon,b,e),null!=q)){if(null!=q.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");e=q.zpp_inner.toiDistance;
if(null!=h){if(null!=h.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");h.zpp_inner.free()}h=q}}g=g.next}else if(0>a.dirx){g=this.list;for(q=null;null!=g&&g.aabb.minx<=d.maxx;)q=g,g=g.next;for(g=q;null!=g;){if(g.aabb.intersect(d)&&(null==c||g.shape.filter.shouldCollide(c))&&(q=a.aabbsect(g.aabb),0<=q&&q<e&&(q=0==g.shape.type?a.circlesect(g.shape.circle,b,e):a.polysect(g.shape.polygon,b,e),null!=q))){if(null!=q.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");
e=q.zpp_inner.toiDistance;if(null!=h){if(null!=h.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");h.zpp_inner.free()}h=q}g=g.prev}}else for(g=this.list;null!=g&&g.aabb.minx<=d.maxx&&g.aabb.minx<a.originx+a.dirx*e;){if(g.aabb.intersect(d)&&(null==c||g.shape.filter.shouldCollide(c))&&(q=a.aabbsect(g.aabb),0<=q&&q<e&&(q=0==g.shape.type?a.circlesect(g.shape.circle,b,e):a.polysect(g.shape.polygon,b,e),null!=q))){if(null!=q.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");
e=q.zpp_inner.toiDistance;if(null!=h){if(null!=h.zpp_inner.next)throw new f("Error: This object has been disposed of and cannot be used");h.zpp_inner.free()}h=q}g=g.next}null!=d.outer&&(d.outer.zpp_inner=null,d.outer=null);d.wrap_min=d.wrap_max=null;d._invalidate=null;d._validate=null;d.next=X.zpp_pool;X.zpp_pool=d;return h},rayMultiCast:function(a,b,c,d){this.sync_broadphase();a.validate_dir();var e=a.rayAABB();d=null==d?new bd:d;if(0==a.dirx)for(var f=this.list;null!=f&&f.aabb.minx<=e.minx;)f.aabb.intersect(e)&&
(null==c||f.shape.filter.shouldCollide(c))&&0<=a.aabbsect(f.aabb)&&(0==f.shape.type?a.circlesect2(f.shape.circle,b,d):a.polysect2(f.shape.polygon,b,d)),f=f.next;else if(0>a.dirx){for(var f=this.list,g=null;null!=f&&f.aabb.minx<=e.maxx;)g=f,f=f.next;for(f=g;null!=f;)f.aabb.intersect(e)&&(null==c||f.shape.filter.shouldCollide(c))&&0<=a.aabbsect(f.aabb)&&(0==f.shape.type?a.circlesect2(f.shape.circle,b,d):a.polysect2(f.shape.polygon,b,d)),f=f.prev}else for(f=this.list;null!=f&&f.aabb.minx<=e.maxx;)f.aabb.intersect(e)&&
(null==c||f.shape.filter.shouldCollide(c))&&0<=a.aabbsect(f.aabb)&&(0==f.shape.type?a.circlesect2(f.shape.circle,b,d):a.polysect2(f.shape.polygon,b,d)),f=f.next;null!=e.outer&&(e.outer.zpp_inner=null,e.outer=null);e.wrap_min=e.wrap_max=null;e._invalidate=null;e._validate=null;e.next=X.zpp_pool;X.zpp_pool=e;return d},__class__:af});var Af=function(a,b){this.width=0;this.list=null;this.width=a;this.list=[]};Af.__name__=!0;Af.prototype={resize:function(a,b,c){this.width=a;var d=0;for(a*=b;d<a;)b=d++,
this.list[b]=c},get:function(a,b){return this.list[b*this.width+a]},set:function(a,b,c){return this.list[b*this.width+a]=c},__class__:Af};var Bf=function(a,b){this.width=0;this.list=null;this.width=a;this.list=[]};Bf.__name__=!0;Bf.prototype={resize:function(a,b,c){this.width=a;var d=0;for(a*=b;d<a;)b=d++,this.list[b]=c},get:function(a,b){return this.list[b*this.width+a]},set:function(a,b,c){return this.list[b*this.width+a]=c},__class__:Bf};var zf=function(a,b){this.width=0;this.list=null;this.width=
a;this.list=[]};zf.__name__=!0;zf.prototype={resize:function(a,b,c){this.width=a;var d=0;for(a*=b;d<a;)b=d++,this.list[b]=c},get:function(a,b){return this.list[b*this.width+a]},set:function(a,b,c){return this.list[b*this.width+a]=c},__class__:zf};var ya=function(){this.id=this.di=0;this.next=this.hnext=null;this.value=!1};ya.__name__=!0;ya.get=function(a,b,c){a=ya.getpersist(a,b);a.value=c;return a};ya.getpersist=function(a,b){var c;null==ya.zpp_pool?c=new ya:(c=ya.zpp_pool,ya.zpp_pool=c.next,c.next=
null);null;c.id=a;c.di=b;return c};ya.ordered_get=function(a,b,c){return a<=b?ya.get(a,b,c):ya.get(b,a,c)};ya.ordered_get_persist=function(a,b){return a<=b?ya.getpersist(a,b):ya.getpersist(b,a)};ya.prototype={free:function(){},alloc:function(){},__class__:ya};var Ze=function(){this.cnt=0;this.table=null;this.cnt=0;this.table=[];for(var a=0;1048576>a;)a++,this.table.push(null)};Ze.__name__=!0;Ze.prototype={empty:function(){return 0==this.cnt},clear:function(){for(var a=0,b=this.table.length;a<b;){var c=
a++,d=this.table[c];if(null!=d){for(;null!=d;){var e=d.hnext;d.hnext=null;d;d=e}this.table[c]=null}}},get:function(a,b){var c=this.table[106039*a+b&1048575];if(null==c)return null;if(c.id!=a||c.di!=b){do c=c.hnext;while(null!=c&&(c.id!=a||c.di!=b))}return c},ordered_get:function(a,b){if(a>b){var c=a;a=b;b=c}return this.get(a,b)},has:function(a,b){var c=this.table[106039*a+b&1048575];if(null==c)return!1;if(c.id==a&&c.di==b)return!0;do c=c.hnext;while(null!=c&&(c.id!=a||c.di!=b));return null!=c},maybeAdd:function(a){var b=
106039*a.id+a.di&1048575,c=this.table[b];null==c?(this.table[b]=a,a.hnext=null):(a.hnext=c.hnext,c.hnext=a);this.cnt++},add:function(a){var b=106039*a.id+a.di&1048575,c=this.table[b];null==c?(this.table[b]=a,a.hnext=null):(a.hnext=c.hnext,c.hnext=a);this.cnt++},remove:function(a){var b=106039*a.id+a.di&1048575,c=this.table[b];if(c==a)this.table[b]=c.hnext;else if(null!=c){do b=c,c=c.hnext;while(null!=c&&c!=a);b.hnext=c.hnext}a.hnext=null;this.cnt--},hash:function(a,b){return 106039*a+b&1048575},__class__:Ze};
var Ff=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Ff.__name__=!0;Ff.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==vc.zpp_pool?b=new vc:(b=vc.zpp_pool,vc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},
insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==vc.zpp_pool?c=new vc:(c=vc.zpp_pool,vc.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=vc.zpp_pool;vc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},
inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,
c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=vc.zpp_pool;vc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=
this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=
b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:Ff};var ua=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};ua.__name__=!0;ua.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Ma.zpp_pool?b=new Ma:(b=Ma.zpp_pool,Ma.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=
!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Ma.zpp_pool?c=new Ma:(c=Ma.zpp_pool,Ma.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Ma.zpp_pool;
Ma.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=
c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Ma.zpp_pool;Ma.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();
this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=
this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:ua};var Wc=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Wc.__name__=!0;Wc.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==ma.zpp_pool?
b=new ma:(b=ma.zpp_pool,ma.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==ma.zpp_pool?c=new ma:(c=ma.zpp_pool,ma.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},
inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=ma.zpp_pool;ma.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},
inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=ma.zpp_pool;ma.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);
return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=
!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:Wc};var Pd=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Pd.__name__=!0;Pd.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=
!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Hb.zpp_pool?b=new Hb:(b=Hb.zpp_pool,Hb.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Hb.zpp_pool?c=new Hb:(c=Hb.zpp_pool,Hb.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,
this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Hb.zpp_pool;Hb.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=
null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));
a=b;a.elt=null;a.next=Hb.zpp_pool;Hb.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},
size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:Pd};var Od=function(){this.length=0;this.modified=
this.pushmod=!1;this.head=null};Od.__name__=!0;Od.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Xa.zpp_pool?b=new Xa:(b=Xa.zpp_pool,Xa.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,
b)},inlined_insert:function(a,b){var c;null==Xa.zpp_pool?c=new Xa:(c=Xa.zpp_pool,Xa.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Xa.zpp_pool;Xa.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},
inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,
c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Xa.zpp_pool;Xa.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=
this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=
b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:Od};var sf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};sf.__name__=!0;sf.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==kb.zpp_pool?b=new kb:(b=kb.zpp_pool,kb.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=
!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==kb.zpp_pool?c=new kb:(c=kb.zpp_pool,kb.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=kb.zpp_pool;
kb.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=
c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=kb.zpp_pool;kb.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();
this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=
this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:sf};var xf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};xf.__name__=!0;xf.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Ob.zpp_pool?
b=new Ob:(b=Ob.zpp_pool,Ob.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Ob.zpp_pool?c=new Ob:(c=Ob.zpp_pool,Ob.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},
inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Ob.zpp_pool;Ob.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},
inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Ob.zpp_pool;Ob.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);
return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=
!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:xf};var yf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};yf.__name__=!0;yf.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=
!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Ub.zpp_pool?b=new Ub:(b=Ub.zpp_pool,Ub.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Ub.zpp_pool?c=new Ub:(c=Ub.zpp_pool,Ub.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,
this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Ub.zpp_pool;Ub.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=
null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));
a=b;a.elt=null;a.next=Ub.zpp_pool;Ub.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},
size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:yf};var Cd=function(){this.length=0;this.modified=
this.pushmod=!1;this.head=null};Cd.__name__=!0;Cd.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Fc.zpp_pool?b=new Fc:(b=Fc.zpp_pool,Fc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,
b)},inlined_insert:function(a,b){var c;null==Fc.zpp_pool?c=new Fc:(c=Fc.zpp_pool,Fc.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Fc.zpp_pool;Fc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},
inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,
c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Fc.zpp_pool;Fc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=
this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=
b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:Cd};var Ef=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Ef.__name__=!0;Ef.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==bc.zpp_pool?b=new bc:(b=bc.zpp_pool,bc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=
!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==bc.zpp_pool?c=new bc:(c=bc.zpp_pool,bc.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=bc.zpp_pool;
bc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=
c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=bc.zpp_pool;bc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();
this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=
this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:Ef};var vd=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};vd.__name__=!0;vd.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Lc.zpp_pool?
b=new Lc:(b=Lc.zpp_pool,Lc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Lc.zpp_pool?c=new Lc:(c=Lc.zpp_pool,Lc.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},
inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Lc.zpp_pool;Lc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},
inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Lc.zpp_pool;Lc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);
return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=
!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:vd};var ud=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};ud.__name__=!0;ud.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=
!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Pb.zpp_pool?b=new Pb:(b=Pb.zpp_pool,Pb.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Pb.zpp_pool?c=new Pb:(c=Pb.zpp_pool,Pb.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,
this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Pb.zpp_pool;Pb.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=
null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));
a=b;a.elt=null;a.next=Pb.zpp_pool;Pb.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},
size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:ud};var Cf=function(){this.length=0;this.modified=
this.pushmod=!1;this.head=null};Cf.__name__=!0;Cf.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==wc.zpp_pool?b=new wc:(b=wc.zpp_pool,wc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,
b)},inlined_insert:function(a,b){var c;null==wc.zpp_pool?c=new wc:(c=wc.zpp_pool,wc.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=wc.zpp_pool;wc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},
inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,
c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=wc.zpp_pool;wc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=
this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=
b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:Cf};var Df=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Df.__name__=!0;Df.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Gc.zpp_pool?b=new Gc:(b=Gc.zpp_pool,Gc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=
!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Gc.zpp_pool?c=new Gc:(c=Gc.zpp_pool,Gc.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Gc.zpp_pool;
Gc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=
c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Gc.zpp_pool;Gc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();
this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=
this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:Df};var Gf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Gf.__name__=!0;Gf.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==xc.zpp_pool?
b=new xc:(b=xc.zpp_pool,xc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==xc.zpp_pool?c=new xc:(c=xc.zpp_pool,xc.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},
inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=xc.zpp_pool;xc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},
inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=xc.zpp_pool;xc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);
return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=
!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:Gf};var $e=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};$e.__name__=!0;$e.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=
!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==lb.zpp_pool?b=new lb:(b=lb.zpp_pool,lb.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==lb.zpp_pool?c=new lb:(c=lb.zpp_pool,lb.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,
this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=lb.zpp_pool;lb.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=
null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));
a=b;a.elt=null;a.next=lb.zpp_pool;lb.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},
size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:$e};var Qa=function(){this.length=0;this.modified=
this.pushmod=!1;this.head=null};Qa.__name__=!0;Qa.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==tb.zpp_pool?b=new tb:(b=tb.zpp_pool,tb.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,
b)},inlined_insert:function(a,b){var c;null==tb.zpp_pool?c=new tb:(c=tb.zpp_pool,tb.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=tb.zpp_pool;tb.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},
inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,
c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=tb.zpp_pool;tb.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=
this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=
b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:Qa};var Hf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Hf.__name__=!0;Hf.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Ya.zpp_pool?b=new Ya:(b=Ya.zpp_pool,Ya.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=
!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Ya.zpp_pool?c=new Ya:(c=Ya.zpp_pool,Ya.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Ya.zpp_pool;
Ya.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=
c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Ya.zpp_pool;Ya.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();
this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=
this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:Hf};var Kf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Kf.__name__=!0;Kf.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Ib.zpp_pool?
b=new Ib:(b=Ib.zpp_pool,Ib.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Ib.zpp_pool?c=new Ib:(c=Ib.zpp_pool,Ib.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},
inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Ib.zpp_pool;Ib.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},
inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Ib.zpp_pool;Ib.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);
return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=
!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:Kf};var Lf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Lf.__name__=!0;Lf.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=
!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Jb.zpp_pool?b=new Jb:(b=Jb.zpp_pool,Jb.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Jb.zpp_pool?c=new Jb:(c=Jb.zpp_pool,Jb.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,
this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Jb.zpp_pool;Jb.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=
null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));
a=b;a.elt=null;a.next=Jb.zpp_pool;Jb.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},
size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:Lf};var cf=function(){this.length=0;this.modified=
this.pushmod=!1;this.head=null};cf.__name__=!0;cf.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Kb.zpp_pool?b=new Kb:(b=Kb.zpp_pool,Kb.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,
b)},inlined_insert:function(a,b){var c;null==Kb.zpp_pool?c=new Kb:(c=Kb.zpp_pool,Kb.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Kb.zpp_pool;Kb.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},
inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,
c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Kb.zpp_pool;Kb.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=
this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=
b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:cf};var bf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};bf.__name__=!0;bf.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Mc.zpp_pool?b=new Mc:(b=Mc.zpp_pool,Mc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=
!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Mc.zpp_pool?c=new Mc:(c=Mc.zpp_pool,Mc.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Mc.zpp_pool;
Mc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=
c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=Mc.zpp_pool;Mc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();
this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=
this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:bf};var Jf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Jf.__name__=!0;Jf.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==yc.zpp_pool?
b=new yc:(b=yc.zpp_pool,yc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==yc.zpp_pool?c=new yc:(c=yc.zpp_pool,yc.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},
inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=yc.zpp_pool;yc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},
inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=yc.zpp_pool;yc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);
return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=
!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:Jf};var Mf=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Mf.__name__=!0;Mf.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=
!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==Nc.zpp_pool?b=new Nc:(b=Nc.zpp_pool,Nc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==Nc.zpp_pool?c=new Nc:(c=Nc.zpp_pool,Nc.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,
this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=Nc.zpp_pool;Nc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=
null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));
a=b;a.elt=null;a.next=Nc.zpp_pool;Nc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},
size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:Mf};var Nf=function(){this.length=0;this.modified=
this.pushmod=!1;this.head=null};Nf.__name__=!0;Nf.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==zc.zpp_pool?b=new zc:(b=zc.zpp_pool,zc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,
b)},inlined_insert:function(a,b){var c;null==zc.zpp_pool?c=new zc:(c=zc.zpp_pool,zc.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=zc.zpp_pool;zc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},
inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,
c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=zc.zpp_pool;zc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=
this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=
b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:Nf};var Of=function(){this.length=0;this.modified=this.pushmod=!1;this.head=null};Of.__name__=!0;Of.prototype={begin:function(){return this.head},setbegin:function(a){this.head=a;this.pushmod=this.modified=!0},add:function(a){return this.inlined_add(a)},inlined_add:function(a){var b;null==lc.zpp_pool?b=new lc:(b=lc.zpp_pool,lc.zpp_pool=b.next,b.next=null);null;b.elt=a;b.next=this.head;this.head=b;this.modified=
!0;this.length++;return a},addAll:function(a){for(a=a.head;null!=a;)this.add(a.elt),a=a.next},insert:function(a,b){return this.inlined_insert(a,b)},inlined_insert:function(a,b){var c;null==lc.zpp_pool?c=new lc:(c=lc.zpp_pool,lc.zpp_pool=c.next,c.next=null);null;c.elt=b;null==a?(c.next=this.head,this.head=c):(c.next=a.next,a.next=c);this.pushmod=this.modified=!0;this.length++;return c},pop:function(){this.inlined_pop()},inlined_pop:function(){var a=this.head;this.head=a.next;a.elt=null;a.next=lc.zpp_pool;
lc.zpp_pool=a;null==this.head&&(this.pushmod=!0);this.modified=!0;this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var a=this.head.elt;this.pop();return a},remove:function(a){this.inlined_try_remove(a)},try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=c;){if(c.elt==a){this.erase(b);d=!0;break}b=c;c=c.next}return d},inlined_remove:function(a){this.inlined_try_remove(a)},inlined_try_remove:function(a){for(var b=null,c=this.head,d=!1;null!=
c;){if(c.elt==a){this.inlined_erase(b);d=!0;break}b=c;c=c.next}return d},erase:function(a){return this.inlined_erase(a)},inlined_erase:function(a){var b,c;null==a?(b=this.head,this.head=c=b.next,null==this.head&&(this.pushmod=!0)):(b=a.next,c=b.next,a.next=c,null==c&&(this.pushmod=!0));a=b;a.elt=null;a.next=lc.zpp_pool;lc.zpp_pool=a;this.modified=!0;this.length--;this.pushmod=!0;return c},splice:function(a,b){for(;0<b--&&null!=a.next;)this.erase(a);return a.next},clear:function(){for(;null!=this.head;)this.inlined_pop();
this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var a=this.head,b=null;null!=a;){var c=a.next;a.next=b;b=this.head=a;a=c}this.pushmod=this.modified=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(a){return this.inlined_has(a)},inlined_has:function(a){var b;b=!1;for(var c=this.head;null!=c;){if(c.elt==a){b=!0;break}c=c.next}return b},front:function(){return this.head.elt},back:function(){for(var a=
this.head,b=a;null!=b;)a=b,b=b.next;return a.elt},iterator_at:function(a){for(var b=this.head;0<a--&&null!=b;)b=b.next;return b},at:function(a){a=this.iterator_at(a);return null!=a?a.elt:null},__class__:Of};var sc=function(){this.next=this.elt=null};sc.__name__=!0;sc.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:sc};var vc=function(){this.next=this.elt=null};vc.__name__=!0;vc.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},
__class__:vc};var Ma=function(){this.next=this.elt=null};Ma.__name__=!0;Ma.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:Ma};var ma=function(){this.next=this.elt=null};ma.__name__=!0;ma.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:ma};var Bb=function(){this.next=this.elt=null};Bb.__name__=!0;Bb.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},
__class__:Bb};var Hb=function(){this.next=this.elt=null};Hb.__name__=!0;Hb.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:Hb};var Xa=function(){this.next=this.elt=null};Xa.__name__=!0;Xa.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:Xa};var rc=function(){this.next=this.elt=null};rc.__name__=!0;rc.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},
__class__:rc};var ic=function(){this.next=this.elt=null};ic.__name__=!0;ic.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:ic};var Cb=function(){this.next=this.elt=null};Cb.__name__=!0;Cb.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:Cb};var cc=function(){this.next=this.elt=null};cc.__name__=!0;cc.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},
__class__:cc};var kb=function(){this.next=this.elt=null};kb.__name__=!0;kb.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:kb};var hc=function(){this.next=this.elt=null};hc.__name__=!0;hc.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:hc};var Ob=function(){this.next=this.elt=null};Ob.__name__=!0;Ob.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},
__class__:Ob};var Ub=function(){this.next=this.elt=null};Ub.__name__=!0;Ub.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:Ub};var Fc=function(){this.next=this.elt=null};Fc.__name__=!0;Fc.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:Fc};var bc=function(){this.next=this.elt=null};bc.__name__=!0;bc.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},
__class__:bc};var Lc=function(){this.next=this.elt=null};Lc.__name__=!0;Lc.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:Lc};var Pb=function(){this.next=this.elt=null};Pb.__name__=!0;Pb.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:Pb};var wc=function(){this.next=this.elt=null};wc.__name__=!0;wc.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},
__class__:wc};var Gc=function(){this.next=this.elt=null};Gc.__name__=!0;Gc.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:Gc};var Va=function(){this.next=this.elt=null};Va.__name__=!0;Va.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:Va};var xc=function(){this.next=this.elt=null};xc.__name__=!0;xc.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},
__class__:xc};var lb=function(){this.next=this.elt=null};lb.__name__=!0;lb.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:lb};var tb=function(){this.next=this.elt=null};tb.__name__=!0;tb.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:tb};var Ya=function(){this.next=this.elt=null};Ya.__name__=!0;Ya.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},
__class__:Ya};var Ib=function(){this.next=this.elt=null};Ib.__name__=!0;Ib.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:Ib};var Jb=function(){this.next=this.elt=null};Jb.__name__=!0;Jb.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:Jb};var Kb=function(){this.next=this.elt=null};Kb.__name__=!0;Kb.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},
__class__:Kb};var Mc=function(){this.next=this.elt=null};Mc.__name__=!0;Mc.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:Mc};var yc=function(){this.next=this.elt=null};yc.__name__=!0;yc.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:yc};var Nc=function(){this.next=this.elt=null};Nc.__name__=!0;Nc.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},
__class__:Nc};var zc=function(){this.next=this.elt=null};zc.__name__=!0;zc.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:zc};var lc=function(){this.next=this.elt=null};lc.__name__=!0;lc.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:lc};var de=function(){this.at_index=0;this.at_ite=null;this.zip_length=!1;this._length=0;this.inner=null;Ac.call(this);this.at_ite=null;this.at_index=0;this.zip_length=
!0;this._length=0};de.__name__=!0;de.get=function(a,b){null==b&&(b=!1);var c=new de;c.inner=a;c.zpp_inner.immutable=b;return c};de.__super__=Ac;de.prototype=I(Ac.prototype,{zpp_gl:function(){this.zpp_vm();if(this.zip_length){this._length=0;for(var a=this.inner.next;null!=a;)this._length++,a=a.next;this.zip_length=!1}return this._length},zpp_vm:function(){this.zpp_inner.validate();this.inner.modified&&(this.zip_length=!0,this._length=0,this.at_ite=null)},at:function(a){this.zpp_vm();if(0>a||a>=this.zpp_gl())throw new f("Error: Index out of bounds");
this.zpp_inner.reverse_flag&&(a=this.zpp_gl()-1-a);if(a<this.at_index||null==this.at_ite)for(this.at_index=0,this.at_ite=this.inner.next;;)break;for(;this.at_index!=a;)for(this.at_index++,this.at_ite=this.at_ite.next;;)break;return this.at_ite.wrapper()},push:function(a){if(this.zpp_inner.immutable)throw new f("Error: Vec2List is immutable");this.zpp_inner.modify_test();this.zpp_vm();if(a.zpp_inner._inuse)throw new f("Error: Vec2 is already in use");var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):
!0){if(this.zpp_inner.reverse_flag)this.inner.add(a.zpp_inner);else{var c=this.inner.iterator_at(this.zpp_gl()-1);this.inner.insert(c,a.zpp_inner)}this.zpp_inner.invalidate();null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a)}return b},unshift:function(a){if(this.zpp_inner.immutable)throw new f("Error: Vec2List is immutable");this.zpp_inner.modify_test();this.zpp_vm();if(a.zpp_inner._inuse)throw new f("Error: Vec2 is already in use");var b;if(b=null!=this.zpp_inner.adder?this.zpp_inner.adder(a):
!0){if(this.zpp_inner.reverse_flag){var c=this.inner.iterator_at(this.zpp_gl()-1);this.inner.insert(c,a.zpp_inner)}else this.inner.add(a.zpp_inner);this.zpp_inner.invalidate();null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(a)}return b},pop:function(){if(this.zpp_inner.immutable)throw new f("Error: Vec2List is immutable");this.zpp_inner.modify_test();if(this.empty())throw new f("Error: Cannot remove from empty list");this.zpp_vm();var a=null;if(this.zpp_inner.reverse_flag){var a=this.inner.next,
b=a.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(b);this.zpp_inner.dontremove||this.inner.pop()}else{null!=this.at_ite&&null==this.at_ite.next&&(this.at_ite=null);var b=1==this.zpp_gl()?null:this.inner.iterator_at(this.zpp_gl()-2),a=null==b?this.inner.next:b.next,c=a.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(c);this.zpp_inner.dontremove||this.inner.erase(b)}this.zpp_inner.invalidate();return a.wrapper()},shift:function(){if(this.zpp_inner.immutable)throw new f("Error: Vec2List is immutable");
this.zpp_inner.modify_test();if(this.empty())throw new f("Error: Cannot remove from empty list");this.zpp_vm();var a=null;if(this.zpp_inner.reverse_flag){null!=this.at_ite&&null==this.at_ite.next&&(this.at_ite=null);var b;b=1==this.zpp_gl()?null:this.inner.iterator_at(this.zpp_gl()-2);var a=null==b?this.inner.next:b.next,c=a.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(c);this.zpp_inner.dontremove||this.inner.erase(b)}else a=this.inner.next,b=a.wrapper(),null!=this.zpp_inner.subber&&
this.zpp_inner.subber(b),this.zpp_inner.dontremove||this.inner.pop();this.zpp_inner.invalidate();return a.wrapper()},remove:function(a){if(this.zpp_inner.immutable)throw new f("Error: Vec2List is immutable");this.zpp_inner.modify_test();this.zpp_vm();var b;b=!1;for(var c=this.inner.next;null!=c;){if(a.zpp_inner==c){b=!0;break}c=c.next}b&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(a),this.zpp_inner.dontremove||this.inner.remove(a.zpp_inner),this.zpp_inner.invalidate());return b},clear:function(){if(this.zpp_inner.immutable)throw new f("Error: Vec2List is immutable");
if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},__class__:de});var mb=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this._modifiable=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new md;this._invalidated=!0};mb.__name__=!0;mb.get=function(a,b){null==b&&(b=!1);
var c=new Td;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};mb.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0;this.push_ite=this.at_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&
this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:mb};var pc=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this._modifiable=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new Wc;this._invalidated=!0};pc.__name__=!0;pc.get=function(a,b){null==
b&&(b=!1);var c=new Ka;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};pc.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0;this.push_ite=this.at_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=!1,
null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:pc};var od=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this._modifiable=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new Xb;this._invalidated=!0};od.__name__=!0;od.get=
function(a,b){null==b&&(b=!1);var c=new Wd;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};od.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0;this.push_ite=this.at_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=
!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:od};var Jc=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this._modifiable=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new Pd;this._invalidated=!0};Jc.__name__=!0;Jc.get=
function(a,b){null==b&&(b=!1);var c=new Vd;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};Jc.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0;this.push_ite=this.at_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=
!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:Jc};var qd=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this._modifiable=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new cf;this._invalidated=!0};qd.__name__=!0;qd.get=
function(a,b){null==b&&(b=!1);var c=new Sd;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};qd.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0;this.push_ite=this.at_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=
!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:qd};var Vb=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this._modifiable=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new Uc;this._invalidated=!0};Vb.__name__=!0;Vb.get=
function(a,b){null==b&&(b=!1);var c=new pd;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};Vb.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0;this.push_ite=this.at_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=
!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:Vb};var yd=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this._modifiable=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new ie;this._invalidated=!0};yd.__name__=!0;yd.get=
function(a,b){null==b&&(b=!1);var c=new Ac;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};yd.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0;this.push_ite=this.at_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=
!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:yd};var $c=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this._modifiable=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new Nf;this._invalidated=!0};$c.__name__=!0;$c.get=
function(a,b){null==b&&(b=!1);var c=new Rc;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};$c.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0;this.push_ite=this.at_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=
!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:$c};var gd=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this._modifiable=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new Of;this._invalidated=!0};gd.__name__=!0;gd.get=
function(a,b){null==b&&(b=!1);var c=new bd;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};gd.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0;this.push_ite=this.at_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=
!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:gd};var oc=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this._modifiable=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new Mf;this._invalidated=!0};oc.__name__=!0;oc.get=
function(a,b){null==b&&(b=!1);var c=new Kd;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};oc.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0;this.push_ite=this.at_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=
!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:oc};var hd=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this._modifiable=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new $e;this._invalidated=!0};hd.__name__=!0;hd.get=
function(a,b){null==b&&(b=!1);var c=new Xd;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};hd.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0;this.push_ite=this.at_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=
!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:hd};var Zc=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this._modifiable=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new ua;this._invalidated=!0};Zc.__name__=!0;Zc.get=
function(a,b){null==b&&(b=!1);var c=new Ab;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};Zc.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0;this.push_ite=this.at_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=
!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:Zc};var qb=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this._modifiable=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new Od;this._invalidated=!0};qb.__name__=!0;qb.get=
function(a,b){null==b&&(b=!1);var c=new sd;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};qb.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0;this.push_ite=this.at_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=
!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:qb};var td=function(){this.user_length=0;this.zip_length=!1;this.at_ite=this.push_ite=null;this.at_index=0;this.dontremove=this.reverse_flag=!1;this._invalidate=this._validate=this._modifiable=this.adder=this.post_adder=this.subber=null;this.immutable=this._invalidated=!1;this.outer=this.inner=null;this.inner=new Ia;this._invalidated=!0};td.__name__=!0;td.get=
function(a,b){null==b&&(b=!1);var c=new xd;c.zpp_inner.inner=a;b&&(c.zpp_inner.immutable=!0);c.zpp_inner.zip_length=!0;return c};td.prototype={valmod:function(){this.validate();this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0;this.push_ite=this.at_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=
!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0;null!=this._invalidate&&this._invalidate(this)},__class__:td};var Bc=function(){};Bc.__name__=!0;Bc.sqrt=function(a){return Math.sqrt(a)};Bc.invsqrt=function(a){return 1/Math.sqrt(a)};Bc.sqr=function(a){return a*a};Bc.clamp2=function(a,b){return Bc.clamp(a,-b,b)};Bc.clamp=function(a,b,c){return a<b?b:a>c?c:a};var ga=function(){};ga.__name__=!0;var pa=function(){this.colour=0;this.lt=this.swapped=this.data=this.prev=
this.next=this.parent=null};pa.__name__=!0;pa.prototype={free:function(){this.swapped=this.lt=this.data=null},alloc:function(){},verify:function(){if(!this.empty()){for(var a=this.parent;null!=a.prev;)a=a.prev;for(;null!=a;){var b=a.data,c=!0;if(!this.empty()){for(var d=this.parent;null!=d.prev;)d=d.prev;for(;null!=d;){var e=d.data;if(!c){if(!this.lt(b,e)&&this.lt(e,b))return!1}else if(b==e)c=!1;else if(!this.lt(e,b)&&this.lt(b,e))return!1;if(null!=d.next)for(d=d.next;null!=d.prev;)d=d.prev;else{for(;null!=
d.parent&&d==d.parent.next;)d=d.parent;d=d.parent}}}if(null!=a.next)for(a=a.next;null!=a.prev;)a=a.prev;else{for(;null!=a.parent&&a==a.parent.next;)a=a.parent;a=a.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var a=0;if(!this.empty()){for(var b=this.parent;null!=b.prev;)b=b.prev;for(;null!=b;)if(a++,null!=b.next)for(b=b.next;null!=b.prev;)b=b.prev;else{for(;null!=b.parent&&
b==b.parent.next;)b=b.parent;b=b.parent}}return a},has:function(a){return null!=this.find(a)},find:function(a){for(var b=this.parent;null!=b&&b.data!=a;)b=this.lt(a,b.data)?b.prev:b.next;return b},has_weak:function(a){return null!=this.find_weak(a)},find_weak:function(a){for(var b=this.parent;null!=b;)if(this.lt(a,b.data))b=b.prev;else if(this.lt(b.data,a))b=b.next;else break;return b},lower_bound:function(a){var b=null;if(!this.empty()){for(var c=this.parent;null!=c.prev;)c=c.prev;for(;null!=c;){var d=
c.data;if(!this.lt(d,a)){b=d;break}if(null!=c.next)for(c=c.next;null!=c.prev;)c=c.prev;else{for(;null!=c.parent&&c==c.parent.next;)c=c.parent;c=c.parent}}}return b},first:function(){for(var a=this.parent;null!=a.prev;)a=a.prev;return a.data},pop_front:function(){for(var a=this.parent;null!=a.prev;)a=a.prev;var b=a.data;this.remove_node(a);return b},remove:function(a){a=this.find(a);this.remove_node(a)},successor_node:function(a){if(null!=a.next)for(a=a.next;null!=a.prev;)a=a.prev;else{var b=a;for(a=
a.parent;null!=a&&a.prev!=b;)b=a,a=a.parent}return a},predecessor_node:function(a){if(null!=a.prev)for(a=a.prev;null!=a.next;)a=a.next;else{var b=a;for(a=a.parent;null!=a&&a.next!=b;)b=a,a=a.parent}return a},successor:function(a){a=this.successor_node(this.find(a));return null==a?null:a.data},predecessor:function(a){a=this.predecessor_node(this.find(a));return null==a?null:a.data},remove_node:function(a){if(null!=a.next&&null!=a.prev){for(var b=a.next;null!=b.prev;)b=b.prev;var c=a.data;a.data=b.data;
b.data=c;null!=this.swapped&&this.swapped(a.data,b.data);a=b}b=null==a.prev?a.next:a.prev;if(1==a.colour)if(null!=a.prev||null!=a.next)b.colour=1;else if(null!=a.parent)for(c=a.parent;;){c.colour++;c.prev.colour--;c.next.colour--;var d=c.prev;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==d.colour){if(null!=d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);break}}d=c.next;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==
d.colour){if(null!=d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);break}}if(2==c.colour)if(null==c.parent)c.colour=1;else{c=c.parent;continue}break}c=a.parent;null==c?this.parent=b:c.prev==a?c.prev=b:c.next=b;null!=b&&(b.parent=c);a.parent=a.prev=a.next=null;a.data=null;a.lt=null;a.swapped=null;a.next=pa.zpp_pool;pa.zpp_pool=a},clear:function(){this.clear_with(function(a){})},clear_with:function(a){if(null!=this.parent){for(var b=
this.parent;null!=b;)b=null!=b.prev?b.prev:null!=b.next?b.next:this.clear_node(b,a);this.parent=null}},clear_node:function(a,b){b(a.data);var c=a.parent;null!=c&&(a==c.prev?c.prev=null:c.next=null,a.parent=null);a.data=null;a.lt=null;a.swapped=null;a.next=pa.zpp_pool;pa.zpp_pool=a;return c},__fix_neg_red:function(a){var b=a.parent;if(b.prev==a){var c=a.prev,d=a.next,e=d.prev,f=d.next;c.colour=0;a.colour=b.colour=1;a.next=e;null!=e&&(e.parent=a);a=b.data;b.data=d.data;d.data=a;null!=this.swapped&&
this.swapped(b.data,d.data);d.prev=f;null!=f&&(f.parent=d);d.next=b.next;null!=b.next&&(b.next.parent=d);b.next=d}else c=a.next,d=a.prev,e=d.next,f=d.prev,c.colour=0,a.colour=b.colour=1,a.prev=e,null!=e&&(e.parent=a),a=b.data,b.data=d.data,d.data=a,null!=this.swapped&&this.swapped(b.data,d.data),d.next=f,null!=f&&(f.parent=d),d.prev=b.prev,null!=b.prev&&(b.prev.parent=d),b.prev=d;null!=d&&(d.parent=b);b=c;null!=b.prev&&0==b.prev.colour?this.__fix_dbl_red(b.prev):null!=b.next&&0==b.next.colour&&this.__fix_dbl_red(b.next)},
__fix_dbl_red:function(a){for(;;){var b=a.parent,c=b.parent;if(null==c){b.colour=1;break}var d,e,f,g,q,k,l;b==c.prev?(f=c,l=c.next,a==b.prev?(d=a,e=b,g=a.prev,q=a.next,k=b.next):(d=b,e=a,g=b.prev,q=a.prev,k=a.next)):(d=c,g=c.prev,a==b.prev?(e=a,f=b,q=a.prev,k=a.next,l=b.next):(e=b,f=a,q=b.prev,k=a.prev,l=a.next));a=c.parent;null==a?this.parent=e:a.prev==c?a.prev=e:a.next=e;null!=e&&(e.parent=a);d.prev=g;null!=g&&(g.parent=d);d.next=q;null!=q&&(q.parent=d);e.prev=d;null!=d&&(d.parent=e);e.next=f;null!=
f&&(f.parent=e);f.prev=k;null!=k&&(k.parent=f);f.next=l;null!=l&&(l.parent=f);e.colour=c.colour-1;d.colour=1;f.colour=1;if(e==this.parent)this.parent.colour=1;else if(0==e.colour&&0==e.parent.colour){a=e;continue}break}},try_insert_bool:function(a){var b=null,c=null;if(null==this.parent)null==pa.zpp_pool?b=new pa:(b=pa.zpp_pool,pa.zpp_pool=b.next,b.next=null),null,b.data=a,this.parent=b;else for(c=this.parent;;)if(this.lt(a,c.data))if(null==c.prev){null==pa.zpp_pool?b=new pa:(b=pa.zpp_pool,pa.zpp_pool=
b.next,b.next=null);null;b.data=a;c.prev=b;b.parent=c;break}else c=c.prev;else if(this.lt(c.data,a))if(null==c.next){null==pa.zpp_pool?b=new pa:(b=pa.zpp_pool,pa.zpp_pool=b.next,b.next=null);null;b.data=a;c.next=b;b.parent=c;break}else c=c.next;else break;if(null==b)return!1;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return!0},try_insert:function(a){var b=null,c=null;if(null==this.parent)null==pa.zpp_pool?b=new pa:(b=pa.zpp_pool,pa.zpp_pool=b.next,b.next=null),
null,b.data=a,this.parent=b;else for(c=this.parent;;)if(this.lt(a,c.data))if(null==c.prev){null==pa.zpp_pool?b=new pa:(b=pa.zpp_pool,pa.zpp_pool=b.next,b.next=null);null;b.data=a;c.prev=b;b.parent=c;break}else c=c.prev;else if(this.lt(c.data,a))if(null==c.next){null==pa.zpp_pool?b=new pa:(b=pa.zpp_pool,pa.zpp_pool=b.next,b.next=null);null;b.data=a;c.next=b;b.parent=c;break}else c=c.next;else break;if(null==b)return c;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));
return b},insert:function(a){var b;null==pa.zpp_pool?b=new pa:(b=pa.zpp_pool,pa.zpp_pool=b.next,b.next=null);null;b.data=a;if(null==this.parent)this.parent=b;else for(a=this.parent;;)if(this.lt(b.data,a.data))if(null==a.prev){a.prev=b;b.parent=a;break}else a=a.prev;else if(null==a.next){a.next=b;b.parent=a;break}else a=a.next;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return b},__class__:pa};var ba=function(){this.colour=0;this.lt=this.swapped=this.data=this.prev=
this.next=this.parent=null};ba.__name__=!0;ba.prototype={free:function(){this.swapped=this.lt=this.data=null},alloc:function(){},verify:function(){if(!this.empty()){for(var a=this.parent;null!=a.prev;)a=a.prev;for(;null!=a;){var b=a.data,c=!0;if(!this.empty()){for(var d=this.parent;null!=d.prev;)d=d.prev;for(;null!=d;){var e=d.data;if(!c){if(!this.lt(b,e)&&this.lt(e,b))return!1}else if(b==e)c=!1;else if(!this.lt(e,b)&&this.lt(b,e))return!1;if(null!=d.next)for(d=d.next;null!=d.prev;)d=d.prev;else{for(;null!=
d.parent&&d==d.parent.next;)d=d.parent;d=d.parent}}}if(null!=a.next)for(a=a.next;null!=a.prev;)a=a.prev;else{for(;null!=a.parent&&a==a.parent.next;)a=a.parent;a=a.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var a=0;if(!this.empty()){for(var b=this.parent;null!=b.prev;)b=b.prev;for(;null!=b;)if(a++,null!=b.next)for(b=b.next;null!=b.prev;)b=b.prev;else{for(;null!=b.parent&&
b==b.parent.next;)b=b.parent;b=b.parent}}return a},has:function(a){return null!=this.find(a)},find:function(a){for(var b=this.parent;null!=b&&b.data!=a;)b=this.lt(a,b.data)?b.prev:b.next;return b},has_weak:function(a){return null!=this.find_weak(a)},find_weak:function(a){for(var b=this.parent;null!=b;)if(this.lt(a,b.data))b=b.prev;else if(this.lt(b.data,a))b=b.next;else break;return b},lower_bound:function(a){var b=null;if(!this.empty()){for(var c=this.parent;null!=c.prev;)c=c.prev;for(;null!=c;){var d=
c.data;if(!this.lt(d,a)){b=d;break}if(null!=c.next)for(c=c.next;null!=c.prev;)c=c.prev;else{for(;null!=c.parent&&c==c.parent.next;)c=c.parent;c=c.parent}}}return b},first:function(){for(var a=this.parent;null!=a.prev;)a=a.prev;return a.data},pop_front:function(){for(var a=this.parent;null!=a.prev;)a=a.prev;var b=a.data;this.remove_node(a);return b},remove:function(a){a=this.find(a);this.remove_node(a)},successor_node:function(a){if(null!=a.next)for(a=a.next;null!=a.prev;)a=a.prev;else{var b=a;for(a=
a.parent;null!=a&&a.prev!=b;)b=a,a=a.parent}return a},predecessor_node:function(a){if(null!=a.prev)for(a=a.prev;null!=a.next;)a=a.next;else{var b=a;for(a=a.parent;null!=a&&a.next!=b;)b=a,a=a.parent}return a},successor:function(a){a=this.successor_node(this.find(a));return null==a?null:a.data},predecessor:function(a){a=this.predecessor_node(this.find(a));return null==a?null:a.data},remove_node:function(a){if(null!=a.next&&null!=a.prev){for(var b=a.next;null!=b.prev;)b=b.prev;var c=a.data;a.data=b.data;
b.data=c;null!=this.swapped&&this.swapped(a.data,b.data);a=b}b=null==a.prev?a.next:a.prev;if(1==a.colour)if(null!=a.prev||null!=a.next)b.colour=1;else if(null!=a.parent)for(c=a.parent;;){c.colour++;c.prev.colour--;c.next.colour--;var d=c.prev;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==d.colour){if(null!=d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);break}}d=c.next;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==
d.colour){if(null!=d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);break}}if(2==c.colour)if(null==c.parent)c.colour=1;else{c=c.parent;continue}break}c=a.parent;null==c?this.parent=b:c.prev==a?c.prev=b:c.next=b;null!=b&&(b.parent=c);a.parent=a.prev=a.next=null;a.data=null;a.lt=null;a.swapped=null;a.next=ba.zpp_pool;ba.zpp_pool=a},clear:function(){this.clear_with(function(a){})},clear_with:function(a){if(null!=this.parent){for(var b=
this.parent;null!=b;)b=null!=b.prev?b.prev:null!=b.next?b.next:this.clear_node(b,a);this.parent=null}},clear_node:function(a,b){b(a.data);var c=a.parent;null!=c&&(a==c.prev?c.prev=null:c.next=null,a.parent=null);a.data=null;a.lt=null;a.swapped=null;a.next=ba.zpp_pool;ba.zpp_pool=a;return c},__fix_neg_red:function(a){var b=a.parent;if(b.prev==a){var c=a.prev,d=a.next,e=d.prev,f=d.next;c.colour=0;a.colour=b.colour=1;a.next=e;null!=e&&(e.parent=a);a=b.data;b.data=d.data;d.data=a;null!=this.swapped&&
this.swapped(b.data,d.data);d.prev=f;null!=f&&(f.parent=d);d.next=b.next;null!=b.next&&(b.next.parent=d);b.next=d}else c=a.next,d=a.prev,e=d.next,f=d.prev,c.colour=0,a.colour=b.colour=1,a.prev=e,null!=e&&(e.parent=a),a=b.data,b.data=d.data,d.data=a,null!=this.swapped&&this.swapped(b.data,d.data),d.next=f,null!=f&&(f.parent=d),d.prev=b.prev,null!=b.prev&&(b.prev.parent=d),b.prev=d;null!=d&&(d.parent=b);b=c;null!=b.prev&&0==b.prev.colour?this.__fix_dbl_red(b.prev):null!=b.next&&0==b.next.colour&&this.__fix_dbl_red(b.next)},
__fix_dbl_red:function(a){for(;;){var b=a.parent,c=b.parent;if(null==c){b.colour=1;break}var d,e,f,g,q,k,l;b==c.prev?(f=c,l=c.next,a==b.prev?(d=a,e=b,g=a.prev,q=a.next,k=b.next):(d=b,e=a,g=b.prev,q=a.prev,k=a.next)):(d=c,g=c.prev,a==b.prev?(e=a,f=b,q=a.prev,k=a.next,l=b.next):(e=b,f=a,q=b.prev,k=a.prev,l=a.next));a=c.parent;null==a?this.parent=e:a.prev==c?a.prev=e:a.next=e;null!=e&&(e.parent=a);d.prev=g;null!=g&&(g.parent=d);d.next=q;null!=q&&(q.parent=d);e.prev=d;null!=d&&(d.parent=e);e.next=f;null!=
f&&(f.parent=e);f.prev=k;null!=k&&(k.parent=f);f.next=l;null!=l&&(l.parent=f);e.colour=c.colour-1;d.colour=1;f.colour=1;if(e==this.parent)this.parent.colour=1;else if(0==e.colour&&0==e.parent.colour){a=e;continue}break}},try_insert_bool:function(a){var b=null,c=null;if(null==this.parent)null==ba.zpp_pool?b=new ba:(b=ba.zpp_pool,ba.zpp_pool=b.next,b.next=null),null,b.data=a,this.parent=b;else for(c=this.parent;;)if(this.lt(a,c.data))if(null==c.prev){null==ba.zpp_pool?b=new ba:(b=ba.zpp_pool,ba.zpp_pool=
b.next,b.next=null);null;b.data=a;c.prev=b;b.parent=c;break}else c=c.prev;else if(this.lt(c.data,a))if(null==c.next){null==ba.zpp_pool?b=new ba:(b=ba.zpp_pool,ba.zpp_pool=b.next,b.next=null);null;b.data=a;c.next=b;b.parent=c;break}else c=c.next;else break;if(null==b)return!1;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return!0},try_insert:function(a){var b=null,c=null;if(null==this.parent)null==ba.zpp_pool?b=new ba:(b=ba.zpp_pool,ba.zpp_pool=b.next,b.next=null),
null,b.data=a,this.parent=b;else for(c=this.parent;;)if(this.lt(a,c.data))if(null==c.prev){null==ba.zpp_pool?b=new ba:(b=ba.zpp_pool,ba.zpp_pool=b.next,b.next=null);null;b.data=a;c.prev=b;b.parent=c;break}else c=c.prev;else if(this.lt(c.data,a))if(null==c.next){null==ba.zpp_pool?b=new ba:(b=ba.zpp_pool,ba.zpp_pool=b.next,b.next=null);null;b.data=a;c.next=b;b.parent=c;break}else c=c.next;else break;if(null==b)return c;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));
return b},insert:function(a){var b;null==ba.zpp_pool?b=new ba:(b=ba.zpp_pool,ba.zpp_pool=b.next,b.next=null);null;b.data=a;if(null==this.parent)this.parent=b;else for(a=this.parent;;)if(this.lt(b.data,a.data))if(null==a.prev){a.prev=b;b.parent=a;break}else a=a.prev;else if(null==a.next){a.next=b;b.parent=a;break}else a=a.next;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return b},__class__:ba};var aa=function(){this.colour=0;this.lt=this.swapped=this.data=this.prev=
this.next=this.parent=null};aa.__name__=!0;aa.prototype={free:function(){this.swapped=this.lt=this.data=null},alloc:function(){},verify:function(){if(!this.empty()){for(var a=this.parent;null!=a.prev;)a=a.prev;for(;null!=a;){var b=a.data,c=!0;if(!this.empty()){for(var d=this.parent;null!=d.prev;)d=d.prev;for(;null!=d;){var e=d.data;if(!c){if(!this.lt(b,e)&&this.lt(e,b))return!1}else if(b==e)c=!1;else if(!this.lt(e,b)&&this.lt(b,e))return!1;if(null!=d.next)for(d=d.next;null!=d.prev;)d=d.prev;else{for(;null!=
d.parent&&d==d.parent.next;)d=d.parent;d=d.parent}}}if(null!=a.next)for(a=a.next;null!=a.prev;)a=a.prev;else{for(;null!=a.parent&&a==a.parent.next;)a=a.parent;a=a.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var a=0;if(!this.empty()){for(var b=this.parent;null!=b.prev;)b=b.prev;for(;null!=b;)if(a++,null!=b.next)for(b=b.next;null!=b.prev;)b=b.prev;else{for(;null!=b.parent&&
b==b.parent.next;)b=b.parent;b=b.parent}}return a},has:function(a){return null!=this.find(a)},find:function(a){for(var b=this.parent;null!=b&&b.data!=a;)b=this.lt(a,b.data)?b.prev:b.next;return b},has_weak:function(a){return null!=this.find_weak(a)},find_weak:function(a){for(var b=this.parent;null!=b;)if(this.lt(a,b.data))b=b.prev;else if(this.lt(b.data,a))b=b.next;else break;return b},lower_bound:function(a){var b=null;if(!this.empty()){for(var c=this.parent;null!=c.prev;)c=c.prev;for(;null!=c;){var d=
c.data;if(!this.lt(d,a)){b=d;break}if(null!=c.next)for(c=c.next;null!=c.prev;)c=c.prev;else{for(;null!=c.parent&&c==c.parent.next;)c=c.parent;c=c.parent}}}return b},first:function(){for(var a=this.parent;null!=a.prev;)a=a.prev;return a.data},pop_front:function(){for(var a=this.parent;null!=a.prev;)a=a.prev;var b=a.data;this.remove_node(a);return b},remove:function(a){a=this.find(a);this.remove_node(a)},successor_node:function(a){if(null!=a.next)for(a=a.next;null!=a.prev;)a=a.prev;else{var b=a;for(a=
a.parent;null!=a&&a.prev!=b;)b=a,a=a.parent}return a},predecessor_node:function(a){if(null!=a.prev)for(a=a.prev;null!=a.next;)a=a.next;else{var b=a;for(a=a.parent;null!=a&&a.next!=b;)b=a,a=a.parent}return a},successor:function(a){a=this.successor_node(this.find(a));return null==a?null:a.data},predecessor:function(a){a=this.predecessor_node(this.find(a));return null==a?null:a.data},remove_node:function(a){if(null!=a.next&&null!=a.prev){for(var b=a.next;null!=b.prev;)b=b.prev;var c=a.data;a.data=b.data;
b.data=c;null!=this.swapped&&this.swapped(a.data,b.data);a=b}b=null==a.prev?a.next:a.prev;if(1==a.colour)if(null!=a.prev||null!=a.next)b.colour=1;else if(null!=a.parent)for(c=a.parent;;){c.colour++;c.prev.colour--;c.next.colour--;var d=c.prev;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==d.colour){if(null!=d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);break}}d=c.next;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==
d.colour){if(null!=d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);break}}if(2==c.colour)if(null==c.parent)c.colour=1;else{c=c.parent;continue}break}c=a.parent;null==c?this.parent=b:c.prev==a?c.prev=b:c.next=b;null!=b&&(b.parent=c);a.parent=a.prev=a.next=null;a.data=null;a.lt=null;a.swapped=null;a.next=aa.zpp_pool;aa.zpp_pool=a},clear:function(){this.clear_with(function(a){})},clear_with:function(a){if(null!=this.parent){for(var b=
this.parent;null!=b;)b=null!=b.prev?b.prev:null!=b.next?b.next:this.clear_node(b,a);this.parent=null}},clear_node:function(a,b){b(a.data);var c=a.parent;null!=c&&(a==c.prev?c.prev=null:c.next=null,a.parent=null);a.data=null;a.lt=null;a.swapped=null;a.next=aa.zpp_pool;aa.zpp_pool=a;return c},__fix_neg_red:function(a){var b=a.parent;if(b.prev==a){var c=a.prev,d=a.next,e=d.prev,f=d.next;c.colour=0;a.colour=b.colour=1;a.next=e;null!=e&&(e.parent=a);a=b.data;b.data=d.data;d.data=a;null!=this.swapped&&
this.swapped(b.data,d.data);d.prev=f;null!=f&&(f.parent=d);d.next=b.next;null!=b.next&&(b.next.parent=d);b.next=d}else c=a.next,d=a.prev,e=d.next,f=d.prev,c.colour=0,a.colour=b.colour=1,a.prev=e,null!=e&&(e.parent=a),a=b.data,b.data=d.data,d.data=a,null!=this.swapped&&this.swapped(b.data,d.data),d.next=f,null!=f&&(f.parent=d),d.prev=b.prev,null!=b.prev&&(b.prev.parent=d),b.prev=d;null!=d&&(d.parent=b);b=c;null!=b.prev&&0==b.prev.colour?this.__fix_dbl_red(b.prev):null!=b.next&&0==b.next.colour&&this.__fix_dbl_red(b.next)},
__fix_dbl_red:function(a){for(;;){var b=a.parent,c=b.parent;if(null==c){b.colour=1;break}var d,e,f,g,q,k,l;b==c.prev?(f=c,l=c.next,a==b.prev?(d=a,e=b,g=a.prev,q=a.next,k=b.next):(d=b,e=a,g=b.prev,q=a.prev,k=a.next)):(d=c,g=c.prev,a==b.prev?(e=a,f=b,q=a.prev,k=a.next,l=b.next):(e=b,f=a,q=b.prev,k=a.prev,l=a.next));a=c.parent;null==a?this.parent=e:a.prev==c?a.prev=e:a.next=e;null!=e&&(e.parent=a);d.prev=g;null!=g&&(g.parent=d);d.next=q;null!=q&&(q.parent=d);e.prev=d;null!=d&&(d.parent=e);e.next=f;null!=
f&&(f.parent=e);f.prev=k;null!=k&&(k.parent=f);f.next=l;null!=l&&(l.parent=f);e.colour=c.colour-1;d.colour=1;f.colour=1;if(e==this.parent)this.parent.colour=1;else if(0==e.colour&&0==e.parent.colour){a=e;continue}break}},try_insert_bool:function(a){var b=null,c=null;if(null==this.parent)null==aa.zpp_pool?b=new aa:(b=aa.zpp_pool,aa.zpp_pool=b.next,b.next=null),null,b.data=a,this.parent=b;else for(c=this.parent;;)if(this.lt(a,c.data))if(null==c.prev){null==aa.zpp_pool?b=new aa:(b=aa.zpp_pool,aa.zpp_pool=
b.next,b.next=null);null;b.data=a;c.prev=b;b.parent=c;break}else c=c.prev;else if(this.lt(c.data,a))if(null==c.next){null==aa.zpp_pool?b=new aa:(b=aa.zpp_pool,aa.zpp_pool=b.next,b.next=null);null;b.data=a;c.next=b;b.parent=c;break}else c=c.next;else break;if(null==b)return!1;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return!0},try_insert:function(a){var b=null,c=null;if(null==this.parent)null==aa.zpp_pool?b=new aa:(b=aa.zpp_pool,aa.zpp_pool=b.next,b.next=null),
null,b.data=a,this.parent=b;else for(c=this.parent;;)if(this.lt(a,c.data))if(null==c.prev){null==aa.zpp_pool?b=new aa:(b=aa.zpp_pool,aa.zpp_pool=b.next,b.next=null);null;b.data=a;c.prev=b;b.parent=c;break}else c=c.prev;else if(this.lt(c.data,a))if(null==c.next){null==aa.zpp_pool?b=new aa:(b=aa.zpp_pool,aa.zpp_pool=b.next,b.next=null);null;b.data=a;c.next=b;b.parent=c;break}else c=c.next;else break;if(null==b)return c;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));
return b},insert:function(a){var b;null==aa.zpp_pool?b=new aa:(b=aa.zpp_pool,aa.zpp_pool=b.next,b.next=null);null;b.data=a;if(null==this.parent)this.parent=b;else for(a=this.parent;;)if(this.lt(b.data,a.data))if(null==a.prev){a.prev=b;b.parent=a;break}else a=a.prev;else if(null==a.next){a.next=b;b.parent=a;break}else a=a.next;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return b},__class__:aa};var ia=function(){this.colour=0;this.lt=this.swapped=this.data=this.prev=
this.next=this.parent=null};ia.__name__=!0;ia.prototype={free:function(){this.swapped=this.lt=this.data=null},alloc:function(){},verify:function(){if(!this.empty()){for(var a=this.parent;null!=a.prev;)a=a.prev;for(;null!=a;){var b=a.data,c=!0;if(!this.empty()){for(var d=this.parent;null!=d.prev;)d=d.prev;for(;null!=d;){var e=d.data;if(!c){if(!this.lt(b,e)&&this.lt(e,b))return!1}else if(b==e)c=!1;else if(!this.lt(e,b)&&this.lt(b,e))return!1;if(null!=d.next)for(d=d.next;null!=d.prev;)d=d.prev;else{for(;null!=
d.parent&&d==d.parent.next;)d=d.parent;d=d.parent}}}if(null!=a.next)for(a=a.next;null!=a.prev;)a=a.prev;else{for(;null!=a.parent&&a==a.parent.next;)a=a.parent;a=a.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var a=0;if(!this.empty()){for(var b=this.parent;null!=b.prev;)b=b.prev;for(;null!=b;)if(a++,null!=b.next)for(b=b.next;null!=b.prev;)b=b.prev;else{for(;null!=b.parent&&
b==b.parent.next;)b=b.parent;b=b.parent}}return a},has:function(a){return null!=this.find(a)},find:function(a){for(var b=this.parent;null!=b&&b.data!=a;)b=this.lt(a,b.data)?b.prev:b.next;return b},has_weak:function(a){return null!=this.find_weak(a)},find_weak:function(a){for(var b=this.parent;null!=b;)if(this.lt(a,b.data))b=b.prev;else if(this.lt(b.data,a))b=b.next;else break;return b},lower_bound:function(a){var b=null;if(!this.empty()){for(var c=this.parent;null!=c.prev;)c=c.prev;for(;null!=c;){var d=
c.data;if(!this.lt(d,a)){b=d;break}if(null!=c.next)for(c=c.next;null!=c.prev;)c=c.prev;else{for(;null!=c.parent&&c==c.parent.next;)c=c.parent;c=c.parent}}}return b},first:function(){for(var a=this.parent;null!=a.prev;)a=a.prev;return a.data},pop_front:function(){for(var a=this.parent;null!=a.prev;)a=a.prev;var b=a.data;this.remove_node(a);return b},remove:function(a){a=this.find(a);this.remove_node(a)},successor_node:function(a){if(null!=a.next)for(a=a.next;null!=a.prev;)a=a.prev;else{var b=a;for(a=
a.parent;null!=a&&a.prev!=b;)b=a,a=a.parent}return a},predecessor_node:function(a){if(null!=a.prev)for(a=a.prev;null!=a.next;)a=a.next;else{var b=a;for(a=a.parent;null!=a&&a.next!=b;)b=a,a=a.parent}return a},successor:function(a){a=this.successor_node(this.find(a));return null==a?null:a.data},predecessor:function(a){a=this.predecessor_node(this.find(a));return null==a?null:a.data},remove_node:function(a){if(null!=a.next&&null!=a.prev){for(var b=a.next;null!=b.prev;)b=b.prev;var c=a.data;a.data=b.data;
b.data=c;null!=this.swapped&&this.swapped(a.data,b.data);a=b}b=null==a.prev?a.next:a.prev;if(1==a.colour)if(null!=a.prev||null!=a.next)b.colour=1;else if(null!=a.parent)for(c=a.parent;;){c.colour++;c.prev.colour--;c.next.colour--;var d=c.prev;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==d.colour){if(null!=d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);break}}d=c.next;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==
d.colour){if(null!=d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);break}}if(2==c.colour)if(null==c.parent)c.colour=1;else{c=c.parent;continue}break}c=a.parent;null==c?this.parent=b:c.prev==a?c.prev=b:c.next=b;null!=b&&(b.parent=c);a.parent=a.prev=a.next=null;a.data=null;a.lt=null;a.swapped=null;a.next=ia.zpp_pool;ia.zpp_pool=a},clear:function(){this.clear_with(function(a){})},clear_with:function(a){if(null!=this.parent){for(var b=
this.parent;null!=b;)b=null!=b.prev?b.prev:null!=b.next?b.next:this.clear_node(b,a);this.parent=null}},clear_node:function(a,b){b(a.data);var c=a.parent;null!=c&&(a==c.prev?c.prev=null:c.next=null,a.parent=null);a.data=null;a.lt=null;a.swapped=null;a.next=ia.zpp_pool;ia.zpp_pool=a;return c},__fix_neg_red:function(a){var b=a.parent;if(b.prev==a){var c=a.prev,d=a.next,e=d.prev,f=d.next;c.colour=0;a.colour=b.colour=1;a.next=e;null!=e&&(e.parent=a);a=b.data;b.data=d.data;d.data=a;null!=this.swapped&&
this.swapped(b.data,d.data);d.prev=f;null!=f&&(f.parent=d);d.next=b.next;null!=b.next&&(b.next.parent=d);b.next=d}else c=a.next,d=a.prev,e=d.next,f=d.prev,c.colour=0,a.colour=b.colour=1,a.prev=e,null!=e&&(e.parent=a),a=b.data,b.data=d.data,d.data=a,null!=this.swapped&&this.swapped(b.data,d.data),d.next=f,null!=f&&(f.parent=d),d.prev=b.prev,null!=b.prev&&(b.prev.parent=d),b.prev=d;null!=d&&(d.parent=b);b=c;null!=b.prev&&0==b.prev.colour?this.__fix_dbl_red(b.prev):null!=b.next&&0==b.next.colour&&this.__fix_dbl_red(b.next)},
__fix_dbl_red:function(a){for(;;){var b=a.parent,c=b.parent;if(null==c){b.colour=1;break}var d,e,f,g,q,k,l;b==c.prev?(f=c,l=c.next,a==b.prev?(d=a,e=b,g=a.prev,q=a.next,k=b.next):(d=b,e=a,g=b.prev,q=a.prev,k=a.next)):(d=c,g=c.prev,a==b.prev?(e=a,f=b,q=a.prev,k=a.next,l=b.next):(e=b,f=a,q=b.prev,k=a.prev,l=a.next));a=c.parent;null==a?this.parent=e:a.prev==c?a.prev=e:a.next=e;null!=e&&(e.parent=a);d.prev=g;null!=g&&(g.parent=d);d.next=q;null!=q&&(q.parent=d);e.prev=d;null!=d&&(d.parent=e);e.next=f;null!=
f&&(f.parent=e);f.prev=k;null!=k&&(k.parent=f);f.next=l;null!=l&&(l.parent=f);e.colour=c.colour-1;d.colour=1;f.colour=1;if(e==this.parent)this.parent.colour=1;else if(0==e.colour&&0==e.parent.colour){a=e;continue}break}},try_insert_bool:function(a){var b=null,c=null;if(null==this.parent)null==ia.zpp_pool?b=new ia:(b=ia.zpp_pool,ia.zpp_pool=b.next,b.next=null),null,b.data=a,this.parent=b;else for(c=this.parent;;)if(this.lt(a,c.data))if(null==c.prev){null==ia.zpp_pool?b=new ia:(b=ia.zpp_pool,ia.zpp_pool=
b.next,b.next=null);null;b.data=a;c.prev=b;b.parent=c;break}else c=c.prev;else if(this.lt(c.data,a))if(null==c.next){null==ia.zpp_pool?b=new ia:(b=ia.zpp_pool,ia.zpp_pool=b.next,b.next=null);null;b.data=a;c.next=b;b.parent=c;break}else c=c.next;else break;if(null==b)return!1;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return!0},try_insert:function(a){var b=null,c=null;if(null==this.parent)null==ia.zpp_pool?b=new ia:(b=ia.zpp_pool,ia.zpp_pool=b.next,b.next=null),
null,b.data=a,this.parent=b;else for(c=this.parent;;)if(this.lt(a,c.data))if(null==c.prev){null==ia.zpp_pool?b=new ia:(b=ia.zpp_pool,ia.zpp_pool=b.next,b.next=null);null;b.data=a;c.prev=b;b.parent=c;break}else c=c.prev;else if(this.lt(c.data,a))if(null==c.next){null==ia.zpp_pool?b=new ia:(b=ia.zpp_pool,ia.zpp_pool=b.next,b.next=null);null;b.data=a;c.next=b;b.parent=c;break}else c=c.next;else break;if(null==b)return c;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));
return b},insert:function(a){var b;null==ia.zpp_pool?b=new ia:(b=ia.zpp_pool,ia.zpp_pool=b.next,b.next=null);null;b.data=a;if(null==this.parent)this.parent=b;else for(a=this.parent;;)if(this.lt(b.data,a.data))if(null==a.prev){a.prev=b;b.parent=a;break}else a=a.prev;else if(null==a.next){a.next=b;b.parent=a;break}else a=a.next;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return b},__class__:ia};var Z=function(){this.colour=0;this.lt=this.swapped=this.data=this.prev=
this.next=this.parent=null};Z.__name__=!0;Z.prototype={free:function(){this.swapped=this.lt=this.data=null},alloc:function(){},verify:function(){if(!this.empty()){for(var a=this.parent;null!=a.prev;)a=a.prev;for(;null!=a;){var b=a.data,c=!0;if(!this.empty()){for(var d=this.parent;null!=d.prev;)d=d.prev;for(;null!=d;){var e=d.data;if(!c){if(!this.lt(b,e)&&this.lt(e,b))return!1}else if(b==e)c=!1;else if(!this.lt(e,b)&&this.lt(b,e))return!1;if(null!=d.next)for(d=d.next;null!=d.prev;)d=d.prev;else{for(;null!=
d.parent&&d==d.parent.next;)d=d.parent;d=d.parent}}}if(null!=a.next)for(a=a.next;null!=a.prev;)a=a.prev;else{for(;null!=a.parent&&a==a.parent.next;)a=a.parent;a=a.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var a=0;if(!this.empty()){for(var b=this.parent;null!=b.prev;)b=b.prev;for(;null!=b;)if(a++,null!=b.next)for(b=b.next;null!=b.prev;)b=b.prev;else{for(;null!=b.parent&&
b==b.parent.next;)b=b.parent;b=b.parent}}return a},has:function(a){return null!=this.find(a)},find:function(a){for(var b=this.parent;null!=b&&b.data!=a;)b=this.lt(a,b.data)?b.prev:b.next;return b},has_weak:function(a){return null!=this.find_weak(a)},find_weak:function(a){for(var b=this.parent;null!=b;)if(this.lt(a,b.data))b=b.prev;else if(this.lt(b.data,a))b=b.next;else break;return b},lower_bound:function(a){var b=null;if(!this.empty()){for(var c=this.parent;null!=c.prev;)c=c.prev;for(;null!=c;){var d=
c.data;if(!this.lt(d,a)){b=d;break}if(null!=c.next)for(c=c.next;null!=c.prev;)c=c.prev;else{for(;null!=c.parent&&c==c.parent.next;)c=c.parent;c=c.parent}}}return b},first:function(){for(var a=this.parent;null!=a.prev;)a=a.prev;return a.data},pop_front:function(){for(var a=this.parent;null!=a.prev;)a=a.prev;var b=a.data;this.remove_node(a);return b},remove:function(a){a=this.find(a);this.remove_node(a)},successor_node:function(a){if(null!=a.next)for(a=a.next;null!=a.prev;)a=a.prev;else{var b=a;for(a=
a.parent;null!=a&&a.prev!=b;)b=a,a=a.parent}return a},predecessor_node:function(a){if(null!=a.prev)for(a=a.prev;null!=a.next;)a=a.next;else{var b=a;for(a=a.parent;null!=a&&a.next!=b;)b=a,a=a.parent}return a},successor:function(a){a=this.successor_node(this.find(a));return null==a?null:a.data},predecessor:function(a){a=this.predecessor_node(this.find(a));return null==a?null:a.data},remove_node:function(a){if(null!=a.next&&null!=a.prev){for(var b=a.next;null!=b.prev;)b=b.prev;var c=a.data;a.data=b.data;
b.data=c;null!=this.swapped&&this.swapped(a.data,b.data);a=b}b=null==a.prev?a.next:a.prev;if(1==a.colour)if(null!=a.prev||null!=a.next)b.colour=1;else if(null!=a.parent)for(c=a.parent;;){c.colour++;c.prev.colour--;c.next.colour--;var d=c.prev;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==d.colour){if(null!=d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);break}}d=c.next;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==
d.colour){if(null!=d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);break}}if(2==c.colour)if(null==c.parent)c.colour=1;else{c=c.parent;continue}break}c=a.parent;null==c?this.parent=b:c.prev==a?c.prev=b:c.next=b;null!=b&&(b.parent=c);a.parent=a.prev=a.next=null;a.data=null;a.lt=null;a.swapped=null;a.next=Z.zpp_pool;Z.zpp_pool=a},clear:function(){this.clear_with(function(a){})},clear_with:function(a){if(null!=this.parent){for(var b=
this.parent;null!=b;)b=null!=b.prev?b.prev:null!=b.next?b.next:this.clear_node(b,a);this.parent=null}},clear_node:function(a,b){b(a.data);var c=a.parent;null!=c&&(a==c.prev?c.prev=null:c.next=null,a.parent=null);a.data=null;a.lt=null;a.swapped=null;a.next=Z.zpp_pool;Z.zpp_pool=a;return c},__fix_neg_red:function(a){var b=a.parent;if(b.prev==a){var c=a.prev,d=a.next,e=d.prev,f=d.next;c.colour=0;a.colour=b.colour=1;a.next=e;null!=e&&(e.parent=a);a=b.data;b.data=d.data;d.data=a;null!=this.swapped&&this.swapped(b.data,
d.data);d.prev=f;null!=f&&(f.parent=d);d.next=b.next;null!=b.next&&(b.next.parent=d);b.next=d}else c=a.next,d=a.prev,e=d.next,f=d.prev,c.colour=0,a.colour=b.colour=1,a.prev=e,null!=e&&(e.parent=a),a=b.data,b.data=d.data,d.data=a,null!=this.swapped&&this.swapped(b.data,d.data),d.next=f,null!=f&&(f.parent=d),d.prev=b.prev,null!=b.prev&&(b.prev.parent=d),b.prev=d;null!=d&&(d.parent=b);b=c;null!=b.prev&&0==b.prev.colour?this.__fix_dbl_red(b.prev):null!=b.next&&0==b.next.colour&&this.__fix_dbl_red(b.next)},
__fix_dbl_red:function(a){for(;;){var b=a.parent,c=b.parent;if(null==c){b.colour=1;break}var d,e,f,g,q,k,l;b==c.prev?(f=c,l=c.next,a==b.prev?(d=a,e=b,g=a.prev,q=a.next,k=b.next):(d=b,e=a,g=b.prev,q=a.prev,k=a.next)):(d=c,g=c.prev,a==b.prev?(e=a,f=b,q=a.prev,k=a.next,l=b.next):(e=b,f=a,q=b.prev,k=a.prev,l=a.next));a=c.parent;null==a?this.parent=e:a.prev==c?a.prev=e:a.next=e;null!=e&&(e.parent=a);d.prev=g;null!=g&&(g.parent=d);d.next=q;null!=q&&(q.parent=d);e.prev=d;null!=d&&(d.parent=e);e.next=f;null!=
f&&(f.parent=e);f.prev=k;null!=k&&(k.parent=f);f.next=l;null!=l&&(l.parent=f);e.colour=c.colour-1;d.colour=1;f.colour=1;if(e==this.parent)this.parent.colour=1;else if(0==e.colour&&0==e.parent.colour){a=e;continue}break}},try_insert_bool:function(a){var b=null,c=null;if(null==this.parent)null==Z.zpp_pool?b=new Z:(b=Z.zpp_pool,Z.zpp_pool=b.next,b.next=null),null,b.data=a,this.parent=b;else for(c=this.parent;;)if(this.lt(a,c.data))if(null==c.prev){null==Z.zpp_pool?b=new Z:(b=Z.zpp_pool,Z.zpp_pool=b.next,
b.next=null);null;b.data=a;c.prev=b;b.parent=c;break}else c=c.prev;else if(this.lt(c.data,a))if(null==c.next){null==Z.zpp_pool?b=new Z:(b=Z.zpp_pool,Z.zpp_pool=b.next,b.next=null);null;b.data=a;c.next=b;b.parent=c;break}else c=c.next;else break;if(null==b)return!1;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return!0},try_insert:function(a){var b=null,c=null;if(null==this.parent)null==Z.zpp_pool?b=new Z:(b=Z.zpp_pool,Z.zpp_pool=b.next,b.next=null),null,b.data=a,
this.parent=b;else for(c=this.parent;;)if(this.lt(a,c.data))if(null==c.prev){null==Z.zpp_pool?b=new Z:(b=Z.zpp_pool,Z.zpp_pool=b.next,b.next=null);null;b.data=a;c.prev=b;b.parent=c;break}else c=c.prev;else if(this.lt(c.data,a))if(null==c.next){null==Z.zpp_pool?b=new Z:(b=Z.zpp_pool,Z.zpp_pool=b.next,b.next=null);null;b.data=a;c.next=b;b.parent=c;break}else c=c.next;else break;if(null==b)return c;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return b},insert:function(a){var b;
null==Z.zpp_pool?b=new Z:(b=Z.zpp_pool,Z.zpp_pool=b.next,b.next=null);null;b.data=a;if(null==this.parent)this.parent=b;else for(a=this.parent;;)if(this.lt(b.data,a.data))if(null==a.prev){a.prev=b;b.parent=a;break}else a=a.prev;else if(null==a.next){a.next=b;b.parent=a;break}else a=a.next;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return b},__class__:Z};var ha=function(){this.colour=0;this.lt=this.swapped=this.data=this.prev=this.next=this.parent=null};ha.__name__=
!0;ha.prototype={free:function(){this.swapped=this.lt=this.data=null},alloc:function(){},verify:function(){if(!this.empty()){for(var a=this.parent;null!=a.prev;)a=a.prev;for(;null!=a;){var b=a.data,c=!0;if(!this.empty()){for(var d=this.parent;null!=d.prev;)d=d.prev;for(;null!=d;){var e=d.data;if(!c){if(!this.lt(b,e)&&this.lt(e,b))return!1}else if(b==e)c=!1;else if(!this.lt(e,b)&&this.lt(b,e))return!1;if(null!=d.next)for(d=d.next;null!=d.prev;)d=d.prev;else{for(;null!=d.parent&&d==d.parent.next;)d=
d.parent;d=d.parent}}}if(null!=a.next)for(a=a.next;null!=a.prev;)a=a.prev;else{for(;null!=a.parent&&a==a.parent.next;)a=a.parent;a=a.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var a=0;if(!this.empty()){for(var b=this.parent;null!=b.prev;)b=b.prev;for(;null!=b;)if(a++,null!=b.next)for(b=b.next;null!=b.prev;)b=b.prev;else{for(;null!=b.parent&&b==b.parent.next;)b=b.parent;
b=b.parent}}return a},has:function(a){return null!=this.find(a)},find:function(a){for(var b=this.parent;null!=b&&b.data!=a;)b=this.lt(a,b.data)?b.prev:b.next;return b},has_weak:function(a){return null!=this.find_weak(a)},find_weak:function(a){for(var b=this.parent;null!=b;)if(this.lt(a,b.data))b=b.prev;else if(this.lt(b.data,a))b=b.next;else break;return b},lower_bound:function(a){var b=null;if(!this.empty()){for(var c=this.parent;null!=c.prev;)c=c.prev;for(;null!=c;){var d=c.data;if(!this.lt(d,a)){b=
d;break}if(null!=c.next)for(c=c.next;null!=c.prev;)c=c.prev;else{for(;null!=c.parent&&c==c.parent.next;)c=c.parent;c=c.parent}}}return b},first:function(){for(var a=this.parent;null!=a.prev;)a=a.prev;return a.data},pop_front:function(){for(var a=this.parent;null!=a.prev;)a=a.prev;var b=a.data;this.remove_node(a);return b},remove:function(a){a=this.find(a);this.remove_node(a)},successor_node:function(a){if(null!=a.next)for(a=a.next;null!=a.prev;)a=a.prev;else{var b=a;for(a=a.parent;null!=a&&a.prev!=
b;)b=a,a=a.parent}return a},predecessor_node:function(a){if(null!=a.prev)for(a=a.prev;null!=a.next;)a=a.next;else{var b=a;for(a=a.parent;null!=a&&a.next!=b;)b=a,a=a.parent}return a},successor:function(a){a=this.successor_node(this.find(a));return null==a?null:a.data},predecessor:function(a){a=this.predecessor_node(this.find(a));return null==a?null:a.data},remove_node:function(a){if(null!=a.next&&null!=a.prev){for(var b=a.next;null!=b.prev;)b=b.prev;var c=a.data;a.data=b.data;b.data=c;null!=this.swapped&&
this.swapped(a.data,b.data);a=b}b=null==a.prev?a.next:a.prev;if(1==a.colour)if(null!=a.prev||null!=a.next)b.colour=1;else if(null!=a.parent)for(c=a.parent;;){c.colour++;c.prev.colour--;c.next.colour--;var d=c.prev;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==d.colour){if(null!=d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);break}}d=c.next;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==d.colour){if(null!=
d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);break}}if(2==c.colour)if(null==c.parent)c.colour=1;else{c=c.parent;continue}break}c=a.parent;null==c?this.parent=b:c.prev==a?c.prev=b:c.next=b;null!=b&&(b.parent=c);a.parent=a.prev=a.next=null;a.data=null;a.lt=null;a.swapped=null;a.next=ha.zpp_pool;ha.zpp_pool=a},clear:function(){this.clear_with(function(a){})},clear_with:function(a){if(null!=this.parent){for(var b=this.parent;null!=
b;)b=null!=b.prev?b.prev:null!=b.next?b.next:this.clear_node(b,a);this.parent=null}},clear_node:function(a,b){b(a.data);var c=a.parent;null!=c&&(a==c.prev?c.prev=null:c.next=null,a.parent=null);a.data=null;a.lt=null;a.swapped=null;a.next=ha.zpp_pool;ha.zpp_pool=a;return c},__fix_neg_red:function(a){var b=a.parent;if(b.prev==a){var c=a.prev,d=a.next,e=d.prev,f=d.next;c.colour=0;a.colour=b.colour=1;a.next=e;null!=e&&(e.parent=a);a=b.data;b.data=d.data;d.data=a;null!=this.swapped&&this.swapped(b.data,
d.data);d.prev=f;null!=f&&(f.parent=d);d.next=b.next;null!=b.next&&(b.next.parent=d);b.next=d}else c=a.next,d=a.prev,e=d.next,f=d.prev,c.colour=0,a.colour=b.colour=1,a.prev=e,null!=e&&(e.parent=a),a=b.data,b.data=d.data,d.data=a,null!=this.swapped&&this.swapped(b.data,d.data),d.next=f,null!=f&&(f.parent=d),d.prev=b.prev,null!=b.prev&&(b.prev.parent=d),b.prev=d;null!=d&&(d.parent=b);b=c;null!=b.prev&&0==b.prev.colour?this.__fix_dbl_red(b.prev):null!=b.next&&0==b.next.colour&&this.__fix_dbl_red(b.next)},
__fix_dbl_red:function(a){for(;;){var b=a.parent,c=b.parent;if(null==c){b.colour=1;break}var d,e,f,g,q,k,l;b==c.prev?(f=c,l=c.next,a==b.prev?(d=a,e=b,g=a.prev,q=a.next,k=b.next):(d=b,e=a,g=b.prev,q=a.prev,k=a.next)):(d=c,g=c.prev,a==b.prev?(e=a,f=b,q=a.prev,k=a.next,l=b.next):(e=b,f=a,q=b.prev,k=a.prev,l=a.next));a=c.parent;null==a?this.parent=e:a.prev==c?a.prev=e:a.next=e;null!=e&&(e.parent=a);d.prev=g;null!=g&&(g.parent=d);d.next=q;null!=q&&(q.parent=d);e.prev=d;null!=d&&(d.parent=e);e.next=f;null!=
f&&(f.parent=e);f.prev=k;null!=k&&(k.parent=f);f.next=l;null!=l&&(l.parent=f);e.colour=c.colour-1;d.colour=1;f.colour=1;if(e==this.parent)this.parent.colour=1;else if(0==e.colour&&0==e.parent.colour){a=e;continue}break}},try_insert_bool:function(a){var b=null,c=null;if(null==this.parent)null==ha.zpp_pool?b=new ha:(b=ha.zpp_pool,ha.zpp_pool=b.next,b.next=null),null,b.data=a,this.parent=b;else for(c=this.parent;;)if(this.lt(a,c.data))if(null==c.prev){null==ha.zpp_pool?b=new ha:(b=ha.zpp_pool,ha.zpp_pool=
b.next,b.next=null);null;b.data=a;c.prev=b;b.parent=c;break}else c=c.prev;else if(this.lt(c.data,a))if(null==c.next){null==ha.zpp_pool?b=new ha:(b=ha.zpp_pool,ha.zpp_pool=b.next,b.next=null);null;b.data=a;c.next=b;b.parent=c;break}else c=c.next;else break;if(null==b)return!1;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return!0},try_insert:function(a){var b=null,c=null;if(null==this.parent)null==ha.zpp_pool?b=new ha:(b=ha.zpp_pool,ha.zpp_pool=b.next,b.next=null),
null,b.data=a,this.parent=b;else for(c=this.parent;;)if(this.lt(a,c.data))if(null==c.prev){null==ha.zpp_pool?b=new ha:(b=ha.zpp_pool,ha.zpp_pool=b.next,b.next=null);null;b.data=a;c.prev=b;b.parent=c;break}else c=c.prev;else if(this.lt(c.data,a))if(null==c.next){null==ha.zpp_pool?b=new ha:(b=ha.zpp_pool,ha.zpp_pool=b.next,b.next=null);null;b.data=a;c.next=b;b.parent=c;break}else c=c.next;else break;if(null==b)return c;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));
return b},insert:function(a){var b;null==ha.zpp_pool?b=new ha:(b=ha.zpp_pool,ha.zpp_pool=b.next,b.next=null);null;b.data=a;if(null==this.parent)this.parent=b;else for(a=this.parent;;)if(this.lt(b.data,a.data))if(null==a.prev){a.prev=b;b.parent=a;break}else a=a.prev;else if(null==a.next){a.next=b;b.parent=a;break}else a=a.next;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return b},__class__:ha};var R=function(){this.colour=0;this.lt=this.swapped=this.data=this.prev=
this.next=this.parent=null};R.__name__=!0;R.prototype={free:function(){this.swapped=this.lt=this.data=null},alloc:function(){},verify:function(){if(!this.empty()){for(var a=this.parent;null!=a.prev;)a=a.prev;for(;null!=a;){var b=a.data,c=!0;if(!this.empty()){for(var d=this.parent;null!=d.prev;)d=d.prev;for(;null!=d;){var e=d.data;if(!c){if(!this.lt(b,e)&&this.lt(e,b))return!1}else if(b==e)c=!1;else if(!this.lt(e,b)&&this.lt(b,e))return!1;if(null!=d.next)for(d=d.next;null!=d.prev;)d=d.prev;else{for(;null!=
d.parent&&d==d.parent.next;)d=d.parent;d=d.parent}}}if(null!=a.next)for(a=a.next;null!=a.prev;)a=a.prev;else{for(;null!=a.parent&&a==a.parent.next;)a=a.parent;a=a.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var a=0;if(!this.empty()){for(var b=this.parent;null!=b.prev;)b=b.prev;for(;null!=b;)if(a++,null!=b.next)for(b=b.next;null!=b.prev;)b=b.prev;else{for(;null!=b.parent&&
b==b.parent.next;)b=b.parent;b=b.parent}}return a},has:function(a){return null!=this.find(a)},find:function(a){for(var b=this.parent;null!=b&&b.data!=a;)b=this.lt(a,b.data)?b.prev:b.next;return b},has_weak:function(a){return null!=this.find_weak(a)},find_weak:function(a){for(var b=this.parent;null!=b;)if(this.lt(a,b.data))b=b.prev;else if(this.lt(b.data,a))b=b.next;else break;return b},lower_bound:function(a){var b=null;if(!this.empty()){for(var c=this.parent;null!=c.prev;)c=c.prev;for(;null!=c;){var d=
c.data;if(!this.lt(d,a)){b=d;break}if(null!=c.next)for(c=c.next;null!=c.prev;)c=c.prev;else{for(;null!=c.parent&&c==c.parent.next;)c=c.parent;c=c.parent}}}return b},first:function(){for(var a=this.parent;null!=a.prev;)a=a.prev;return a.data},pop_front:function(){for(var a=this.parent;null!=a.prev;)a=a.prev;var b=a.data;this.remove_node(a);return b},remove:function(a){a=this.find(a);this.remove_node(a)},successor_node:function(a){if(null!=a.next)for(a=a.next;null!=a.prev;)a=a.prev;else{var b=a;for(a=
a.parent;null!=a&&a.prev!=b;)b=a,a=a.parent}return a},predecessor_node:function(a){if(null!=a.prev)for(a=a.prev;null!=a.next;)a=a.next;else{var b=a;for(a=a.parent;null!=a&&a.next!=b;)b=a,a=a.parent}return a},successor:function(a){a=this.successor_node(this.find(a));return null==a?null:a.data},predecessor:function(a){a=this.predecessor_node(this.find(a));return null==a?null:a.data},remove_node:function(a){if(null!=a.next&&null!=a.prev){for(var b=a.next;null!=b.prev;)b=b.prev;var c=a.data;a.data=b.data;
b.data=c;null!=this.swapped&&this.swapped(a.data,b.data);a=b}b=null==a.prev?a.next:a.prev;if(1==a.colour)if(null!=a.prev||null!=a.next)b.colour=1;else if(null!=a.parent)for(c=a.parent;;){c.colour++;c.prev.colour--;c.next.colour--;var d=c.prev;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==d.colour){if(null!=d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);break}}d=c.next;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==
d.colour){if(null!=d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);break}}if(2==c.colour)if(null==c.parent)c.colour=1;else{c=c.parent;continue}break}c=a.parent;null==c?this.parent=b:c.prev==a?c.prev=b:c.next=b;null!=b&&(b.parent=c);a.parent=a.prev=a.next=null;a.data=null;a.lt=null;a.swapped=null;a.next=R.zpp_pool;R.zpp_pool=a},clear:function(){this.clear_with(function(a){})},clear_with:function(a){if(null!=this.parent){for(var b=
this.parent;null!=b;)b=null!=b.prev?b.prev:null!=b.next?b.next:this.clear_node(b,a);this.parent=null}},clear_node:function(a,b){b(a.data);var c=a.parent;null!=c&&(a==c.prev?c.prev=null:c.next=null,a.parent=null);a.data=null;a.lt=null;a.swapped=null;a.next=R.zpp_pool;R.zpp_pool=a;return c},__fix_neg_red:function(a){var b=a.parent;if(b.prev==a){var c=a.prev,d=a.next,e=d.prev,f=d.next;c.colour=0;a.colour=b.colour=1;a.next=e;null!=e&&(e.parent=a);a=b.data;b.data=d.data;d.data=a;null!=this.swapped&&this.swapped(b.data,
d.data);d.prev=f;null!=f&&(f.parent=d);d.next=b.next;null!=b.next&&(b.next.parent=d);b.next=d}else c=a.next,d=a.prev,e=d.next,f=d.prev,c.colour=0,a.colour=b.colour=1,a.prev=e,null!=e&&(e.parent=a),a=b.data,b.data=d.data,d.data=a,null!=this.swapped&&this.swapped(b.data,d.data),d.next=f,null!=f&&(f.parent=d),d.prev=b.prev,null!=b.prev&&(b.prev.parent=d),b.prev=d;null!=d&&(d.parent=b);b=c;null!=b.prev&&0==b.prev.colour?this.__fix_dbl_red(b.prev):null!=b.next&&0==b.next.colour&&this.__fix_dbl_red(b.next)},
__fix_dbl_red:function(a){for(;;){var b=a.parent,c=b.parent;if(null==c){b.colour=1;break}var d,e,f,g,q,k,l;b==c.prev?(f=c,l=c.next,a==b.prev?(d=a,e=b,g=a.prev,q=a.next,k=b.next):(d=b,e=a,g=b.prev,q=a.prev,k=a.next)):(d=c,g=c.prev,a==b.prev?(e=a,f=b,q=a.prev,k=a.next,l=b.next):(e=b,f=a,q=b.prev,k=a.prev,l=a.next));a=c.parent;null==a?this.parent=e:a.prev==c?a.prev=e:a.next=e;null!=e&&(e.parent=a);d.prev=g;null!=g&&(g.parent=d);d.next=q;null!=q&&(q.parent=d);e.prev=d;null!=d&&(d.parent=e);e.next=f;null!=
f&&(f.parent=e);f.prev=k;null!=k&&(k.parent=f);f.next=l;null!=l&&(l.parent=f);e.colour=c.colour-1;d.colour=1;f.colour=1;if(e==this.parent)this.parent.colour=1;else if(0==e.colour&&0==e.parent.colour){a=e;continue}break}},try_insert_bool:function(a){var b=null,c=null;if(null==this.parent)null==R.zpp_pool?b=new R:(b=R.zpp_pool,R.zpp_pool=b.next,b.next=null),null,b.data=a,this.parent=b;else for(c=this.parent;;)if(this.lt(a,c.data))if(null==c.prev){null==R.zpp_pool?b=new R:(b=R.zpp_pool,R.zpp_pool=b.next,
b.next=null);null;b.data=a;c.prev=b;b.parent=c;break}else c=c.prev;else if(this.lt(c.data,a))if(null==c.next){null==R.zpp_pool?b=new R:(b=R.zpp_pool,R.zpp_pool=b.next,b.next=null);null;b.data=a;c.next=b;b.parent=c;break}else c=c.next;else break;if(null==b)return!1;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return!0},try_insert:function(a){var b=null,c=null;if(null==this.parent)null==R.zpp_pool?b=new R:(b=R.zpp_pool,R.zpp_pool=b.next,b.next=null),null,b.data=a,
this.parent=b;else for(c=this.parent;;)if(this.lt(a,c.data))if(null==c.prev){null==R.zpp_pool?b=new R:(b=R.zpp_pool,R.zpp_pool=b.next,b.next=null);null;b.data=a;c.prev=b;b.parent=c;break}else c=c.prev;else if(this.lt(c.data,a))if(null==c.next){null==R.zpp_pool?b=new R:(b=R.zpp_pool,R.zpp_pool=b.next,b.next=null);null;b.data=a;c.next=b;b.parent=c;break}else c=c.next;else break;if(null==b)return c;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return b},insert:function(a){var b;
null==R.zpp_pool?b=new R:(b=R.zpp_pool,R.zpp_pool=b.next,b.next=null);null;b.data=a;if(null==this.parent)this.parent=b;else for(a=this.parent;;)if(this.lt(b.data,a.data))if(null==a.prev){a.prev=b;b.parent=a;break}else a=a.prev;else if(null==a.next){a.next=b;b.parent=a;break}else a=a.next;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return b},__class__:R};var U=function(){this.colour=0;this.lt=this.swapped=this.data=this.prev=this.next=this.parent=null};U.__name__=
!0;U.prototype={free:function(){this.swapped=this.lt=this.data=null},alloc:function(){},verify:function(){if(!this.empty()){for(var a=this.parent;null!=a.prev;)a=a.prev;for(;null!=a;){var b=a.data,c=!0;if(!this.empty()){for(var d=this.parent;null!=d.prev;)d=d.prev;for(;null!=d;){var e=d.data;if(!c){if(!this.lt(b,e)&&this.lt(e,b))return!1}else if(b==e)c=!1;else if(!this.lt(e,b)&&this.lt(b,e))return!1;if(null!=d.next)for(d=d.next;null!=d.prev;)d=d.prev;else{for(;null!=d.parent&&d==d.parent.next;)d=
d.parent;d=d.parent}}}if(null!=a.next)for(a=a.next;null!=a.prev;)a=a.prev;else{for(;null!=a.parent&&a==a.parent.next;)a=a.parent;a=a.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var a=0;if(!this.empty()){for(var b=this.parent;null!=b.prev;)b=b.prev;for(;null!=b;)if(a++,null!=b.next)for(b=b.next;null!=b.prev;)b=b.prev;else{for(;null!=b.parent&&b==b.parent.next;)b=b.parent;
b=b.parent}}return a},has:function(a){return null!=this.find(a)},find:function(a){for(var b=this.parent;null!=b&&b.data!=a;)b=this.lt(a,b.data)?b.prev:b.next;return b},has_weak:function(a){return null!=this.find_weak(a)},find_weak:function(a){for(var b=this.parent;null!=b;)if(this.lt(a,b.data))b=b.prev;else if(this.lt(b.data,a))b=b.next;else break;return b},lower_bound:function(a){var b=null;if(!this.empty()){for(var c=this.parent;null!=c.prev;)c=c.prev;for(;null!=c;){var d=c.data;if(!this.lt(d,a)){b=
d;break}if(null!=c.next)for(c=c.next;null!=c.prev;)c=c.prev;else{for(;null!=c.parent&&c==c.parent.next;)c=c.parent;c=c.parent}}}return b},first:function(){for(var a=this.parent;null!=a.prev;)a=a.prev;return a.data},pop_front:function(){for(var a=this.parent;null!=a.prev;)a=a.prev;var b=a.data;this.remove_node(a);return b},remove:function(a){a=this.find(a);this.remove_node(a)},successor_node:function(a){if(null!=a.next)for(a=a.next;null!=a.prev;)a=a.prev;else{var b=a;for(a=a.parent;null!=a&&a.prev!=
b;)b=a,a=a.parent}return a},predecessor_node:function(a){if(null!=a.prev)for(a=a.prev;null!=a.next;)a=a.next;else{var b=a;for(a=a.parent;null!=a&&a.next!=b;)b=a,a=a.parent}return a},successor:function(a){a=this.successor_node(this.find(a));return null==a?null:a.data},predecessor:function(a){a=this.predecessor_node(this.find(a));return null==a?null:a.data},remove_node:function(a){if(null!=a.next&&null!=a.prev){for(var b=a.next;null!=b.prev;)b=b.prev;var c=a.data;a.data=b.data;b.data=c;null!=this.swapped&&
this.swapped(a.data,b.data);a=b}b=null==a.prev?a.next:a.prev;if(1==a.colour)if(null!=a.prev||null!=a.next)b.colour=1;else if(null!=a.parent)for(c=a.parent;;){c.colour++;c.prev.colour--;c.next.colour--;var d=c.prev;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==d.colour){if(null!=d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);break}}d=c.next;if(-1==d.colour){this.__fix_neg_red(d);break}else if(0==d.colour){if(null!=
d.prev&&0==d.prev.colour){this.__fix_dbl_red(d.prev);break}if(null!=d.next&&0==d.next.colour){this.__fix_dbl_red(d.next);break}}if(2==c.colour)if(null==c.parent)c.colour=1;else{c=c.parent;continue}break}c=a.parent;null==c?this.parent=b:c.prev==a?c.prev=b:c.next=b;null!=b&&(b.parent=c);a.parent=a.prev=a.next=null;a.data=null;a.lt=null;a.swapped=null;a.next=U.zpp_pool;U.zpp_pool=a},clear:function(){this.clear_with(function(a){})},clear_with:function(a){if(null!=this.parent){for(var b=this.parent;null!=
b;)b=null!=b.prev?b.prev:null!=b.next?b.next:this.clear_node(b,a);this.parent=null}},clear_node:function(a,b){b(a.data);var c=a.parent;null!=c&&(a==c.prev?c.prev=null:c.next=null,a.parent=null);a.data=null;a.lt=null;a.swapped=null;a.next=U.zpp_pool;U.zpp_pool=a;return c},__fix_neg_red:function(a){var b=a.parent;if(b.prev==a){var c=a.prev,d=a.next,e=d.prev,f=d.next;c.colour=0;a.colour=b.colour=1;a.next=e;null!=e&&(e.parent=a);a=b.data;b.data=d.data;d.data=a;null!=this.swapped&&this.swapped(b.data,
d.data);d.prev=f;null!=f&&(f.parent=d);d.next=b.next;null!=b.next&&(b.next.parent=d);b.next=d}else c=a.next,d=a.prev,e=d.next,f=d.prev,c.colour=0,a.colour=b.colour=1,a.prev=e,null!=e&&(e.parent=a),a=b.data,b.data=d.data,d.data=a,null!=this.swapped&&this.swapped(b.data,d.data),d.next=f,null!=f&&(f.parent=d),d.prev=b.prev,null!=b.prev&&(b.prev.parent=d),b.prev=d;null!=d&&(d.parent=b);b=c;null!=b.prev&&0==b.prev.colour?this.__fix_dbl_red(b.prev):null!=b.next&&0==b.next.colour&&this.__fix_dbl_red(b.next)},
__fix_dbl_red:function(a){for(;;){var b=a.parent,c=b.parent;if(null==c){b.colour=1;break}var d,e,f,g,q,k,l;b==c.prev?(f=c,l=c.next,a==b.prev?(d=a,e=b,g=a.prev,q=a.next,k=b.next):(d=b,e=a,g=b.prev,q=a.prev,k=a.next)):(d=c,g=c.prev,a==b.prev?(e=a,f=b,q=a.prev,k=a.next,l=b.next):(e=b,f=a,q=b.prev,k=a.prev,l=a.next));a=c.parent;null==a?this.parent=e:a.prev==c?a.prev=e:a.next=e;null!=e&&(e.parent=a);d.prev=g;null!=g&&(g.parent=d);d.next=q;null!=q&&(q.parent=d);e.prev=d;null!=d&&(d.parent=e);e.next=f;null!=
f&&(f.parent=e);f.prev=k;null!=k&&(k.parent=f);f.next=l;null!=l&&(l.parent=f);e.colour=c.colour-1;d.colour=1;f.colour=1;if(e==this.parent)this.parent.colour=1;else if(0==e.colour&&0==e.parent.colour){a=e;continue}break}},try_insert_bool:function(a){var b=null,c=null;if(null==this.parent)null==U.zpp_pool?b=new U:(b=U.zpp_pool,U.zpp_pool=b.next,b.next=null),null,b.data=a,this.parent=b;else for(c=this.parent;;)if(this.lt(a,c.data))if(null==c.prev){null==U.zpp_pool?b=new U:(b=U.zpp_pool,U.zpp_pool=b.next,
b.next=null);null;b.data=a;c.prev=b;b.parent=c;break}else c=c.prev;else if(this.lt(c.data,a))if(null==c.next){null==U.zpp_pool?b=new U:(b=U.zpp_pool,U.zpp_pool=b.next,b.next=null);null;b.data=a;c.next=b;b.parent=c;break}else c=c.next;else break;if(null==b)return!1;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return!0},try_insert:function(a){var b=null,c=null;if(null==this.parent)null==U.zpp_pool?b=new U:(b=U.zpp_pool,U.zpp_pool=b.next,b.next=null),null,b.data=a,
this.parent=b;else for(c=this.parent;;)if(this.lt(a,c.data))if(null==c.prev){null==U.zpp_pool?b=new U:(b=U.zpp_pool,U.zpp_pool=b.next,b.next=null);null;b.data=a;c.prev=b;b.parent=c;break}else c=c.prev;else if(this.lt(c.data,a))if(null==c.next){null==U.zpp_pool?b=new U:(b=U.zpp_pool,U.zpp_pool=b.next,b.next=null);null;b.data=a;c.next=b;b.parent=c;break}else c=c.next;else break;if(null==b)return c;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return b},insert:function(a){var b;
null==U.zpp_pool?b=new U:(b=U.zpp_pool,U.zpp_pool=b.next,b.next=null);null;b.data=a;if(null==this.parent)this.parent=b;else for(a=this.parent;;)if(this.lt(b.data,a.data))if(null==a.prev){a.prev=b;b.parent=a;break}else a=a.prev;else if(null==a.next){a.next=b;b.parent=a;break}else a=a.next;null==b.parent?b.colour=1:(b.colour=0,0==b.parent.colour&&this.__fix_dbl_red(b));return b},__class__:U};var fa,Xf=0;String.prototype.__class__=String;String.__name__=!0;Array.__name__=!0;Date.prototype.__class__=
Date;Date.__name__=["Date"];var Yf={__name__:["Int"]},Zf={__name__:["Dynamic"]},Sf=Number;Sf.__name__=["Float"];var Tf=Boolean;Tf.__ename__=["Bool"];var $f={__name__:["Class"]},ag={};Xc.AUTO="auto";Xc.RECOMMENDED="recommended";Xc.CANVAS="canvas";Xc.WEBGL="webgl";qa.MEASUREMENT_INTERVAL=1E3;qa.FONT_FAMILY="Helvetica,Arial";qa.FPS_BG_CLR="#00FF00";qa.FPS_WARN_BG_CLR="#FF8000";qa.FPS_PROB_BG_CLR="#FF0000";qa.MS_BG_CLR="#FFFF00";qa.MEM_BG_CLR="#086A87";qa.INFO_BG_CLR="#00FFFF";qa.FPS_TXT_CLR="#000000";
qa.MS_TXT_CLR="#000000";qa.MEM_TXT_CLR="#FFFFFF";qa.INFO_TXT_CLR="#000000";qa.TOP_LEFT="TL";qa.TOP_RIGHT="TR";qa.BOTTOM_LEFT="BL";qa.BOTTOM_RIGHT="BR";qa.DELAY_TIME=4E3;ca.__toStr={}.toString;u.epsilon=1E-8;u.fluidAngularDragFriction=2.5;u.fluidAngularDrag=100;u.fluidVacuumDrag=.5;u.fluidLinearDrag=.5;u.collisionSlop=.2;u.collisionSlopCCD=.5;u.distanceThresholdCCD=.05;u.staticCCDLinearThreshold=.05;u.staticCCDAngularThreshold=.005;u.bulletCCDLinearThreshold=.125;u.bulletCCDAngularThreshold=.0125;
u.dynamicSweepLinearThreshold=17;u.dynamicSweepAngularThreshold=.6;u.angularCCDSlipScale=.75;u.arbiterExpirationDelay=6;u.staticFrictionThreshold=2;u.elasticThreshold=20;u.sleepDelay=60;u.linearSleepThreshold=.2;u.angularSleepThreshold=.4;u.contactBiasCoef=.3;u.contactStaticBiasCoef=.6;u.contactContinuousBiasCoef=.4;u.contactContinuousStaticBiasCoef=.5;u.constraintLinearSlop=.1;u.constraintAngularSlop=.001;u.illConditionedThreshold=2E8;T.zpp_internalAlloc=!1;Ja.zpp_internalAlloc=!1;Ua.zpp_internalAlloc=
!1;na._Constraint=0;na._Interactor=0;na._CbType=0;na._CbSet=0;na._Listener=0;na._ZPP_SimpleVert=0;na._ZPP_SimpleSeg=0;na._Space=0;na._InteractionGroup=0;Ra.internal=!1;Ha.ANY_SHAPE=new vb;Ha.ANY_BODY=new vb;Ha.ANY_COMPOUND=new vb;Ha.ANY_CONSTRAINT=new vb;g.internal=!1;g.id_ImmState_ACCEPT=1;g.id_ImmState_IGNORE=2;g.id_ImmState_ALWAYS=4;g.id_GravMassMode_DEFAULT=0;g.id_GravMassMode_FIXED=1;g.id_GravMassMode_SCALED=2;g.id_InertiaMode_DEFAULT=0;g.id_InertiaMode_FIXED=1;g.id_MassMode_DEFAULT=0;g.id_MassMode_FIXED=
1;g.id_BodyType_STATIC=1;g.id_BodyType_DYNAMIC=2;g.id_BodyType_KINEMATIC=3;g.id_ListenerType_BODY=0;g.id_PreFlag_ACCEPT=1;g.id_ListenerType_CONSTRAINT=1;g.id_PreFlag_IGNORE=2;g.id_ListenerType_INTERACTION=2;g.id_PreFlag_ACCEPT_ONCE=3;g.id_ListenerType_PRE=3;g.id_PreFlag_IGNORE_ONCE=4;g.id_CbEvent_BEGIN=0;g.id_InteractionType_COLLISION=1;g.id_CbEvent_ONGOING=6;g.id_InteractionType_SENSOR=2;g.id_CbEvent_END=1;g.id_InteractionType_FLUID=4;g.id_CbEvent_WAKE=2;g.id_InteractionType_ANY=7;g.id_CbEvent_SLEEP=
3;g.id_CbEvent_BREAK=4;g.id_CbEvent_PRE=5;g.id_Winding_UNDEFINED=0;g.id_Winding_CLOCKWISE=1;g.id_Winding_ANTICLOCKWISE=2;g.id_ValidationResult_VALID=0;g.id_ValidationResult_DEGENERATE=1;g.id_ValidationResult_CONCAVE=2;g.id_ValidationResult_SELF_INTERSECTING=3;g.id_ShapeType_CIRCLE=0;g.id_ShapeType_POLYGON=1;g.id_Broadphase_DYNAMIC_AABB_TREE=0;g.id_Broadphase_SWEEP_AND_PRUNE=1;g.id_ArbiterType_COLLISION=1;g.id_ArbiterType_SENSOR=2;g.id_ArbiterType_FLUID=4;va.internal=!1;null==g.ListenerType_BODY&&
(g.internal=!0,g.ListenerType_BODY=new pb,g.internal=!1);var bg=g.ListenerType_BODY;null==g.ListenerType_CONSTRAINT&&(g.internal=!0,g.ListenerType_CONSTRAINT=new pb,g.internal=!1);var cg=g.ListenerType_CONSTRAINT;null==g.ListenerType_INTERACTION&&(g.internal=!0,g.ListenerType_INTERACTION=new pb,g.internal=!1);var dg=g.ListenerType_INTERACTION;null==g.ListenerType_PRE&&(g.internal=!0,g.ListenerType_PRE=new pb,g.internal=!1);va.types=[bg,cg,dg,g.ListenerType_PRE];null==g.CbEvent_BEGIN&&(g.internal=
!0,g.CbEvent_BEGIN=new S,g.internal=!1);var eg=g.CbEvent_BEGIN;null==g.CbEvent_END&&(g.internal=!0,g.CbEvent_END=new S,g.internal=!1);var fg=g.CbEvent_END;null==g.CbEvent_WAKE&&(g.internal=!0,g.CbEvent_WAKE=new S,g.internal=!1);var gg=g.CbEvent_WAKE;null==g.CbEvent_SLEEP&&(g.internal=!0,g.CbEvent_SLEEP=new S,g.internal=!1);var hg=g.CbEvent_SLEEP;null==g.CbEvent_BREAK&&(g.internal=!0,g.CbEvent_BREAK=new S,g.internal=!1);var ig=g.CbEvent_BREAK;null==g.CbEvent_PRE&&(g.internal=!0,g.CbEvent_PRE=new S,
g.internal=!1);var jg=g.CbEvent_PRE;null==g.CbEvent_ONGOING&&(g.internal=!0,g.CbEvent_ONGOING=new S,g.internal=!1);va.events=[eg,fg,gg,hg,ig,jg,g.CbEvent_ONGOING];Lb.UCbSet=new zd;Lb.VCbSet=new zd;Lb.WCbSet=new zd;Lb.UCbType=new Uc;Lb.VCbType=new Uc;Lb.WCbType=new Uc;F.internal=!1;F.COL=1;F.FLUID=4;F.SENSOR=2;null==g.ArbiterType_COLLISION&&(g.internal=!0,g.ArbiterType_COLLISION=new rb,g.internal=!1);var kg=g.ArbiterType_COLLISION;null==g.ArbiterType_SENSOR&&(g.internal=!0,g.ArbiterType_SENSOR=new rb,
g.internal=!1);var lg=g.ArbiterType_SENSOR;null==g.ArbiterType_FLUID&&(g.internal=!0,g.ArbiterType_FLUID=new rb,g.internal=!1);F.types=[null,kg,lg,null,g.ArbiterType_FLUID];dc.FACE1=0;dc.FACE2=1;dc.CIRCLE=2;Ia.internal=!1;C.flowpoly=new ie;C.flowsegs=new ie;Ba.internal=!1;wb.internal=!1;da.me=new da;da.look_march=[-1,224,56,216,14,-1,54,214,131,99,-1,91,141,109,181,85];ea.nextId=0;null==g.BodyType_STATIC&&(g.internal=!0,g.BodyType_STATIC=new Ga,g.internal=!1);var mg=g.BodyType_STATIC;null==g.BodyType_DYNAMIC&&
(g.internal=!0,g.BodyType_DYNAMIC=new Ga,g.internal=!1);var ng=g.BodyType_DYNAMIC;null==g.BodyType_KINEMATIC&&(g.internal=!0,g.BodyType_KINEMATIC=new Ga,g.internal=!1);H.types=[null,mg,ng,g.BodyType_KINEMATIC];H.cur_graph_depth=0;W.WAKE=1;W.PROPS=2;W.ANGDRAG=4;W.ARBITERS=8;null==g.ShapeType_CIRCLE&&(g.internal=!0,g.ShapeType_CIRCLE=new Tc,g.internal=!1);var og=g.ShapeType_CIRCLE;null==g.ShapeType_POLYGON&&(g.internal=!0,g.ShapeType_POLYGON=new Tc,g.internal=!1);cd.types=[og,g.ShapeType_POLYGON];Ca.internal=
!1;Gb.tmpaabb=new X;ee.FATTEN=3;ee.VEL_STEPS=2;mb.internal=!1;pc.internal=!1;od.internal=!1;Jc.internal=!1;qd.internal=!1;Vb.internal=!1;yd.internal=!1;$c.internal=!1;gd.internal=!1;oc.internal=!1;hd.internal=!1;Zc.internal=!1;qb.internal=!1;td.internal=!1;la.main()})("undefined"!=typeof console?console:{log:function(){}},"undefined"!=typeof window?window:exports,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);
